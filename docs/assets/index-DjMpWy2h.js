function DU(n,t){for(var e=0;e<t.length;e++){const s=t[e];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();function tO(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function ZS(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var e=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(e,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),e}var Gv={exports:{}},Sd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TI;function OU(){if(TI)return Sd;TI=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(s,r,a){var i=null;if(a!==void 0&&(i=""+a),r.key!==void 0&&(i=""+r.key),"key"in r){a={};for(var o in r)o!=="key"&&(a[o]=r[o])}else a=r;return r=a.ref,{$$typeof:n,type:s,key:i,ref:r!==void 0?r:null,props:a}}return Sd.Fragment=t,Sd.jsx=e,Sd.jsxs=e,Sd}var NI;function _U(){return NI||(NI=1,Gv.exports=OU()),Gv.exports}var q=_U(),jv={exports:{}},Kt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CI;function FU(){if(CI)return Kt;CI=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function m(P){return P===null||typeof P!="object"?null:(P=f&&P[f]||P["@@iterator"],typeof P=="function"?P:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,x={};function v(P,j,rt){this.props=P,this.context=j,this.refs=x,this.updater=rt||g}v.prototype.isReactComponent={},v.prototype.setState=function(P,j){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,j,"setState")},v.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function w(){}w.prototype=v.prototype;function T(P,j,rt){this.props=P,this.context=j,this.refs=x,this.updater=rt||g}var C=T.prototype=new w;C.constructor=T,b(C,v.prototype),C.isPureReactComponent=!0;var k=Array.isArray,$={H:null,A:null,T:null,S:null,V:null},I=Object.prototype.hasOwnProperty;function D(P,j,rt,st,mt,gt){return rt=gt.ref,{$$typeof:n,type:P,key:j,ref:rt!==void 0?rt:null,props:gt}}function _(P,j){return D(P.type,j,void 0,void 0,void 0,P.props)}function O(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function L(P){var j={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(rt){return j[rt]})}var R=/\/+/g;function V(P,j){return typeof P=="object"&&P!==null&&P.key!=null?L(""+P.key):j.toString(36)}function Y(){}function Q(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(Y,Y):(P.status="pending",P.then(function(j){P.status==="pending"&&(P.status="fulfilled",P.value=j)},function(j){P.status==="pending"&&(P.status="rejected",P.reason=j)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function tt(P,j,rt,st,mt){var gt=typeof P;(gt==="undefined"||gt==="boolean")&&(P=null);var bt=!1;if(P===null)bt=!0;else switch(gt){case"bigint":case"string":case"number":bt=!0;break;case"object":switch(P.$$typeof){case n:case t:bt=!0;break;case d:return bt=P._init,tt(bt(P._payload),j,rt,st,mt)}}if(bt)return mt=mt(P),bt=st===""?"."+V(P,0):st,k(mt)?(rt="",bt!=null&&(rt=bt.replace(R,"$&/")+"/"),tt(mt,j,rt,"",function(_t){return _t})):mt!=null&&(O(mt)&&(mt=_(mt,rt+(mt.key==null||P&&P.key===mt.key?"":(""+mt.key).replace(R,"$&/")+"/")+bt)),j.push(mt)),1;bt=0;var $t=st===""?".":st+":";if(k(P))for(var Ct=0;Ct<P.length;Ct++)st=P[Ct],gt=$t+V(st,Ct),bt+=tt(st,j,rt,gt,mt);else if(Ct=m(P),typeof Ct=="function")for(P=Ct.call(P),Ct=0;!(st=P.next()).done;)st=st.value,gt=$t+V(st,Ct++),bt+=tt(st,j,rt,gt,mt);else if(gt==="object"){if(typeof P.then=="function")return tt(Q(P),j,rt,st,mt);throw j=String(P),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return bt}function B(P,j,rt){if(P==null)return P;var st=[],mt=0;return tt(P,st,"","",function(gt){return j.call(rt,gt,mt++)}),st}function W(P){if(P._status===-1){var j=P._result;j=j(),j.then(function(rt){(P._status===0||P._status===-1)&&(P._status=1,P._result=rt)},function(rt){(P._status===0||P._status===-1)&&(P._status=2,P._result=rt)}),P._status===-1&&(P._status=0,P._result=j)}if(P._status===1)return P._result.default;throw P._result}var X=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function ot(){}return Kt.Children={map:B,forEach:function(P,j,rt){B(P,function(){j.apply(this,arguments)},rt)},count:function(P){var j=0;return B(P,function(){j++}),j},toArray:function(P){return B(P,function(j){return j})||[]},only:function(P){if(!O(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Kt.Component=v,Kt.Fragment=e,Kt.Profiler=r,Kt.PureComponent=T,Kt.StrictMode=s,Kt.Suspense=l,Kt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,Kt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return $.H.useMemoCache(P)}},Kt.cache=function(P){return function(){return P.apply(null,arguments)}},Kt.cloneElement=function(P,j,rt){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var st=b({},P.props),mt=P.key,gt=void 0;if(j!=null)for(bt in j.ref!==void 0&&(gt=void 0),j.key!==void 0&&(mt=""+j.key),j)!I.call(j,bt)||bt==="key"||bt==="__self"||bt==="__source"||bt==="ref"&&j.ref===void 0||(st[bt]=j[bt]);var bt=arguments.length-2;if(bt===1)st.children=rt;else if(1<bt){for(var $t=Array(bt),Ct=0;Ct<bt;Ct++)$t[Ct]=arguments[Ct+2];st.children=$t}return D(P.type,mt,void 0,void 0,gt,st)},Kt.createContext=function(P){return P={$$typeof:i,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:a,_context:P},P},Kt.createElement=function(P,j,rt){var st,mt={},gt=null;if(j!=null)for(st in j.key!==void 0&&(gt=""+j.key),j)I.call(j,st)&&st!=="key"&&st!=="__self"&&st!=="__source"&&(mt[st]=j[st]);var bt=arguments.length-2;if(bt===1)mt.children=rt;else if(1<bt){for(var $t=Array(bt),Ct=0;Ct<bt;Ct++)$t[Ct]=arguments[Ct+2];mt.children=$t}if(P&&P.defaultProps)for(st in bt=P.defaultProps,bt)mt[st]===void 0&&(mt[st]=bt[st]);return D(P,gt,void 0,void 0,null,mt)},Kt.createRef=function(){return{current:null}},Kt.forwardRef=function(P){return{$$typeof:o,render:P}},Kt.isValidElement=O,Kt.lazy=function(P){return{$$typeof:d,_payload:{_status:-1,_result:P},_init:W}},Kt.memo=function(P,j){return{$$typeof:c,type:P,compare:j===void 0?null:j}},Kt.startTransition=function(P){var j=$.T,rt={};$.T=rt;try{var st=P(),mt=$.S;mt!==null&&mt(rt,st),typeof st=="object"&&st!==null&&typeof st.then=="function"&&st.then(ot,X)}catch(gt){X(gt)}finally{$.T=j}},Kt.unstable_useCacheRefresh=function(){return $.H.useCacheRefresh()},Kt.use=function(P){return $.H.use(P)},Kt.useActionState=function(P,j,rt){return $.H.useActionState(P,j,rt)},Kt.useCallback=function(P,j){return $.H.useCallback(P,j)},Kt.useContext=function(P){return $.H.useContext(P)},Kt.useDebugValue=function(){},Kt.useDeferredValue=function(P,j){return $.H.useDeferredValue(P,j)},Kt.useEffect=function(P,j,rt){var st=$.H;if(typeof rt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return st.useEffect(P,j)},Kt.useId=function(){return $.H.useId()},Kt.useImperativeHandle=function(P,j,rt){return $.H.useImperativeHandle(P,j,rt)},Kt.useInsertionEffect=function(P,j){return $.H.useInsertionEffect(P,j)},Kt.useLayoutEffect=function(P,j){return $.H.useLayoutEffect(P,j)},Kt.useMemo=function(P,j){return $.H.useMemo(P,j)},Kt.useOptimistic=function(P,j){return $.H.useOptimistic(P,j)},Kt.useReducer=function(P,j,rt){return $.H.useReducer(P,j,rt)},Kt.useRef=function(P){return $.H.useRef(P)},Kt.useState=function(P){return $.H.useState(P)},Kt.useSyncExternalStore=function(P,j,rt){return $.H.useSyncExternalStore(P,j,rt)},Kt.useTransition=function(){return $.H.useTransition()},Kt.version="19.1.0",Kt}var kI;function QS(){return kI||(kI=1,jv.exports=FU()),jv.exports}var nt=QS();const _g=tO(nt);var Hv={exports:{}},Td={},qv={exports:{}},Kv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $I;function LU(){return $I||($I=1,function(n){function t(B,W){var X=B.length;B.push(W);t:for(;0<X;){var ot=X-1>>>1,P=B[ot];if(0<r(P,W))B[ot]=W,B[X]=P,X=ot;else break t}}function e(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var W=B[0],X=B.pop();if(X!==W){B[0]=X;t:for(var ot=0,P=B.length,j=P>>>1;ot<j;){var rt=2*(ot+1)-1,st=B[rt],mt=rt+1,gt=B[mt];if(0>r(st,X))mt<P&&0>r(gt,st)?(B[ot]=gt,B[mt]=X,ot=mt):(B[ot]=st,B[rt]=X,ot=rt);else if(mt<P&&0>r(gt,X))B[ot]=gt,B[mt]=X,ot=mt;else break t}}return W}function r(B,W){var X=B.sortIndex-W.sortIndex;return X!==0?X:B.id-W.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();n.unstable_now=function(){return i.now()-o}}var l=[],c=[],d=1,f=null,m=3,g=!1,b=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function k(B){for(var W=e(c);W!==null;){if(W.callback===null)s(c);else if(W.startTime<=B)s(c),W.sortIndex=W.expirationTime,t(l,W);else break;W=e(c)}}function $(B){if(x=!1,k(B),!b)if(e(l)!==null)b=!0,I||(I=!0,V());else{var W=e(c);W!==null&&tt($,W.startTime-B)}}var I=!1,D=-1,_=5,O=-1;function L(){return v?!0:!(n.unstable_now()-O<_)}function R(){if(v=!1,I){var B=n.unstable_now();O=B;var W=!0;try{t:{b=!1,x&&(x=!1,T(D),D=-1),g=!0;var X=m;try{e:{for(k(B),f=e(l);f!==null&&!(f.expirationTime>B&&L());){var ot=f.callback;if(typeof ot=="function"){f.callback=null,m=f.priorityLevel;var P=ot(f.expirationTime<=B);if(B=n.unstable_now(),typeof P=="function"){f.callback=P,k(B),W=!0;break e}f===e(l)&&s(l),k(B)}else s(l);f=e(l)}if(f!==null)W=!0;else{var j=e(c);j!==null&&tt($,j.startTime-B),W=!1}}break t}finally{f=null,m=X,g=!1}W=void 0}}finally{W?V():I=!1}}}var V;if(typeof C=="function")V=function(){C(R)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Q=Y.port2;Y.port1.onmessage=R,V=function(){Q.postMessage(null)}}else V=function(){w(R,0)};function tt(B,W){D=w(function(){B(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(B){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var X=m;m=W;try{return B()}finally{m=X}},n.unstable_requestPaint=function(){v=!0},n.unstable_runWithPriority=function(B,W){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var X=m;m=B;try{return W()}finally{m=X}},n.unstable_scheduleCallback=function(B,W,X){var ot=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ot+X:ot):X=ot,B){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=X+P,B={id:d++,callback:W,priorityLevel:B,startTime:X,expirationTime:P,sortIndex:-1},X>ot?(B.sortIndex=X,t(c,B),e(l)===null&&B===e(c)&&(x?(T(D),D=-1):x=!0,tt($,X-ot))):(B.sortIndex=P,t(l,B),b||g||(b=!0,I||(I=!0,V()))),B},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(B){var W=m;return function(){var X=m;m=W;try{return B.apply(this,arguments)}finally{m=X}}}}(Kv)),Kv}var EI;function MU(){return EI||(EI=1,qv.exports=LU()),qv.exports}var Xv={exports:{}},ts={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var II;function zU(){if(II)return ts;II=1;var n=QS();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var s={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(l,c,d){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:f==null?null:""+f,children:l,containerInfo:c,implementation:d}}var i=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return ts.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,ts.createPortal=function(l,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return a(l,c,null,d)},ts.flushSync=function(l){var c=i.T,d=s.p;try{if(i.T=null,s.p=2,l)return l()}finally{i.T=c,s.p=d,s.d.f()}},ts.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,s.d.C(l,c))},ts.prefetchDNS=function(l){typeof l=="string"&&s.d.D(l)},ts.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var d=c.as,f=o(d,c.crossOrigin),m=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;d==="style"?s.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:f,integrity:m,fetchPriority:g}):d==="script"&&s.d.X(l,{crossOrigin:f,integrity:m,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},ts.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var d=o(c.as,c.crossOrigin);s.d.M(l,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&s.d.M(l)},ts.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var d=c.as,f=o(d,c.crossOrigin);s.d.L(l,d,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},ts.preloadModule=function(l,c){if(typeof l=="string")if(c){var d=o(c.as,c.crossOrigin);s.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else s.d.m(l)},ts.requestFormReset=function(l){s.d.r(l)},ts.unstable_batchedUpdates=function(l,c){return l(c)},ts.useFormState=function(l,c,d){return i.H.useFormState(l,c,d)},ts.useFormStatus=function(){return i.H.useHostTransitionStatus()},ts.version="19.1.0",ts}var AI;function PU(){if(AI)return Xv.exports;AI=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Xv.exports=zU(),Xv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RI;function BU(){if(RI)return Td;RI=1;var n=MU(),t=QS(),e=PU();function s(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function a(u){var h=u,p=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(p=h.return),u=h.return;while(u)}return h.tag===3?p:null}function i(u){if(u.tag===13){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function o(u){if(a(u)!==u)throw Error(s(188))}function l(u){var h=u.alternate;if(!h){if(h=a(u),h===null)throw Error(s(188));return h!==u?null:u}for(var p=u,y=h;;){var S=p.return;if(S===null)break;var N=S.alternate;if(N===null){if(y=S.return,y!==null){p=y;continue}break}if(S.child===N.child){for(N=S.child;N;){if(N===p)return o(S),u;if(N===y)return o(S),h;N=N.sibling}throw Error(s(188))}if(p.return!==y.return)p=S,y=N;else{for(var A=!1,z=S.child;z;){if(z===p){A=!0,p=S,y=N;break}if(z===y){A=!0,y=S,p=N;break}z=z.sibling}if(!A){for(z=N.child;z;){if(z===p){A=!0,p=N,y=S;break}if(z===y){A=!0,y=N,p=S;break}z=z.sibling}if(!A)throw Error(s(189))}}if(p.alternate!==y)throw Error(s(190))}if(p.tag!==3)throw Error(s(188));return p.stateNode.current===p?u:h}function c(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u;for(u=u.child;u!==null;){if(h=c(u),h!==null)return h;u=u.sibling}return null}var d=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),T=Symbol.for("react.consumer"),C=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function V(u){return u===null||typeof u!="object"?null:(u=R&&u[R]||u["@@iterator"],typeof u=="function"?u:null)}var Y=Symbol.for("react.client.reference");function Q(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===Y?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case b:return"Fragment";case v:return"Profiler";case x:return"StrictMode";case $:return"Suspense";case I:return"SuspenseList";case O:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case g:return"Portal";case C:return(u.displayName||"Context")+".Provider";case T:return(u._context.displayName||"Context")+".Consumer";case k:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case D:return h=u.displayName||null,h!==null?h:Q(u.type)||"Memo";case _:h=u._payload,u=u._init;try{return Q(u(h))}catch{}}return null}var tt=Array.isArray,B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},ot=[],P=-1;function j(u){return{current:u}}function rt(u){0>P||(u.current=ot[P],ot[P]=null,P--)}function st(u,h){P++,ot[P]=u.current,u.current=h}var mt=j(null),gt=j(null),bt=j(null),$t=j(null);function Ct(u,h){switch(st(bt,h),st(gt,u),st(mt,null),h.nodeType){case 9:case 11:u=(u=h.documentElement)&&(u=u.namespaceURI)?ZE(u):0;break;default:if(u=h.tagName,h=h.namespaceURI)h=ZE(h),u=QE(h,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}rt(mt),st(mt,u)}function _t(){rt(mt),rt(gt),rt(bt)}function Wt(u){u.memoizedState!==null&&st($t,u);var h=mt.current,p=QE(h,u.type);h!==p&&(st(gt,u),st(mt,p))}function Gt(u){gt.current===u&&(rt(mt),rt(gt)),$t.current===u&&(rt($t),yd._currentValue=X)}var ue=Object.prototype.hasOwnProperty,fe=n.unstable_scheduleCallback,Ee=n.unstable_cancelCallback,xe=n.unstable_shouldYield,pe=n.unstable_requestPaint,oe=n.unstable_now,Ie=n.unstable_getCurrentPriorityLevel,ar=n.unstable_ImmediatePriority,sn=n.unstable_UserBlockingPriority,Vs=n.unstable_NormalPriority,hs=n.unstable_LowPriority,Zr=n.unstable_IdlePriority,Us=n.log,Ir=n.unstable_setDisableYieldValue,Ns=null,Ke=null;function Wn(u){if(typeof Us=="function"&&Ir(u),Ke&&typeof Ke.setStrictMode=="function")try{Ke.setStrictMode(Ns,u)}catch{}}var vn=Math.clz32?Math.clz32:Dx,Nh=Math.log,Ch=Math.LN2;function Dx(u){return u>>>=0,u===0?32:31-(Nh(u)/Ch|0)|0}var ka=256,Vl=4194304;function $a(u){var h=u&42;if(h!==0)return h;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function Tm(u,h,p){var y=u.pendingLanes;if(y===0)return 0;var S=0,N=u.suspendedLanes,A=u.pingedLanes;u=u.warmLanes;var z=y&134217727;return z!==0?(y=z&~N,y!==0?S=$a(y):(A&=z,A!==0?S=$a(A):p||(p=z&~u,p!==0&&(S=$a(p))))):(z=y&~N,z!==0?S=$a(z):A!==0?S=$a(A):p||(p=y&~u,p!==0&&(S=$a(p)))),S===0?0:h!==0&&h!==S&&(h&N)===0&&(N=S&-S,p=h&-h,N>=p||N===32&&(p&4194048)!==0)?h:S}function kh(u,h){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&h)===0}function xB(u,h){switch(u){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _C(){var u=ka;return ka<<=1,(ka&4194048)===0&&(ka=256),u}function FC(){var u=Vl;return Vl<<=1,(Vl&62914560)===0&&(Vl=4194304),u}function Ox(u){for(var h=[],p=0;31>p;p++)h.push(u);return h}function $h(u,h){u.pendingLanes|=h,h!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function vB(u,h,p,y,S,N){var A=u.pendingLanes;u.pendingLanes=p,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=p,u.entangledLanes&=p,u.errorRecoveryDisabledLanes&=p,u.shellSuspendCounter=0;var z=u.entanglements,H=u.expirationTimes,ct=u.hiddenUpdates;for(p=A&~p;0<p;){var yt=31-vn(p),vt=1<<yt;z[yt]=0,H[yt]=-1;var ht=ct[yt];if(ht!==null)for(ct[yt]=null,yt=0;yt<ht.length;yt++){var dt=ht[yt];dt!==null&&(dt.lane&=-536870913)}p&=~vt}y!==0&&LC(u,y,0),N!==0&&S===0&&u.tag!==0&&(u.suspendedLanes|=N&~(A&~h))}function LC(u,h,p){u.pendingLanes|=h,u.suspendedLanes&=~h;var y=31-vn(h);u.entangledLanes|=h,u.entanglements[y]=u.entanglements[y]|1073741824|p&4194090}function MC(u,h){var p=u.entangledLanes|=h;for(u=u.entanglements;p;){var y=31-vn(p),S=1<<y;S&h|u[y]&h&&(u[y]|=h),p&=~S}}function _x(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function Fx(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function zC(){var u=W.p;return u!==0?u:(u=window.event,u===void 0?32:yI(u.type))}function wB(u,h){var p=W.p;try{return W.p=u,h()}finally{W.p=p}}var bi=Math.random().toString(36).slice(2),Qn="__reactFiber$"+bi,Cs="__reactProps$"+bi,Ul="__reactContainer$"+bi,Lx="__reactEvents$"+bi,SB="__reactListeners$"+bi,TB="__reactHandles$"+bi,PC="__reactResources$"+bi,Eh="__reactMarker$"+bi;function Mx(u){delete u[Qn],delete u[Cs],delete u[Lx],delete u[SB],delete u[TB]}function Wl(u){var h=u[Qn];if(h)return h;for(var p=u.parentNode;p;){if(h=p[Ul]||p[Qn]){if(p=h.alternate,h.child!==null||p!==null&&p.child!==null)for(u=nI(u);u!==null;){if(p=u[Qn])return p;u=nI(u)}return h}u=p,p=u.parentNode}return null}function Gl(u){if(u=u[Qn]||u[Ul]){var h=u.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return u}return null}function Ih(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u.stateNode;throw Error(s(33))}function jl(u){var h=u[PC];return h||(h=u[PC]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function An(u){u[Eh]=!0}var BC=new Set,VC={};function No(u,h){Hl(u,h),Hl(u+"Capture",h)}function Hl(u,h){for(VC[u]=h,u=0;u<h.length;u++)BC.add(h[u])}var NB=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),UC={},WC={};function CB(u){return ue.call(WC,u)?!0:ue.call(UC,u)?!1:NB.test(u)?WC[u]=!0:(UC[u]=!0,!1)}function Nm(u,h,p){if(CB(h))if(p===null)u.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":u.removeAttribute(h);return;case"boolean":var y=h.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){u.removeAttribute(h);return}}u.setAttribute(h,""+p)}}function Cm(u,h,p){if(p===null)u.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(h);return}u.setAttribute(h,""+p)}}function Ea(u,h,p,y){if(y===null)u.removeAttribute(p);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(p);return}u.setAttributeNS(h,p,""+y)}}var zx,GC;function ql(u){if(zx===void 0)try{throw Error()}catch(p){var h=p.stack.trim().match(/\n( *(at )?)/);zx=h&&h[1]||"",GC=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zx+u+GC}var Px=!1;function Bx(u,h){if(!u||Px)return"";Px=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(h){var vt=function(){throw Error()};if(Object.defineProperty(vt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(vt,[])}catch(dt){var ht=dt}Reflect.construct(u,[],vt)}else{try{vt.call()}catch(dt){ht=dt}u.call(vt.prototype)}}else{try{throw Error()}catch(dt){ht=dt}(vt=u())&&typeof vt.catch=="function"&&vt.catch(function(){})}}catch(dt){if(dt&&ht&&typeof dt.stack=="string")return[dt.stack,ht.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=y.DetermineComponentFrameRoot(),A=N[0],z=N[1];if(A&&z){var H=A.split(`
`),ct=z.split(`
`);for(S=y=0;y<H.length&&!H[y].includes("DetermineComponentFrameRoot");)y++;for(;S<ct.length&&!ct[S].includes("DetermineComponentFrameRoot");)S++;if(y===H.length||S===ct.length)for(y=H.length-1,S=ct.length-1;1<=y&&0<=S&&H[y]!==ct[S];)S--;for(;1<=y&&0<=S;y--,S--)if(H[y]!==ct[S]){if(y!==1||S!==1)do if(y--,S--,0>S||H[y]!==ct[S]){var yt=`
`+H[y].replace(" at new "," at ");return u.displayName&&yt.includes("<anonymous>")&&(yt=yt.replace("<anonymous>",u.displayName)),yt}while(1<=y&&0<=S);break}}}finally{Px=!1,Error.prepareStackTrace=p}return(p=u?u.displayName||u.name:"")?ql(p):""}function kB(u){switch(u.tag){case 26:case 27:case 5:return ql(u.type);case 16:return ql("Lazy");case 13:return ql("Suspense");case 19:return ql("SuspenseList");case 0:case 15:return Bx(u.type,!1);case 11:return Bx(u.type.render,!1);case 1:return Bx(u.type,!0);case 31:return ql("Activity");default:return""}}function jC(u){try{var h="";do h+=kB(u),u=u.return;while(u);return h}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function ir(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function HC(u){var h=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function $B(u){var h=HC(u)?"checked":"value",p=Object.getOwnPropertyDescriptor(u.constructor.prototype,h),y=""+u[h];if(!u.hasOwnProperty(h)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,N=p.set;return Object.defineProperty(u,h,{configurable:!0,get:function(){return S.call(this)},set:function(A){y=""+A,N.call(this,A)}}),Object.defineProperty(u,h,{enumerable:p.enumerable}),{getValue:function(){return y},setValue:function(A){y=""+A},stopTracking:function(){u._valueTracker=null,delete u[h]}}}}function km(u){u._valueTracker||(u._valueTracker=$B(u))}function qC(u){if(!u)return!1;var h=u._valueTracker;if(!h)return!0;var p=h.getValue(),y="";return u&&(y=HC(u)?u.checked?"true":"false":u.value),u=y,u!==p?(h.setValue(u),!0):!1}function $m(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var EB=/[\n"\\]/g;function or(u){return u.replace(EB,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Vx(u,h,p,y,S,N,A,z){u.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?u.type=A:u.removeAttribute("type"),h!=null?A==="number"?(h===0&&u.value===""||u.value!=h)&&(u.value=""+ir(h)):u.value!==""+ir(h)&&(u.value=""+ir(h)):A!=="submit"&&A!=="reset"||u.removeAttribute("value"),h!=null?Ux(u,A,ir(h)):p!=null?Ux(u,A,ir(p)):y!=null&&u.removeAttribute("value"),S==null&&N!=null&&(u.defaultChecked=!!N),S!=null&&(u.checked=S&&typeof S!="function"&&typeof S!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?u.name=""+ir(z):u.removeAttribute("name")}function KC(u,h,p,y,S,N,A,z){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(u.type=N),h!=null||p!=null){if(!(N!=="submit"&&N!=="reset"||h!=null))return;p=p!=null?""+ir(p):"",h=h!=null?""+ir(h):p,z||h===u.value||(u.value=h),u.defaultValue=h}y=y??S,y=typeof y!="function"&&typeof y!="symbol"&&!!y,u.checked=z?u.checked:!!y,u.defaultChecked=!!y,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(u.name=A)}function Ux(u,h,p){h==="number"&&$m(u.ownerDocument)===u||u.defaultValue===""+p||(u.defaultValue=""+p)}function Kl(u,h,p,y){if(u=u.options,h){h={};for(var S=0;S<p.length;S++)h["$"+p[S]]=!0;for(p=0;p<u.length;p++)S=h.hasOwnProperty("$"+u[p].value),u[p].selected!==S&&(u[p].selected=S),S&&y&&(u[p].defaultSelected=!0)}else{for(p=""+ir(p),h=null,S=0;S<u.length;S++){if(u[S].value===p){u[S].selected=!0,y&&(u[S].defaultSelected=!0);return}h!==null||u[S].disabled||(h=u[S])}h!==null&&(h.selected=!0)}}function XC(u,h,p){if(h!=null&&(h=""+ir(h),h!==u.value&&(u.value=h),p==null)){u.defaultValue!==h&&(u.defaultValue=h);return}u.defaultValue=p!=null?""+ir(p):""}function YC(u,h,p,y){if(h==null){if(y!=null){if(p!=null)throw Error(s(92));if(tt(y)){if(1<y.length)throw Error(s(93));y=y[0]}p=y}p==null&&(p=""),h=p}p=ir(h),u.defaultValue=p,y=u.textContent,y===p&&y!==""&&y!==null&&(u.value=y)}function Xl(u,h){if(h){var p=u.firstChild;if(p&&p===u.lastChild&&p.nodeType===3){p.nodeValue=h;return}}u.textContent=h}var IB=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ZC(u,h,p){var y=h.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?y?u.setProperty(h,""):h==="float"?u.cssFloat="":u[h]="":y?u.setProperty(h,p):typeof p!="number"||p===0||IB.has(h)?h==="float"?u.cssFloat=p:u[h]=(""+p).trim():u[h]=p+"px"}function QC(u,h,p){if(h!=null&&typeof h!="object")throw Error(s(62));if(u=u.style,p!=null){for(var y in p)!p.hasOwnProperty(y)||h!=null&&h.hasOwnProperty(y)||(y.indexOf("--")===0?u.setProperty(y,""):y==="float"?u.cssFloat="":u[y]="");for(var S in h)y=h[S],h.hasOwnProperty(S)&&p[S]!==y&&ZC(u,S,y)}else for(var N in h)h.hasOwnProperty(N)&&ZC(u,N,h[N])}function Wx(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var AB=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),RB=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Em(u){return RB.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}var Gx=null;function jx(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Yl=null,Zl=null;function JC(u){var h=Gl(u);if(h&&(u=h.stateNode)){var p=u[Cs]||null;t:switch(u=h.stateNode,h.type){case"input":if(Vx(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),h=p.name,p.type==="radio"&&h!=null){for(p=u;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+or(""+h)+'"][type="radio"]'),h=0;h<p.length;h++){var y=p[h];if(y!==u&&y.form===u.form){var S=y[Cs]||null;if(!S)throw Error(s(90));Vx(y,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(h=0;h<p.length;h++)y=p[h],y.form===u.form&&qC(y)}break t;case"textarea":XC(u,p.value,p.defaultValue);break t;case"select":h=p.value,h!=null&&Kl(u,!!p.multiple,h,!1)}}}var Hx=!1;function tk(u,h,p){if(Hx)return u(h,p);Hx=!0;try{var y=u(h);return y}finally{if(Hx=!1,(Yl!==null||Zl!==null)&&(fg(),Yl&&(h=Yl,u=Zl,Zl=Yl=null,JC(h),u)))for(h=0;h<u.length;h++)JC(u[h])}}function Ah(u,h){var p=u.stateNode;if(p===null)return null;var y=p[Cs]||null;if(y===null)return null;p=y[h];t:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(u=u.type,y=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!y;break t;default:u=!1}if(u)return null;if(p&&typeof p!="function")throw Error(s(231,h,typeof p));return p}var Ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qx=!1;if(Ia)try{var Rh={};Object.defineProperty(Rh,"passive",{get:function(){qx=!0}}),window.addEventListener("test",Rh,Rh),window.removeEventListener("test",Rh,Rh)}catch{qx=!1}var xi=null,Kx=null,Im=null;function ek(){if(Im)return Im;var u,h=Kx,p=h.length,y,S="value"in xi?xi.value:xi.textContent,N=S.length;for(u=0;u<p&&h[u]===S[u];u++);var A=p-u;for(y=1;y<=A&&h[p-y]===S[N-y];y++);return Im=S.slice(u,1<y?1-y:void 0)}function Am(u){var h=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&h===13&&(u=13)):u=h,u===10&&(u=13),32<=u||u===13?u:0}function Rm(){return!0}function nk(){return!1}function ks(u){function h(p,y,S,N,A){this._reactName=p,this._targetInst=S,this.type=y,this.nativeEvent=N,this.target=A,this.currentTarget=null;for(var z in u)u.hasOwnProperty(z)&&(p=u[z],this[z]=p?p(N):N[z]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?Rm:nk,this.isPropagationStopped=nk,this}return d(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Rm)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Rm)},persist:function(){},isPersistent:Rm}),h}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dm=ks(Co),Dh=d({},Co,{view:0,detail:0}),DB=ks(Dh),Xx,Yx,Oh,Om=d({},Dh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qx,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Oh&&(Oh&&u.type==="mousemove"?(Xx=u.screenX-Oh.screenX,Yx=u.screenY-Oh.screenY):Yx=Xx=0,Oh=u),Xx)},movementY:function(u){return"movementY"in u?u.movementY:Yx}}),sk=ks(Om),OB=d({},Om,{dataTransfer:0}),_B=ks(OB),FB=d({},Dh,{relatedTarget:0}),Zx=ks(FB),LB=d({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),MB=ks(LB),zB=d({},Co,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),PB=ks(zB),BB=d({},Co,{data:0}),rk=ks(BB),VB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GB(u){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(u):(u=WB[u])?!!h[u]:!1}function Qx(){return GB}var jB=d({},Dh,{key:function(u){if(u.key){var h=VB[u.key]||u.key;if(h!=="Unidentified")return h}return u.type==="keypress"?(u=Am(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?UB[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qx,charCode:function(u){return u.type==="keypress"?Am(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Am(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),HB=ks(jB),qB=d({},Om,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ak=ks(qB),KB=d({},Dh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qx}),XB=ks(KB),YB=d({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZB=ks(YB),QB=d({},Om,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),JB=ks(QB),tV=d({},Co,{newState:0,oldState:0}),eV=ks(tV),nV=[9,13,27,32],Jx=Ia&&"CompositionEvent"in window,_h=null;Ia&&"documentMode"in document&&(_h=document.documentMode);var sV=Ia&&"TextEvent"in window&&!_h,ik=Ia&&(!Jx||_h&&8<_h&&11>=_h),ok=" ",lk=!1;function uk(u,h){switch(u){case"keyup":return nV.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ck(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Ql=!1;function rV(u,h){switch(u){case"compositionend":return ck(h);case"keypress":return h.which!==32?null:(lk=!0,ok);case"textInput":return u=h.data,u===ok&&lk?null:u;default:return null}}function aV(u,h){if(Ql)return u==="compositionend"||!Jx&&uk(u,h)?(u=ek(),Im=Kx=xi=null,Ql=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return ik&&h.locale!=="ko"?null:h.data;default:return null}}var iV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hk(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h==="input"?!!iV[u.type]:h==="textarea"}function dk(u,h,p,y){Yl?Zl?Zl.push(y):Zl=[y]:Yl=y,h=xg(h,"onChange"),0<h.length&&(p=new Dm("onChange","change",null,p,y),u.push({event:p,listeners:h}))}var Fh=null,Lh=null;function oV(u){HE(u,0)}function _m(u){var h=Ih(u);if(qC(h))return u}function fk(u,h){if(u==="change")return h}var pk=!1;if(Ia){var t1;if(Ia){var e1="oninput"in document;if(!e1){var mk=document.createElement("div");mk.setAttribute("oninput","return;"),e1=typeof mk.oninput=="function"}t1=e1}else t1=!1;pk=t1&&(!document.documentMode||9<document.documentMode)}function gk(){Fh&&(Fh.detachEvent("onpropertychange",yk),Lh=Fh=null)}function yk(u){if(u.propertyName==="value"&&_m(Lh)){var h=[];dk(h,Lh,u,jx(u)),tk(oV,h)}}function lV(u,h,p){u==="focusin"?(gk(),Fh=h,Lh=p,Fh.attachEvent("onpropertychange",yk)):u==="focusout"&&gk()}function uV(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return _m(Lh)}function cV(u,h){if(u==="click")return _m(h)}function hV(u,h){if(u==="input"||u==="change")return _m(h)}function dV(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var Ws=typeof Object.is=="function"?Object.is:dV;function Mh(u,h){if(Ws(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var p=Object.keys(u),y=Object.keys(h);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var S=p[y];if(!ue.call(h,S)||!Ws(u[S],h[S]))return!1}return!0}function bk(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function xk(u,h){var p=bk(u);u=0;for(var y;p;){if(p.nodeType===3){if(y=u+p.textContent.length,u<=h&&y>=h)return{node:p,offset:h-u};u=y}t:{for(;p;){if(p.nextSibling){p=p.nextSibling;break t}p=p.parentNode}p=void 0}p=bk(p)}}function vk(u,h){return u&&h?u===h?!0:u&&u.nodeType===3?!1:h&&h.nodeType===3?vk(u,h.parentNode):"contains"in u?u.contains(h):u.compareDocumentPosition?!!(u.compareDocumentPosition(h)&16):!1:!1}function wk(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var h=$m(u.document);h instanceof u.HTMLIFrameElement;){try{var p=typeof h.contentWindow.location.href=="string"}catch{p=!1}if(p)u=h.contentWindow;else break;h=$m(u.document)}return h}function n1(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h&&(h==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||h==="textarea"||u.contentEditable==="true")}var fV=Ia&&"documentMode"in document&&11>=document.documentMode,Jl=null,s1=null,zh=null,r1=!1;function Sk(u,h,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;r1||Jl==null||Jl!==$m(y)||(y=Jl,"selectionStart"in y&&n1(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),zh&&Mh(zh,y)||(zh=y,y=xg(s1,"onSelect"),0<y.length&&(h=new Dm("onSelect","select",null,h,p),u.push({event:h,listeners:y}),h.target=Jl)))}function ko(u,h){var p={};return p[u.toLowerCase()]=h.toLowerCase(),p["Webkit"+u]="webkit"+h,p["Moz"+u]="moz"+h,p}var tu={animationend:ko("Animation","AnimationEnd"),animationiteration:ko("Animation","AnimationIteration"),animationstart:ko("Animation","AnimationStart"),transitionrun:ko("Transition","TransitionRun"),transitionstart:ko("Transition","TransitionStart"),transitioncancel:ko("Transition","TransitionCancel"),transitionend:ko("Transition","TransitionEnd")},a1={},Tk={};Ia&&(Tk=document.createElement("div").style,"AnimationEvent"in window||(delete tu.animationend.animation,delete tu.animationiteration.animation,delete tu.animationstart.animation),"TransitionEvent"in window||delete tu.transitionend.transition);function $o(u){if(a1[u])return a1[u];if(!tu[u])return u;var h=tu[u],p;for(p in h)if(h.hasOwnProperty(p)&&p in Tk)return a1[u]=h[p];return u}var Nk=$o("animationend"),Ck=$o("animationiteration"),kk=$o("animationstart"),pV=$o("transitionrun"),mV=$o("transitionstart"),gV=$o("transitioncancel"),$k=$o("transitionend"),Ek=new Map,i1="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");i1.push("scrollEnd");function Ar(u,h){Ek.set(u,h),No(h,[u])}var Ik=new WeakMap;function lr(u,h){if(typeof u=="object"&&u!==null){var p=Ik.get(u);return p!==void 0?p:(h={value:u,source:h,stack:jC(h)},Ik.set(u,h),h)}return{value:u,source:h,stack:jC(h)}}var ur=[],eu=0,o1=0;function Fm(){for(var u=eu,h=o1=eu=0;h<u;){var p=ur[h];ur[h++]=null;var y=ur[h];ur[h++]=null;var S=ur[h];ur[h++]=null;var N=ur[h];if(ur[h++]=null,y!==null&&S!==null){var A=y.pending;A===null?S.next=S:(S.next=A.next,A.next=S),y.pending=S}N!==0&&Ak(p,S,N)}}function Lm(u,h,p,y){ur[eu++]=u,ur[eu++]=h,ur[eu++]=p,ur[eu++]=y,o1|=y,u.lanes|=y,u=u.alternate,u!==null&&(u.lanes|=y)}function l1(u,h,p,y){return Lm(u,h,p,y),Mm(u)}function nu(u,h){return Lm(u,null,null,h),Mm(u)}function Ak(u,h,p){u.lanes|=p;var y=u.alternate;y!==null&&(y.lanes|=p);for(var S=!1,N=u.return;N!==null;)N.childLanes|=p,y=N.alternate,y!==null&&(y.childLanes|=p),N.tag===22&&(u=N.stateNode,u===null||u._visibility&1||(S=!0)),u=N,N=N.return;return u.tag===3?(N=u.stateNode,S&&h!==null&&(S=31-vn(p),u=N.hiddenUpdates,y=u[S],y===null?u[S]=[h]:y.push(h),h.lane=p|536870912),N):null}function Mm(u){if(50<ud)throw ud=0,pv=null,Error(s(185));for(var h=u.return;h!==null;)u=h,h=u.return;return u.tag===3?u.stateNode:null}var su={};function yV(u,h,p,y){this.tag=u,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gs(u,h,p,y){return new yV(u,h,p,y)}function u1(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Aa(u,h){var p=u.alternate;return p===null?(p=Gs(u.tag,h,u.key,u.mode),p.elementType=u.elementType,p.type=u.type,p.stateNode=u.stateNode,p.alternate=u,u.alternate=p):(p.pendingProps=h,p.type=u.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=u.flags&65011712,p.childLanes=u.childLanes,p.lanes=u.lanes,p.child=u.child,p.memoizedProps=u.memoizedProps,p.memoizedState=u.memoizedState,p.updateQueue=u.updateQueue,h=u.dependencies,p.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},p.sibling=u.sibling,p.index=u.index,p.ref=u.ref,p.refCleanup=u.refCleanup,p}function Rk(u,h){u.flags&=65011714;var p=u.alternate;return p===null?(u.childLanes=0,u.lanes=h,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=p.childLanes,u.lanes=p.lanes,u.child=p.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=p.memoizedProps,u.memoizedState=p.memoizedState,u.updateQueue=p.updateQueue,u.type=p.type,h=p.dependencies,u.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),u}function zm(u,h,p,y,S,N){var A=0;if(y=u,typeof u=="function")u1(u)&&(A=1);else if(typeof u=="string")A=xU(u,p,mt.current)?26:u==="html"||u==="head"||u==="body"?27:5;else t:switch(u){case O:return u=Gs(31,p,h,S),u.elementType=O,u.lanes=N,u;case b:return Eo(p.children,S,N,h);case x:A=8,S|=24;break;case v:return u=Gs(12,p,h,S|2),u.elementType=v,u.lanes=N,u;case $:return u=Gs(13,p,h,S),u.elementType=$,u.lanes=N,u;case I:return u=Gs(19,p,h,S),u.elementType=I,u.lanes=N,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case w:case C:A=10;break t;case T:A=9;break t;case k:A=11;break t;case D:A=14;break t;case _:A=16,y=null;break t}A=29,p=Error(s(130,u===null?"null":typeof u,"")),y=null}return h=Gs(A,p,h,S),h.elementType=u,h.type=y,h.lanes=N,h}function Eo(u,h,p,y){return u=Gs(7,u,y,h),u.lanes=p,u}function c1(u,h,p){return u=Gs(6,u,null,h),u.lanes=p,u}function h1(u,h,p){return h=Gs(4,u.children!==null?u.children:[],u.key,h),h.lanes=p,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}var ru=[],au=0,Pm=null,Bm=0,cr=[],hr=0,Io=null,Ra=1,Da="";function Ao(u,h){ru[au++]=Bm,ru[au++]=Pm,Pm=u,Bm=h}function Dk(u,h,p){cr[hr++]=Ra,cr[hr++]=Da,cr[hr++]=Io,Io=u;var y=Ra;u=Da;var S=32-vn(y)-1;y&=~(1<<S),p+=1;var N=32-vn(h)+S;if(30<N){var A=S-S%5;N=(y&(1<<A)-1).toString(32),y>>=A,S-=A,Ra=1<<32-vn(h)+S|p<<S|y,Da=N+u}else Ra=1<<N|p<<S|y,Da=u}function d1(u){u.return!==null&&(Ao(u,1),Dk(u,1,0))}function f1(u){for(;u===Pm;)Pm=ru[--au],ru[au]=null,Bm=ru[--au],ru[au]=null;for(;u===Io;)Io=cr[--hr],cr[hr]=null,Da=cr[--hr],cr[hr]=null,Ra=cr[--hr],cr[hr]=null}var ds=null,Xe=null,me=!1,Ro=null,Qr=!1,p1=Error(s(519));function Do(u){var h=Error(s(418,""));throw Vh(lr(h,u)),p1}function Ok(u){var h=u.stateNode,p=u.type,y=u.memoizedProps;switch(h[Qn]=u,h[Cs]=y,p){case"dialog":re("cancel",h),re("close",h);break;case"iframe":case"object":case"embed":re("load",h);break;case"video":case"audio":for(p=0;p<hd.length;p++)re(hd[p],h);break;case"source":re("error",h);break;case"img":case"image":case"link":re("error",h),re("load",h);break;case"details":re("toggle",h);break;case"input":re("invalid",h),KC(h,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0),km(h);break;case"select":re("invalid",h);break;case"textarea":re("invalid",h),YC(h,y.value,y.defaultValue,y.children),km(h)}p=y.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||h.textContent===""+p||y.suppressHydrationWarning===!0||YE(h.textContent,p)?(y.popover!=null&&(re("beforetoggle",h),re("toggle",h)),y.onScroll!=null&&re("scroll",h),y.onScrollEnd!=null&&re("scrollend",h),y.onClick!=null&&(h.onclick=vg),h=!0):h=!1,h||Do(u)}function _k(u){for(ds=u.return;ds;)switch(ds.tag){case 5:case 13:Qr=!1;return;case 27:case 3:Qr=!0;return;default:ds=ds.return}}function Ph(u){if(u!==ds)return!1;if(!me)return _k(u),me=!0,!1;var h=u.tag,p;if((p=h!==3&&h!==27)&&((p=h===5)&&(p=u.type,p=!(p!=="form"&&p!=="button")||Av(u.type,u.memoizedProps)),p=!p),p&&Xe&&Do(u),_k(u),h===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));t:{for(u=u.nextSibling,h=0;u;){if(u.nodeType===8)if(p=u.data,p==="/$"){if(h===0){Xe=Dr(u.nextSibling);break t}h--}else p!=="$"&&p!=="$!"&&p!=="$?"||h++;u=u.nextSibling}Xe=null}}else h===27?(h=Xe,Fi(u.type)?(u=_v,_v=null,Xe=u):Xe=h):Xe=ds?Dr(u.stateNode.nextSibling):null;return!0}function Bh(){Xe=ds=null,me=!1}function Fk(){var u=Ro;return u!==null&&(Is===null?Is=u:Is.push.apply(Is,u),Ro=null),u}function Vh(u){Ro===null?Ro=[u]:Ro.push(u)}var m1=j(null),Oo=null,Oa=null;function vi(u,h,p){st(m1,h._currentValue),h._currentValue=p}function _a(u){u._currentValue=m1.current,rt(m1)}function g1(u,h,p){for(;u!==null;){var y=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,y!==null&&(y.childLanes|=h)):y!==null&&(y.childLanes&h)!==h&&(y.childLanes|=h),u===p)break;u=u.return}}function y1(u,h,p,y){var S=u.child;for(S!==null&&(S.return=u);S!==null;){var N=S.dependencies;if(N!==null){var A=S.child;N=N.firstContext;t:for(;N!==null;){var z=N;N=S;for(var H=0;H<h.length;H++)if(z.context===h[H]){N.lanes|=p,z=N.alternate,z!==null&&(z.lanes|=p),g1(N.return,p,u),y||(A=null);break t}N=z.next}}else if(S.tag===18){if(A=S.return,A===null)throw Error(s(341));A.lanes|=p,N=A.alternate,N!==null&&(N.lanes|=p),g1(A,p,u),A=null}else A=S.child;if(A!==null)A.return=S;else for(A=S;A!==null;){if(A===u){A=null;break}if(S=A.sibling,S!==null){S.return=A.return,A=S;break}A=A.return}S=A}}function Uh(u,h,p,y){u=null;for(var S=h,N=!1;S!==null;){if(!N){if((S.flags&524288)!==0)N=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var A=S.alternate;if(A===null)throw Error(s(387));if(A=A.memoizedProps,A!==null){var z=S.type;Ws(S.pendingProps.value,A.value)||(u!==null?u.push(z):u=[z])}}else if(S===$t.current){if(A=S.alternate,A===null)throw Error(s(387));A.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(u!==null?u.push(yd):u=[yd])}S=S.return}u!==null&&y1(h,u,p,y),h.flags|=262144}function Vm(u){for(u=u.firstContext;u!==null;){if(!Ws(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function _o(u){Oo=u,Oa=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function Jn(u){return Lk(Oo,u)}function Um(u,h){return Oo===null&&_o(u),Lk(u,h)}function Lk(u,h){var p=h._currentValue;if(h={context:h,memoizedValue:p,next:null},Oa===null){if(u===null)throw Error(s(308));Oa=h,u.dependencies={lanes:0,firstContext:h},u.flags|=524288}else Oa=Oa.next=h;return p}var bV=typeof AbortController<"u"?AbortController:function(){var u=[],h=this.signal={aborted:!1,addEventListener:function(p,y){u.push(y)}};this.abort=function(){h.aborted=!0,u.forEach(function(p){return p()})}},xV=n.unstable_scheduleCallback,vV=n.unstable_NormalPriority,wn={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function b1(){return{controller:new bV,data:new Map,refCount:0}}function Wh(u){u.refCount--,u.refCount===0&&xV(vV,function(){u.controller.abort()})}var Gh=null,x1=0,iu=0,ou=null;function wV(u,h){if(Gh===null){var p=Gh=[];x1=0,iu=wv(),ou={status:"pending",value:void 0,then:function(y){p.push(y)}}}return x1++,h.then(Mk,Mk),h}function Mk(){if(--x1===0&&Gh!==null){ou!==null&&(ou.status="fulfilled");var u=Gh;Gh=null,iu=0,ou=null;for(var h=0;h<u.length;h++)(0,u[h])()}}function SV(u,h){var p=[],y={status:"pending",value:null,reason:null,then:function(S){p.push(S)}};return u.then(function(){y.status="fulfilled",y.value=h;for(var S=0;S<p.length;S++)(0,p[S])(h)},function(S){for(y.status="rejected",y.reason=S,S=0;S<p.length;S++)(0,p[S])(void 0)}),y}var zk=B.S;B.S=function(u,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&wV(u,h),zk!==null&&zk(u,h)};var Fo=j(null);function v1(){var u=Fo.current;return u!==null?u:_e.pooledCache}function Wm(u,h){h===null?st(Fo,Fo.current):st(Fo,h.pool)}function Pk(){var u=v1();return u===null?null:{parent:wn._currentValue,pool:u}}var jh=Error(s(460)),Bk=Error(s(474)),Gm=Error(s(542)),w1={then:function(){}};function Vk(u){return u=u.status,u==="fulfilled"||u==="rejected"}function jm(){}function Uk(u,h,p){switch(p=u[p],p===void 0?u.push(h):p!==h&&(h.then(jm,jm),h=p),h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,Gk(u),u;default:if(typeof h.status=="string")h.then(jm,jm);else{if(u=_e,u!==null&&100<u.shellSuspendCounter)throw Error(s(482));u=h,u.status="pending",u.then(function(y){if(h.status==="pending"){var S=h;S.status="fulfilled",S.value=y}},function(y){if(h.status==="pending"){var S=h;S.status="rejected",S.reason=y}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,Gk(u),u}throw Hh=h,jh}}var Hh=null;function Wk(){if(Hh===null)throw Error(s(459));var u=Hh;return Hh=null,u}function Gk(u){if(u===jh||u===Gm)throw Error(s(483))}var wi=!1;function S1(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function T1(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Si(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function Ti(u,h,p){var y=u.updateQueue;if(y===null)return null;if(y=y.shared,(ve&2)!==0){var S=y.pending;return S===null?h.next=h:(h.next=S.next,S.next=h),y.pending=h,h=Mm(u),Ak(u,null,p),h}return Lm(u,y,h,p),Mm(u)}function qh(u,h,p){if(h=h.updateQueue,h!==null&&(h=h.shared,(p&4194048)!==0)){var y=h.lanes;y&=u.pendingLanes,p|=y,h.lanes=p,MC(u,p)}}function N1(u,h){var p=u.updateQueue,y=u.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var S=null,N=null;if(p=p.firstBaseUpdate,p!==null){do{var A={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};N===null?S=N=A:N=N.next=A,p=p.next}while(p!==null);N===null?S=N=h:N=N.next=h}else S=N=h;p={baseState:y.baseState,firstBaseUpdate:S,lastBaseUpdate:N,shared:y.shared,callbacks:y.callbacks},u.updateQueue=p;return}u=p.lastBaseUpdate,u===null?p.firstBaseUpdate=h:u.next=h,p.lastBaseUpdate=h}var C1=!1;function Kh(){if(C1){var u=ou;if(u!==null)throw u}}function Xh(u,h,p,y){C1=!1;var S=u.updateQueue;wi=!1;var N=S.firstBaseUpdate,A=S.lastBaseUpdate,z=S.shared.pending;if(z!==null){S.shared.pending=null;var H=z,ct=H.next;H.next=null,A===null?N=ct:A.next=ct,A=H;var yt=u.alternate;yt!==null&&(yt=yt.updateQueue,z=yt.lastBaseUpdate,z!==A&&(z===null?yt.firstBaseUpdate=ct:z.next=ct,yt.lastBaseUpdate=H))}if(N!==null){var vt=S.baseState;A=0,yt=ct=H=null,z=N;do{var ht=z.lane&-536870913,dt=ht!==z.lane;if(dt?(ce&ht)===ht:(y&ht)===ht){ht!==0&&ht===iu&&(C1=!0),yt!==null&&(yt=yt.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});t:{var Ut=u,zt=z;ht=h;var ke=p;switch(zt.tag){case 1:if(Ut=zt.payload,typeof Ut=="function"){vt=Ut.call(ke,vt,ht);break t}vt=Ut;break t;case 3:Ut.flags=Ut.flags&-65537|128;case 0:if(Ut=zt.payload,ht=typeof Ut=="function"?Ut.call(ke,vt,ht):Ut,ht==null)break t;vt=d({},vt,ht);break t;case 2:wi=!0}}ht=z.callback,ht!==null&&(u.flags|=64,dt&&(u.flags|=8192),dt=S.callbacks,dt===null?S.callbacks=[ht]:dt.push(ht))}else dt={lane:ht,tag:z.tag,payload:z.payload,callback:z.callback,next:null},yt===null?(ct=yt=dt,H=vt):yt=yt.next=dt,A|=ht;if(z=z.next,z===null){if(z=S.shared.pending,z===null)break;dt=z,z=dt.next,dt.next=null,S.lastBaseUpdate=dt,S.shared.pending=null}}while(!0);yt===null&&(H=vt),S.baseState=H,S.firstBaseUpdate=ct,S.lastBaseUpdate=yt,N===null&&(S.shared.lanes=0),Ri|=A,u.lanes=A,u.memoizedState=vt}}function jk(u,h){if(typeof u!="function")throw Error(s(191,u));u.call(h)}function Hk(u,h){var p=u.callbacks;if(p!==null)for(u.callbacks=null,u=0;u<p.length;u++)jk(p[u],h)}var lu=j(null),Hm=j(0);function qk(u,h){u=Va,st(Hm,u),st(lu,h),Va=u|h.baseLanes}function k1(){st(Hm,Va),st(lu,lu.current)}function $1(){Va=Hm.current,rt(lu),rt(Hm)}var Ni=0,Jt=null,Ne=null,dn=null,qm=!1,uu=!1,Lo=!1,Km=0,Yh=0,cu=null,TV=0;function rn(){throw Error(s(321))}function E1(u,h){if(h===null)return!1;for(var p=0;p<h.length&&p<u.length;p++)if(!Ws(u[p],h[p]))return!1;return!0}function I1(u,h,p,y,S,N){return Ni=N,Jt=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,B.H=u===null||u.memoizedState===null?A$:R$,Lo=!1,N=p(y,S),Lo=!1,uu&&(N=Xk(h,p,y,S)),Kk(u),N}function Kk(u){B.H=tg;var h=Ne!==null&&Ne.next!==null;if(Ni=0,dn=Ne=Jt=null,qm=!1,Yh=0,cu=null,h)throw Error(s(300));u===null||Rn||(u=u.dependencies,u!==null&&Vm(u)&&(Rn=!0))}function Xk(u,h,p,y){Jt=u;var S=0;do{if(uu&&(cu=null),Yh=0,uu=!1,25<=S)throw Error(s(301));if(S+=1,dn=Ne=null,u.updateQueue!=null){var N=u.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}B.H=AV,N=h(p,y)}while(uu);return N}function NV(){var u=B.H,h=u.useState()[0];return h=typeof h.then=="function"?Zh(h):h,u=u.useState()[0],(Ne!==null?Ne.memoizedState:null)!==u&&(Jt.flags|=1024),h}function A1(){var u=Km!==0;return Km=0,u}function R1(u,h,p){h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~p}function D1(u){if(qm){for(u=u.memoizedState;u!==null;){var h=u.queue;h!==null&&(h.pending=null),u=u.next}qm=!1}Ni=0,dn=Ne=Jt=null,uu=!1,Yh=Km=0,cu=null}function $s(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?Jt.memoizedState=dn=u:dn=dn.next=u,dn}function fn(){if(Ne===null){var u=Jt.alternate;u=u!==null?u.memoizedState:null}else u=Ne.next;var h=dn===null?Jt.memoizedState:dn.next;if(h!==null)dn=h,Ne=u;else{if(u===null)throw Jt.alternate===null?Error(s(467)):Error(s(310));Ne=u,u={memoizedState:Ne.memoizedState,baseState:Ne.baseState,baseQueue:Ne.baseQueue,queue:Ne.queue,next:null},dn===null?Jt.memoizedState=dn=u:dn=dn.next=u}return dn}function O1(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zh(u){var h=Yh;return Yh+=1,cu===null&&(cu=[]),u=Uk(cu,u,h),h=Jt,(dn===null?h.memoizedState:dn.next)===null&&(h=h.alternate,B.H=h===null||h.memoizedState===null?A$:R$),u}function Xm(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return Zh(u);if(u.$$typeof===C)return Jn(u)}throw Error(s(438,String(u)))}function _1(u){var h=null,p=Jt.updateQueue;if(p!==null&&(h=p.memoCache),h==null){var y=Jt.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(h={data:y.data.map(function(S){return S.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),p===null&&(p=O1(),Jt.updateQueue=p),p.memoCache=h,p=h.data[h.index],p===void 0)for(p=h.data[h.index]=Array(u),y=0;y<u;y++)p[y]=L;return h.index++,p}function Fa(u,h){return typeof h=="function"?h(u):h}function Ym(u){var h=fn();return F1(h,Ne,u)}function F1(u,h,p){var y=u.queue;if(y===null)throw Error(s(311));y.lastRenderedReducer=p;var S=u.baseQueue,N=y.pending;if(N!==null){if(S!==null){var A=S.next;S.next=N.next,N.next=A}h.baseQueue=S=N,y.pending=null}if(N=u.baseState,S===null)u.memoizedState=N;else{h=S.next;var z=A=null,H=null,ct=h,yt=!1;do{var vt=ct.lane&-536870913;if(vt!==ct.lane?(ce&vt)===vt:(Ni&vt)===vt){var ht=ct.revertLane;if(ht===0)H!==null&&(H=H.next={lane:0,revertLane:0,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null}),vt===iu&&(yt=!0);else if((Ni&ht)===ht){ct=ct.next,ht===iu&&(yt=!0);continue}else vt={lane:0,revertLane:ct.revertLane,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null},H===null?(z=H=vt,A=N):H=H.next=vt,Jt.lanes|=ht,Ri|=ht;vt=ct.action,Lo&&p(N,vt),N=ct.hasEagerState?ct.eagerState:p(N,vt)}else ht={lane:vt,revertLane:ct.revertLane,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null},H===null?(z=H=ht,A=N):H=H.next=ht,Jt.lanes|=vt,Ri|=vt;ct=ct.next}while(ct!==null&&ct!==h);if(H===null?A=N:H.next=z,!Ws(N,u.memoizedState)&&(Rn=!0,yt&&(p=ou,p!==null)))throw p;u.memoizedState=N,u.baseState=A,u.baseQueue=H,y.lastRenderedState=N}return S===null&&(y.lanes=0),[u.memoizedState,y.dispatch]}function L1(u){var h=fn(),p=h.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=u;var y=p.dispatch,S=p.pending,N=h.memoizedState;if(S!==null){p.pending=null;var A=S=S.next;do N=u(N,A.action),A=A.next;while(A!==S);Ws(N,h.memoizedState)||(Rn=!0),h.memoizedState=N,h.baseQueue===null&&(h.baseState=N),p.lastRenderedState=N}return[N,y]}function Yk(u,h,p){var y=Jt,S=fn(),N=me;if(N){if(p===void 0)throw Error(s(407));p=p()}else p=h();var A=!Ws((Ne||S).memoizedState,p);A&&(S.memoizedState=p,Rn=!0),S=S.queue;var z=Jk.bind(null,y,S,u);if(Qh(2048,8,z,[u]),S.getSnapshot!==h||A||dn!==null&&dn.memoizedState.tag&1){if(y.flags|=2048,hu(9,Zm(),Qk.bind(null,y,S,p,h),null),_e===null)throw Error(s(349));N||(Ni&124)!==0||Zk(y,h,p)}return p}function Zk(u,h,p){u.flags|=16384,u={getSnapshot:h,value:p},h=Jt.updateQueue,h===null?(h=O1(),Jt.updateQueue=h,h.stores=[u]):(p=h.stores,p===null?h.stores=[u]:p.push(u))}function Qk(u,h,p,y){h.value=p,h.getSnapshot=y,t$(h)&&e$(u)}function Jk(u,h,p){return p(function(){t$(h)&&e$(u)})}function t$(u){var h=u.getSnapshot;u=u.value;try{var p=h();return!Ws(u,p)}catch{return!0}}function e$(u){var h=nu(u,2);h!==null&&Xs(h,u,2)}function M1(u){var h=$s();if(typeof u=="function"){var p=u;if(u=p(),Lo){Wn(!0);try{p()}finally{Wn(!1)}}}return h.memoizedState=h.baseState=u,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:u},h}function n$(u,h,p,y){return u.baseState=p,F1(u,Ne,typeof y=="function"?y:Fa)}function CV(u,h,p,y,S){if(Jm(u))throw Error(s(485));if(u=h.action,u!==null){var N={payload:S,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){N.listeners.push(A)}};B.T!==null?p(!0):N.isTransition=!1,y(N),p=h.pending,p===null?(N.next=h.pending=N,s$(h,N)):(N.next=p.next,h.pending=p.next=N)}}function s$(u,h){var p=h.action,y=h.payload,S=u.state;if(h.isTransition){var N=B.T,A={};B.T=A;try{var z=p(S,y),H=B.S;H!==null&&H(A,z),r$(u,h,z)}catch(ct){z1(u,h,ct)}finally{B.T=N}}else try{N=p(S,y),r$(u,h,N)}catch(ct){z1(u,h,ct)}}function r$(u,h,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(y){a$(u,h,y)},function(y){return z1(u,h,y)}):a$(u,h,p)}function a$(u,h,p){h.status="fulfilled",h.value=p,i$(h),u.state=p,h=u.pending,h!==null&&(p=h.next,p===h?u.pending=null:(p=p.next,h.next=p,s$(u,p)))}function z1(u,h,p){var y=u.pending;if(u.pending=null,y!==null){y=y.next;do h.status="rejected",h.reason=p,i$(h),h=h.next;while(h!==y)}u.action=null}function i$(u){u=u.listeners;for(var h=0;h<u.length;h++)(0,u[h])()}function o$(u,h){return h}function l$(u,h){if(me){var p=_e.formState;if(p!==null){t:{var y=Jt;if(me){if(Xe){e:{for(var S=Xe,N=Qr;S.nodeType!==8;){if(!N){S=null;break e}if(S=Dr(S.nextSibling),S===null){S=null;break e}}N=S.data,S=N==="F!"||N==="F"?S:null}if(S){Xe=Dr(S.nextSibling),y=S.data==="F!";break t}}Do(y)}y=!1}y&&(h=p[0])}}return p=$s(),p.memoizedState=p.baseState=h,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o$,lastRenderedState:h},p.queue=y,p=$$.bind(null,Jt,y),y.dispatch=p,y=M1(!1),N=W1.bind(null,Jt,!1,y.queue),y=$s(),S={state:h,dispatch:null,action:u,pending:null},y.queue=S,p=CV.bind(null,Jt,S,N,p),S.dispatch=p,y.memoizedState=u,[h,p,!1]}function u$(u){var h=fn();return c$(h,Ne,u)}function c$(u,h,p){if(h=F1(u,h,o$)[0],u=Ym(Fa)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var y=Zh(h)}catch(A){throw A===jh?Gm:A}else y=h;h=fn();var S=h.queue,N=S.dispatch;return p!==h.memoizedState&&(Jt.flags|=2048,hu(9,Zm(),kV.bind(null,S,p),null)),[y,N,u]}function kV(u,h){u.action=h}function h$(u){var h=fn(),p=Ne;if(p!==null)return c$(h,p,u);fn(),h=h.memoizedState,p=fn();var y=p.queue.dispatch;return p.memoizedState=u,[h,y,!1]}function hu(u,h,p,y){return u={tag:u,create:p,deps:y,inst:h,next:null},h=Jt.updateQueue,h===null&&(h=O1(),Jt.updateQueue=h),p=h.lastEffect,p===null?h.lastEffect=u.next=u:(y=p.next,p.next=u,u.next=y,h.lastEffect=u),u}function Zm(){return{destroy:void 0,resource:void 0}}function d$(){return fn().memoizedState}function Qm(u,h,p,y){var S=$s();y=y===void 0?null:y,Jt.flags|=u,S.memoizedState=hu(1|h,Zm(),p,y)}function Qh(u,h,p,y){var S=fn();y=y===void 0?null:y;var N=S.memoizedState.inst;Ne!==null&&y!==null&&E1(y,Ne.memoizedState.deps)?S.memoizedState=hu(h,N,p,y):(Jt.flags|=u,S.memoizedState=hu(1|h,N,p,y))}function f$(u,h){Qm(8390656,8,u,h)}function p$(u,h){Qh(2048,8,u,h)}function m$(u,h){return Qh(4,2,u,h)}function g$(u,h){return Qh(4,4,u,h)}function y$(u,h){if(typeof h=="function"){u=u();var p=h(u);return function(){typeof p=="function"?p():h(null)}}if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function b$(u,h,p){p=p!=null?p.concat([u]):null,Qh(4,4,y$.bind(null,h,u),p)}function P1(){}function x$(u,h){var p=fn();h=h===void 0?null:h;var y=p.memoizedState;return h!==null&&E1(h,y[1])?y[0]:(p.memoizedState=[u,h],u)}function v$(u,h){var p=fn();h=h===void 0?null:h;var y=p.memoizedState;if(h!==null&&E1(h,y[1]))return y[0];if(y=u(),Lo){Wn(!0);try{u()}finally{Wn(!1)}}return p.memoizedState=[y,h],y}function B1(u,h,p){return p===void 0||(Ni&1073741824)!==0?u.memoizedState=h:(u.memoizedState=p,u=TE(),Jt.lanes|=u,Ri|=u,p)}function w$(u,h,p,y){return Ws(p,h)?p:lu.current!==null?(u=B1(u,p,y),Ws(u,h)||(Rn=!0),u):(Ni&42)===0?(Rn=!0,u.memoizedState=p):(u=TE(),Jt.lanes|=u,Ri|=u,h)}function S$(u,h,p,y,S){var N=W.p;W.p=N!==0&&8>N?N:8;var A=B.T,z={};B.T=z,W1(u,!1,h,p);try{var H=S(),ct=B.S;if(ct!==null&&ct(z,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var yt=SV(H,y);Jh(u,h,yt,Ks(u))}else Jh(u,h,y,Ks(u))}catch(vt){Jh(u,h,{then:function(){},status:"rejected",reason:vt},Ks())}finally{W.p=N,B.T=A}}function $V(){}function V1(u,h,p,y){if(u.tag!==5)throw Error(s(476));var S=T$(u).queue;S$(u,S,h,X,p===null?$V:function(){return N$(u),p(y)})}function T$(u){var h=u.memoizedState;if(h!==null)return h;h={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:X},next:null};var p={};return h.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:p},next:null},u.memoizedState=h,u=u.alternate,u!==null&&(u.memoizedState=h),h}function N$(u){var h=T$(u).next.queue;Jh(u,h,{},Ks())}function U1(){return Jn(yd)}function C$(){return fn().memoizedState}function k$(){return fn().memoizedState}function EV(u){for(var h=u.return;h!==null;){switch(h.tag){case 24:case 3:var p=Ks();u=Si(p);var y=Ti(h,u,p);y!==null&&(Xs(y,h,p),qh(y,h,p)),h={cache:b1()},u.payload=h;return}h=h.return}}function IV(u,h,p){var y=Ks();p={lane:y,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Jm(u)?E$(h,p):(p=l1(u,h,p,y),p!==null&&(Xs(p,u,y),I$(p,h,y)))}function $$(u,h,p){var y=Ks();Jh(u,h,p,y)}function Jh(u,h,p,y){var S={lane:y,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Jm(u))E$(h,S);else{var N=u.alternate;if(u.lanes===0&&(N===null||N.lanes===0)&&(N=h.lastRenderedReducer,N!==null))try{var A=h.lastRenderedState,z=N(A,p);if(S.hasEagerState=!0,S.eagerState=z,Ws(z,A))return Lm(u,h,S,0),_e===null&&Fm(),!1}catch{}finally{}if(p=l1(u,h,S,y),p!==null)return Xs(p,u,y),I$(p,h,y),!0}return!1}function W1(u,h,p,y){if(y={lane:2,revertLane:wv(),action:y,hasEagerState:!1,eagerState:null,next:null},Jm(u)){if(h)throw Error(s(479))}else h=l1(u,p,y,2),h!==null&&Xs(h,u,2)}function Jm(u){var h=u.alternate;return u===Jt||h!==null&&h===Jt}function E$(u,h){uu=qm=!0;var p=u.pending;p===null?h.next=h:(h.next=p.next,p.next=h),u.pending=h}function I$(u,h,p){if((p&4194048)!==0){var y=h.lanes;y&=u.pendingLanes,p|=y,h.lanes=p,MC(u,p)}}var tg={readContext:Jn,use:Xm,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useLayoutEffect:rn,useInsertionEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useSyncExternalStore:rn,useId:rn,useHostTransitionStatus:rn,useFormState:rn,useActionState:rn,useOptimistic:rn,useMemoCache:rn,useCacheRefresh:rn},A$={readContext:Jn,use:Xm,useCallback:function(u,h){return $s().memoizedState=[u,h===void 0?null:h],u},useContext:Jn,useEffect:f$,useImperativeHandle:function(u,h,p){p=p!=null?p.concat([u]):null,Qm(4194308,4,y$.bind(null,h,u),p)},useLayoutEffect:function(u,h){return Qm(4194308,4,u,h)},useInsertionEffect:function(u,h){Qm(4,2,u,h)},useMemo:function(u,h){var p=$s();h=h===void 0?null:h;var y=u();if(Lo){Wn(!0);try{u()}finally{Wn(!1)}}return p.memoizedState=[y,h],y},useReducer:function(u,h,p){var y=$s();if(p!==void 0){var S=p(h);if(Lo){Wn(!0);try{p(h)}finally{Wn(!1)}}}else S=h;return y.memoizedState=y.baseState=S,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:S},y.queue=u,u=u.dispatch=IV.bind(null,Jt,u),[y.memoizedState,u]},useRef:function(u){var h=$s();return u={current:u},h.memoizedState=u},useState:function(u){u=M1(u);var h=u.queue,p=$$.bind(null,Jt,h);return h.dispatch=p,[u.memoizedState,p]},useDebugValue:P1,useDeferredValue:function(u,h){var p=$s();return B1(p,u,h)},useTransition:function(){var u=M1(!1);return u=S$.bind(null,Jt,u.queue,!0,!1),$s().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,h,p){var y=Jt,S=$s();if(me){if(p===void 0)throw Error(s(407));p=p()}else{if(p=h(),_e===null)throw Error(s(349));(ce&124)!==0||Zk(y,h,p)}S.memoizedState=p;var N={value:p,getSnapshot:h};return S.queue=N,f$(Jk.bind(null,y,N,u),[u]),y.flags|=2048,hu(9,Zm(),Qk.bind(null,y,N,p,h),null),p},useId:function(){var u=$s(),h=_e.identifierPrefix;if(me){var p=Da,y=Ra;p=(y&~(1<<32-vn(y)-1)).toString(32)+p,h="«"+h+"R"+p,p=Km++,0<p&&(h+="H"+p.toString(32)),h+="»"}else p=TV++,h="«"+h+"r"+p.toString(32)+"»";return u.memoizedState=h},useHostTransitionStatus:U1,useFormState:l$,useActionState:l$,useOptimistic:function(u){var h=$s();h.memoizedState=h.baseState=u;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=p,h=W1.bind(null,Jt,!0,p),p.dispatch=h,[u,h]},useMemoCache:_1,useCacheRefresh:function(){return $s().memoizedState=EV.bind(null,Jt)}},R$={readContext:Jn,use:Xm,useCallback:x$,useContext:Jn,useEffect:p$,useImperativeHandle:b$,useInsertionEffect:m$,useLayoutEffect:g$,useMemo:v$,useReducer:Ym,useRef:d$,useState:function(){return Ym(Fa)},useDebugValue:P1,useDeferredValue:function(u,h){var p=fn();return w$(p,Ne.memoizedState,u,h)},useTransition:function(){var u=Ym(Fa)[0],h=fn().memoizedState;return[typeof u=="boolean"?u:Zh(u),h]},useSyncExternalStore:Yk,useId:C$,useHostTransitionStatus:U1,useFormState:u$,useActionState:u$,useOptimistic:function(u,h){var p=fn();return n$(p,Ne,u,h)},useMemoCache:_1,useCacheRefresh:k$},AV={readContext:Jn,use:Xm,useCallback:x$,useContext:Jn,useEffect:p$,useImperativeHandle:b$,useInsertionEffect:m$,useLayoutEffect:g$,useMemo:v$,useReducer:L1,useRef:d$,useState:function(){return L1(Fa)},useDebugValue:P1,useDeferredValue:function(u,h){var p=fn();return Ne===null?B1(p,u,h):w$(p,Ne.memoizedState,u,h)},useTransition:function(){var u=L1(Fa)[0],h=fn().memoizedState;return[typeof u=="boolean"?u:Zh(u),h]},useSyncExternalStore:Yk,useId:C$,useHostTransitionStatus:U1,useFormState:h$,useActionState:h$,useOptimistic:function(u,h){var p=fn();return Ne!==null?n$(p,Ne,u,h):(p.baseState=u,[u,p.queue.dispatch])},useMemoCache:_1,useCacheRefresh:k$},du=null,td=0;function eg(u){var h=td;return td+=1,du===null&&(du=[]),Uk(du,u,h)}function ed(u,h){h=h.props.ref,u.ref=h!==void 0?h:null}function ng(u,h){throw h.$$typeof===f?Error(s(525)):(u=Object.prototype.toString.call(h),Error(s(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u)))}function D$(u){var h=u._init;return h(u._payload)}function O$(u){function h(at,et){if(u){var ut=at.deletions;ut===null?(at.deletions=[et],at.flags|=16):ut.push(et)}}function p(at,et){if(!u)return null;for(;et!==null;)h(at,et),et=et.sibling;return null}function y(at){for(var et=new Map;at!==null;)at.key!==null?et.set(at.key,at):et.set(at.index,at),at=at.sibling;return et}function S(at,et){return at=Aa(at,et),at.index=0,at.sibling=null,at}function N(at,et,ut){return at.index=ut,u?(ut=at.alternate,ut!==null?(ut=ut.index,ut<et?(at.flags|=67108866,et):ut):(at.flags|=67108866,et)):(at.flags|=1048576,et)}function A(at){return u&&at.alternate===null&&(at.flags|=67108866),at}function z(at,et,ut,xt){return et===null||et.tag!==6?(et=c1(ut,at.mode,xt),et.return=at,et):(et=S(et,ut),et.return=at,et)}function H(at,et,ut,xt){var Rt=ut.type;return Rt===b?yt(at,et,ut.props.children,xt,ut.key):et!==null&&(et.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===_&&D$(Rt)===et.type)?(et=S(et,ut.props),ed(et,ut),et.return=at,et):(et=zm(ut.type,ut.key,ut.props,null,at.mode,xt),ed(et,ut),et.return=at,et)}function ct(at,et,ut,xt){return et===null||et.tag!==4||et.stateNode.containerInfo!==ut.containerInfo||et.stateNode.implementation!==ut.implementation?(et=h1(ut,at.mode,xt),et.return=at,et):(et=S(et,ut.children||[]),et.return=at,et)}function yt(at,et,ut,xt,Rt){return et===null||et.tag!==7?(et=Eo(ut,at.mode,xt,Rt),et.return=at,et):(et=S(et,ut),et.return=at,et)}function vt(at,et,ut){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return et=c1(""+et,at.mode,ut),et.return=at,et;if(typeof et=="object"&&et!==null){switch(et.$$typeof){case m:return ut=zm(et.type,et.key,et.props,null,at.mode,ut),ed(ut,et),ut.return=at,ut;case g:return et=h1(et,at.mode,ut),et.return=at,et;case _:var xt=et._init;return et=xt(et._payload),vt(at,et,ut)}if(tt(et)||V(et))return et=Eo(et,at.mode,ut,null),et.return=at,et;if(typeof et.then=="function")return vt(at,eg(et),ut);if(et.$$typeof===C)return vt(at,Um(at,et),ut);ng(at,et)}return null}function ht(at,et,ut,xt){var Rt=et!==null?et.key:null;if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Rt!==null?null:z(at,et,""+ut,xt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case m:return ut.key===Rt?H(at,et,ut,xt):null;case g:return ut.key===Rt?ct(at,et,ut,xt):null;case _:return Rt=ut._init,ut=Rt(ut._payload),ht(at,et,ut,xt)}if(tt(ut)||V(ut))return Rt!==null?null:yt(at,et,ut,xt,null);if(typeof ut.then=="function")return ht(at,et,eg(ut),xt);if(ut.$$typeof===C)return ht(at,et,Um(at,ut),xt);ng(at,ut)}return null}function dt(at,et,ut,xt,Rt){if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return at=at.get(ut)||null,z(et,at,""+xt,Rt);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case m:return at=at.get(xt.key===null?ut:xt.key)||null,H(et,at,xt,Rt);case g:return at=at.get(xt.key===null?ut:xt.key)||null,ct(et,at,xt,Rt);case _:var ee=xt._init;return xt=ee(xt._payload),dt(at,et,ut,xt,Rt)}if(tt(xt)||V(xt))return at=at.get(ut)||null,yt(et,at,xt,Rt,null);if(typeof xt.then=="function")return dt(at,et,ut,eg(xt),Rt);if(xt.$$typeof===C)return dt(at,et,ut,Um(et,xt),Rt);ng(et,xt)}return null}function Ut(at,et,ut,xt){for(var Rt=null,ee=null,Mt=et,Pt=et=0,On=null;Mt!==null&&Pt<ut.length;Pt++){Mt.index>Pt?(On=Mt,Mt=null):On=Mt.sibling;var de=ht(at,Mt,ut[Pt],xt);if(de===null){Mt===null&&(Mt=On);break}u&&Mt&&de.alternate===null&&h(at,Mt),et=N(de,et,Pt),ee===null?Rt=de:ee.sibling=de,ee=de,Mt=On}if(Pt===ut.length)return p(at,Mt),me&&Ao(at,Pt),Rt;if(Mt===null){for(;Pt<ut.length;Pt++)Mt=vt(at,ut[Pt],xt),Mt!==null&&(et=N(Mt,et,Pt),ee===null?Rt=Mt:ee.sibling=Mt,ee=Mt);return me&&Ao(at,Pt),Rt}for(Mt=y(Mt);Pt<ut.length;Pt++)On=dt(Mt,at,Pt,ut[Pt],xt),On!==null&&(u&&On.alternate!==null&&Mt.delete(On.key===null?Pt:On.key),et=N(On,et,Pt),ee===null?Rt=On:ee.sibling=On,ee=On);return u&&Mt.forEach(function(Bi){return h(at,Bi)}),me&&Ao(at,Pt),Rt}function zt(at,et,ut,xt){if(ut==null)throw Error(s(151));for(var Rt=null,ee=null,Mt=et,Pt=et=0,On=null,de=ut.next();Mt!==null&&!de.done;Pt++,de=ut.next()){Mt.index>Pt?(On=Mt,Mt=null):On=Mt.sibling;var Bi=ht(at,Mt,de.value,xt);if(Bi===null){Mt===null&&(Mt=On);break}u&&Mt&&Bi.alternate===null&&h(at,Mt),et=N(Bi,et,Pt),ee===null?Rt=Bi:ee.sibling=Bi,ee=Bi,Mt=On}if(de.done)return p(at,Mt),me&&Ao(at,Pt),Rt;if(Mt===null){for(;!de.done;Pt++,de=ut.next())de=vt(at,de.value,xt),de!==null&&(et=N(de,et,Pt),ee===null?Rt=de:ee.sibling=de,ee=de);return me&&Ao(at,Pt),Rt}for(Mt=y(Mt);!de.done;Pt++,de=ut.next())de=dt(Mt,at,Pt,de.value,xt),de!==null&&(u&&de.alternate!==null&&Mt.delete(de.key===null?Pt:de.key),et=N(de,et,Pt),ee===null?Rt=de:ee.sibling=de,ee=de);return u&&Mt.forEach(function(RU){return h(at,RU)}),me&&Ao(at,Pt),Rt}function ke(at,et,ut,xt){if(typeof ut=="object"&&ut!==null&&ut.type===b&&ut.key===null&&(ut=ut.props.children),typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case m:t:{for(var Rt=ut.key;et!==null;){if(et.key===Rt){if(Rt=ut.type,Rt===b){if(et.tag===7){p(at,et.sibling),xt=S(et,ut.props.children),xt.return=at,at=xt;break t}}else if(et.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===_&&D$(Rt)===et.type){p(at,et.sibling),xt=S(et,ut.props),ed(xt,ut),xt.return=at,at=xt;break t}p(at,et);break}else h(at,et);et=et.sibling}ut.type===b?(xt=Eo(ut.props.children,at.mode,xt,ut.key),xt.return=at,at=xt):(xt=zm(ut.type,ut.key,ut.props,null,at.mode,xt),ed(xt,ut),xt.return=at,at=xt)}return A(at);case g:t:{for(Rt=ut.key;et!==null;){if(et.key===Rt)if(et.tag===4&&et.stateNode.containerInfo===ut.containerInfo&&et.stateNode.implementation===ut.implementation){p(at,et.sibling),xt=S(et,ut.children||[]),xt.return=at,at=xt;break t}else{p(at,et);break}else h(at,et);et=et.sibling}xt=h1(ut,at.mode,xt),xt.return=at,at=xt}return A(at);case _:return Rt=ut._init,ut=Rt(ut._payload),ke(at,et,ut,xt)}if(tt(ut))return Ut(at,et,ut,xt);if(V(ut)){if(Rt=V(ut),typeof Rt!="function")throw Error(s(150));return ut=Rt.call(ut),zt(at,et,ut,xt)}if(typeof ut.then=="function")return ke(at,et,eg(ut),xt);if(ut.$$typeof===C)return ke(at,et,Um(at,ut),xt);ng(at,ut)}return typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint"?(ut=""+ut,et!==null&&et.tag===6?(p(at,et.sibling),xt=S(et,ut),xt.return=at,at=xt):(p(at,et),xt=c1(ut,at.mode,xt),xt.return=at,at=xt),A(at)):p(at,et)}return function(at,et,ut,xt){try{td=0;var Rt=ke(at,et,ut,xt);return du=null,Rt}catch(Mt){if(Mt===jh||Mt===Gm)throw Mt;var ee=Gs(29,Mt,null,at.mode);return ee.lanes=xt,ee.return=at,ee}finally{}}}var fu=O$(!0),_$=O$(!1),dr=j(null),Jr=null;function Ci(u){var h=u.alternate;st(Sn,Sn.current&1),st(dr,u),Jr===null&&(h===null||lu.current!==null||h.memoizedState!==null)&&(Jr=u)}function F$(u){if(u.tag===22){if(st(Sn,Sn.current),st(dr,u),Jr===null){var h=u.alternate;h!==null&&h.memoizedState!==null&&(Jr=u)}}else ki()}function ki(){st(Sn,Sn.current),st(dr,dr.current)}function La(u){rt(dr),Jr===u&&(Jr=null),rt(Sn)}var Sn=j(0);function sg(u){for(var h=u;h!==null;){if(h.tag===13){var p=h.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||Ov(p)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function G1(u,h,p,y){h=u.memoizedState,p=p(y,h),p=p==null?h:d({},h,p),u.memoizedState=p,u.lanes===0&&(u.updateQueue.baseState=p)}var j1={enqueueSetState:function(u,h,p){u=u._reactInternals;var y=Ks(),S=Si(y);S.payload=h,p!=null&&(S.callback=p),h=Ti(u,S,y),h!==null&&(Xs(h,u,y),qh(h,u,y))},enqueueReplaceState:function(u,h,p){u=u._reactInternals;var y=Ks(),S=Si(y);S.tag=1,S.payload=h,p!=null&&(S.callback=p),h=Ti(u,S,y),h!==null&&(Xs(h,u,y),qh(h,u,y))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var p=Ks(),y=Si(p);y.tag=2,h!=null&&(y.callback=h),h=Ti(u,y,p),h!==null&&(Xs(h,u,p),qh(h,u,p))}};function L$(u,h,p,y,S,N,A){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(y,N,A):h.prototype&&h.prototype.isPureReactComponent?!Mh(p,y)||!Mh(S,N):!0}function M$(u,h,p,y){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(p,y),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(p,y),h.state!==u&&j1.enqueueReplaceState(h,h.state,null)}function Mo(u,h){var p=h;if("ref"in h){p={};for(var y in h)y!=="ref"&&(p[y]=h[y])}if(u=u.defaultProps){p===h&&(p=d({},p));for(var S in u)p[S]===void 0&&(p[S]=u[S])}return p}var rg=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)};function z$(u){rg(u)}function P$(u){console.error(u)}function B$(u){rg(u)}function ag(u,h){try{var p=u.onUncaughtError;p(h.value,{componentStack:h.stack})}catch(y){setTimeout(function(){throw y})}}function V$(u,h,p){try{var y=u.onCaughtError;y(p.value,{componentStack:p.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function H1(u,h,p){return p=Si(p),p.tag=3,p.payload={element:null},p.callback=function(){ag(u,h)},p}function U$(u){return u=Si(u),u.tag=3,u}function W$(u,h,p,y){var S=p.type.getDerivedStateFromError;if(typeof S=="function"){var N=y.value;u.payload=function(){return S(N)},u.callback=function(){V$(h,p,y)}}var A=p.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(u.callback=function(){V$(h,p,y),typeof S!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var z=y.stack;this.componentDidCatch(y.value,{componentStack:z!==null?z:""})})}function RV(u,h,p,y,S){if(p.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(h=p.alternate,h!==null&&Uh(h,p,S,!0),p=dr.current,p!==null){switch(p.tag){case 13:return Jr===null?gv():p.alternate===null&&Ye===0&&(Ye=3),p.flags&=-257,p.flags|=65536,p.lanes=S,y===w1?p.flags|=16384:(h=p.updateQueue,h===null?p.updateQueue=new Set([y]):h.add(y),bv(u,y,S)),!1;case 22:return p.flags|=65536,y===w1?p.flags|=16384:(h=p.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([y])},p.updateQueue=h):(p=h.retryQueue,p===null?h.retryQueue=new Set([y]):p.add(y)),bv(u,y,S)),!1}throw Error(s(435,p.tag))}return bv(u,y,S),gv(),!1}if(me)return h=dr.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=S,y!==p1&&(u=Error(s(422),{cause:y}),Vh(lr(u,p)))):(y!==p1&&(h=Error(s(423),{cause:y}),Vh(lr(h,p))),u=u.current.alternate,u.flags|=65536,S&=-S,u.lanes|=S,y=lr(y,p),S=H1(u.stateNode,y,S),N1(u,S),Ye!==4&&(Ye=2)),!1;var N=Error(s(520),{cause:y});if(N=lr(N,p),ld===null?ld=[N]:ld.push(N),Ye!==4&&(Ye=2),h===null)return!0;y=lr(y,p),p=h;do{switch(p.tag){case 3:return p.flags|=65536,u=S&-S,p.lanes|=u,u=H1(p.stateNode,y,u),N1(p,u),!1;case 1:if(h=p.type,N=p.stateNode,(p.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Di===null||!Di.has(N))))return p.flags|=65536,S&=-S,p.lanes|=S,S=U$(S),W$(S,u,p,y),N1(p,S),!1}p=p.return}while(p!==null);return!1}var G$=Error(s(461)),Rn=!1;function Gn(u,h,p,y){h.child=u===null?_$(h,null,p,y):fu(h,u.child,p,y)}function j$(u,h,p,y,S){p=p.render;var N=h.ref;if("ref"in y){var A={};for(var z in y)z!=="ref"&&(A[z]=y[z])}else A=y;return _o(h),y=I1(u,h,p,A,N,S),z=A1(),u!==null&&!Rn?(R1(u,h,S),Ma(u,h,S)):(me&&z&&d1(h),h.flags|=1,Gn(u,h,y,S),h.child)}function H$(u,h,p,y,S){if(u===null){var N=p.type;return typeof N=="function"&&!u1(N)&&N.defaultProps===void 0&&p.compare===null?(h.tag=15,h.type=N,q$(u,h,N,y,S)):(u=zm(p.type,null,y,h,h.mode,S),u.ref=h.ref,u.return=h,h.child=u)}if(N=u.child,!tv(u,S)){var A=N.memoizedProps;if(p=p.compare,p=p!==null?p:Mh,p(A,y)&&u.ref===h.ref)return Ma(u,h,S)}return h.flags|=1,u=Aa(N,y),u.ref=h.ref,u.return=h,h.child=u}function q$(u,h,p,y,S){if(u!==null){var N=u.memoizedProps;if(Mh(N,y)&&u.ref===h.ref)if(Rn=!1,h.pendingProps=y=N,tv(u,S))(u.flags&131072)!==0&&(Rn=!0);else return h.lanes=u.lanes,Ma(u,h,S)}return q1(u,h,p,y,S)}function K$(u,h,p){var y=h.pendingProps,S=y.children,N=u!==null?u.memoizedState:null;if(y.mode==="hidden"){if((h.flags&128)!==0){if(y=N!==null?N.baseLanes|p:p,u!==null){for(S=h.child=u.child,N=0;S!==null;)N=N|S.lanes|S.childLanes,S=S.sibling;h.childLanes=N&~y}else h.childLanes=0,h.child=null;return X$(u,h,y,p)}if((p&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},u!==null&&Wm(h,N!==null?N.cachePool:null),N!==null?qk(h,N):k1(),F$(h);else return h.lanes=h.childLanes=536870912,X$(u,h,N!==null?N.baseLanes|p:p,p)}else N!==null?(Wm(h,N.cachePool),qk(h,N),ki(),h.memoizedState=null):(u!==null&&Wm(h,null),k1(),ki());return Gn(u,h,S,p),h.child}function X$(u,h,p,y){var S=v1();return S=S===null?null:{parent:wn._currentValue,pool:S},h.memoizedState={baseLanes:p,cachePool:S},u!==null&&Wm(h,null),k1(),F$(h),u!==null&&Uh(u,h,y,!0),null}function ig(u,h){var p=h.ref;if(p===null)u!==null&&u.ref!==null&&(h.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(s(284));(u===null||u.ref!==p)&&(h.flags|=4194816)}}function q1(u,h,p,y,S){return _o(h),p=I1(u,h,p,y,void 0,S),y=A1(),u!==null&&!Rn?(R1(u,h,S),Ma(u,h,S)):(me&&y&&d1(h),h.flags|=1,Gn(u,h,p,S),h.child)}function Y$(u,h,p,y,S,N){return _o(h),h.updateQueue=null,p=Xk(h,y,p,S),Kk(u),y=A1(),u!==null&&!Rn?(R1(u,h,N),Ma(u,h,N)):(me&&y&&d1(h),h.flags|=1,Gn(u,h,p,N),h.child)}function Z$(u,h,p,y,S){if(_o(h),h.stateNode===null){var N=su,A=p.contextType;typeof A=="object"&&A!==null&&(N=Jn(A)),N=new p(y,N),h.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=j1,h.stateNode=N,N._reactInternals=h,N=h.stateNode,N.props=y,N.state=h.memoizedState,N.refs={},S1(h),A=p.contextType,N.context=typeof A=="object"&&A!==null?Jn(A):su,N.state=h.memoizedState,A=p.getDerivedStateFromProps,typeof A=="function"&&(G1(h,p,A,y),N.state=h.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(A=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),A!==N.state&&j1.enqueueReplaceState(N,N.state,null),Xh(h,y,N,S),Kh(),N.state=h.memoizedState),typeof N.componentDidMount=="function"&&(h.flags|=4194308),y=!0}else if(u===null){N=h.stateNode;var z=h.memoizedProps,H=Mo(p,z);N.props=H;var ct=N.context,yt=p.contextType;A=su,typeof yt=="object"&&yt!==null&&(A=Jn(yt));var vt=p.getDerivedStateFromProps;yt=typeof vt=="function"||typeof N.getSnapshotBeforeUpdate=="function",z=h.pendingProps!==z,yt||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(z||ct!==A)&&M$(h,N,y,A),wi=!1;var ht=h.memoizedState;N.state=ht,Xh(h,y,N,S),Kh(),ct=h.memoizedState,z||ht!==ct||wi?(typeof vt=="function"&&(G1(h,p,vt,y),ct=h.memoizedState),(H=wi||L$(h,p,H,y,ht,ct,A))?(yt||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(h.flags|=4194308)):(typeof N.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=y,h.memoizedState=ct),N.props=y,N.state=ct,N.context=A,y=H):(typeof N.componentDidMount=="function"&&(h.flags|=4194308),y=!1)}else{N=h.stateNode,T1(u,h),A=h.memoizedProps,yt=Mo(p,A),N.props=yt,vt=h.pendingProps,ht=N.context,ct=p.contextType,H=su,typeof ct=="object"&&ct!==null&&(H=Jn(ct)),z=p.getDerivedStateFromProps,(ct=typeof z=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(A!==vt||ht!==H)&&M$(h,N,y,H),wi=!1,ht=h.memoizedState,N.state=ht,Xh(h,y,N,S),Kh();var dt=h.memoizedState;A!==vt||ht!==dt||wi||u!==null&&u.dependencies!==null&&Vm(u.dependencies)?(typeof z=="function"&&(G1(h,p,z,y),dt=h.memoizedState),(yt=wi||L$(h,p,yt,y,ht,dt,H)||u!==null&&u.dependencies!==null&&Vm(u.dependencies))?(ct||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(y,dt,H),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(y,dt,H)),typeof N.componentDidUpdate=="function"&&(h.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof N.componentDidUpdate!="function"||A===u.memoizedProps&&ht===u.memoizedState||(h.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||A===u.memoizedProps&&ht===u.memoizedState||(h.flags|=1024),h.memoizedProps=y,h.memoizedState=dt),N.props=y,N.state=dt,N.context=H,y=yt):(typeof N.componentDidUpdate!="function"||A===u.memoizedProps&&ht===u.memoizedState||(h.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||A===u.memoizedProps&&ht===u.memoizedState||(h.flags|=1024),y=!1)}return N=y,ig(u,h),y=(h.flags&128)!==0,N||y?(N=h.stateNode,p=y&&typeof p.getDerivedStateFromError!="function"?null:N.render(),h.flags|=1,u!==null&&y?(h.child=fu(h,u.child,null,S),h.child=fu(h,null,p,S)):Gn(u,h,p,S),h.memoizedState=N.state,u=h.child):u=Ma(u,h,S),u}function Q$(u,h,p,y){return Bh(),h.flags|=256,Gn(u,h,p,y),h.child}var K1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function X1(u){return{baseLanes:u,cachePool:Pk()}}function Y1(u,h,p){return u=u!==null?u.childLanes&~p:0,h&&(u|=fr),u}function J$(u,h,p){var y=h.pendingProps,S=!1,N=(h.flags&128)!==0,A;if((A=N)||(A=u!==null&&u.memoizedState===null?!1:(Sn.current&2)!==0),A&&(S=!0,h.flags&=-129),A=(h.flags&32)!==0,h.flags&=-33,u===null){if(me){if(S?Ci(h):ki(),me){var z=Xe,H;if(H=z){t:{for(H=z,z=Qr;H.nodeType!==8;){if(!z){z=null;break t}if(H=Dr(H.nextSibling),H===null){z=null;break t}}z=H}z!==null?(h.memoizedState={dehydrated:z,treeContext:Io!==null?{id:Ra,overflow:Da}:null,retryLane:536870912,hydrationErrors:null},H=Gs(18,null,null,0),H.stateNode=z,H.return=h,h.child=H,ds=h,Xe=null,H=!0):H=!1}H||Do(h)}if(z=h.memoizedState,z!==null&&(z=z.dehydrated,z!==null))return Ov(z)?h.lanes=32:h.lanes=536870912,null;La(h)}return z=y.children,y=y.fallback,S?(ki(),S=h.mode,z=og({mode:"hidden",children:z},S),y=Eo(y,S,p,null),z.return=h,y.return=h,z.sibling=y,h.child=z,S=h.child,S.memoizedState=X1(p),S.childLanes=Y1(u,A,p),h.memoizedState=K1,y):(Ci(h),Z1(h,z))}if(H=u.memoizedState,H!==null&&(z=H.dehydrated,z!==null)){if(N)h.flags&256?(Ci(h),h.flags&=-257,h=Q1(u,h,p)):h.memoizedState!==null?(ki(),h.child=u.child,h.flags|=128,h=null):(ki(),S=y.fallback,z=h.mode,y=og({mode:"visible",children:y.children},z),S=Eo(S,z,p,null),S.flags|=2,y.return=h,S.return=h,y.sibling=S,h.child=y,fu(h,u.child,null,p),y=h.child,y.memoizedState=X1(p),y.childLanes=Y1(u,A,p),h.memoizedState=K1,h=S);else if(Ci(h),Ov(z)){if(A=z.nextSibling&&z.nextSibling.dataset,A)var ct=A.dgst;A=ct,y=Error(s(419)),y.stack="",y.digest=A,Vh({value:y,source:null,stack:null}),h=Q1(u,h,p)}else if(Rn||Uh(u,h,p,!1),A=(p&u.childLanes)!==0,Rn||A){if(A=_e,A!==null&&(y=p&-p,y=(y&42)!==0?1:_x(y),y=(y&(A.suspendedLanes|p))!==0?0:y,y!==0&&y!==H.retryLane))throw H.retryLane=y,nu(u,y),Xs(A,u,y),G$;z.data==="$?"||gv(),h=Q1(u,h,p)}else z.data==="$?"?(h.flags|=192,h.child=u.child,h=null):(u=H.treeContext,Xe=Dr(z.nextSibling),ds=h,me=!0,Ro=null,Qr=!1,u!==null&&(cr[hr++]=Ra,cr[hr++]=Da,cr[hr++]=Io,Ra=u.id,Da=u.overflow,Io=h),h=Z1(h,y.children),h.flags|=4096);return h}return S?(ki(),S=y.fallback,z=h.mode,H=u.child,ct=H.sibling,y=Aa(H,{mode:"hidden",children:y.children}),y.subtreeFlags=H.subtreeFlags&65011712,ct!==null?S=Aa(ct,S):(S=Eo(S,z,p,null),S.flags|=2),S.return=h,y.return=h,y.sibling=S,h.child=y,y=S,S=h.child,z=u.child.memoizedState,z===null?z=X1(p):(H=z.cachePool,H!==null?(ct=wn._currentValue,H=H.parent!==ct?{parent:ct,pool:ct}:H):H=Pk(),z={baseLanes:z.baseLanes|p,cachePool:H}),S.memoizedState=z,S.childLanes=Y1(u,A,p),h.memoizedState=K1,y):(Ci(h),p=u.child,u=p.sibling,p=Aa(p,{mode:"visible",children:y.children}),p.return=h,p.sibling=null,u!==null&&(A=h.deletions,A===null?(h.deletions=[u],h.flags|=16):A.push(u)),h.child=p,h.memoizedState=null,p)}function Z1(u,h){return h=og({mode:"visible",children:h},u.mode),h.return=u,u.child=h}function og(u,h){return u=Gs(22,u,null,h),u.lanes=0,u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},u}function Q1(u,h,p){return fu(h,u.child,null,p),u=Z1(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function tE(u,h,p){u.lanes|=h;var y=u.alternate;y!==null&&(y.lanes|=h),g1(u.return,h,p)}function J1(u,h,p,y,S){var N=u.memoizedState;N===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:S}:(N.isBackwards=h,N.rendering=null,N.renderingStartTime=0,N.last=y,N.tail=p,N.tailMode=S)}function eE(u,h,p){var y=h.pendingProps,S=y.revealOrder,N=y.tail;if(Gn(u,h,y.children,p),y=Sn.current,(y&2)!==0)y=y&1|2,h.flags|=128;else{if(u!==null&&(u.flags&128)!==0)t:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&tE(u,p,h);else if(u.tag===19)tE(u,p,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break t;for(;u.sibling===null;){if(u.return===null||u.return===h)break t;u=u.return}u.sibling.return=u.return,u=u.sibling}y&=1}switch(st(Sn,y),S){case"forwards":for(p=h.child,S=null;p!==null;)u=p.alternate,u!==null&&sg(u)===null&&(S=p),p=p.sibling;p=S,p===null?(S=h.child,h.child=null):(S=p.sibling,p.sibling=null),J1(h,!1,S,p,N);break;case"backwards":for(p=null,S=h.child,h.child=null;S!==null;){if(u=S.alternate,u!==null&&sg(u)===null){h.child=S;break}u=S.sibling,S.sibling=p,p=S,S=u}J1(h,!0,p,null,N);break;case"together":J1(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Ma(u,h,p){if(u!==null&&(h.dependencies=u.dependencies),Ri|=h.lanes,(p&h.childLanes)===0)if(u!==null){if(Uh(u,h,p,!1),(p&h.childLanes)===0)return null}else return null;if(u!==null&&h.child!==u.child)throw Error(s(153));if(h.child!==null){for(u=h.child,p=Aa(u,u.pendingProps),h.child=p,p.return=h;u.sibling!==null;)u=u.sibling,p=p.sibling=Aa(u,u.pendingProps),p.return=h;p.sibling=null}return h.child}function tv(u,h){return(u.lanes&h)!==0?!0:(u=u.dependencies,!!(u!==null&&Vm(u)))}function DV(u,h,p){switch(h.tag){case 3:Ct(h,h.stateNode.containerInfo),vi(h,wn,u.memoizedState.cache),Bh();break;case 27:case 5:Wt(h);break;case 4:Ct(h,h.stateNode.containerInfo);break;case 10:vi(h,h.type,h.memoizedProps.value);break;case 13:var y=h.memoizedState;if(y!==null)return y.dehydrated!==null?(Ci(h),h.flags|=128,null):(p&h.child.childLanes)!==0?J$(u,h,p):(Ci(h),u=Ma(u,h,p),u!==null?u.sibling:null);Ci(h);break;case 19:var S=(u.flags&128)!==0;if(y=(p&h.childLanes)!==0,y||(Uh(u,h,p,!1),y=(p&h.childLanes)!==0),S){if(y)return eE(u,h,p);h.flags|=128}if(S=h.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),st(Sn,Sn.current),y)break;return null;case 22:case 23:return h.lanes=0,K$(u,h,p);case 24:vi(h,wn,u.memoizedState.cache)}return Ma(u,h,p)}function nE(u,h,p){if(u!==null)if(u.memoizedProps!==h.pendingProps)Rn=!0;else{if(!tv(u,p)&&(h.flags&128)===0)return Rn=!1,DV(u,h,p);Rn=(u.flags&131072)!==0}else Rn=!1,me&&(h.flags&1048576)!==0&&Dk(h,Bm,h.index);switch(h.lanes=0,h.tag){case 16:t:{u=h.pendingProps;var y=h.elementType,S=y._init;if(y=S(y._payload),h.type=y,typeof y=="function")u1(y)?(u=Mo(y,u),h.tag=1,h=Z$(null,h,y,u,p)):(h.tag=0,h=q1(null,h,y,u,p));else{if(y!=null){if(S=y.$$typeof,S===k){h.tag=11,h=j$(null,h,y,u,p);break t}else if(S===D){h.tag=14,h=H$(null,h,y,u,p);break t}}throw h=Q(y)||y,Error(s(306,h,""))}}return h;case 0:return q1(u,h,h.type,h.pendingProps,p);case 1:return y=h.type,S=Mo(y,h.pendingProps),Z$(u,h,y,S,p);case 3:t:{if(Ct(h,h.stateNode.containerInfo),u===null)throw Error(s(387));y=h.pendingProps;var N=h.memoizedState;S=N.element,T1(u,h),Xh(h,y,null,p);var A=h.memoizedState;if(y=A.cache,vi(h,wn,y),y!==N.cache&&y1(h,[wn],p,!0),Kh(),y=A.element,N.isDehydrated)if(N={element:y,isDehydrated:!1,cache:A.cache},h.updateQueue.baseState=N,h.memoizedState=N,h.flags&256){h=Q$(u,h,y,p);break t}else if(y!==S){S=lr(Error(s(424)),h),Vh(S),h=Q$(u,h,y,p);break t}else{switch(u=h.stateNode.containerInfo,u.nodeType){case 9:u=u.body;break;default:u=u.nodeName==="HTML"?u.ownerDocument.body:u}for(Xe=Dr(u.firstChild),ds=h,me=!0,Ro=null,Qr=!0,p=_$(h,null,y,p),h.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Bh(),y===S){h=Ma(u,h,p);break t}Gn(u,h,y,p)}h=h.child}return h;case 26:return ig(u,h),u===null?(p=iI(h.type,null,h.pendingProps,null))?h.memoizedState=p:me||(p=h.type,u=h.pendingProps,y=wg(bt.current).createElement(p),y[Qn]=h,y[Cs]=u,Hn(y,p,u),An(y),h.stateNode=y):h.memoizedState=iI(h.type,u.memoizedProps,h.pendingProps,u.memoizedState),null;case 27:return Wt(h),u===null&&me&&(y=h.stateNode=sI(h.type,h.pendingProps,bt.current),ds=h,Qr=!0,S=Xe,Fi(h.type)?(_v=S,Xe=Dr(y.firstChild)):Xe=S),Gn(u,h,h.pendingProps.children,p),ig(u,h),u===null&&(h.flags|=4194304),h.child;case 5:return u===null&&me&&((S=y=Xe)&&(y=iU(y,h.type,h.pendingProps,Qr),y!==null?(h.stateNode=y,ds=h,Xe=Dr(y.firstChild),Qr=!1,S=!0):S=!1),S||Do(h)),Wt(h),S=h.type,N=h.pendingProps,A=u!==null?u.memoizedProps:null,y=N.children,Av(S,N)?y=null:A!==null&&Av(S,A)&&(h.flags|=32),h.memoizedState!==null&&(S=I1(u,h,NV,null,null,p),yd._currentValue=S),ig(u,h),Gn(u,h,y,p),h.child;case 6:return u===null&&me&&((u=p=Xe)&&(p=oU(p,h.pendingProps,Qr),p!==null?(h.stateNode=p,ds=h,Xe=null,u=!0):u=!1),u||Do(h)),null;case 13:return J$(u,h,p);case 4:return Ct(h,h.stateNode.containerInfo),y=h.pendingProps,u===null?h.child=fu(h,null,y,p):Gn(u,h,y,p),h.child;case 11:return j$(u,h,h.type,h.pendingProps,p);case 7:return Gn(u,h,h.pendingProps,p),h.child;case 8:return Gn(u,h,h.pendingProps.children,p),h.child;case 12:return Gn(u,h,h.pendingProps.children,p),h.child;case 10:return y=h.pendingProps,vi(h,h.type,y.value),Gn(u,h,y.children,p),h.child;case 9:return S=h.type._context,y=h.pendingProps.children,_o(h),S=Jn(S),y=y(S),h.flags|=1,Gn(u,h,y,p),h.child;case 14:return H$(u,h,h.type,h.pendingProps,p);case 15:return q$(u,h,h.type,h.pendingProps,p);case 19:return eE(u,h,p);case 31:return y=h.pendingProps,p=h.mode,y={mode:y.mode,children:y.children},u===null?(p=og(y,p),p.ref=h.ref,h.child=p,p.return=h,h=p):(p=Aa(u.child,y),p.ref=h.ref,h.child=p,p.return=h,h=p),h;case 22:return K$(u,h,p);case 24:return _o(h),y=Jn(wn),u===null?(S=v1(),S===null&&(S=_e,N=b1(),S.pooledCache=N,N.refCount++,N!==null&&(S.pooledCacheLanes|=p),S=N),h.memoizedState={parent:y,cache:S},S1(h),vi(h,wn,S)):((u.lanes&p)!==0&&(T1(u,h),Xh(h,null,null,p),Kh()),S=u.memoizedState,N=h.memoizedState,S.parent!==y?(S={parent:y,cache:y},h.memoizedState=S,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=S),vi(h,wn,y)):(y=N.cache,vi(h,wn,y),y!==S.cache&&y1(h,[wn],p,!0))),Gn(u,h,h.pendingProps.children,p),h.child;case 29:throw h.pendingProps}throw Error(s(156,h.tag))}function za(u){u.flags|=4}function sE(u,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!hI(h)){if(h=dr.current,h!==null&&((ce&4194048)===ce?Jr!==null:(ce&62914560)!==ce&&(ce&536870912)===0||h!==Jr))throw Hh=w1,Bk;u.flags|=8192}}function lg(u,h){h!==null&&(u.flags|=4),u.flags&16384&&(h=u.tag!==22?FC():536870912,u.lanes|=h,yu|=h)}function nd(u,h){if(!me)switch(u.tailMode){case"hidden":h=u.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?u.tail=null:p.sibling=null;break;case"collapsed":p=u.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:y.sibling=null}}function Ge(u){var h=u.alternate!==null&&u.alternate.child===u.child,p=0,y=0;if(h)for(var S=u.child;S!==null;)p|=S.lanes|S.childLanes,y|=S.subtreeFlags&65011712,y|=S.flags&65011712,S.return=u,S=S.sibling;else for(S=u.child;S!==null;)p|=S.lanes|S.childLanes,y|=S.subtreeFlags,y|=S.flags,S.return=u,S=S.sibling;return u.subtreeFlags|=y,u.childLanes=p,h}function OV(u,h,p){var y=h.pendingProps;switch(f1(h),h.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ge(h),null;case 1:return Ge(h),null;case 3:return p=h.stateNode,y=null,u!==null&&(y=u.memoizedState.cache),h.memoizedState.cache!==y&&(h.flags|=2048),_a(wn),_t(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(u===null||u.child===null)&&(Ph(h)?za(h):u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Fk())),Ge(h),null;case 26:return p=h.memoizedState,u===null?(za(h),p!==null?(Ge(h),sE(h,p)):(Ge(h),h.flags&=-16777217)):p?p!==u.memoizedState?(za(h),Ge(h),sE(h,p)):(Ge(h),h.flags&=-16777217):(u.memoizedProps!==y&&za(h),Ge(h),h.flags&=-16777217),null;case 27:Gt(h),p=bt.current;var S=h.type;if(u!==null&&h.stateNode!=null)u.memoizedProps!==y&&za(h);else{if(!y){if(h.stateNode===null)throw Error(s(166));return Ge(h),null}u=mt.current,Ph(h)?Ok(h):(u=sI(S,y,p),h.stateNode=u,za(h))}return Ge(h),null;case 5:if(Gt(h),p=h.type,u!==null&&h.stateNode!=null)u.memoizedProps!==y&&za(h);else{if(!y){if(h.stateNode===null)throw Error(s(166));return Ge(h),null}if(u=mt.current,Ph(h))Ok(h);else{switch(S=wg(bt.current),u){case 1:u=S.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:u=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":u=S.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":u=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":u=S.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof y.is=="string"?S.createElement("select",{is:y.is}):S.createElement("select"),y.multiple?u.multiple=!0:y.size&&(u.size=y.size);break;default:u=typeof y.is=="string"?S.createElement(p,{is:y.is}):S.createElement(p)}}u[Qn]=h,u[Cs]=y;t:for(S=h.child;S!==null;){if(S.tag===5||S.tag===6)u.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===h)break t;for(;S.sibling===null;){if(S.return===null||S.return===h)break t;S=S.return}S.sibling.return=S.return,S=S.sibling}h.stateNode=u;t:switch(Hn(u,p,y),p){case"button":case"input":case"select":case"textarea":u=!!y.autoFocus;break t;case"img":u=!0;break t;default:u=!1}u&&za(h)}}return Ge(h),h.flags&=-16777217,null;case 6:if(u&&h.stateNode!=null)u.memoizedProps!==y&&za(h);else{if(typeof y!="string"&&h.stateNode===null)throw Error(s(166));if(u=bt.current,Ph(h)){if(u=h.stateNode,p=h.memoizedProps,y=null,S=ds,S!==null)switch(S.tag){case 27:case 5:y=S.memoizedProps}u[Qn]=h,u=!!(u.nodeValue===p||y!==null&&y.suppressHydrationWarning===!0||YE(u.nodeValue,p)),u||Do(h)}else u=wg(u).createTextNode(y),u[Qn]=h,h.stateNode=u}return Ge(h),null;case 13:if(y=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(S=Ph(h),y!==null&&y.dehydrated!==null){if(u===null){if(!S)throw Error(s(318));if(S=h.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(s(317));S[Qn]=h}else Bh(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ge(h),S=!1}else S=Fk(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=S),S=!0;if(!S)return h.flags&256?(La(h),h):(La(h),null)}if(La(h),(h.flags&128)!==0)return h.lanes=p,h;if(p=y!==null,u=u!==null&&u.memoizedState!==null,p){y=h.child,S=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(S=y.alternate.memoizedState.cachePool.pool);var N=null;y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(N=y.memoizedState.cachePool.pool),N!==S&&(y.flags|=2048)}return p!==u&&p&&(h.child.flags|=8192),lg(h,h.updateQueue),Ge(h),null;case 4:return _t(),u===null&&Cv(h.stateNode.containerInfo),Ge(h),null;case 10:return _a(h.type),Ge(h),null;case 19:if(rt(Sn),S=h.memoizedState,S===null)return Ge(h),null;if(y=(h.flags&128)!==0,N=S.rendering,N===null)if(y)nd(S,!1);else{if(Ye!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(N=sg(u),N!==null){for(h.flags|=128,nd(S,!1),u=N.updateQueue,h.updateQueue=u,lg(h,u),h.subtreeFlags=0,u=p,p=h.child;p!==null;)Rk(p,u),p=p.sibling;return st(Sn,Sn.current&1|2),h.child}u=u.sibling}S.tail!==null&&oe()>hg&&(h.flags|=128,y=!0,nd(S,!1),h.lanes=4194304)}else{if(!y)if(u=sg(N),u!==null){if(h.flags|=128,y=!0,u=u.updateQueue,h.updateQueue=u,lg(h,u),nd(S,!0),S.tail===null&&S.tailMode==="hidden"&&!N.alternate&&!me)return Ge(h),null}else 2*oe()-S.renderingStartTime>hg&&p!==536870912&&(h.flags|=128,y=!0,nd(S,!1),h.lanes=4194304);S.isBackwards?(N.sibling=h.child,h.child=N):(u=S.last,u!==null?u.sibling=N:h.child=N,S.last=N)}return S.tail!==null?(h=S.tail,S.rendering=h,S.tail=h.sibling,S.renderingStartTime=oe(),h.sibling=null,u=Sn.current,st(Sn,y?u&1|2:u&1),h):(Ge(h),null);case 22:case 23:return La(h),$1(),y=h.memoizedState!==null,u!==null?u.memoizedState!==null!==y&&(h.flags|=8192):y&&(h.flags|=8192),y?(p&536870912)!==0&&(h.flags&128)===0&&(Ge(h),h.subtreeFlags&6&&(h.flags|=8192)):Ge(h),p=h.updateQueue,p!==null&&lg(h,p.retryQueue),p=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),y=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(y=h.memoizedState.cachePool.pool),y!==p&&(h.flags|=2048),u!==null&&rt(Fo),null;case 24:return p=null,u!==null&&(p=u.memoizedState.cache),h.memoizedState.cache!==p&&(h.flags|=2048),_a(wn),Ge(h),null;case 25:return null;case 30:return null}throw Error(s(156,h.tag))}function _V(u,h){switch(f1(h),h.tag){case 1:return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return _a(wn),_t(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 26:case 27:case 5:return Gt(h),null;case 13:if(La(h),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(s(340));Bh()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return rt(Sn),null;case 4:return _t(),null;case 10:return _a(h.type),null;case 22:case 23:return La(h),$1(),u!==null&&rt(Fo),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 24:return _a(wn),null;case 25:return null;default:return null}}function rE(u,h){switch(f1(h),h.tag){case 3:_a(wn),_t();break;case 26:case 27:case 5:Gt(h);break;case 4:_t();break;case 13:La(h);break;case 19:rt(Sn);break;case 10:_a(h.type);break;case 22:case 23:La(h),$1(),u!==null&&rt(Fo);break;case 24:_a(wn)}}function sd(u,h){try{var p=h.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var S=y.next;p=S;do{if((p.tag&u)===u){y=void 0;var N=p.create,A=p.inst;y=N(),A.destroy=y}p=p.next}while(p!==S)}}catch(z){Ae(h,h.return,z)}}function $i(u,h,p){try{var y=h.updateQueue,S=y!==null?y.lastEffect:null;if(S!==null){var N=S.next;y=N;do{if((y.tag&u)===u){var A=y.inst,z=A.destroy;if(z!==void 0){A.destroy=void 0,S=h;var H=p,ct=z;try{ct()}catch(yt){Ae(S,H,yt)}}}y=y.next}while(y!==N)}}catch(yt){Ae(h,h.return,yt)}}function aE(u){var h=u.updateQueue;if(h!==null){var p=u.stateNode;try{Hk(h,p)}catch(y){Ae(u,u.return,y)}}}function iE(u,h,p){p.props=Mo(u.type,u.memoizedProps),p.state=u.memoizedState;try{p.componentWillUnmount()}catch(y){Ae(u,h,y)}}function rd(u,h){try{var p=u.ref;if(p!==null){switch(u.tag){case 26:case 27:case 5:var y=u.stateNode;break;case 30:y=u.stateNode;break;default:y=u.stateNode}typeof p=="function"?u.refCleanup=p(y):p.current=y}}catch(S){Ae(u,h,S)}}function ta(u,h){var p=u.ref,y=u.refCleanup;if(p!==null)if(typeof y=="function")try{y()}catch(S){Ae(u,h,S)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(S){Ae(u,h,S)}else p.current=null}function oE(u){var h=u.type,p=u.memoizedProps,y=u.stateNode;try{t:switch(h){case"button":case"input":case"select":case"textarea":p.autoFocus&&y.focus();break t;case"img":p.src?y.src=p.src:p.srcSet&&(y.srcset=p.srcSet)}}catch(S){Ae(u,u.return,S)}}function ev(u,h,p){try{var y=u.stateNode;eU(y,u.type,p,h),y[Cs]=h}catch(S){Ae(u,u.return,S)}}function lE(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27&&Fi(u.type)||u.tag===4}function nv(u){t:for(;;){for(;u.sibling===null;){if(u.return===null||lE(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.tag===27&&Fi(u.type)||u.flags&2||u.child===null||u.tag===4)continue t;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function sv(u,h,p){var y=u.tag;if(y===5||y===6)u=u.stateNode,h?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(u,h):(h=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,h.appendChild(u),p=p._reactRootContainer,p!=null||h.onclick!==null||(h.onclick=vg));else if(y!==4&&(y===27&&Fi(u.type)&&(p=u.stateNode,h=null),u=u.child,u!==null))for(sv(u,h,p),u=u.sibling;u!==null;)sv(u,h,p),u=u.sibling}function ug(u,h,p){var y=u.tag;if(y===5||y===6)u=u.stateNode,h?p.insertBefore(u,h):p.appendChild(u);else if(y!==4&&(y===27&&Fi(u.type)&&(p=u.stateNode),u=u.child,u!==null))for(ug(u,h,p),u=u.sibling;u!==null;)ug(u,h,p),u=u.sibling}function uE(u){var h=u.stateNode,p=u.memoizedProps;try{for(var y=u.type,S=h.attributes;S.length;)h.removeAttributeNode(S[0]);Hn(h,y,p),h[Qn]=u,h[Cs]=p}catch(N){Ae(u,u.return,N)}}var Pa=!1,an=!1,rv=!1,cE=typeof WeakSet=="function"?WeakSet:Set,Dn=null;function FV(u,h){if(u=u.containerInfo,Ev=$g,u=wk(u),n1(u)){if("selectionStart"in u)var p={start:u.selectionStart,end:u.selectionEnd};else t:{p=(p=u.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var S=y.anchorOffset,N=y.focusNode;y=y.focusOffset;try{p.nodeType,N.nodeType}catch{p=null;break t}var A=0,z=-1,H=-1,ct=0,yt=0,vt=u,ht=null;e:for(;;){for(var dt;vt!==p||S!==0&&vt.nodeType!==3||(z=A+S),vt!==N||y!==0&&vt.nodeType!==3||(H=A+y),vt.nodeType===3&&(A+=vt.nodeValue.length),(dt=vt.firstChild)!==null;)ht=vt,vt=dt;for(;;){if(vt===u)break e;if(ht===p&&++ct===S&&(z=A),ht===N&&++yt===y&&(H=A),(dt=vt.nextSibling)!==null)break;vt=ht,ht=vt.parentNode}vt=dt}p=z===-1||H===-1?null:{start:z,end:H}}else p=null}p=p||{start:0,end:0}}else p=null;for(Iv={focusedElem:u,selectionRange:p},$g=!1,Dn=h;Dn!==null;)if(h=Dn,u=h.child,(h.subtreeFlags&1024)!==0&&u!==null)u.return=h,Dn=u;else for(;Dn!==null;){switch(h=Dn,N=h.alternate,u=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&N!==null){u=void 0,p=h,S=N.memoizedProps,N=N.memoizedState,y=p.stateNode;try{var Ut=Mo(p.type,S,p.elementType===p.type);u=y.getSnapshotBeforeUpdate(Ut,N),y.__reactInternalSnapshotBeforeUpdate=u}catch(zt){Ae(p,p.return,zt)}}break;case 3:if((u&1024)!==0){if(u=h.stateNode.containerInfo,p=u.nodeType,p===9)Dv(u);else if(p===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":Dv(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(s(163))}if(u=h.sibling,u!==null){u.return=h.return,Dn=u;break}Dn=h.return}}function hE(u,h,p){var y=p.flags;switch(p.tag){case 0:case 11:case 15:Ei(u,p),y&4&&sd(5,p);break;case 1:if(Ei(u,p),y&4)if(u=p.stateNode,h===null)try{u.componentDidMount()}catch(A){Ae(p,p.return,A)}else{var S=Mo(p.type,h.memoizedProps);h=h.memoizedState;try{u.componentDidUpdate(S,h,u.__reactInternalSnapshotBeforeUpdate)}catch(A){Ae(p,p.return,A)}}y&64&&aE(p),y&512&&rd(p,p.return);break;case 3:if(Ei(u,p),y&64&&(u=p.updateQueue,u!==null)){if(h=null,p.child!==null)switch(p.child.tag){case 27:case 5:h=p.child.stateNode;break;case 1:h=p.child.stateNode}try{Hk(u,h)}catch(A){Ae(p,p.return,A)}}break;case 27:h===null&&y&4&&uE(p);case 26:case 5:Ei(u,p),h===null&&y&4&&oE(p),y&512&&rd(p,p.return);break;case 12:Ei(u,p);break;case 13:Ei(u,p),y&4&&pE(u,p),y&64&&(u=p.memoizedState,u!==null&&(u=u.dehydrated,u!==null&&(p=GV.bind(null,p),lU(u,p))));break;case 22:if(y=p.memoizedState!==null||Pa,!y){h=h!==null&&h.memoizedState!==null||an,S=Pa;var N=an;Pa=y,(an=h)&&!N?Ii(u,p,(p.subtreeFlags&8772)!==0):Ei(u,p),Pa=S,an=N}break;case 30:break;default:Ei(u,p)}}function dE(u){var h=u.alternate;h!==null&&(u.alternate=null,dE(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&Mx(h)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var ze=null,Es=!1;function Ba(u,h,p){for(p=p.child;p!==null;)fE(u,h,p),p=p.sibling}function fE(u,h,p){if(Ke&&typeof Ke.onCommitFiberUnmount=="function")try{Ke.onCommitFiberUnmount(Ns,p)}catch{}switch(p.tag){case 26:an||ta(p,h),Ba(u,h,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:an||ta(p,h);var y=ze,S=Es;Fi(p.type)&&(ze=p.stateNode,Es=!1),Ba(u,h,p),fd(p.stateNode),ze=y,Es=S;break;case 5:an||ta(p,h);case 6:if(y=ze,S=Es,ze=null,Ba(u,h,p),ze=y,Es=S,ze!==null)if(Es)try{(ze.nodeType===9?ze.body:ze.nodeName==="HTML"?ze.ownerDocument.body:ze).removeChild(p.stateNode)}catch(N){Ae(p,h,N)}else try{ze.removeChild(p.stateNode)}catch(N){Ae(p,h,N)}break;case 18:ze!==null&&(Es?(u=ze,eI(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,p.stateNode),wd(u)):eI(ze,p.stateNode));break;case 4:y=ze,S=Es,ze=p.stateNode.containerInfo,Es=!0,Ba(u,h,p),ze=y,Es=S;break;case 0:case 11:case 14:case 15:an||$i(2,p,h),an||$i(4,p,h),Ba(u,h,p);break;case 1:an||(ta(p,h),y=p.stateNode,typeof y.componentWillUnmount=="function"&&iE(p,h,y)),Ba(u,h,p);break;case 21:Ba(u,h,p);break;case 22:an=(y=an)||p.memoizedState!==null,Ba(u,h,p),an=y;break;default:Ba(u,h,p)}}function pE(u,h){if(h.memoizedState===null&&(u=h.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{wd(u)}catch(p){Ae(h,h.return,p)}}function LV(u){switch(u.tag){case 13:case 19:var h=u.stateNode;return h===null&&(h=u.stateNode=new cE),h;case 22:return u=u.stateNode,h=u._retryCache,h===null&&(h=u._retryCache=new cE),h;default:throw Error(s(435,u.tag))}}function av(u,h){var p=LV(u);h.forEach(function(y){var S=jV.bind(null,u,y);p.has(y)||(p.add(y),y.then(S,S))})}function js(u,h){var p=h.deletions;if(p!==null)for(var y=0;y<p.length;y++){var S=p[y],N=u,A=h,z=A;t:for(;z!==null;){switch(z.tag){case 27:if(Fi(z.type)){ze=z.stateNode,Es=!1;break t}break;case 5:ze=z.stateNode,Es=!1;break t;case 3:case 4:ze=z.stateNode.containerInfo,Es=!0;break t}z=z.return}if(ze===null)throw Error(s(160));fE(N,A,S),ze=null,Es=!1,N=S.alternate,N!==null&&(N.return=null),S.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)mE(h,u),h=h.sibling}var Rr=null;function mE(u,h){var p=u.alternate,y=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:js(h,u),Hs(u),y&4&&($i(3,u,u.return),sd(3,u),$i(5,u,u.return));break;case 1:js(h,u),Hs(u),y&512&&(an||p===null||ta(p,p.return)),y&64&&Pa&&(u=u.updateQueue,u!==null&&(y=u.callbacks,y!==null&&(p=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=p===null?y:p.concat(y))));break;case 26:var S=Rr;if(js(h,u),Hs(u),y&512&&(an||p===null||ta(p,p.return)),y&4){var N=p!==null?p.memoizedState:null;if(y=u.memoizedState,p===null)if(y===null)if(u.stateNode===null){t:{y=u.type,p=u.memoizedProps,S=S.ownerDocument||S;e:switch(y){case"title":N=S.getElementsByTagName("title")[0],(!N||N[Eh]||N[Qn]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=S.createElement(y),S.head.insertBefore(N,S.querySelector("head > title"))),Hn(N,y,p),N[Qn]=u,An(N),y=N;break t;case"link":var A=uI("link","href",S).get(y+(p.href||""));if(A){for(var z=0;z<A.length;z++)if(N=A[z],N.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&N.getAttribute("rel")===(p.rel==null?null:p.rel)&&N.getAttribute("title")===(p.title==null?null:p.title)&&N.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){A.splice(z,1);break e}}N=S.createElement(y),Hn(N,y,p),S.head.appendChild(N);break;case"meta":if(A=uI("meta","content",S).get(y+(p.content||""))){for(z=0;z<A.length;z++)if(N=A[z],N.getAttribute("content")===(p.content==null?null:""+p.content)&&N.getAttribute("name")===(p.name==null?null:p.name)&&N.getAttribute("property")===(p.property==null?null:p.property)&&N.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&N.getAttribute("charset")===(p.charSet==null?null:p.charSet)){A.splice(z,1);break e}}N=S.createElement(y),Hn(N,y,p),S.head.appendChild(N);break;default:throw Error(s(468,y))}N[Qn]=u,An(N),y=N}u.stateNode=y}else cI(S,u.type,u.stateNode);else u.stateNode=lI(S,y,u.memoizedProps);else N!==y?(N===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):N.count--,y===null?cI(S,u.type,u.stateNode):lI(S,y,u.memoizedProps)):y===null&&u.stateNode!==null&&ev(u,u.memoizedProps,p.memoizedProps)}break;case 27:js(h,u),Hs(u),y&512&&(an||p===null||ta(p,p.return)),p!==null&&y&4&&ev(u,u.memoizedProps,p.memoizedProps);break;case 5:if(js(h,u),Hs(u),y&512&&(an||p===null||ta(p,p.return)),u.flags&32){S=u.stateNode;try{Xl(S,"")}catch(dt){Ae(u,u.return,dt)}}y&4&&u.stateNode!=null&&(S=u.memoizedProps,ev(u,S,p!==null?p.memoizedProps:S)),y&1024&&(rv=!0);break;case 6:if(js(h,u),Hs(u),y&4){if(u.stateNode===null)throw Error(s(162));y=u.memoizedProps,p=u.stateNode;try{p.nodeValue=y}catch(dt){Ae(u,u.return,dt)}}break;case 3:if(Ng=null,S=Rr,Rr=Sg(h.containerInfo),js(h,u),Rr=S,Hs(u),y&4&&p!==null&&p.memoizedState.isDehydrated)try{wd(h.containerInfo)}catch(dt){Ae(u,u.return,dt)}rv&&(rv=!1,gE(u));break;case 4:y=Rr,Rr=Sg(u.stateNode.containerInfo),js(h,u),Hs(u),Rr=y;break;case 12:js(h,u),Hs(u);break;case 13:js(h,u),Hs(u),u.child.flags&8192&&u.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(hv=oe()),y&4&&(y=u.updateQueue,y!==null&&(u.updateQueue=null,av(u,y)));break;case 22:S=u.memoizedState!==null;var H=p!==null&&p.memoizedState!==null,ct=Pa,yt=an;if(Pa=ct||S,an=yt||H,js(h,u),an=yt,Pa=ct,Hs(u),y&8192)t:for(h=u.stateNode,h._visibility=S?h._visibility&-2:h._visibility|1,S&&(p===null||H||Pa||an||zo(u)),p=null,h=u;;){if(h.tag===5||h.tag===26){if(p===null){H=p=h;try{if(N=H.stateNode,S)A=N.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{z=H.stateNode;var vt=H.memoizedProps.style,ht=vt!=null&&vt.hasOwnProperty("display")?vt.display:null;z.style.display=ht==null||typeof ht=="boolean"?"":(""+ht).trim()}}catch(dt){Ae(H,H.return,dt)}}}else if(h.tag===6){if(p===null){H=h;try{H.stateNode.nodeValue=S?"":H.memoizedProps}catch(dt){Ae(H,H.return,dt)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===u)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break t;for(;h.sibling===null;){if(h.return===null||h.return===u)break t;p===h&&(p=null),h=h.return}p===h&&(p=null),h.sibling.return=h.return,h=h.sibling}y&4&&(y=u.updateQueue,y!==null&&(p=y.retryQueue,p!==null&&(y.retryQueue=null,av(u,p))));break;case 19:js(h,u),Hs(u),y&4&&(y=u.updateQueue,y!==null&&(u.updateQueue=null,av(u,y)));break;case 30:break;case 21:break;default:js(h,u),Hs(u)}}function Hs(u){var h=u.flags;if(h&2){try{for(var p,y=u.return;y!==null;){if(lE(y)){p=y;break}y=y.return}if(p==null)throw Error(s(160));switch(p.tag){case 27:var S=p.stateNode,N=nv(u);ug(u,N,S);break;case 5:var A=p.stateNode;p.flags&32&&(Xl(A,""),p.flags&=-33);var z=nv(u);ug(u,z,A);break;case 3:case 4:var H=p.stateNode.containerInfo,ct=nv(u);sv(u,ct,H);break;default:throw Error(s(161))}}catch(yt){Ae(u,u.return,yt)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function gE(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var h=u;gE(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),u=u.sibling}}function Ei(u,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)hE(u,h.alternate,h),h=h.sibling}function zo(u){for(u=u.child;u!==null;){var h=u;switch(h.tag){case 0:case 11:case 14:case 15:$i(4,h,h.return),zo(h);break;case 1:ta(h,h.return);var p=h.stateNode;typeof p.componentWillUnmount=="function"&&iE(h,h.return,p),zo(h);break;case 27:fd(h.stateNode);case 26:case 5:ta(h,h.return),zo(h);break;case 22:h.memoizedState===null&&zo(h);break;case 30:zo(h);break;default:zo(h)}u=u.sibling}}function Ii(u,h,p){for(p=p&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var y=h.alternate,S=u,N=h,A=N.flags;switch(N.tag){case 0:case 11:case 15:Ii(S,N,p),sd(4,N);break;case 1:if(Ii(S,N,p),y=N,S=y.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(ct){Ae(y,y.return,ct)}if(y=N,S=y.updateQueue,S!==null){var z=y.stateNode;try{var H=S.shared.hiddenCallbacks;if(H!==null)for(S.shared.hiddenCallbacks=null,S=0;S<H.length;S++)jk(H[S],z)}catch(ct){Ae(y,y.return,ct)}}p&&A&64&&aE(N),rd(N,N.return);break;case 27:uE(N);case 26:case 5:Ii(S,N,p),p&&y===null&&A&4&&oE(N),rd(N,N.return);break;case 12:Ii(S,N,p);break;case 13:Ii(S,N,p),p&&A&4&&pE(S,N);break;case 22:N.memoizedState===null&&Ii(S,N,p),rd(N,N.return);break;case 30:break;default:Ii(S,N,p)}h=h.sibling}}function iv(u,h){var p=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),u=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(u=h.memoizedState.cachePool.pool),u!==p&&(u!=null&&u.refCount++,p!=null&&Wh(p))}function ov(u,h){u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&Wh(u))}function ea(u,h,p,y){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)yE(u,h,p,y),h=h.sibling}function yE(u,h,p,y){var S=h.flags;switch(h.tag){case 0:case 11:case 15:ea(u,h,p,y),S&2048&&sd(9,h);break;case 1:ea(u,h,p,y);break;case 3:ea(u,h,p,y),S&2048&&(u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&Wh(u)));break;case 12:if(S&2048){ea(u,h,p,y),u=h.stateNode;try{var N=h.memoizedProps,A=N.id,z=N.onPostCommit;typeof z=="function"&&z(A,h.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(H){Ae(h,h.return,H)}}else ea(u,h,p,y);break;case 13:ea(u,h,p,y);break;case 23:break;case 22:N=h.stateNode,A=h.alternate,h.memoizedState!==null?N._visibility&2?ea(u,h,p,y):ad(u,h):N._visibility&2?ea(u,h,p,y):(N._visibility|=2,pu(u,h,p,y,(h.subtreeFlags&10256)!==0)),S&2048&&iv(A,h);break;case 24:ea(u,h,p,y),S&2048&&ov(h.alternate,h);break;default:ea(u,h,p,y)}}function pu(u,h,p,y,S){for(S=S&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var N=u,A=h,z=p,H=y,ct=A.flags;switch(A.tag){case 0:case 11:case 15:pu(N,A,z,H,S),sd(8,A);break;case 23:break;case 22:var yt=A.stateNode;A.memoizedState!==null?yt._visibility&2?pu(N,A,z,H,S):ad(N,A):(yt._visibility|=2,pu(N,A,z,H,S)),S&&ct&2048&&iv(A.alternate,A);break;case 24:pu(N,A,z,H,S),S&&ct&2048&&ov(A.alternate,A);break;default:pu(N,A,z,H,S)}h=h.sibling}}function ad(u,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var p=u,y=h,S=y.flags;switch(y.tag){case 22:ad(p,y),S&2048&&iv(y.alternate,y);break;case 24:ad(p,y),S&2048&&ov(y.alternate,y);break;default:ad(p,y)}h=h.sibling}}var id=8192;function mu(u){if(u.subtreeFlags&id)for(u=u.child;u!==null;)bE(u),u=u.sibling}function bE(u){switch(u.tag){case 26:mu(u),u.flags&id&&u.memoizedState!==null&&wU(Rr,u.memoizedState,u.memoizedProps);break;case 5:mu(u);break;case 3:case 4:var h=Rr;Rr=Sg(u.stateNode.containerInfo),mu(u),Rr=h;break;case 22:u.memoizedState===null&&(h=u.alternate,h!==null&&h.memoizedState!==null?(h=id,id=16777216,mu(u),id=h):mu(u));break;default:mu(u)}}function xE(u){var h=u.alternate;if(h!==null&&(u=h.child,u!==null)){h.child=null;do h=u.sibling,u.sibling=null,u=h;while(u!==null)}}function od(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var p=0;p<h.length;p++){var y=h[p];Dn=y,wE(y,u)}xE(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)vE(u),u=u.sibling}function vE(u){switch(u.tag){case 0:case 11:case 15:od(u),u.flags&2048&&$i(9,u,u.return);break;case 3:od(u);break;case 12:od(u);break;case 22:var h=u.stateNode;u.memoizedState!==null&&h._visibility&2&&(u.return===null||u.return.tag!==13)?(h._visibility&=-3,cg(u)):od(u);break;default:od(u)}}function cg(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var p=0;p<h.length;p++){var y=h[p];Dn=y,wE(y,u)}xE(u)}for(u=u.child;u!==null;){switch(h=u,h.tag){case 0:case 11:case 15:$i(8,h,h.return),cg(h);break;case 22:p=h.stateNode,p._visibility&2&&(p._visibility&=-3,cg(h));break;default:cg(h)}u=u.sibling}}function wE(u,h){for(;Dn!==null;){var p=Dn;switch(p.tag){case 0:case 11:case 15:$i(8,p,h);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var y=p.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:Wh(p.memoizedState.cache)}if(y=p.child,y!==null)y.return=p,Dn=y;else t:for(p=u;Dn!==null;){y=Dn;var S=y.sibling,N=y.return;if(dE(y),y===p){Dn=null;break t}if(S!==null){S.return=N,Dn=S;break t}Dn=N}}}var MV={getCacheForType:function(u){var h=Jn(wn),p=h.data.get(u);return p===void 0&&(p=u(),h.data.set(u,p)),p}},zV=typeof WeakMap=="function"?WeakMap:Map,ve=0,_e=null,se=null,ce=0,we=0,qs=null,Ai=!1,gu=!1,lv=!1,Va=0,Ye=0,Ri=0,Po=0,uv=0,fr=0,yu=0,ld=null,Is=null,cv=!1,hv=0,hg=1/0,dg=null,Di=null,jn=0,Oi=null,bu=null,xu=0,dv=0,fv=null,SE=null,ud=0,pv=null;function Ks(){if((ve&2)!==0&&ce!==0)return ce&-ce;if(B.T!==null){var u=iu;return u!==0?u:wv()}return zC()}function TE(){fr===0&&(fr=(ce&536870912)===0||me?_C():536870912);var u=dr.current;return u!==null&&(u.flags|=32),fr}function Xs(u,h,p){(u===_e&&(we===2||we===9)||u.cancelPendingCommit!==null)&&(vu(u,0),_i(u,ce,fr,!1)),$h(u,p),((ve&2)===0||u!==_e)&&(u===_e&&((ve&2)===0&&(Po|=p),Ye===4&&_i(u,ce,fr,!1)),na(u))}function NE(u,h,p){if((ve&6)!==0)throw Error(s(327));var y=!p&&(h&124)===0&&(h&u.expiredLanes)===0||kh(u,h),S=y?VV(u,h):yv(u,h,!0),N=y;do{if(S===0){gu&&!y&&_i(u,h,0,!1);break}else{if(p=u.current.alternate,N&&!PV(p)){S=yv(u,h,!1),N=!1;continue}if(S===2){if(N=h,u.errorRecoveryDisabledLanes&N)var A=0;else A=u.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){h=A;t:{var z=u;S=ld;var H=z.current.memoizedState.isDehydrated;if(H&&(vu(z,A).flags|=256),A=yv(z,A,!1),A!==2){if(lv&&!H){z.errorRecoveryDisabledLanes|=N,Po|=N,S=4;break t}N=Is,Is=S,N!==null&&(Is===null?Is=N:Is.push.apply(Is,N))}S=A}if(N=!1,S!==2)continue}}if(S===1){vu(u,0),_i(u,h,0,!0);break}t:{switch(y=u,N=S,N){case 0:case 1:throw Error(s(345));case 4:if((h&4194048)!==h)break;case 6:_i(y,h,fr,!Ai);break t;case 2:Is=null;break;case 3:case 5:break;default:throw Error(s(329))}if((h&62914560)===h&&(S=hv+300-oe(),10<S)){if(_i(y,h,fr,!Ai),Tm(y,0,!0)!==0)break t;y.timeoutHandle=JE(CE.bind(null,y,p,Is,dg,cv,h,fr,Po,yu,Ai,N,2,-0,0),S);break t}CE(y,p,Is,dg,cv,h,fr,Po,yu,Ai,N,0,-0,0)}}break}while(!0);na(u)}function CE(u,h,p,y,S,N,A,z,H,ct,yt,vt,ht,dt){if(u.timeoutHandle=-1,vt=h.subtreeFlags,(vt&8192||(vt&16785408)===16785408)&&(gd={stylesheets:null,count:0,unsuspend:vU},bE(h),vt=SU(),vt!==null)){u.cancelPendingCommit=vt(DE.bind(null,u,h,N,p,y,S,A,z,H,yt,1,ht,dt)),_i(u,N,A,!ct);return}DE(u,h,N,p,y,S,A,z,H)}function PV(u){for(var h=u;;){var p=h.tag;if((p===0||p===11||p===15)&&h.flags&16384&&(p=h.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var y=0;y<p.length;y++){var S=p[y],N=S.getSnapshot;S=S.value;try{if(!Ws(N(),S))return!1}catch{return!1}}if(p=h.child,h.subtreeFlags&16384&&p!==null)p.return=h,h=p;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function _i(u,h,p,y){h&=~uv,h&=~Po,u.suspendedLanes|=h,u.pingedLanes&=~h,y&&(u.warmLanes|=h),y=u.expirationTimes;for(var S=h;0<S;){var N=31-vn(S),A=1<<N;y[N]=-1,S&=~A}p!==0&&LC(u,p,h)}function fg(){return(ve&6)===0?(cd(0),!1):!0}function mv(){if(se!==null){if(we===0)var u=se.return;else u=se,Oa=Oo=null,D1(u),du=null,td=0,u=se;for(;u!==null;)rE(u.alternate,u),u=u.return;se=null}}function vu(u,h){var p=u.timeoutHandle;p!==-1&&(u.timeoutHandle=-1,sU(p)),p=u.cancelPendingCommit,p!==null&&(u.cancelPendingCommit=null,p()),mv(),_e=u,se=p=Aa(u.current,null),ce=h,we=0,qs=null,Ai=!1,gu=kh(u,h),lv=!1,yu=fr=uv=Po=Ri=Ye=0,Is=ld=null,cv=!1,(h&8)!==0&&(h|=h&32);var y=u.entangledLanes;if(y!==0)for(u=u.entanglements,y&=h;0<y;){var S=31-vn(y),N=1<<S;h|=u[S],y&=~N}return Va=h,Fm(),p}function kE(u,h){Jt=null,B.H=tg,h===jh||h===Gm?(h=Wk(),we=3):h===Bk?(h=Wk(),we=4):we=h===G$?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,qs=h,se===null&&(Ye=1,ag(u,lr(h,u.current)))}function $E(){var u=B.H;return B.H=tg,u===null?tg:u}function EE(){var u=B.A;return B.A=MV,u}function gv(){Ye=4,Ai||(ce&4194048)!==ce&&dr.current!==null||(gu=!0),(Ri&134217727)===0&&(Po&134217727)===0||_e===null||_i(_e,ce,fr,!1)}function yv(u,h,p){var y=ve;ve|=2;var S=$E(),N=EE();(_e!==u||ce!==h)&&(dg=null,vu(u,h)),h=!1;var A=Ye;t:do try{if(we!==0&&se!==null){var z=se,H=qs;switch(we){case 8:mv(),A=6;break t;case 3:case 2:case 9:case 6:dr.current===null&&(h=!0);var ct=we;if(we=0,qs=null,wu(u,z,H,ct),p&&gu){A=0;break t}break;default:ct=we,we=0,qs=null,wu(u,z,H,ct)}}BV(),A=Ye;break}catch(yt){kE(u,yt)}while(!0);return h&&u.shellSuspendCounter++,Oa=Oo=null,ve=y,B.H=S,B.A=N,se===null&&(_e=null,ce=0,Fm()),A}function BV(){for(;se!==null;)IE(se)}function VV(u,h){var p=ve;ve|=2;var y=$E(),S=EE();_e!==u||ce!==h?(dg=null,hg=oe()+500,vu(u,h)):gu=kh(u,h);t:do try{if(we!==0&&se!==null){h=se;var N=qs;e:switch(we){case 1:we=0,qs=null,wu(u,h,N,1);break;case 2:case 9:if(Vk(N)){we=0,qs=null,AE(h);break}h=function(){we!==2&&we!==9||_e!==u||(we=7),na(u)},N.then(h,h);break t;case 3:we=7;break t;case 4:we=5;break t;case 7:Vk(N)?(we=0,qs=null,AE(h)):(we=0,qs=null,wu(u,h,N,7));break;case 5:var A=null;switch(se.tag){case 26:A=se.memoizedState;case 5:case 27:var z=se;if(!A||hI(A)){we=0,qs=null;var H=z.sibling;if(H!==null)se=H;else{var ct=z.return;ct!==null?(se=ct,pg(ct)):se=null}break e}}we=0,qs=null,wu(u,h,N,5);break;case 6:we=0,qs=null,wu(u,h,N,6);break;case 8:mv(),Ye=6;break t;default:throw Error(s(462))}}UV();break}catch(yt){kE(u,yt)}while(!0);return Oa=Oo=null,B.H=y,B.A=S,ve=p,se!==null?0:(_e=null,ce=0,Fm(),Ye)}function UV(){for(;se!==null&&!xe();)IE(se)}function IE(u){var h=nE(u.alternate,u,Va);u.memoizedProps=u.pendingProps,h===null?pg(u):se=h}function AE(u){var h=u,p=h.alternate;switch(h.tag){case 15:case 0:h=Y$(p,h,h.pendingProps,h.type,void 0,ce);break;case 11:h=Y$(p,h,h.pendingProps,h.type.render,h.ref,ce);break;case 5:D1(h);default:rE(p,h),h=se=Rk(h,Va),h=nE(p,h,Va)}u.memoizedProps=u.pendingProps,h===null?pg(u):se=h}function wu(u,h,p,y){Oa=Oo=null,D1(h),du=null,td=0;var S=h.return;try{if(RV(u,S,h,p,ce)){Ye=1,ag(u,lr(p,u.current)),se=null;return}}catch(N){if(S!==null)throw se=S,N;Ye=1,ag(u,lr(p,u.current)),se=null;return}h.flags&32768?(me||y===1?u=!0:gu||(ce&536870912)!==0?u=!1:(Ai=u=!0,(y===2||y===9||y===3||y===6)&&(y=dr.current,y!==null&&y.tag===13&&(y.flags|=16384))),RE(h,u)):pg(h)}function pg(u){var h=u;do{if((h.flags&32768)!==0){RE(h,Ai);return}u=h.return;var p=OV(h.alternate,h,Va);if(p!==null){se=p;return}if(h=h.sibling,h!==null){se=h;return}se=h=u}while(h!==null);Ye===0&&(Ye=5)}function RE(u,h){do{var p=_V(u.alternate,u);if(p!==null){p.flags&=32767,se=p;return}if(p=u.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!h&&(u=u.sibling,u!==null)){se=u;return}se=u=p}while(u!==null);Ye=6,se=null}function DE(u,h,p,y,S,N,A,z,H){u.cancelPendingCommit=null;do mg();while(jn!==0);if((ve&6)!==0)throw Error(s(327));if(h!==null){if(h===u.current)throw Error(s(177));if(N=h.lanes|h.childLanes,N|=o1,vB(u,p,N,A,z,H),u===_e&&(se=_e=null,ce=0),bu=h,Oi=u,xu=p,dv=N,fv=S,SE=y,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,HV(Vs,function(){return ME(),null})):(u.callbackNode=null,u.callbackPriority=0),y=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||y){y=B.T,B.T=null,S=W.p,W.p=2,A=ve,ve|=4;try{FV(u,h,p)}finally{ve=A,W.p=S,B.T=y}}jn=1,OE(),_E(),FE()}}function OE(){if(jn===1){jn=0;var u=Oi,h=bu,p=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||p){p=B.T,B.T=null;var y=W.p;W.p=2;var S=ve;ve|=4;try{mE(h,u);var N=Iv,A=wk(u.containerInfo),z=N.focusedElem,H=N.selectionRange;if(A!==z&&z&&z.ownerDocument&&vk(z.ownerDocument.documentElement,z)){if(H!==null&&n1(z)){var ct=H.start,yt=H.end;if(yt===void 0&&(yt=ct),"selectionStart"in z)z.selectionStart=ct,z.selectionEnd=Math.min(yt,z.value.length);else{var vt=z.ownerDocument||document,ht=vt&&vt.defaultView||window;if(ht.getSelection){var dt=ht.getSelection(),Ut=z.textContent.length,zt=Math.min(H.start,Ut),ke=H.end===void 0?zt:Math.min(H.end,Ut);!dt.extend&&zt>ke&&(A=ke,ke=zt,zt=A);var at=xk(z,zt),et=xk(z,ke);if(at&&et&&(dt.rangeCount!==1||dt.anchorNode!==at.node||dt.anchorOffset!==at.offset||dt.focusNode!==et.node||dt.focusOffset!==et.offset)){var ut=vt.createRange();ut.setStart(at.node,at.offset),dt.removeAllRanges(),zt>ke?(dt.addRange(ut),dt.extend(et.node,et.offset)):(ut.setEnd(et.node,et.offset),dt.addRange(ut))}}}}for(vt=[],dt=z;dt=dt.parentNode;)dt.nodeType===1&&vt.push({element:dt,left:dt.scrollLeft,top:dt.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<vt.length;z++){var xt=vt[z];xt.element.scrollLeft=xt.left,xt.element.scrollTop=xt.top}}$g=!!Ev,Iv=Ev=null}finally{ve=S,W.p=y,B.T=p}}u.current=h,jn=2}}function _E(){if(jn===2){jn=0;var u=Oi,h=bu,p=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||p){p=B.T,B.T=null;var y=W.p;W.p=2;var S=ve;ve|=4;try{hE(u,h.alternate,h)}finally{ve=S,W.p=y,B.T=p}}jn=3}}function FE(){if(jn===4||jn===3){jn=0,pe();var u=Oi,h=bu,p=xu,y=SE;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?jn=5:(jn=0,bu=Oi=null,LE(u,u.pendingLanes));var S=u.pendingLanes;if(S===0&&(Di=null),Fx(p),h=h.stateNode,Ke&&typeof Ke.onCommitFiberRoot=="function")try{Ke.onCommitFiberRoot(Ns,h,void 0,(h.current.flags&128)===128)}catch{}if(y!==null){h=B.T,S=W.p,W.p=2,B.T=null;try{for(var N=u.onRecoverableError,A=0;A<y.length;A++){var z=y[A];N(z.value,{componentStack:z.stack})}}finally{B.T=h,W.p=S}}(xu&3)!==0&&mg(),na(u),S=u.pendingLanes,(p&4194090)!==0&&(S&42)!==0?u===pv?ud++:(ud=0,pv=u):ud=0,cd(0)}}function LE(u,h){(u.pooledCacheLanes&=h)===0&&(h=u.pooledCache,h!=null&&(u.pooledCache=null,Wh(h)))}function mg(u){return OE(),_E(),FE(),ME()}function ME(){if(jn!==5)return!1;var u=Oi,h=dv;dv=0;var p=Fx(xu),y=B.T,S=W.p;try{W.p=32>p?32:p,B.T=null,p=fv,fv=null;var N=Oi,A=xu;if(jn=0,bu=Oi=null,xu=0,(ve&6)!==0)throw Error(s(331));var z=ve;if(ve|=4,vE(N.current),yE(N,N.current,A,p),ve=z,cd(0,!1),Ke&&typeof Ke.onPostCommitFiberRoot=="function")try{Ke.onPostCommitFiberRoot(Ns,N)}catch{}return!0}finally{W.p=S,B.T=y,LE(u,h)}}function zE(u,h,p){h=lr(p,h),h=H1(u.stateNode,h,2),u=Ti(u,h,2),u!==null&&($h(u,2),na(u))}function Ae(u,h,p){if(u.tag===3)zE(u,u,p);else for(;h!==null;){if(h.tag===3){zE(h,u,p);break}else if(h.tag===1){var y=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Di===null||!Di.has(y))){u=lr(p,u),p=U$(2),y=Ti(h,p,2),y!==null&&(W$(p,y,h,u),$h(y,2),na(y));break}}h=h.return}}function bv(u,h,p){var y=u.pingCache;if(y===null){y=u.pingCache=new zV;var S=new Set;y.set(h,S)}else S=y.get(h),S===void 0&&(S=new Set,y.set(h,S));S.has(p)||(lv=!0,S.add(p),u=WV.bind(null,u,h,p),h.then(u,u))}function WV(u,h,p){var y=u.pingCache;y!==null&&y.delete(h),u.pingedLanes|=u.suspendedLanes&p,u.warmLanes&=~p,_e===u&&(ce&p)===p&&(Ye===4||Ye===3&&(ce&62914560)===ce&&300>oe()-hv?(ve&2)===0&&vu(u,0):uv|=p,yu===ce&&(yu=0)),na(u)}function PE(u,h){h===0&&(h=FC()),u=nu(u,h),u!==null&&($h(u,h),na(u))}function GV(u){var h=u.memoizedState,p=0;h!==null&&(p=h.retryLane),PE(u,p)}function jV(u,h){var p=0;switch(u.tag){case 13:var y=u.stateNode,S=u.memoizedState;S!==null&&(p=S.retryLane);break;case 19:y=u.stateNode;break;case 22:y=u.stateNode._retryCache;break;default:throw Error(s(314))}y!==null&&y.delete(h),PE(u,p)}function HV(u,h){return fe(u,h)}var gg=null,Su=null,xv=!1,yg=!1,vv=!1,Bo=0;function na(u){u!==Su&&u.next===null&&(Su===null?gg=Su=u:Su=Su.next=u),yg=!0,xv||(xv=!0,KV())}function cd(u,h){if(!vv&&yg){vv=!0;do for(var p=!1,y=gg;y!==null;){if(u!==0){var S=y.pendingLanes;if(S===0)var N=0;else{var A=y.suspendedLanes,z=y.pingedLanes;N=(1<<31-vn(42|u)+1)-1,N&=S&~(A&~z),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(p=!0,WE(y,N))}else N=ce,N=Tm(y,y===_e?N:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(N&3)===0||kh(y,N)||(p=!0,WE(y,N));y=y.next}while(p);vv=!1}}function qV(){BE()}function BE(){yg=xv=!1;var u=0;Bo!==0&&(nU()&&(u=Bo),Bo=0);for(var h=oe(),p=null,y=gg;y!==null;){var S=y.next,N=VE(y,h);N===0?(y.next=null,p===null?gg=S:p.next=S,S===null&&(Su=p)):(p=y,(u!==0||(N&3)!==0)&&(yg=!0)),y=S}cd(u)}function VE(u,h){for(var p=u.suspendedLanes,y=u.pingedLanes,S=u.expirationTimes,N=u.pendingLanes&-62914561;0<N;){var A=31-vn(N),z=1<<A,H=S[A];H===-1?((z&p)===0||(z&y)!==0)&&(S[A]=xB(z,h)):H<=h&&(u.expiredLanes|=z),N&=~z}if(h=_e,p=ce,p=Tm(u,u===h?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),y=u.callbackNode,p===0||u===h&&(we===2||we===9)||u.cancelPendingCommit!==null)return y!==null&&y!==null&&Ee(y),u.callbackNode=null,u.callbackPriority=0;if((p&3)===0||kh(u,p)){if(h=p&-p,h===u.callbackPriority)return h;switch(y!==null&&Ee(y),Fx(p)){case 2:case 8:p=sn;break;case 32:p=Vs;break;case 268435456:p=Zr;break;default:p=Vs}return y=UE.bind(null,u),p=fe(p,y),u.callbackPriority=h,u.callbackNode=p,h}return y!==null&&y!==null&&Ee(y),u.callbackPriority=2,u.callbackNode=null,2}function UE(u,h){if(jn!==0&&jn!==5)return u.callbackNode=null,u.callbackPriority=0,null;var p=u.callbackNode;if(mg()&&u.callbackNode!==p)return null;var y=ce;return y=Tm(u,u===_e?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),y===0?null:(NE(u,y,h),VE(u,oe()),u.callbackNode!=null&&u.callbackNode===p?UE.bind(null,u):null)}function WE(u,h){if(mg())return null;NE(u,h,!0)}function KV(){rU(function(){(ve&6)!==0?fe(ar,qV):BE()})}function wv(){return Bo===0&&(Bo=_C()),Bo}function GE(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:Em(""+u)}function jE(u,h){var p=h.ownerDocument.createElement("input");return p.name=h.name,p.value=h.value,u.id&&p.setAttribute("form",u.id),h.parentNode.insertBefore(p,h),u=new FormData(u),p.parentNode.removeChild(p),u}function XV(u,h,p,y,S){if(h==="submit"&&p&&p.stateNode===S){var N=GE((S[Cs]||null).action),A=y.submitter;A&&(h=(h=A[Cs]||null)?GE(h.formAction):A.getAttribute("formAction"),h!==null&&(N=h,A=null));var z=new Dm("action","action",null,y,S);u.push({event:z,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(Bo!==0){var H=A?jE(S,A):new FormData(S);V1(p,{pending:!0,data:H,method:S.method,action:N},null,H)}}else typeof N=="function"&&(z.preventDefault(),H=A?jE(S,A):new FormData(S),V1(p,{pending:!0,data:H,method:S.method,action:N},N,H))},currentTarget:S}]})}}for(var Sv=0;Sv<i1.length;Sv++){var Tv=i1[Sv],YV=Tv.toLowerCase(),ZV=Tv[0].toUpperCase()+Tv.slice(1);Ar(YV,"on"+ZV)}Ar(Nk,"onAnimationEnd"),Ar(Ck,"onAnimationIteration"),Ar(kk,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(pV,"onTransitionRun"),Ar(mV,"onTransitionStart"),Ar(gV,"onTransitionCancel"),Ar($k,"onTransitionEnd"),Hl("onMouseEnter",["mouseout","mouseover"]),Hl("onMouseLeave",["mouseout","mouseover"]),Hl("onPointerEnter",["pointerout","pointerover"]),Hl("onPointerLeave",["pointerout","pointerover"]),No("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),No("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),No("onBeforeInput",["compositionend","keypress","textInput","paste"]),No("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),No("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),No("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QV=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hd));function HE(u,h){h=(h&4)!==0;for(var p=0;p<u.length;p++){var y=u[p],S=y.event;y=y.listeners;t:{var N=void 0;if(h)for(var A=y.length-1;0<=A;A--){var z=y[A],H=z.instance,ct=z.currentTarget;if(z=z.listener,H!==N&&S.isPropagationStopped())break t;N=z,S.currentTarget=ct;try{N(S)}catch(yt){rg(yt)}S.currentTarget=null,N=H}else for(A=0;A<y.length;A++){if(z=y[A],H=z.instance,ct=z.currentTarget,z=z.listener,H!==N&&S.isPropagationStopped())break t;N=z,S.currentTarget=ct;try{N(S)}catch(yt){rg(yt)}S.currentTarget=null,N=H}}}}function re(u,h){var p=h[Lx];p===void 0&&(p=h[Lx]=new Set);var y=u+"__bubble";p.has(y)||(qE(h,u,2,!1),p.add(y))}function Nv(u,h,p){var y=0;h&&(y|=4),qE(p,u,y,h)}var bg="_reactListening"+Math.random().toString(36).slice(2);function Cv(u){if(!u[bg]){u[bg]=!0,BC.forEach(function(p){p!=="selectionchange"&&(QV.has(p)||Nv(p,!1,u),Nv(p,!0,u))});var h=u.nodeType===9?u:u.ownerDocument;h===null||h[bg]||(h[bg]=!0,Nv("selectionchange",!1,h))}}function qE(u,h,p,y){switch(yI(h)){case 2:var S=CU;break;case 8:S=kU;break;default:S=Pv}p=S.bind(null,h,p,u),S=void 0,!qx||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(S=!0),y?S!==void 0?u.addEventListener(h,p,{capture:!0,passive:S}):u.addEventListener(h,p,!0):S!==void 0?u.addEventListener(h,p,{passive:S}):u.addEventListener(h,p,!1)}function kv(u,h,p,y,S){var N=y;if((h&1)===0&&(h&2)===0&&y!==null)t:for(;;){if(y===null)return;var A=y.tag;if(A===3||A===4){var z=y.stateNode.containerInfo;if(z===S)break;if(A===4)for(A=y.return;A!==null;){var H=A.tag;if((H===3||H===4)&&A.stateNode.containerInfo===S)return;A=A.return}for(;z!==null;){if(A=Wl(z),A===null)return;if(H=A.tag,H===5||H===6||H===26||H===27){y=N=A;continue t}z=z.parentNode}}y=y.return}tk(function(){var ct=N,yt=jx(p),vt=[];t:{var ht=Ek.get(u);if(ht!==void 0){var dt=Dm,Ut=u;switch(u){case"keypress":if(Am(p)===0)break t;case"keydown":case"keyup":dt=HB;break;case"focusin":Ut="focus",dt=Zx;break;case"focusout":Ut="blur",dt=Zx;break;case"beforeblur":case"afterblur":dt=Zx;break;case"click":if(p.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dt=sk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dt=_B;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dt=XB;break;case Nk:case Ck:case kk:dt=MB;break;case $k:dt=ZB;break;case"scroll":case"scrollend":dt=DB;break;case"wheel":dt=JB;break;case"copy":case"cut":case"paste":dt=PB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dt=ak;break;case"toggle":case"beforetoggle":dt=eV}var zt=(h&4)!==0,ke=!zt&&(u==="scroll"||u==="scrollend"),at=zt?ht!==null?ht+"Capture":null:ht;zt=[];for(var et=ct,ut;et!==null;){var xt=et;if(ut=xt.stateNode,xt=xt.tag,xt!==5&&xt!==26&&xt!==27||ut===null||at===null||(xt=Ah(et,at),xt!=null&&zt.push(dd(et,xt,ut))),ke)break;et=et.return}0<zt.length&&(ht=new dt(ht,Ut,null,p,yt),vt.push({event:ht,listeners:zt}))}}if((h&7)===0){t:{if(ht=u==="mouseover"||u==="pointerover",dt=u==="mouseout"||u==="pointerout",ht&&p!==Gx&&(Ut=p.relatedTarget||p.fromElement)&&(Wl(Ut)||Ut[Ul]))break t;if((dt||ht)&&(ht=yt.window===yt?yt:(ht=yt.ownerDocument)?ht.defaultView||ht.parentWindow:window,dt?(Ut=p.relatedTarget||p.toElement,dt=ct,Ut=Ut?Wl(Ut):null,Ut!==null&&(ke=a(Ut),zt=Ut.tag,Ut!==ke||zt!==5&&zt!==27&&zt!==6)&&(Ut=null)):(dt=null,Ut=ct),dt!==Ut)){if(zt=sk,xt="onMouseLeave",at="onMouseEnter",et="mouse",(u==="pointerout"||u==="pointerover")&&(zt=ak,xt="onPointerLeave",at="onPointerEnter",et="pointer"),ke=dt==null?ht:Ih(dt),ut=Ut==null?ht:Ih(Ut),ht=new zt(xt,et+"leave",dt,p,yt),ht.target=ke,ht.relatedTarget=ut,xt=null,Wl(yt)===ct&&(zt=new zt(at,et+"enter",Ut,p,yt),zt.target=ut,zt.relatedTarget=ke,xt=zt),ke=xt,dt&&Ut)e:{for(zt=dt,at=Ut,et=0,ut=zt;ut;ut=Tu(ut))et++;for(ut=0,xt=at;xt;xt=Tu(xt))ut++;for(;0<et-ut;)zt=Tu(zt),et--;for(;0<ut-et;)at=Tu(at),ut--;for(;et--;){if(zt===at||at!==null&&zt===at.alternate)break e;zt=Tu(zt),at=Tu(at)}zt=null}else zt=null;dt!==null&&KE(vt,ht,dt,zt,!1),Ut!==null&&ke!==null&&KE(vt,ke,Ut,zt,!0)}}t:{if(ht=ct?Ih(ct):window,dt=ht.nodeName&&ht.nodeName.toLowerCase(),dt==="select"||dt==="input"&&ht.type==="file")var Rt=fk;else if(hk(ht))if(pk)Rt=hV;else{Rt=uV;var ee=lV}else dt=ht.nodeName,!dt||dt.toLowerCase()!=="input"||ht.type!=="checkbox"&&ht.type!=="radio"?ct&&Wx(ct.elementType)&&(Rt=fk):Rt=cV;if(Rt&&(Rt=Rt(u,ct))){dk(vt,Rt,p,yt);break t}ee&&ee(u,ht,ct),u==="focusout"&&ct&&ht.type==="number"&&ct.memoizedProps.value!=null&&Ux(ht,"number",ht.value)}switch(ee=ct?Ih(ct):window,u){case"focusin":(hk(ee)||ee.contentEditable==="true")&&(Jl=ee,s1=ct,zh=null);break;case"focusout":zh=s1=Jl=null;break;case"mousedown":r1=!0;break;case"contextmenu":case"mouseup":case"dragend":r1=!1,Sk(vt,p,yt);break;case"selectionchange":if(fV)break;case"keydown":case"keyup":Sk(vt,p,yt)}var Mt;if(Jx)t:{switch(u){case"compositionstart":var Pt="onCompositionStart";break t;case"compositionend":Pt="onCompositionEnd";break t;case"compositionupdate":Pt="onCompositionUpdate";break t}Pt=void 0}else Ql?uk(u,p)&&(Pt="onCompositionEnd"):u==="keydown"&&p.keyCode===229&&(Pt="onCompositionStart");Pt&&(ik&&p.locale!=="ko"&&(Ql||Pt!=="onCompositionStart"?Pt==="onCompositionEnd"&&Ql&&(Mt=ek()):(xi=yt,Kx="value"in xi?xi.value:xi.textContent,Ql=!0)),ee=xg(ct,Pt),0<ee.length&&(Pt=new rk(Pt,u,null,p,yt),vt.push({event:Pt,listeners:ee}),Mt?Pt.data=Mt:(Mt=ck(p),Mt!==null&&(Pt.data=Mt)))),(Mt=sV?rV(u,p):aV(u,p))&&(Pt=xg(ct,"onBeforeInput"),0<Pt.length&&(ee=new rk("onBeforeInput","beforeinput",null,p,yt),vt.push({event:ee,listeners:Pt}),ee.data=Mt)),XV(vt,u,ct,p,yt)}HE(vt,h)})}function dd(u,h,p){return{instance:u,listener:h,currentTarget:p}}function xg(u,h){for(var p=h+"Capture",y=[];u!==null;){var S=u,N=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||N===null||(S=Ah(u,p),S!=null&&y.unshift(dd(u,S,N)),S=Ah(u,h),S!=null&&y.push(dd(u,S,N))),u.tag===3)return y;u=u.return}return[]}function Tu(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function KE(u,h,p,y,S){for(var N=h._reactName,A=[];p!==null&&p!==y;){var z=p,H=z.alternate,ct=z.stateNode;if(z=z.tag,H!==null&&H===y)break;z!==5&&z!==26&&z!==27||ct===null||(H=ct,S?(ct=Ah(p,N),ct!=null&&A.unshift(dd(p,ct,H))):S||(ct=Ah(p,N),ct!=null&&A.push(dd(p,ct,H)))),p=p.return}A.length!==0&&u.push({event:h,listeners:A})}var JV=/\r\n?/g,tU=/\u0000|\uFFFD/g;function XE(u){return(typeof u=="string"?u:""+u).replace(JV,`
`).replace(tU,"")}function YE(u,h){return h=XE(h),XE(u)===h}function vg(){}function Ce(u,h,p,y,S,N){switch(p){case"children":typeof y=="string"?h==="body"||h==="textarea"&&y===""||Xl(u,y):(typeof y=="number"||typeof y=="bigint")&&h!=="body"&&Xl(u,""+y);break;case"className":Cm(u,"class",y);break;case"tabIndex":Cm(u,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":Cm(u,p,y);break;case"style":QC(u,y,N);break;case"data":if(h!=="object"){Cm(u,"data",y);break}case"src":case"href":if(y===""&&(h!=="a"||p!=="href")){u.removeAttribute(p);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){u.removeAttribute(p);break}y=Em(""+y),u.setAttribute(p,y);break;case"action":case"formAction":if(typeof y=="function"){u.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(p==="formAction"?(h!=="input"&&Ce(u,h,"name",S.name,S,null),Ce(u,h,"formEncType",S.formEncType,S,null),Ce(u,h,"formMethod",S.formMethod,S,null),Ce(u,h,"formTarget",S.formTarget,S,null)):(Ce(u,h,"encType",S.encType,S,null),Ce(u,h,"method",S.method,S,null),Ce(u,h,"target",S.target,S,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){u.removeAttribute(p);break}y=Em(""+y),u.setAttribute(p,y);break;case"onClick":y!=null&&(u.onclick=vg);break;case"onScroll":y!=null&&re("scroll",u);break;case"onScrollEnd":y!=null&&re("scrollend",u);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(s(61));if(p=y.__html,p!=null){if(S.children!=null)throw Error(s(60));u.innerHTML=p}}break;case"multiple":u.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":u.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){u.removeAttribute("xlink:href");break}p=Em(""+y),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?u.setAttribute(p,""+y):u.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?u.setAttribute(p,""):u.removeAttribute(p);break;case"capture":case"download":y===!0?u.setAttribute(p,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?u.setAttribute(p,y):u.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?u.setAttribute(p,y):u.removeAttribute(p);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?u.removeAttribute(p):u.setAttribute(p,y);break;case"popover":re("beforetoggle",u),re("toggle",u),Nm(u,"popover",y);break;case"xlinkActuate":Ea(u,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Ea(u,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Ea(u,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Ea(u,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Ea(u,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Ea(u,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Ea(u,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Ea(u,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Ea(u,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":Nm(u,"is",y);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=AB.get(p)||p,Nm(u,p,y))}}function $v(u,h,p,y,S,N){switch(p){case"style":QC(u,y,N);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(s(61));if(p=y.__html,p!=null){if(S.children!=null)throw Error(s(60));u.innerHTML=p}}break;case"children":typeof y=="string"?Xl(u,y):(typeof y=="number"||typeof y=="bigint")&&Xl(u,""+y);break;case"onScroll":y!=null&&re("scroll",u);break;case"onScrollEnd":y!=null&&re("scrollend",u);break;case"onClick":y!=null&&(u.onclick=vg);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!VC.hasOwnProperty(p))t:{if(p[0]==="o"&&p[1]==="n"&&(S=p.endsWith("Capture"),h=p.slice(2,S?p.length-7:void 0),N=u[Cs]||null,N=N!=null?N[p]:null,typeof N=="function"&&u.removeEventListener(h,N,S),typeof y=="function")){typeof N!="function"&&N!==null&&(p in u?u[p]=null:u.hasAttribute(p)&&u.removeAttribute(p)),u.addEventListener(h,y,S);break t}p in u?u[p]=y:y===!0?u.setAttribute(p,""):Nm(u,p,y)}}}function Hn(u,h,p){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":re("error",u),re("load",u);var y=!1,S=!1,N;for(N in p)if(p.hasOwnProperty(N)){var A=p[N];if(A!=null)switch(N){case"src":y=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,h));default:Ce(u,h,N,A,p,null)}}S&&Ce(u,h,"srcSet",p.srcSet,p,null),y&&Ce(u,h,"src",p.src,p,null);return;case"input":re("invalid",u);var z=N=A=S=null,H=null,ct=null;for(y in p)if(p.hasOwnProperty(y)){var yt=p[y];if(yt!=null)switch(y){case"name":S=yt;break;case"type":A=yt;break;case"checked":H=yt;break;case"defaultChecked":ct=yt;break;case"value":N=yt;break;case"defaultValue":z=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(s(137,h));break;default:Ce(u,h,y,yt,p,null)}}KC(u,N,z,H,ct,A,S,!1),km(u);return;case"select":re("invalid",u),y=A=N=null;for(S in p)if(p.hasOwnProperty(S)&&(z=p[S],z!=null))switch(S){case"value":N=z;break;case"defaultValue":A=z;break;case"multiple":y=z;default:Ce(u,h,S,z,p,null)}h=N,p=A,u.multiple=!!y,h!=null?Kl(u,!!y,h,!1):p!=null&&Kl(u,!!y,p,!0);return;case"textarea":re("invalid",u),N=S=y=null;for(A in p)if(p.hasOwnProperty(A)&&(z=p[A],z!=null))switch(A){case"value":y=z;break;case"defaultValue":S=z;break;case"children":N=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(s(91));break;default:Ce(u,h,A,z,p,null)}YC(u,y,S,N),km(u);return;case"option":for(H in p)if(p.hasOwnProperty(H)&&(y=p[H],y!=null))switch(H){case"selected":u.selected=y&&typeof y!="function"&&typeof y!="symbol";break;default:Ce(u,h,H,y,p,null)}return;case"dialog":re("beforetoggle",u),re("toggle",u),re("cancel",u),re("close",u);break;case"iframe":case"object":re("load",u);break;case"video":case"audio":for(y=0;y<hd.length;y++)re(hd[y],u);break;case"image":re("error",u),re("load",u);break;case"details":re("toggle",u);break;case"embed":case"source":case"link":re("error",u),re("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ct in p)if(p.hasOwnProperty(ct)&&(y=p[ct],y!=null))switch(ct){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,h));default:Ce(u,h,ct,y,p,null)}return;default:if(Wx(h)){for(yt in p)p.hasOwnProperty(yt)&&(y=p[yt],y!==void 0&&$v(u,h,yt,y,p,void 0));return}}for(z in p)p.hasOwnProperty(z)&&(y=p[z],y!=null&&Ce(u,h,z,y,p,null))}function eU(u,h,p,y){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,N=null,A=null,z=null,H=null,ct=null,yt=null;for(dt in p){var vt=p[dt];if(p.hasOwnProperty(dt)&&vt!=null)switch(dt){case"checked":break;case"value":break;case"defaultValue":H=vt;default:y.hasOwnProperty(dt)||Ce(u,h,dt,null,y,vt)}}for(var ht in y){var dt=y[ht];if(vt=p[ht],y.hasOwnProperty(ht)&&(dt!=null||vt!=null))switch(ht){case"type":N=dt;break;case"name":S=dt;break;case"checked":ct=dt;break;case"defaultChecked":yt=dt;break;case"value":A=dt;break;case"defaultValue":z=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(s(137,h));break;default:dt!==vt&&Ce(u,h,ht,dt,y,vt)}}Vx(u,A,z,H,ct,yt,N,S);return;case"select":dt=A=z=ht=null;for(N in p)if(H=p[N],p.hasOwnProperty(N)&&H!=null)switch(N){case"value":break;case"multiple":dt=H;default:y.hasOwnProperty(N)||Ce(u,h,N,null,y,H)}for(S in y)if(N=y[S],H=p[S],y.hasOwnProperty(S)&&(N!=null||H!=null))switch(S){case"value":ht=N;break;case"defaultValue":z=N;break;case"multiple":A=N;default:N!==H&&Ce(u,h,S,N,y,H)}h=z,p=A,y=dt,ht!=null?Kl(u,!!p,ht,!1):!!y!=!!p&&(h!=null?Kl(u,!!p,h,!0):Kl(u,!!p,p?[]:"",!1));return;case"textarea":dt=ht=null;for(z in p)if(S=p[z],p.hasOwnProperty(z)&&S!=null&&!y.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:Ce(u,h,z,null,y,S)}for(A in y)if(S=y[A],N=p[A],y.hasOwnProperty(A)&&(S!=null||N!=null))switch(A){case"value":ht=S;break;case"defaultValue":dt=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(s(91));break;default:S!==N&&Ce(u,h,A,S,y,N)}XC(u,ht,dt);return;case"option":for(var Ut in p)if(ht=p[Ut],p.hasOwnProperty(Ut)&&ht!=null&&!y.hasOwnProperty(Ut))switch(Ut){case"selected":u.selected=!1;break;default:Ce(u,h,Ut,null,y,ht)}for(H in y)if(ht=y[H],dt=p[H],y.hasOwnProperty(H)&&ht!==dt&&(ht!=null||dt!=null))switch(H){case"selected":u.selected=ht&&typeof ht!="function"&&typeof ht!="symbol";break;default:Ce(u,h,H,ht,y,dt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var zt in p)ht=p[zt],p.hasOwnProperty(zt)&&ht!=null&&!y.hasOwnProperty(zt)&&Ce(u,h,zt,null,y,ht);for(ct in y)if(ht=y[ct],dt=p[ct],y.hasOwnProperty(ct)&&ht!==dt&&(ht!=null||dt!=null))switch(ct){case"children":case"dangerouslySetInnerHTML":if(ht!=null)throw Error(s(137,h));break;default:Ce(u,h,ct,ht,y,dt)}return;default:if(Wx(h)){for(var ke in p)ht=p[ke],p.hasOwnProperty(ke)&&ht!==void 0&&!y.hasOwnProperty(ke)&&$v(u,h,ke,void 0,y,ht);for(yt in y)ht=y[yt],dt=p[yt],!y.hasOwnProperty(yt)||ht===dt||ht===void 0&&dt===void 0||$v(u,h,yt,ht,y,dt);return}}for(var at in p)ht=p[at],p.hasOwnProperty(at)&&ht!=null&&!y.hasOwnProperty(at)&&Ce(u,h,at,null,y,ht);for(vt in y)ht=y[vt],dt=p[vt],!y.hasOwnProperty(vt)||ht===dt||ht==null&&dt==null||Ce(u,h,vt,ht,y,dt)}var Ev=null,Iv=null;function wg(u){return u.nodeType===9?u:u.ownerDocument}function ZE(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function QE(u,h){if(u===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&h==="foreignObject"?0:u}function Av(u,h){return u==="textarea"||u==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Rv=null;function nU(){var u=window.event;return u&&u.type==="popstate"?u===Rv?!1:(Rv=u,!0):(Rv=null,!1)}var JE=typeof setTimeout=="function"?setTimeout:void 0,sU=typeof clearTimeout=="function"?clearTimeout:void 0,tI=typeof Promise=="function"?Promise:void 0,rU=typeof queueMicrotask=="function"?queueMicrotask:typeof tI<"u"?function(u){return tI.resolve(null).then(u).catch(aU)}:JE;function aU(u){setTimeout(function(){throw u})}function Fi(u){return u==="head"}function eI(u,h){var p=h,y=0,S=0;do{var N=p.nextSibling;if(u.removeChild(p),N&&N.nodeType===8)if(p=N.data,p==="/$"){if(0<y&&8>y){p=y;var A=u.ownerDocument;if(p&1&&fd(A.documentElement),p&2&&fd(A.body),p&4)for(p=A.head,fd(p),A=p.firstChild;A;){var z=A.nextSibling,H=A.nodeName;A[Eh]||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&A.rel.toLowerCase()==="stylesheet"||p.removeChild(A),A=z}}if(S===0){u.removeChild(N),wd(h);return}S--}else p==="$"||p==="$?"||p==="$!"?S++:y=p.charCodeAt(0)-48;else y=0;p=N}while(p);wd(h)}function Dv(u){var h=u.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var p=h;switch(h=h.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Dv(p),Mx(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}u.removeChild(p)}}function iU(u,h,p,y){for(;u.nodeType===1;){var S=p;if(u.nodeName.toLowerCase()!==h.toLowerCase()){if(!y&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(y){if(!u[Eh])switch(h){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(N=u.getAttribute("rel"),N==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(N!==S.rel||u.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||u.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||u.getAttribute("title")!==(S.title==null?null:S.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(N=u.getAttribute("src"),(N!==(S.src==null?null:S.src)||u.getAttribute("type")!==(S.type==null?null:S.type)||u.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&N&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(h==="input"&&u.type==="hidden"){var N=S.name==null?null:""+S.name;if(S.type==="hidden"&&u.getAttribute("name")===N)return u}else return u;if(u=Dr(u.nextSibling),u===null)break}return null}function oU(u,h,p){if(h==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!p||(u=Dr(u.nextSibling),u===null))return null;return u}function Ov(u){return u.data==="$!"||u.data==="$?"&&u.ownerDocument.readyState==="complete"}function lU(u,h){var p=u.ownerDocument;if(u.data!=="$?"||p.readyState==="complete")h();else{var y=function(){h(),p.removeEventListener("DOMContentLoaded",y)};p.addEventListener("DOMContentLoaded",y),u._reactRetry=y}}function Dr(u){for(;u!=null;u=u.nextSibling){var h=u.nodeType;if(h===1||h===3)break;if(h===8){if(h=u.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return u}var _v=null;function nI(u){u=u.previousSibling;for(var h=0;u;){if(u.nodeType===8){var p=u.data;if(p==="$"||p==="$!"||p==="$?"){if(h===0)return u;h--}else p==="/$"&&h++}u=u.previousSibling}return null}function sI(u,h,p){switch(h=wg(p),u){case"html":if(u=h.documentElement,!u)throw Error(s(452));return u;case"head":if(u=h.head,!u)throw Error(s(453));return u;case"body":if(u=h.body,!u)throw Error(s(454));return u;default:throw Error(s(451))}}function fd(u){for(var h=u.attributes;h.length;)u.removeAttributeNode(h[0]);Mx(u)}var pr=new Map,rI=new Set;function Sg(u){return typeof u.getRootNode=="function"?u.getRootNode():u.nodeType===9?u:u.ownerDocument}var Ua=W.d;W.d={f:uU,r:cU,D:hU,C:dU,L:fU,m:pU,X:gU,S:mU,M:yU};function uU(){var u=Ua.f(),h=fg();return u||h}function cU(u){var h=Gl(u);h!==null&&h.tag===5&&h.type==="form"?N$(h):Ua.r(u)}var Nu=typeof document>"u"?null:document;function aI(u,h,p){var y=Nu;if(y&&typeof h=="string"&&h){var S=or(h);S='link[rel="'+u+'"][href="'+S+'"]',typeof p=="string"&&(S+='[crossorigin="'+p+'"]'),rI.has(S)||(rI.add(S),u={rel:u,crossOrigin:p,href:h},y.querySelector(S)===null&&(h=y.createElement("link"),Hn(h,"link",u),An(h),y.head.appendChild(h)))}}function hU(u){Ua.D(u),aI("dns-prefetch",u,null)}function dU(u,h){Ua.C(u,h),aI("preconnect",u,h)}function fU(u,h,p){Ua.L(u,h,p);var y=Nu;if(y&&u&&h){var S='link[rel="preload"][as="'+or(h)+'"]';h==="image"&&p&&p.imageSrcSet?(S+='[imagesrcset="'+or(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(S+='[imagesizes="'+or(p.imageSizes)+'"]')):S+='[href="'+or(u)+'"]';var N=S;switch(h){case"style":N=Cu(u);break;case"script":N=ku(u)}pr.has(N)||(u=d({rel:"preload",href:h==="image"&&p&&p.imageSrcSet?void 0:u,as:h},p),pr.set(N,u),y.querySelector(S)!==null||h==="style"&&y.querySelector(pd(N))||h==="script"&&y.querySelector(md(N))||(h=y.createElement("link"),Hn(h,"link",u),An(h),y.head.appendChild(h)))}}function pU(u,h){Ua.m(u,h);var p=Nu;if(p&&u){var y=h&&typeof h.as=="string"?h.as:"script",S='link[rel="modulepreload"][as="'+or(y)+'"][href="'+or(u)+'"]',N=S;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=ku(u)}if(!pr.has(N)&&(u=d({rel:"modulepreload",href:u},h),pr.set(N,u),p.querySelector(S)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(md(N)))return}y=p.createElement("link"),Hn(y,"link",u),An(y),p.head.appendChild(y)}}}function mU(u,h,p){Ua.S(u,h,p);var y=Nu;if(y&&u){var S=jl(y).hoistableStyles,N=Cu(u);h=h||"default";var A=S.get(N);if(!A){var z={loading:0,preload:null};if(A=y.querySelector(pd(N)))z.loading=5;else{u=d({rel:"stylesheet",href:u,"data-precedence":h},p),(p=pr.get(N))&&Fv(u,p);var H=A=y.createElement("link");An(H),Hn(H,"link",u),H._p=new Promise(function(ct,yt){H.onload=ct,H.onerror=yt}),H.addEventListener("load",function(){z.loading|=1}),H.addEventListener("error",function(){z.loading|=2}),z.loading|=4,Tg(A,h,y)}A={type:"stylesheet",instance:A,count:1,state:z},S.set(N,A)}}}function gU(u,h){Ua.X(u,h);var p=Nu;if(p&&u){var y=jl(p).hoistableScripts,S=ku(u),N=y.get(S);N||(N=p.querySelector(md(S)),N||(u=d({src:u,async:!0},h),(h=pr.get(S))&&Lv(u,h),N=p.createElement("script"),An(N),Hn(N,"link",u),p.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},y.set(S,N))}}function yU(u,h){Ua.M(u,h);var p=Nu;if(p&&u){var y=jl(p).hoistableScripts,S=ku(u),N=y.get(S);N||(N=p.querySelector(md(S)),N||(u=d({src:u,async:!0,type:"module"},h),(h=pr.get(S))&&Lv(u,h),N=p.createElement("script"),An(N),Hn(N,"link",u),p.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},y.set(S,N))}}function iI(u,h,p,y){var S=(S=bt.current)?Sg(S):null;if(!S)throw Error(s(446));switch(u){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(h=Cu(p.href),p=jl(S).hoistableStyles,y=p.get(h),y||(y={type:"style",instance:null,count:0,state:null},p.set(h,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){u=Cu(p.href);var N=jl(S).hoistableStyles,A=N.get(u);if(A||(S=S.ownerDocument||S,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(u,A),(N=S.querySelector(pd(u)))&&!N._p&&(A.instance=N,A.state.loading=5),pr.has(u)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},pr.set(u,p),N||bU(S,u,p,A.state))),h&&y===null)throw Error(s(528,""));return A}if(h&&y!==null)throw Error(s(529,""));return null;case"script":return h=p.async,p=p.src,typeof p=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=ku(p),p=jl(S).hoistableScripts,y=p.get(h),y||(y={type:"script",instance:null,count:0,state:null},p.set(h,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,u))}}function Cu(u){return'href="'+or(u)+'"'}function pd(u){return'link[rel="stylesheet"]['+u+"]"}function oI(u){return d({},u,{"data-precedence":u.precedence,precedence:null})}function bU(u,h,p,y){u.querySelector('link[rel="preload"][as="style"]['+h+"]")?y.loading=1:(h=u.createElement("link"),y.preload=h,h.addEventListener("load",function(){return y.loading|=1}),h.addEventListener("error",function(){return y.loading|=2}),Hn(h,"link",p),An(h),u.head.appendChild(h))}function ku(u){return'[src="'+or(u)+'"]'}function md(u){return"script[async]"+u}function lI(u,h,p){if(h.count++,h.instance===null)switch(h.type){case"style":var y=u.querySelector('style[data-href~="'+or(p.href)+'"]');if(y)return h.instance=y,An(y),y;var S=d({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return y=(u.ownerDocument||u).createElement("style"),An(y),Hn(y,"style",S),Tg(y,p.precedence,u),h.instance=y;case"stylesheet":S=Cu(p.href);var N=u.querySelector(pd(S));if(N)return h.state.loading|=4,h.instance=N,An(N),N;y=oI(p),(S=pr.get(S))&&Fv(y,S),N=(u.ownerDocument||u).createElement("link"),An(N);var A=N;return A._p=new Promise(function(z,H){A.onload=z,A.onerror=H}),Hn(N,"link",y),h.state.loading|=4,Tg(N,p.precedence,u),h.instance=N;case"script":return N=ku(p.src),(S=u.querySelector(md(N)))?(h.instance=S,An(S),S):(y=p,(S=pr.get(N))&&(y=d({},p),Lv(y,S)),u=u.ownerDocument||u,S=u.createElement("script"),An(S),Hn(S,"link",y),u.head.appendChild(S),h.instance=S);case"void":return null;default:throw Error(s(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(y=h.instance,h.state.loading|=4,Tg(y,p.precedence,u));return h.instance}function Tg(u,h,p){for(var y=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=y.length?y[y.length-1]:null,N=S,A=0;A<y.length;A++){var z=y[A];if(z.dataset.precedence===h)N=z;else if(N!==S)break}N?N.parentNode.insertBefore(u,N.nextSibling):(h=p.nodeType===9?p.head:p,h.insertBefore(u,h.firstChild))}function Fv(u,h){u.crossOrigin==null&&(u.crossOrigin=h.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=h.referrerPolicy),u.title==null&&(u.title=h.title)}function Lv(u,h){u.crossOrigin==null&&(u.crossOrigin=h.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=h.referrerPolicy),u.integrity==null&&(u.integrity=h.integrity)}var Ng=null;function uI(u,h,p){if(Ng===null){var y=new Map,S=Ng=new Map;S.set(p,y)}else S=Ng,y=S.get(p),y||(y=new Map,S.set(p,y));if(y.has(u))return y;for(y.set(u,null),p=p.getElementsByTagName(u),S=0;S<p.length;S++){var N=p[S];if(!(N[Eh]||N[Qn]||u==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var A=N.getAttribute(h)||"";A=u+A;var z=y.get(A);z?z.push(N):y.set(A,[N])}}return y}function cI(u,h,p){u=u.ownerDocument||u,u.head.insertBefore(p,h==="title"?u.querySelector("head > title"):null)}function xU(u,h,p){if(p===1||h.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return u=h.disabled,typeof h.precedence=="string"&&u==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function hI(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}var gd=null;function vU(){}function wU(u,h,p){if(gd===null)throw Error(s(475));var y=gd;if(h.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var S=Cu(p.href),N=u.querySelector(pd(S));if(N){u=N._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(y.count++,y=Cg.bind(y),u.then(y,y)),h.state.loading|=4,h.instance=N,An(N);return}N=u.ownerDocument||u,p=oI(p),(S=pr.get(S))&&Fv(p,S),N=N.createElement("link"),An(N);var A=N;A._p=new Promise(function(z,H){A.onload=z,A.onerror=H}),Hn(N,"link",p),h.instance=N}y.stylesheets===null&&(y.stylesheets=new Map),y.stylesheets.set(h,u),(u=h.state.preload)&&(h.state.loading&3)===0&&(y.count++,h=Cg.bind(y),u.addEventListener("load",h),u.addEventListener("error",h))}}function SU(){if(gd===null)throw Error(s(475));var u=gd;return u.stylesheets&&u.count===0&&Mv(u,u.stylesheets),0<u.count?function(h){var p=setTimeout(function(){if(u.stylesheets&&Mv(u,u.stylesheets),u.unsuspend){var y=u.unsuspend;u.unsuspend=null,y()}},6e4);return u.unsuspend=h,function(){u.unsuspend=null,clearTimeout(p)}}:null}function Cg(){if(this.count--,this.count===0){if(this.stylesheets)Mv(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var kg=null;function Mv(u,h){u.stylesheets=null,u.unsuspend!==null&&(u.count++,kg=new Map,h.forEach(TU,u),kg=null,Cg.call(u))}function TU(u,h){if(!(h.state.loading&4)){var p=kg.get(u);if(p)var y=p.get(null);else{p=new Map,kg.set(u,p);for(var S=u.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<S.length;N++){var A=S[N];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(p.set(A.dataset.precedence,A),y=A)}y&&p.set(null,y)}S=h.instance,A=S.getAttribute("data-precedence"),N=p.get(A)||y,N===y&&p.set(null,S),p.set(A,S),this.count++,y=Cg.bind(this),S.addEventListener("load",y),S.addEventListener("error",y),N?N.parentNode.insertBefore(S,N.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(S,u.firstChild)),h.state.loading|=4}}var yd={$$typeof:C,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function NU(u,h,p,y,S,N,A,z){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ox(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ox(0),this.hiddenUpdates=Ox(null),this.identifierPrefix=y,this.onUncaughtError=S,this.onCaughtError=N,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function dI(u,h,p,y,S,N,A,z,H,ct,yt,vt){return u=new NU(u,h,p,A,z,H,ct,vt),h=1,N===!0&&(h|=24),N=Gs(3,null,null,h),u.current=N,N.stateNode=u,h=b1(),h.refCount++,u.pooledCache=h,h.refCount++,N.memoizedState={element:y,isDehydrated:p,cache:h},S1(N),u}function fI(u){return u?(u=su,u):su}function pI(u,h,p,y,S,N){S=fI(S),y.context===null?y.context=S:y.pendingContext=S,y=Si(h),y.payload={element:p},N=N===void 0?null:N,N!==null&&(y.callback=N),p=Ti(u,y,h),p!==null&&(Xs(p,u,h),qh(p,u,h))}function mI(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var p=u.retryLane;u.retryLane=p!==0&&p<h?p:h}}function zv(u,h){mI(u,h),(u=u.alternate)&&mI(u,h)}function gI(u){if(u.tag===13){var h=nu(u,67108864);h!==null&&Xs(h,u,67108864),zv(u,67108864)}}var $g=!0;function CU(u,h,p,y){var S=B.T;B.T=null;var N=W.p;try{W.p=2,Pv(u,h,p,y)}finally{W.p=N,B.T=S}}function kU(u,h,p,y){var S=B.T;B.T=null;var N=W.p;try{W.p=8,Pv(u,h,p,y)}finally{W.p=N,B.T=S}}function Pv(u,h,p,y){if($g){var S=Bv(y);if(S===null)kv(u,h,y,Eg,p),bI(u,y);else if(EU(S,u,h,p,y))y.stopPropagation();else if(bI(u,y),h&4&&-1<$U.indexOf(u)){for(;S!==null;){var N=Gl(S);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var A=$a(N.pendingLanes);if(A!==0){var z=N;for(z.pendingLanes|=2,z.entangledLanes|=2;A;){var H=1<<31-vn(A);z.entanglements[1]|=H,A&=~H}na(N),(ve&6)===0&&(hg=oe()+500,cd(0))}}break;case 13:z=nu(N,2),z!==null&&Xs(z,N,2),fg(),zv(N,2)}if(N=Bv(y),N===null&&kv(u,h,y,Eg,p),N===S)break;S=N}S!==null&&y.stopPropagation()}else kv(u,h,y,null,p)}}function Bv(u){return u=jx(u),Vv(u)}var Eg=null;function Vv(u){if(Eg=null,u=Wl(u),u!==null){var h=a(u);if(h===null)u=null;else{var p=h.tag;if(p===13){if(u=i(h),u!==null)return u;u=null}else if(p===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;u=null}else h!==u&&(u=null)}}return Eg=u,null}function yI(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ie()){case ar:return 2;case sn:return 8;case Vs:case hs:return 32;case Zr:return 268435456;default:return 32}default:return 32}}var Uv=!1,Li=null,Mi=null,zi=null,bd=new Map,xd=new Map,Pi=[],$U="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bI(u,h){switch(u){case"focusin":case"focusout":Li=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":bd.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":xd.delete(h.pointerId)}}function vd(u,h,p,y,S,N){return u===null||u.nativeEvent!==N?(u={blockedOn:h,domEventName:p,eventSystemFlags:y,nativeEvent:N,targetContainers:[S]},h!==null&&(h=Gl(h),h!==null&&gI(h)),u):(u.eventSystemFlags|=y,h=u.targetContainers,S!==null&&h.indexOf(S)===-1&&h.push(S),u)}function EU(u,h,p,y,S){switch(h){case"focusin":return Li=vd(Li,u,h,p,y,S),!0;case"dragenter":return Mi=vd(Mi,u,h,p,y,S),!0;case"mouseover":return zi=vd(zi,u,h,p,y,S),!0;case"pointerover":var N=S.pointerId;return bd.set(N,vd(bd.get(N)||null,u,h,p,y,S)),!0;case"gotpointercapture":return N=S.pointerId,xd.set(N,vd(xd.get(N)||null,u,h,p,y,S)),!0}return!1}function xI(u){var h=Wl(u.target);if(h!==null){var p=a(h);if(p!==null){if(h=p.tag,h===13){if(h=i(p),h!==null){u.blockedOn=h,wB(u.priority,function(){if(p.tag===13){var y=Ks();y=_x(y);var S=nu(p,y);S!==null&&Xs(S,p,y),zv(p,y)}});return}}else if(h===3&&p.stateNode.current.memoizedState.isDehydrated){u.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Ig(u){if(u.blockedOn!==null)return!1;for(var h=u.targetContainers;0<h.length;){var p=Bv(u.nativeEvent);if(p===null){p=u.nativeEvent;var y=new p.constructor(p.type,p);Gx=y,p.target.dispatchEvent(y),Gx=null}else return h=Gl(p),h!==null&&gI(h),u.blockedOn=p,!1;h.shift()}return!0}function vI(u,h,p){Ig(u)&&p.delete(h)}function IU(){Uv=!1,Li!==null&&Ig(Li)&&(Li=null),Mi!==null&&Ig(Mi)&&(Mi=null),zi!==null&&Ig(zi)&&(zi=null),bd.forEach(vI),xd.forEach(vI)}function Ag(u,h){u.blockedOn===h&&(u.blockedOn=null,Uv||(Uv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,IU)))}var Rg=null;function wI(u){Rg!==u&&(Rg=u,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Rg===u&&(Rg=null);for(var h=0;h<u.length;h+=3){var p=u[h],y=u[h+1],S=u[h+2];if(typeof y!="function"){if(Vv(y||p)===null)continue;break}var N=Gl(p);N!==null&&(u.splice(h,3),h-=3,V1(N,{pending:!0,data:S,method:p.method,action:y},y,S))}}))}function wd(u){function h(H){return Ag(H,u)}Li!==null&&Ag(Li,u),Mi!==null&&Ag(Mi,u),zi!==null&&Ag(zi,u),bd.forEach(h),xd.forEach(h);for(var p=0;p<Pi.length;p++){var y=Pi[p];y.blockedOn===u&&(y.blockedOn=null)}for(;0<Pi.length&&(p=Pi[0],p.blockedOn===null);)xI(p),p.blockedOn===null&&Pi.shift();if(p=(u.ownerDocument||u).$$reactFormReplay,p!=null)for(y=0;y<p.length;y+=3){var S=p[y],N=p[y+1],A=S[Cs]||null;if(typeof N=="function")A||wI(p);else if(A){var z=null;if(N&&N.hasAttribute("formAction")){if(S=N,A=N[Cs]||null)z=A.formAction;else if(Vv(S)!==null)continue}else z=A.action;typeof z=="function"?p[y+1]=z:(p.splice(y,3),y-=3),wI(p)}}}function Wv(u){this._internalRoot=u}Dg.prototype.render=Wv.prototype.render=function(u){var h=this._internalRoot;if(h===null)throw Error(s(409));var p=h.current,y=Ks();pI(p,y,u,h,null,null)},Dg.prototype.unmount=Wv.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var h=u.containerInfo;pI(u.current,2,null,u,null,null),fg(),h[Ul]=null}};function Dg(u){this._internalRoot=u}Dg.prototype.unstable_scheduleHydration=function(u){if(u){var h=zC();u={blockedOn:null,target:u,priority:h};for(var p=0;p<Pi.length&&h!==0&&h<Pi[p].priority;p++);Pi.splice(p,0,u),p===0&&xI(u)}};var SI=t.version;if(SI!=="19.1.0")throw Error(s(527,SI,"19.1.0"));W.findDOMNode=function(u){var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(s(188)):(u=Object.keys(u).join(","),Error(s(268,u)));return u=l(h),u=u!==null?c(u):null,u=u===null?null:u.stateNode,u};var AU={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Og=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Og.isDisabled&&Og.supportsFiber)try{Ns=Og.inject(AU),Ke=Og}catch{}}return Td.createRoot=function(u,h){if(!r(u))throw Error(s(299));var p=!1,y="",S=z$,N=P$,A=B$,z=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onUncaughtError!==void 0&&(S=h.onUncaughtError),h.onCaughtError!==void 0&&(N=h.onCaughtError),h.onRecoverableError!==void 0&&(A=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(z=h.unstable_transitionCallbacks)),h=dI(u,1,!1,null,null,p,y,S,N,A,z,null),u[Ul]=h.current,Cv(u),new Wv(h)},Td.hydrateRoot=function(u,h,p){if(!r(u))throw Error(s(299));var y=!1,S="",N=z$,A=P$,z=B$,H=null,ct=null;return p!=null&&(p.unstable_strictMode===!0&&(y=!0),p.identifierPrefix!==void 0&&(S=p.identifierPrefix),p.onUncaughtError!==void 0&&(N=p.onUncaughtError),p.onCaughtError!==void 0&&(A=p.onCaughtError),p.onRecoverableError!==void 0&&(z=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(H=p.unstable_transitionCallbacks),p.formState!==void 0&&(ct=p.formState)),h=dI(u,1,!0,h,p??null,y,S,N,A,z,H,ct),h.context=fI(null),p=h.current,y=Ks(),y=_x(y),S=Si(y),S.callback=null,Ti(p,S,y),p=y,h.current.lanes=p,$h(h,p),na(h),u[Ul]=h.current,Cv(u),new Dg(h)},Td.version="19.1.0",Td}var DI;function VU(){if(DI)return Hv.exports;DI=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Hv.exports=BU(),Hv.exports}var UU=VU(),Nd={},OI;function WU(){if(OI)return Nd;OI=1,Object.defineProperty(Nd,"__esModule",{value:!0}),Nd.parse=i,Nd.serialize=c;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,e=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,r=Object.prototype.toString,a=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function i(m,g){const b=new a,x=m.length;if(x<2)return b;const v=(g==null?void 0:g.decode)||d;let w=0;do{const T=m.indexOf("=",w);if(T===-1)break;const C=m.indexOf(";",w),k=C===-1?x:C;if(T>k){w=m.lastIndexOf(";",T-1)+1;continue}const $=o(m,w,T),I=l(m,T,$),D=m.slice($,I);if(b[D]===void 0){let _=o(m,T+1,k),O=l(m,k,_);const L=v(m.slice(_,O));b[D]=L}w=k+1}while(w<x);return b}function o(m,g,b){do{const x=m.charCodeAt(g);if(x!==32&&x!==9)return g}while(++g<b);return b}function l(m,g,b){for(;g>b;){const x=m.charCodeAt(--g);if(x!==32&&x!==9)return g+1}return b}function c(m,g,b){const x=(b==null?void 0:b.encode)||encodeURIComponent;if(!n.test(m))throw new TypeError(`argument name is invalid: ${m}`);const v=x(g);if(!t.test(v))throw new TypeError(`argument val is invalid: ${g}`);let w=m+"="+v;if(!b)return w;if(b.maxAge!==void 0){if(!Number.isInteger(b.maxAge))throw new TypeError(`option maxAge is invalid: ${b.maxAge}`);w+="; Max-Age="+b.maxAge}if(b.domain){if(!e.test(b.domain))throw new TypeError(`option domain is invalid: ${b.domain}`);w+="; Domain="+b.domain}if(b.path){if(!s.test(b.path))throw new TypeError(`option path is invalid: ${b.path}`);w+="; Path="+b.path}if(b.expires){if(!f(b.expires)||!Number.isFinite(b.expires.valueOf()))throw new TypeError(`option expires is invalid: ${b.expires}`);w+="; Expires="+b.expires.toUTCString()}if(b.httpOnly&&(w+="; HttpOnly"),b.secure&&(w+="; Secure"),b.partitioned&&(w+="; Partitioned"),b.priority)switch(typeof b.priority=="string"?b.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${b.priority}`)}if(b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${b.sameSite}`)}return w}function d(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function f(m){return r.call(m)==="[object Date]"}return Nd}WU();/**
 * react-router v7.5.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var _I="popstate";function GU(n={}){function t(s,r){let{pathname:a,search:i,hash:o}=s.location;return Dw("",{pathname:a,search:i,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function e(s,r){return typeof r=="string"?r:Yd(r)}return HU(t,e,null,n)}function qe(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function ga(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function jU(){return Math.random().toString(36).substring(2,10)}function FI(n,t){return{usr:n.state,key:n.key,idx:t}}function Dw(n,t,e=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof t=="string"?oc(t):t,state:e,key:t&&t.key||s||jU()}}function Yd({pathname:n="/",search:t="",hash:e=""}){return t&&t!=="?"&&(n+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(n+=e.charAt(0)==="#"?e:"#"+e),n}function oc(n){let t={};if(n){let e=n.indexOf("#");e>=0&&(t.hash=n.substring(e),n=n.substring(0,e));let s=n.indexOf("?");s>=0&&(t.search=n.substring(s),n=n.substring(0,s)),n&&(t.pathname=n)}return t}function HU(n,t,e,s={}){let{window:r=document.defaultView,v5Compat:a=!1}=s,i=r.history,o="POP",l=null,c=d();c==null&&(c=0,i.replaceState({...i.state,idx:c},""));function d(){return(i.state||{idx:null}).idx}function f(){o="POP";let v=d(),w=v==null?null:v-c;c=v,l&&l({action:o,location:x.location,delta:w})}function m(v,w){o="PUSH";let T=Dw(x.location,v,w);c=d()+1;let C=FI(T,c),k=x.createHref(T);try{i.pushState(C,"",k)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;r.location.assign(k)}a&&l&&l({action:o,location:x.location,delta:1})}function g(v,w){o="REPLACE";let T=Dw(x.location,v,w);c=d();let C=FI(T,c),k=x.createHref(T);i.replaceState(C,"",k),a&&l&&l({action:o,location:x.location,delta:0})}function b(v){let w=r.location.origin!=="null"?r.location.origin:r.location.href,T=typeof v=="string"?v:Yd(v);return T=T.replace(/ $/,"%20"),qe(w,`No window.location.(origin|href) available to create URL for href: ${T}`),new URL(T,w)}let x={get action(){return o},get location(){return n(r,i)},listen(v){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(_I,f),l=v,()=>{r.removeEventListener(_I,f),l=null}},createHref(v){return t(r,v)},createURL:b,encodeLocation(v){let w=b(v);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:g,go(v){return i.go(v)}};return x}function eO(n,t,e="/"){return qU(n,t,e,!1)}function qU(n,t,e,s){let r=typeof t=="string"?oc(t):t,a=Qa(r.pathname||"/",e);if(a==null)return null;let i=nO(n);KU(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=aW(a);o=sW(i[l],c,s)}return o}function nO(n,t=[],e=[],s=""){let r=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(qe(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length));let c=Ya([s,l.relativePath]),d=e.concat(l);a.children&&a.children.length>0&&(qe(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),nO(a.children,t,d,c)),!(a.path==null&&!a.index)&&t.push({path:c,score:eW(c,a.index),routesMeta:d})};return n.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))r(a,i);else for(let l of sO(a.path))r(a,i,l)}),t}function sO(n){let t=n.split("/");if(t.length===0)return[];let[e,...s]=t,r=e.endsWith("?"),a=e.replace(/\?$/,"");if(s.length===0)return r?[a,""]:[a];let i=sO(s.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),r&&o.push(...i),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function KU(n){n.sort((t,e)=>t.score!==e.score?e.score-t.score:nW(t.routesMeta.map(s=>s.childrenIndex),e.routesMeta.map(s=>s.childrenIndex)))}var XU=/^:[\w-]+$/,YU=3,ZU=2,QU=1,JU=10,tW=-2,LI=n=>n==="*";function eW(n,t){let e=n.split("/"),s=e.length;return e.some(LI)&&(s+=tW),t&&(s+=ZU),e.filter(r=>!LI(r)).reduce((r,a)=>r+(XU.test(a)?YU:a===""?QU:JU),s)}function nW(n,t){return n.length===t.length&&n.slice(0,-1).every((s,r)=>s===t[r])?n[n.length-1]-t[t.length-1]:0}function sW(n,t,e=!1){let{routesMeta:s}=n,r={},a="/",i=[];for(let o=0;o<s.length;++o){let l=s[o],c=o===s.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=Sy({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},d),m=l.route;if(!f&&c&&e&&!s[s.length-1].route.index&&(f=Sy({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},d)),!f)return null;Object.assign(r,f.params),i.push({params:r,pathname:Ya([a,f.pathname]),pathnameBase:uW(Ya([a,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(a=Ya([a,f.pathnameBase]))}return i}function Sy(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[e,s]=rW(n.path,n.caseSensitive,n.end),r=t.match(e);if(!r)return null;let a=r[0],i=a.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:s.reduce((c,{paramName:d,isOptional:f},m)=>{if(d==="*"){let b=o[m]||"";i=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const g=o[m];return f&&!g?c[d]=void 0:c[d]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:n}}function rW(n,t=!1,e=!0){ga(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),s]}function aW(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ga(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),n}}function Qa(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,s=n.charAt(e);return s&&s!=="/"?null:n.slice(e)||"/"}function iW(n,t="/"){let{pathname:e,search:s="",hash:r=""}=typeof n=="string"?oc(n):n;return{pathname:e?e.startsWith("/")?e:oW(e,t):t,search:cW(s),hash:hW(r)}}function oW(n,t){let e=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?e.length>1&&e.pop():r!=="."&&e.push(r)}),e.length>1?e.join("/"):"/"}function Yv(n,t,e,s){return`Cannot include a '${n}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function lW(n){return n.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function rO(n){let t=lW(n);return t.map((e,s)=>s===t.length-1?e.pathname:e.pathnameBase)}function aO(n,t,e,s=!1){let r;typeof n=="string"?r=oc(n):(r={...n},qe(!r.pathname||!r.pathname.includes("?"),Yv("?","pathname","search",r)),qe(!r.pathname||!r.pathname.includes("#"),Yv("#","pathname","hash",r)),qe(!r.search||!r.search.includes("#"),Yv("#","search","hash",r)));let a=n===""||r.pathname==="",i=a?"/":r.pathname,o;if(i==null)o=e;else{let f=t.length-1;if(!s&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),f-=1;r.pathname=m.join("/")}o=f>=0?t[f]:"/"}let l=iW(r,o),c=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&e.endsWith("/");return!l.pathname.endsWith("/")&&(c||d)&&(l.pathname+="/"),l}var Ya=n=>n.join("/").replace(/\/\/+/g,"/"),uW=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),cW=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,hW=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function dW(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var iO=["POST","PUT","PATCH","DELETE"];new Set(iO);var fW=["GET",...iO];new Set(fW);var lc=nt.createContext(null);lc.displayName="DataRouter";var i0=nt.createContext(null);i0.displayName="DataRouterState";var oO=nt.createContext({isTransitioning:!1});oO.displayName="ViewTransition";var pW=nt.createContext(new Map);pW.displayName="Fetchers";var mW=nt.createContext(null);mW.displayName="Await";var Ta=nt.createContext(null);Ta.displayName="Navigation";var If=nt.createContext(null);If.displayName="Location";var oi=nt.createContext({outlet:null,matches:[],isDataRoute:!1});oi.displayName="Route";var JS=nt.createContext(null);JS.displayName="RouteError";function gW(n,{relative:t}={}){qe(Af(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:s}=nt.useContext(Ta),{hash:r,pathname:a,search:i}=Rf(n,{relative:t}),o=a;return e!=="/"&&(o=a==="/"?e:Ya([e,a])),s.createHref({pathname:o,search:i,hash:r})}function Af(){return nt.useContext(If)!=null}function li(){return qe(Af(),"useLocation() may be used only in the context of a <Router> component."),nt.useContext(If).location}var lO="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function uO(n){nt.useContext(Ta).static||nt.useLayoutEffect(n)}function uc(){let{isDataRoute:n}=nt.useContext(oi);return n?IW():yW()}function yW(){qe(Af(),"useNavigate() may be used only in the context of a <Router> component.");let n=nt.useContext(lc),{basename:t,navigator:e}=nt.useContext(Ta),{matches:s}=nt.useContext(oi),{pathname:r}=li(),a=JSON.stringify(rO(s)),i=nt.useRef(!1);return uO(()=>{i.current=!0}),nt.useCallback((l,c={})=>{if(ga(i.current,lO),!i.current)return;if(typeof l=="number"){e.go(l);return}let d=aO(l,JSON.parse(a),r,c.relative==="path");n==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ya([t,d.pathname])),(c.replace?e.replace:e.push)(d,c.state,c)},[t,e,a,r,n])}nt.createContext(null);function Rf(n,{relative:t}={}){let{matches:e}=nt.useContext(oi),{pathname:s}=li(),r=JSON.stringify(rO(e));return nt.useMemo(()=>aO(n,JSON.parse(r),s,t==="path"),[n,r,s,t])}function bW(n,t){return cO(n,t)}function cO(n,t,e,s){var T;qe(Af(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r,static:a}=nt.useContext(Ta),{matches:i}=nt.useContext(oi),o=i[i.length-1],l=o?o.params:{},c=o?o.pathname:"/",d=o?o.pathnameBase:"/",f=o&&o.route;{let C=f&&f.path||"";hO(c,!f||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=li(),g;if(t){let C=typeof t=="string"?oc(t):t;qe(d==="/"||((T=C.pathname)==null?void 0:T.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${C.pathname}" was given in the \`location\` prop.`),g=C}else g=m;let b=g.pathname||"/",x=b;if(d!=="/"){let C=d.replace(/^\//,"").split("/");x="/"+b.replace(/^\//,"").split("/").slice(C.length).join("/")}let v=!a&&e&&e.matches&&e.matches.length>0?e.matches:eO(n,{pathname:x});ga(f||v!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),ga(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=TW(v&&v.map(C=>Object.assign({},C,{params:Object.assign({},l,C.params),pathname:Ya([d,r.encodeLocation?r.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?d:Ya([d,r.encodeLocation?r.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),i,e,s);return t&&w?nt.createElement(If.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},w):w}function xW(){let n=EW(),t=dW(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),e=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},a={padding:"2px 4px",backgroundColor:s},i=null;return console.error("Error handled by React Router default ErrorBoundary:",n),i=nt.createElement(nt.Fragment,null,nt.createElement("p",null,"💿 Hey developer 👋"),nt.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",nt.createElement("code",{style:a},"ErrorBoundary")," or"," ",nt.createElement("code",{style:a},"errorElement")," prop on your route.")),nt.createElement(nt.Fragment,null,nt.createElement("h2",null,"Unexpected Application Error!"),nt.createElement("h3",{style:{fontStyle:"italic"}},t),e?nt.createElement("pre",{style:r},e):null,i)}var vW=nt.createElement(xW,null),wW=class extends nt.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,t){return t.location!==n.location||t.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:t.error,location:t.location,revalidation:n.revalidation||t.revalidation}}componentDidCatch(n,t){console.error("React Router caught the following error during render",n,t)}render(){return this.state.error!==void 0?nt.createElement(oi.Provider,{value:this.props.routeContext},nt.createElement(JS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function SW({routeContext:n,match:t,children:e}){let s=nt.useContext(lc);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),nt.createElement(oi.Provider,{value:n},e)}function TW(n,t=[],e=null,s=null){if(n==null){if(!e)return null;if(e.errors)n=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)n=e.matches;else return null}let r=n,a=e==null?void 0:e.errors;if(a!=null){let l=r.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id])!==void 0);qe(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),r=r.slice(0,Math.min(r.length,l+1))}let i=!1,o=-1;if(e)for(let l=0;l<r.length;l++){let c=r[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=l),c.route.id){let{loaderData:d,errors:f}=e,m=c.route.loader&&!d.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||m){i=!0,o>=0?r=r.slice(0,o+1):r=[r[0]];break}}}return r.reduceRight((l,c,d)=>{let f,m=!1,g=null,b=null;e&&(f=a&&c.route.id?a[c.route.id]:void 0,g=c.route.errorElement||vW,i&&(o<0&&d===0?(hO("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,b=null):o===d&&(m=!0,b=c.route.hydrateFallbackElement||null)));let x=t.concat(r.slice(0,d+1)),v=()=>{let w;return f?w=g:m?w=b:c.route.Component?w=nt.createElement(c.route.Component,null):c.route.element?w=c.route.element:w=l,nt.createElement(SW,{match:c,routeContext:{outlet:l,matches:x,isDataRoute:e!=null},children:w})};return e&&(c.route.ErrorBoundary||c.route.errorElement||d===0)?nt.createElement(wW,{location:e.location,revalidation:e.revalidation,component:g,error:f,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}function t2(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function NW(n){let t=nt.useContext(lc);return qe(t,t2(n)),t}function CW(n){let t=nt.useContext(i0);return qe(t,t2(n)),t}function kW(n){let t=nt.useContext(oi);return qe(t,t2(n)),t}function e2(n){let t=kW(n),e=t.matches[t.matches.length-1];return qe(e.route.id,`${n} can only be used on routes that contain a unique "id"`),e.route.id}function $W(){return e2("useRouteId")}function EW(){var s;let n=nt.useContext(JS),t=CW("useRouteError"),e=e2("useRouteError");return n!==void 0?n:(s=t.errors)==null?void 0:s[e]}function IW(){let{router:n}=NW("useNavigate"),t=e2("useNavigate"),e=nt.useRef(!1);return uO(()=>{e.current=!0}),nt.useCallback(async(r,a={})=>{ga(e.current,lO),e.current&&(typeof r=="number"?n.navigate(r):await n.navigate(r,{fromRouteId:t,...a}))},[n,t])}var MI={};function hO(n,t,e){!t&&!MI[n]&&(MI[n]=!0,ga(!1,e))}nt.memo(AW);function AW({routes:n,future:t,state:e}){return cO(n,void 0,e,t)}function Vi(n){qe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function RW({basename:n="/",children:t=null,location:e,navigationType:s="POP",navigator:r,static:a=!1}){qe(!Af(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=n.replace(/^\/*/,"/"),o=nt.useMemo(()=>({basename:i,navigator:r,static:a,future:{}}),[i,r,a]);typeof e=="string"&&(e=oc(e));let{pathname:l="/",search:c="",hash:d="",state:f=null,key:m="default"}=e,g=nt.useMemo(()=>{let b=Qa(l,i);return b==null?null:{location:{pathname:b,search:c,hash:d,state:f,key:m},navigationType:s}},[i,l,c,d,f,m,s]);return ga(g!=null,`<Router basename="${i}"> is not able to match the URL "${l}${c}${d}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:nt.createElement(Ta.Provider,{value:o},nt.createElement(If.Provider,{children:t,value:g}))}function DW({children:n,location:t}){return bW(Ow(n),t)}function Ow(n,t=[]){let e=[];return nt.Children.forEach(n,(s,r)=>{if(!nt.isValidElement(s))return;let a=[...t,r];if(s.type===nt.Fragment){e.push.apply(e,Ow(s.props.children,a));return}qe(s.type===Vi,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),qe(!s.props.index||!s.props.children,"An index route cannot have child routes.");let i={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=Ow(s.props.children,a)),e.push(i)}),e}var sy="get",ry="application/x-www-form-urlencoded";function o0(n){return n!=null&&typeof n.tagName=="string"}function OW(n){return o0(n)&&n.tagName.toLowerCase()==="button"}function _W(n){return o0(n)&&n.tagName.toLowerCase()==="form"}function FW(n){return o0(n)&&n.tagName.toLowerCase()==="input"}function LW(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function MW(n,t){return n.button===0&&(!t||t==="_self")&&!LW(n)}var Fg=null;function zW(){if(Fg===null)try{new FormData(document.createElement("form"),0),Fg=!1}catch{Fg=!0}return Fg}var PW=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Zv(n){return n!=null&&!PW.has(n)?(ga(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ry}"`),null):n}function BW(n,t){let e,s,r,a,i;if(_W(n)){let o=n.getAttribute("action");s=o?Qa(o,t):null,e=n.getAttribute("method")||sy,r=Zv(n.getAttribute("enctype"))||ry,a=new FormData(n)}else if(OW(n)||FW(n)&&(n.type==="submit"||n.type==="image")){let o=n.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||o.getAttribute("action");if(s=l?Qa(l,t):null,e=n.getAttribute("formmethod")||o.getAttribute("method")||sy,r=Zv(n.getAttribute("formenctype"))||Zv(o.getAttribute("enctype"))||ry,a=new FormData(o,n),!zW()){let{name:c,type:d,value:f}=n;if(d==="image"){let m=c?`${c}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else c&&a.append(c,f)}}else{if(o0(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=sy,s=null,r=ry,i=n}return a&&r==="text/plain"&&(i=a,a=void 0),{action:s,method:e.toLowerCase(),encType:r,formData:a,body:i}}function n2(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}async function VW(n,t){if(n.id in t)return t[n.id];try{let e=await import(n.module);return t[n.id]=e,e}catch(e){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function UW(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function WW(n,t,e){let s=await Promise.all(n.map(async r=>{let a=t.routes[r.route.id];if(a){let i=await VW(a,e);return i.links?i.links():[]}return[]}));return qW(s.flat(1).filter(UW).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function zI(n,t,e,s,r,a){let i=(l,c)=>e[c]?l.route.id!==e[c].route.id:!0,o=(l,c)=>{var d;return e[c].pathname!==l.pathname||((d=e[c].route.path)==null?void 0:d.endsWith("*"))&&e[c].params["*"]!==l.params["*"]};return a==="assets"?t.filter((l,c)=>i(l,c)||o(l,c)):a==="data"?t.filter((l,c)=>{var f;let d=s.routes[l.route.id];if(!d||!d.hasLoader)return!1;if(i(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((f=e[0])==null?void 0:f.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function GW(n,t,{includeHydrateFallback:e}={}){return jW(n.map(s=>{let r=t.routes[s.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),e&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function jW(n){return[...new Set(n)]}function HW(n){let t={},e=Object.keys(n).sort();for(let s of e)t[s]=n[s];return t}function qW(n,t){let e=new Set;return new Set(t),n.reduce((s,r)=>{let a=JSON.stringify(HW(r));return e.has(a)||(e.add(a),s.push({key:a,link:r})),s},[])}function KW(n,t){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":t&&Qa(e.pathname,t)==="/"?e.pathname=`${t.replace(/\/$/,"")}/_root.data`:e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function dO(){let n=nt.useContext(lc);return n2(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function XW(){let n=nt.useContext(i0);return n2(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var s2=nt.createContext(void 0);s2.displayName="FrameworkContext";function fO(){let n=nt.useContext(s2);return n2(n,"You must render this element inside a <HydratedRouter> element"),n}function YW(n,t){let e=nt.useContext(s2),[s,r]=nt.useState(!1),[a,i]=nt.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:d,onTouchStart:f}=t,m=nt.useRef(null);nt.useEffect(()=>{if(n==="render"&&i(!0),n==="viewport"){let x=w=>{w.forEach(T=>{i(T.isIntersecting)})},v=new IntersectionObserver(x,{threshold:.5});return m.current&&v.observe(m.current),()=>{v.disconnect()}}},[n]),nt.useEffect(()=>{if(s){let x=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(x)}}},[s]);let g=()=>{r(!0)},b=()=>{r(!1),i(!1)};return e?n!=="intent"?[a,m,{}]:[a,m,{onFocus:Cd(o,g),onBlur:Cd(l,b),onMouseEnter:Cd(c,g),onMouseLeave:Cd(d,b),onTouchStart:Cd(f,g)}]:[!1,m,{}]}function Cd(n,t){return e=>{n&&n(e),e.defaultPrevented||t(e)}}function ZW({page:n,...t}){let{router:e}=dO(),s=nt.useMemo(()=>eO(e.routes,n,e.basename),[e.routes,n,e.basename]);return s?nt.createElement(JW,{page:n,matches:s,...t}):null}function QW(n){let{manifest:t,routeModules:e}=fO(),[s,r]=nt.useState([]);return nt.useEffect(()=>{let a=!1;return WW(n,t,e).then(i=>{a||r(i)}),()=>{a=!0}},[n,t,e]),s}function JW({page:n,matches:t,...e}){let s=li(),{manifest:r,routeModules:a}=fO(),{basename:i}=dO(),{loaderData:o,matches:l}=XW(),c=nt.useMemo(()=>zI(n,t,l,r,s,"data"),[n,t,l,r,s]),d=nt.useMemo(()=>zI(n,t,l,r,s,"assets"),[n,t,l,r,s]),f=nt.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let b=new Set,x=!1;if(t.forEach(w=>{var C;let T=r.routes[w.route.id];!T||!T.hasLoader||(!c.some(k=>k.route.id===w.route.id)&&w.route.id in o&&((C=a[w.route.id])!=null&&C.shouldRevalidate)||T.hasClientLoader?x=!0:b.add(w.route.id))}),b.size===0)return[];let v=KW(n,i);return x&&b.size>0&&v.searchParams.set("_routes",t.filter(w=>b.has(w.route.id)).map(w=>w.route.id).join(",")),[v.pathname+v.search]},[i,o,s,r,c,t,n,a]),m=nt.useMemo(()=>GW(d,r),[d,r]),g=QW(d);return nt.createElement(nt.Fragment,null,f.map(b=>nt.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...e})),m.map(b=>nt.createElement("link",{key:b,rel:"modulepreload",href:b,...e})),g.map(({key:b,link:x})=>nt.createElement("link",{key:b,...x})))}function tG(...n){return t=>{n.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var pO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{pO&&(window.__reactRouterVersion="7.5.0")}catch{}function eG({basename:n,children:t,window:e}){let s=nt.useRef();s.current==null&&(s.current=GU({window:e,v5Compat:!0}));let r=s.current,[a,i]=nt.useState({action:r.action,location:r.location}),o=nt.useCallback(l=>{nt.startTransition(()=>i(l))},[i]);return nt.useLayoutEffect(()=>r.listen(o),[r,o]),nt.createElement(RW,{basename:n,children:t,location:a.location,navigationType:a.action,navigator:r})}var mO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zd=nt.forwardRef(function({onClick:t,discover:e="render",prefetch:s="none",relative:r,reloadDocument:a,replace:i,state:o,target:l,to:c,preventScrollReset:d,viewTransition:f,...m},g){let{basename:b}=nt.useContext(Ta),x=typeof c=="string"&&mO.test(c),v,w=!1;if(typeof c=="string"&&x&&(v=c,pO))try{let O=new URL(window.location.href),L=c.startsWith("//")?new URL(O.protocol+c):new URL(c),R=Qa(L.pathname,b);L.origin===O.origin&&R!=null?c=R+L.search+L.hash:w=!0}catch{ga(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=gW(c,{relative:r}),[C,k,$]=YW(s,m),I=aG(c,{replace:i,state:o,target:l,preventScrollReset:d,relative:r,viewTransition:f});function D(O){t&&t(O),O.defaultPrevented||I(O)}let _=nt.createElement("a",{...m,...$,href:v||T,onClick:w||a?t:D,ref:tG(g,k),target:l,"data-discover":!x&&e==="render"?"true":void 0});return C&&!x?nt.createElement(nt.Fragment,null,_,nt.createElement(ZW,{page:T})):_});Zd.displayName="Link";var nG=nt.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:s="",end:r=!1,style:a,to:i,viewTransition:o,children:l,...c},d){let f=Rf(i,{relative:c.relative}),m=li(),g=nt.useContext(i0),{navigator:b,basename:x}=nt.useContext(Ta),v=g!=null&&cG(f)&&o===!0,w=b.encodeLocation?b.encodeLocation(f).pathname:f.pathname,T=m.pathname,C=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;e||(T=T.toLowerCase(),C=C?C.toLowerCase():null,w=w.toLowerCase()),C&&x&&(C=Qa(C,x)||C);const k=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let $=T===w||!r&&T.startsWith(w)&&T.charAt(k)==="/",I=C!=null&&(C===w||!r&&C.startsWith(w)&&C.charAt(w.length)==="/"),D={isActive:$,isPending:I,isTransitioning:v},_=$?t:void 0,O;typeof s=="function"?O=s(D):O=[s,$?"active":null,I?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let L=typeof a=="function"?a(D):a;return nt.createElement(Zd,{...c,"aria-current":_,className:O,ref:d,style:L,to:i,viewTransition:o},typeof l=="function"?l(D):l)});nG.displayName="NavLink";var sG=nt.forwardRef(({discover:n="render",fetcherKey:t,navigate:e,reloadDocument:s,replace:r,state:a,method:i=sy,action:o,onSubmit:l,relative:c,preventScrollReset:d,viewTransition:f,...m},g)=>{let b=lG(),x=uG(o,{relative:c}),v=i.toLowerCase()==="get"?"get":"post",w=typeof o=="string"&&mO.test(o),T=C=>{if(l&&l(C),C.defaultPrevented)return;C.preventDefault();let k=C.nativeEvent.submitter,$=(k==null?void 0:k.getAttribute("formmethod"))||i;b(k||C.currentTarget,{fetcherKey:t,method:$,navigate:e,replace:r,state:a,relative:c,preventScrollReset:d,viewTransition:f})};return nt.createElement("form",{ref:g,method:v,action:x,onSubmit:s?l:T,...m,"data-discover":!w&&n==="render"?"true":void 0})});sG.displayName="Form";function rG(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gO(n){let t=nt.useContext(lc);return qe(t,rG(n)),t}function aG(n,{target:t,replace:e,state:s,preventScrollReset:r,relative:a,viewTransition:i}={}){let o=uc(),l=li(),c=Rf(n,{relative:a});return nt.useCallback(d=>{if(MW(d,t)){d.preventDefault();let f=e!==void 0?e:Yd(l)===Yd(c);o(n,{replace:f,state:s,preventScrollReset:r,relative:a,viewTransition:i})}},[l,o,c,e,s,t,n,r,a,i])}var iG=0,oG=()=>`__${String(++iG)}__`;function lG(){let{router:n}=gO("useSubmit"),{basename:t}=nt.useContext(Ta),e=$W();return nt.useCallback(async(s,r={})=>{let{action:a,method:i,encType:o,formData:l,body:c}=BW(s,t);if(r.navigate===!1){let d=r.fetcherKey||oG();await n.fetch(d,e,r.action||a,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,flushSync:r.flushSync})}else await n.navigate(r.action||a,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:e,flushSync:r.flushSync,viewTransition:r.viewTransition})},[n,t,e])}function uG(n,{relative:t}={}){let{basename:e}=nt.useContext(Ta),s=nt.useContext(oi);qe(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),a={...Rf(n||".",{relative:t})},i=li();if(n==null){a.search=i.search;let o=new URLSearchParams(a.search),l=o.getAll("index");if(l.some(d=>d==="")){o.delete("index"),l.filter(f=>f).forEach(f=>o.append("index",f));let d=o.toString();a.search=d?`?${d}`:""}}return(!n||n===".")&&r.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(a.pathname=a.pathname==="/"?e:Ya([e,a.pathname])),Yd(a)}function cG(n,t={}){let e=nt.useContext(oO);qe(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=gO("useViewTransitionState"),r=Rf(n,{relative:t.relative});if(!e.isTransitioning)return!1;let a=Qa(e.currentLocation.pathname,s)||e.currentLocation.pathname,i=Qa(e.nextLocation.pathname,s)||e.nextLocation.pathname;return Sy(r.pathname,i)!=null||Sy(r.pathname,a)!=null}new TextEncoder;function Bd(){return Bd=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s])}return n},Bd.apply(this,arguments)}const Qd={origin:[0,0,0],round:4},Vd={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function PI(n){let t=n.pathValue[n.segmentStart],e=t.toLowerCase();const{data:s}=n;for(;s.length>=Vd[e]&&(e==="m"&&s.length>2?(n.segments.push([t,...s.splice(0,2)]),e="l",t=t==="m"?"l":"L"):n.segments.push([t,...s.splice(0,Vd[e])]),Vd[e]););}const qa="SVGPathCommander error";function hG(n){const{index:t,pathValue:e}=n,s=e.charCodeAt(t);return s===48?(n.param=0,void(n.index+=1)):s===49?(n.param=1,void(n.index+=1)):void(n.err=`${qa}: invalid Arc flag "${e[t]}", expecting 0 or 1 at index ${t}`)}function $u(n){return n>=48&&n<=57}const Au="Invalid path value";function dG(n){const{max:t,pathValue:e,index:s}=n;let r,a=s,i=!1,o=!1,l=!1,c=!1;if(a>=t)n.err=`${qa}: ${Au} at index ${a}, "pathValue" is missing param`;else if(r=e.charCodeAt(a),r!==43&&r!==45||(a+=1,r=e.charCodeAt(a)),$u(r)||r===46){if(r!==46){if(i=r===48,a+=1,r=e.charCodeAt(a),i&&a<t&&r&&$u(r))return void(n.err=`${qa}: ${Au} at index ${s}, "${e[s]}" illegal number`);for(;a<t&&$u(e.charCodeAt(a));)a+=1,o=!0;r=e.charCodeAt(a)}if(r===46){for(c=!0,a+=1;$u(e.charCodeAt(a));)a+=1,l=!0;r=e.charCodeAt(a)}if(r===101||r===69){if(c&&!o&&!l)return void(n.err=`${qa}: ${Au} at index ${a}, "${e[a]}" invalid float exponent`);if(a+=1,r=e.charCodeAt(a),r!==43&&r!==45||(a+=1),!(a<t&&$u(e.charCodeAt(a))))return void(n.err=`${qa}: ${Au} at index ${a}, "${e[a]}" invalid integer exponent`);for(;a<t&&$u(e.charCodeAt(a));)a+=1}n.index=a,n.param=+n.pathValue.slice(s,a)}else n.err=`${qa}: ${Au} at index ${a}, "${e[a]}" is not a number`}function Ud(n){const{pathValue:t,max:e}=n;for(;n.index<e&&((s=t.charCodeAt(n.index))===10||s===13||s===8232||s===8233||s===32||s===9||s===11||s===12||s===160||s>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(s));)n.index+=1;var s}function fG(n){return n>=48&&n<=57||n===43||n===45||n===46}function yO(n){const{max:t,pathValue:e,index:s}=n,r=e.charCodeAt(s),a=Vd[e[s].toLowerCase()];if(n.segmentStart=s,function(i){switch(32|i){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}(r))if(n.index+=1,Ud(n),n.data=[],a){for(;;){for(let i=a;i>0;i-=1){if((32|r)!=97||i!==3&&i!==4?dG(n):hG(n),n.err.length)return;n.data.push(n.param),Ud(n),n.index<t&&e.charCodeAt(n.index)===44&&(n.index+=1,Ud(n))}if(n.index>=n.max||!fG(e.charCodeAt(n.index)))break}PI(n)}else PI(n);else n.err=`${qa}: ${Au} "${e[s]}" is not a path command`}function Wr(n){return n.map(t=>Array.isArray(t)?[...t]:t)}function bO(n){this.segments=[],this.pathValue=n,this.max=n.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}function l0(n){return Array.isArray(n)&&n.every(t=>{const e=t[0].toLowerCase();return Vd[e]===t.length-1&&"achlmqstvz".includes(e)})}function Yi(n){if(l0(n))return Wr(n);const t=new bO(n);for(Ud(t);t.index<t.max&&!t.err.length;)yO(t);return t.err?t.err:t.segments}function r2(n){return l0(n)&&n.every(([t])=>t===t.toUpperCase())}function cc(n){if(r2(n))return Wr(n);const t=Yi(n);let e=0,s=0,r=0,a=0;return t.map(i=>{const o=i.slice(1).map(Number),[l]=i,c=l.toUpperCase();if(l==="M")return[e,s]=o,r=e,a=s,["M",e,s];let d=[];if(l!==c)switch(c){case"A":d=[c,o[0],o[1],o[2],o[3],o[4],o[5]+e,o[6]+s];break;case"V":d=[c,o[0]+s];break;case"H":d=[c,o[0]+e];break;default:d=[c,...o.map((m,g)=>m+(g%2?s:e))]}else d=[c,...o];const f=d.length;switch(c){case"Z":e=r,s=a;break;case"H":[,e]=d;break;case"V":[,s]=d;break;default:e=d[f-2],s=d[f-1],c==="M"&&(r=e,a=s)}return d})}function xO(n){return l0(n)&&n.slice(1).every(([t])=>t===t.toLowerCase())}function a2(n){if(xO(n))return Wr(n);const t=Yi(n);let e=0,s=0,r=0,a=0;return t.map(i=>{const o=i.slice(1).map(Number),[l]=i,c=l.toLowerCase();if(l==="M")return[e,s]=o,r=e,a=s,["M",e,s];let d=[];if(l!==c)switch(c){case"a":d=[c,o[0],o[1],o[2],o[3],o[4],o[5]-e,o[6]-s];break;case"v":d=[c,o[0]-s];break;case"h":d=[c,o[0]-e];break;default:d=[c,...o.map((m,g)=>m-(g%2?s:e))]}else l==="m"&&(r=o[0]+e,a=o[1]+s),d=[c,...o];const f=d.length;switch(c){case"z":e=r,s=a;break;case"h":e+=d[1];break;case"v":s+=d[1];break;default:e+=d[f-2],s+=d[f-1]}return d})}function _w(n,t,e){if(n[e].length>7){n[e].shift();const s=n[e];let r=e;for(;s.length;)t[e]="A",n.splice(r+=1,0,["C",...s.splice(0,6)]);n.splice(e,1)}}function i2(n){return r2(n)&&n.every(([t])=>"ACLMQZ".includes(t))}function vO(n){return i2(n)&&n.every(([t])=>"MC".includes(t))}function pG(n,t){const[e]=n,{x1:s,y1:r,x2:a,y2:i}=t,o=n.slice(1).map(Number);let l=n;if("TQ".includes(e)||(t.qx=null,t.qy=null),e==="H")l=["L",n[1],r];else if(e==="V")l=["L",s,n[1]];else if(e==="S"){const c=2*s-a,d=2*r-i;t.x1=c,t.y1=d,l=["C",c,d,...o]}else if(e==="T"){const c=2*s-t.qx,d=2*r-t.qy;t.qx=c,t.qy=d,l=["Q",c,d,...o]}else if(e==="Q"){const[c,d]=o;t.qx=c,t.qy=d}return l}const u0={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Ja(n){if(i2(n))return Wr(n);const t=cc(n),e={...u0},s=t.length;for(let r=0;r<s;r+=1){t[r],t[r]=pG(t[r],e);const a=t[r],i=a.length;e.x1=+a[i-2],e.y1=+a[i-1],e.x2=+a[i-4]||e.x1,e.y2=+a[i-3]||e.y1}return t}function Lg(n,t,e){return{x:n*Math.cos(e)-t*Math.sin(e),y:n*Math.sin(e)+t*Math.cos(e)}}function wO(n,t,e,s,r,a,i,o,l,c){let d=n,f=t,m=e,g=s,b=o,x=l;const v=120*Math.PI/180,w=Math.PI/180*(+r||0);let T,C,k,$,I,D=[];if(c)[C,k,$,I]=c;else{T=Lg(d,f,-w),d=T.x,f=T.y,T=Lg(b,x,-w),b=T.x,x=T.y;const j=(d-b)/2,rt=(f-x)/2;let st=j*j/(m*m)+rt*rt/(g*g);st>1&&(st=Math.sqrt(st),m*=st,g*=st);const mt=m*m,gt=g*g,bt=(a===i?-1:1)*Math.sqrt(Math.abs((mt*gt-mt*rt*rt-gt*j*j)/(mt*rt*rt+gt*j*j)));$=bt*m*rt/g+(d+b)/2,I=bt*-g*j/m+(f+x)/2,C=Math.asin(((f-I)/g*10**9>>0)/10**9),k=Math.asin(((x-I)/g*10**9>>0)/10**9),C=d<$?Math.PI-C:C,k=b<$?Math.PI-k:k,C<0&&(C=2*Math.PI+C),k<0&&(k=2*Math.PI+k),i&&C>k&&(C-=2*Math.PI),!i&&k>C&&(k-=2*Math.PI)}let _=k-C;if(Math.abs(_)>v){const j=k,rt=b,st=x;k=C+v*(i&&k>C?1:-1),b=$+m*Math.cos(k),x=I+g*Math.sin(k),D=wO(b,x,m,g,r,0,i,rt,st,[k,j,$,I])}_=k-C;const O=Math.cos(C),L=Math.sin(C),R=Math.cos(k),V=Math.sin(k),Y=Math.tan(_/4),Q=4/3*m*Y,tt=4/3*g*Y,B=[d,f],W=[d+Q*L,f-tt*O],X=[b+Q*V,x-tt*R],ot=[b,x];if(W[0]=2*B[0]-W[0],W[1]=2*B[1]-W[1],c)return[...W,...X,...ot,...D];D=[...W,...X,...ot,...D];const P=[];for(let j=0,rt=D.length;j<rt;j+=1)P[j]=j%2?Lg(D[j-1],D[j],w).y:Lg(D[j],D[j+1],w).x;return P}function mG(n,t,e,s,r,a){const i=.3333333333333333,o=2/3;return[i*n+o*e,i*t+o*s,i*r+o*e,i*a+o*s,r,a]}function Ru(n,t,e){const[s,r]=n,[a,i]=t;return[s+(a-s)*e,r+(i-r)*e]}function c0(n,t){return Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1]))}function Jd(n,t,e,s,r){const a=c0([n,t],[e,s]);let i={x:0,y:0};if(typeof r=="number")if(r<=0)i={x:n,y:t};else if(r>=a)i={x:e,y:s};else{const[o,l]=Ru([n,t],[e,s],r/a);i={x:o,y:l}}return{length:a,point:i,min:{x:Math.min(n,e),y:Math.min(t,s)},max:{x:Math.max(n,e),y:Math.max(t,s)}}}function BI(n,t,e,s){const a=[n,t],i=[e,s],o=Ru(a,i,.5),l=Ru(i,o,.5),c=Ru(o,l,.5),d=Ru(l,c,.5),f=Ru(c,d,.5),m=Jd(...a,...o,...c,...f,.5).point,g=Jd(...f,...d,...l,...i,0).point;return[m.x,m.y,g.x,g.y,e,s]}function ay(n,t){const[e]=n,s=n.slice(1).map(Number),[r,a]=s;let i;const{x1:o,y1:l,x:c,y:d}=t;switch("TQ".includes(e)||(t.qx=null,t.qy=null),e){case"M":return t.x=r,t.y=a,n;case"A":return i=[o,l,...s],["C",...wO(...i)];case"Q":return t.qx=r,t.qy=a,i=[o,l,...s],["C",...mG(...i)];case"L":return["C",...BI(o,l,r,a)];case"Z":return["C",...BI(o,l,c,d)]}return n}function Ty(n){if(vO(n))return Wr(n);const t=Ja(n),e={...u0},s=[];let r="",a=t.length;for(let i=0;i<a;i+=1){[r]=t[i],s[i]=r,t[i]=ay(t[i],e),_w(t,s,i),a=t.length;const o=t[i],l=o.length;e.x1=+o[l-2],e.y1=+o[l-1],e.x2=+o[l-4]||e.x1,e.y2=+o[l-3]||e.y1}return t}function Ny(n,t){let{round:e}=Qd;if(t==="off"||e==="off")return Wr(n);e=t>=0?t:e;const s=typeof e=="number"&&e>=1?10**e:1;return n.map(r=>{const a=r.slice(1).map(Number).map(i=>e?Math.round(i*s)/s:Math.round(i));return[r[0],...a]})}function Ho(n,t){return Ny(n,t).map(e=>e[0]+e.slice(1).join(" ")).join("")}function iy(n){const t=cc(n),e=t.slice(-1)[0][0]==="Z",s=Ja(t).map((r,a)=>{const[i,o]=r.slice(-2).map(Number);return{seg:t[a],n:r,c:t[a][0],x:i,y:o}}).map((r,a,i)=>{const o=r.seg,l=r.n,c=a&&i[a-1],d=i[a+1],f=r.c,m=i.length,g=a?i[a-1].x:i[m-1].x,b=a?i[a-1].y:i[m-1].y;let x=[];switch(f){case"M":x=e?["Z"]:[f,g,b];break;case"A":x=[f,...o.slice(1,-3),o[5]===1?0:1,g,b];break;case"C":x=d&&d.c==="S"?["S",o[1],o[2],g,b]:[f,o[3],o[4],o[1],o[2],g,b];break;case"S":x=!c||!"CS".includes(c.c)||d&&d.c==="S"?[f,l[1],l[2],g,b]:["C",l[3],l[4],l[1],l[2],g,b];break;case"Q":x=d&&d.c==="T"?["T",g,b]:[f,...o.slice(1,-2),g,b];break;case"T":x=!c||!"QT".includes(c.c)||d&&d.c==="T"?[f,g,b]:["Q",l[1],l[2],g,b];break;case"Z":x=["M",g,b];break;case"H":x=[f,g];break;case"V":x=[f,b];break;default:x=[f,...o.slice(1,-2),g,b]}return x});return e?s.reverse():[s[0],...s.slice(1).reverse()]}function SO(n){const t=[];let e,s=-1;return n.forEach(r=>{r[0]==="M"?(e=[r],s+=1):e=[...e,r],t[s]=e}),t}function gG(n,t,e,s){const[r]=n,a=w=>Math.round(1e4*w)/1e4,i=n.slice(1).map(w=>+w),o=t.slice(1).map(w=>+w),{x1:l,y1:c,x2:d,y2:f,x:m,y:g}=e;let b=n;const[x,v]=o.slice(-2);if("TQ".includes(r)||(e.qx=null,e.qy=null),["V","H","S","T","Z"].includes(r))b=[r,...i];else if(r==="L")a(m)===a(x)?b=["V",v]:a(g)===a(v)&&(b=["H",x]);else if(r==="C"){const[w,T]=o;"CS".includes(s)&&(a(w)===a(2*l-d)&&a(T)===a(2*c-f)||a(l)===a(2*d-m)&&a(c)===a(2*f-g))&&(b=["S",...o.slice(-4)]),e.x1=w,e.y1=T}else if(r==="Q"){const[w,T]=o;e.qx=w,e.qy=T,"QT".includes(s)&&(a(w)===a(2*l-d)&&a(T)===a(2*c-f)||a(l)===a(2*d-m)&&a(c)===a(2*f-g))&&(b=["T",...o.slice(-2)])}return b}function TO(n,t){const e=cc(n),s=Ja(e),r={...u0},a=[],i=e.length;let o="",l="",c=0,d=0,f=0,m=0;for(let x=0;x<i;x+=1){[o]=e[x],a[x]=o,x&&(l=a[x-1]),e[x]=gG(e[x],s[x],r,l);const v=e[x],w=v.length;switch(r.x1=+v[w-2],r.y1=+v[w-1],r.x2=+v[w-4]||r.x1,r.y2=+v[w-3]||r.y1,o){case"Z":c=f,d=m;break;case"H":[,c]=v;break;case"V":[,d]=v;break;default:[c,d]=v.slice(-2).map(Number),o==="M"&&(f=c,m=d)}r.x=c,r.y=d}const g=Ny(e,t),b=Ny(a2(e),t);return g.map((x,v)=>v?x.join("").length<b[v].join("").length?x:b[v]:x)}function Df(n){const t=new Ps,e=Array.from(n);if(!e.every(s=>!Number.isNaN(s)))throw TypeError(`CSSMatrix: "${n}" must only have numbers.`);if(e.length===16){const[s,r,a,i,o,l,c,d,f,m,g,b,x,v,w,T]=e;t.m11=s,t.a=s,t.m21=o,t.c=o,t.m31=f,t.m41=x,t.e=x,t.m12=r,t.b=r,t.m22=l,t.d=l,t.m32=m,t.m42=v,t.f=v,t.m13=a,t.m23=c,t.m33=g,t.m43=w,t.m14=i,t.m24=d,t.m34=b,t.m44=T}else{if(e.length!==6)throw new TypeError("CSSMatrix: expecting an Array of 6/16 values.");{const[s,r,a,i,o,l]=e;t.m11=s,t.a=s,t.m12=r,t.b=r,t.m21=a,t.c=a,t.m22=i,t.d=i,t.m41=o,t.e=o,t.m42=l,t.f=l}}return t}function NO(n){const t=Object.keys(new Ps);if(typeof n=="object"&&t.every(e=>e in n))return Df([n.m11,n.m12,n.m13,n.m14,n.m21,n.m22,n.m23,n.m24,n.m31,n.m32,n.m33,n.m34,n.m41,n.m42,n.m43,n.m44]);throw TypeError(`CSSMatrix: "${JSON.stringify(n)}" is not a DOMMatrix / CSSMatrix / JSON compatible object.`)}function CO(n){if(typeof n!="string")throw TypeError(`CSSMatrix: "${n}" is not a string.`);const t=String(n).replace(/\s/g,"");let e=new Ps;const s=`CSSMatrix: invalid transform string "${n}"`;return t.split(")").filter(r=>r).forEach(r=>{const[a,i]=r.split("(");if(!i)throw TypeError(s);const o=i.split(",").map(b=>b.includes("rad")?parseFloat(b)*(180/Math.PI):parseFloat(b)),[l,c,d,f]=o,m=[l,c,d],g=[l,c,d,f];if(a==="perspective"&&l&&[c,d].every(b=>b===void 0))e.m34=-1/l;else if(a.includes("matrix")&&[6,16].includes(o.length)&&o.every(b=>!Number.isNaN(+b))){const b=o.map(x=>Math.abs(x)<1e-6?0:x);e=e.multiply(Df(b))}else if(a==="translate3d"&&m.every(b=>!Number.isNaN(+b)))e=e.translate(l,c,d);else if(a==="translate"&&l&&d===void 0)e=e.translate(l,c||0,0);else if(a==="rotate3d"&&g.every(b=>!Number.isNaN(+b))&&f)e=e.rotateAxisAngle(l,c,d,f);else if(a==="rotate"&&l&&[c,d].every(b=>b===void 0))e=e.rotate(0,0,l);else if(a==="scale3d"&&m.every(b=>!Number.isNaN(+b))&&m.some(b=>b!==1))e=e.scale(l,c,d);else if(a!=="scale"||Number.isNaN(l)||l===1||d!==void 0)if(a==="skew"&&(l||!Number.isNaN(l)&&c)&&d===void 0)e=e.skew(l,c||0);else{if(!(/[XYZ]/.test(a)&&l&&[c,d].every(b=>b===void 0)&&["translate","rotate","scale","skew"].some(b=>a.includes(b))))throw TypeError(s);if(["skewX","skewY"].includes(a))e=e[a](l);else{const b=a.replace(/[XYZ]/,""),x=a.replace(b,""),v=["X","Y","Z"].indexOf(x),w=b==="scale"?1:0,T=[v===0?l:w,v===1?l:w,v===2?l:w];e=e[b](...T)}}else{const b=Number.isNaN(+c)?l:c;e=e.scale(l,b,1)}}),e}function Fw(n,t){return t?[n.a,n.b,n.c,n.d,n.e,n.f]:[n.m11,n.m12,n.m13,n.m14,n.m21,n.m22,n.m23,n.m24,n.m31,n.m32,n.m33,n.m34,n.m41,n.m42,n.m43,n.m44]}function o2(n,t,e){const s=new Ps;return s.m41=n,s.e=n,s.m42=t,s.f=t,s.m43=e,s}function kO(n,t,e){const s=new Ps,r=Math.PI/180,a=n*r,i=t*r,o=e*r,l=Math.cos(a),c=-Math.sin(a),d=Math.cos(i),f=-Math.sin(i),m=Math.cos(o),g=-Math.sin(o),b=d*m,x=-d*g;s.m11=b,s.a=b,s.m12=x,s.b=x,s.m13=f;const v=c*f*m+l*g;s.m21=v,s.c=v;const w=l*m-c*f*g;return s.m22=w,s.d=w,s.m23=-c*d,s.m31=c*g-l*f*m,s.m32=c*m+l*f*g,s.m33=l*d,s}function $O(n,t,e,s){const r=new Ps,a=Math.sqrt(n*n+t*t+e*e);if(a===0)return r;const i=n/a,o=t/a,l=e/a,c=s*(Math.PI/360),d=Math.sin(c),f=Math.cos(c),m=d*d,g=i*i,b=o*o,x=l*l,v=1-2*(b+x)*m;r.m11=v,r.a=v;const w=2*(i*o*m+l*d*f);r.m12=w,r.b=w,r.m13=2*(i*l*m-o*d*f);const T=2*(o*i*m-l*d*f);r.m21=T,r.c=T;const C=1-2*(x+g)*m;return r.m22=C,r.d=C,r.m23=2*(o*l*m+i*d*f),r.m31=2*(l*i*m+o*d*f),r.m32=2*(l*o*m-i*d*f),r.m33=1-2*(g+b)*m,r}function EO(n,t,e){const s=new Ps;return s.m11=n,s.a=n,s.m22=t,s.d=t,s.m33=e,s}function h0(n,t){const e=new Ps;if(n){const s=n*Math.PI/180,r=Math.tan(s);e.m21=r,e.c=r}if(t){const s=t*Math.PI/180,r=Math.tan(s);e.m12=r,e.b=r}return e}function IO(n){return h0(n,0)}function AO(n){return h0(0,n)}function Wa(n,t){return Df([t.m11*n.m11+t.m12*n.m21+t.m13*n.m31+t.m14*n.m41,t.m11*n.m12+t.m12*n.m22+t.m13*n.m32+t.m14*n.m42,t.m11*n.m13+t.m12*n.m23+t.m13*n.m33+t.m14*n.m43,t.m11*n.m14+t.m12*n.m24+t.m13*n.m34+t.m14*n.m44,t.m21*n.m11+t.m22*n.m21+t.m23*n.m31+t.m24*n.m41,t.m21*n.m12+t.m22*n.m22+t.m23*n.m32+t.m24*n.m42,t.m21*n.m13+t.m22*n.m23+t.m23*n.m33+t.m24*n.m43,t.m21*n.m14+t.m22*n.m24+t.m23*n.m34+t.m24*n.m44,t.m31*n.m11+t.m32*n.m21+t.m33*n.m31+t.m34*n.m41,t.m31*n.m12+t.m32*n.m22+t.m33*n.m32+t.m34*n.m42,t.m31*n.m13+t.m32*n.m23+t.m33*n.m33+t.m34*n.m43,t.m31*n.m14+t.m32*n.m24+t.m33*n.m34+t.m34*n.m44,t.m41*n.m11+t.m42*n.m21+t.m43*n.m31+t.m44*n.m41,t.m41*n.m12+t.m42*n.m22+t.m43*n.m32+t.m44*n.m42,t.m41*n.m13+t.m42*n.m23+t.m43*n.m33+t.m44*n.m43,t.m41*n.m14+t.m42*n.m24+t.m43*n.m34+t.m44*n.m44])}class Ps{constructor(...t){const e=this;if(e.a=1,e.b=0,e.c=0,e.d=1,e.e=0,e.f=0,e.m11=1,e.m12=0,e.m13=0,e.m14=0,e.m21=0,e.m22=1,e.m23=0,e.m24=0,e.m31=0,e.m32=0,e.m33=1,e.m34=0,e.m41=0,e.m42=0,e.m43=0,e.m44=1,t.length){const s=[16,6].some(r=>r===t.length)?t:t[0];return e.setMatrixValue(s)}return e}get isIdentity(){const t=this;return t.m11===1&&t.m12===0&&t.m13===0&&t.m14===0&&t.m21===0&&t.m22===1&&t.m23===0&&t.m24===0&&t.m31===0&&t.m32===0&&t.m33===1&&t.m34===0&&t.m41===0&&t.m42===0&&t.m43===0&&t.m44===1}get is2D(){const t=this;return t.m31===0&&t.m32===0&&t.m33===1&&t.m34===0&&t.m43===0&&t.m44===1}setMatrixValue(t){return typeof t=="string"&&t.length&&t!=="none"?CO(t):[Array,Float64Array,Float32Array].some(e=>t instanceof e)?Df(t):[Ps,DOMMatrix,Object].some(e=>t instanceof e)?NO(t):this}toFloat32Array(t){return Float32Array.from(Fw(this,t))}toFloat64Array(t){return Float64Array.from(Fw(this,t))}toString(){const{is2D:t}=this;return`${t?"matrix":"matrix3d"}(${this.toFloat64Array(t).join(", ")})`}toJSON(){const{is2D:t,isIdentity:e}=this;return{...this,is2D:t,isIdentity:e}}multiply(t){return Wa(this,t)}translate(t,e,s){let r=e,a=s;return r===void 0&&(r=0),a===void 0&&(a=0),Wa(this,o2(t,r,a))}scale(t,e,s){let r=e,a=s;return r===void 0&&(r=t),a===void 0&&(a=1),Wa(this,EO(t,r,a))}rotate(t,e,s){let r=t,a=e||0,i=s||0;return typeof t=="number"&&e===void 0&&s===void 0&&(i=r,r=0,a=0),Wa(this,kO(r,a,i))}rotateAxisAngle(t,e,s,r){if([t,e,s,r].some(a=>Number.isNaN(+a)))throw new TypeError("CSSMatrix: expecting 4 values");return Wa(this,$O(t,e,s,r))}skewX(t){return Wa(this,IO(t))}skewY(t){return Wa(this,AO(t))}skew(t,e){return Wa(this,h0(t,e))}transformPoint(t){const e=this,s=e.m11*t.x+e.m21*t.y+e.m31*t.z+e.m41*t.w,r=e.m12*t.x+e.m22*t.y+e.m32*t.z+e.m42*t.w,a=e.m13*t.x+e.m23*t.y+e.m33*t.z+e.m43*t.w,i=e.m14*t.x+e.m24*t.y+e.m34*t.z+e.m44*t.w;return t instanceof DOMPoint?new DOMPoint(s,r,a,i):{x:s,y:r,z:a,w:i}}}Object.assign(Ps,{Translate:o2,Rotate:kO,RotateAxisAngle:$O,Scale:EO,SkewX:IO,SkewY:AO,Skew:h0,Multiply:Wa,fromArray:Df,fromMatrix:NO,fromString:CO,toArray:Fw});function VI(n,t,e){const[s,r,a]=e,[i,o,l]=function(f,m){let g=o2(...m);return[,,,g.m44]=m,g=f.multiply(g),[g.m41,g.m42,g.m43,g.m44]}(n,[...t,0,1]),c=o-r,d=l-a;return[(i-s)*(Math.abs(a)/Math.abs(d)||1)+s,c*(Math.abs(a)/Math.abs(d)||1)+r]}function RO(n,t){let e,s,r,a,i,o,l=0,c=0;const d=cc(n),f=t&&Object.keys(t);if(!t||!f.length)return Wr(d);const m=Ja(d);if(!t.origin){const{origin:$}=Qd;Object.assign(t,{origin:$})}const g=function($){let I=new Ps;const{origin:D}=$,[_,O]=D,{translate:L}=$,{rotate:R}=$,{skew:V}=$,{scale:Y}=$;return Array.isArray(L)&&L.every(Q=>!Number.isNaN(+Q))&&L.some(Q=>Q!==0)?I=I.translate(...L):typeof L!="number"||Number.isNaN(L)||(I=I.translate(L)),(R||V||Y)&&(I=I.translate(_,O),Array.isArray(R)&&R.every(Q=>!Number.isNaN(+Q))&&R.some(Q=>Q!==0)?I=I.rotate(...R):typeof R!="number"||Number.isNaN(R)||(I=I.rotate(R)),Array.isArray(V)&&V.every(Q=>!Number.isNaN(+Q))&&V.some(Q=>Q!==0)?(I=V[0]?I.skewX(V[0]):I,I=V[1]?I.skewY(V[1]):I):typeof V!="number"||Number.isNaN(V)||(I=I.skewX(V)),Array.isArray(Y)&&Y.every(Q=>!Number.isNaN(+Q))&&Y.some(Q=>Q!==1)?I=I.scale(...Y):typeof Y!="number"||Number.isNaN(Y)||(I=I.scale(Y)),I=I.translate(-_,-O)),I}(t),{origin:b}=t,x={...u0};let v=[],w=0,T="",C=[];const k=[];if(!g.isIdentity){for(e=0,r=d.length;e<r;e+=1){v=d[e],d[e]&&([T]=v),k[e]=T,T==="A"&&(v=ay(m[e],x),d[e]=ay(m[e],x),_w(d,k,e),m[e]=ay(m[e],x),_w(m,k,e),r=Math.max(d.length,m.length)),v=m[e],w=v.length,x.x1=+v[w-2],x.y1=+v[w-1],x.x2=+v[w-4]||x.x1,x.y2=+v[w-3]||x.y1;const $={s:d[e],c:d[e][0],x:x.x1,y:x.y1};C=[...C,$]}return C.map($=>{switch(T=$.c,v=$.s,T){case"L":case"H":case"V":return[i,o]=VI(g,[$.x,$.y],b),l!==i&&c!==o?v=["L",i,o]:c===o?v=["H",i]:l===i&&(v=["V",o]),l=i,c=o,v;default:for(s=1,a=v.length;s<a;s+=2)[l,c]=VI(g,[+v[s],+v[s+1]],b),v[s]=l,v[s+1]=c;return v}})}return Wr(d)}function UI(n,t){const{x:e,y:s}=n,{x:r,y:a}=t,i=e*r+s*a,o=Math.sqrt((e**2+s**2)*(r**2+a**2));return(e*a-s*r<0?-1:1)*Math.acos(i/o)}function yG(n,t,e,s,r,a,i,o,l,c){const{abs:d,sin:f,cos:m,sqrt:g,PI:b}=Math;let x=d(e),v=d(s);const w=(r%360+360)%360*(b/180);if(n===o&&t===l)return{x:n,y:t};if(x===0||v===0)return Jd(n,t,o,l,c).point;const T=(n-o)/2,C=(t-l)/2,k=m(w)*T+f(w)*C,$=-f(w)*T+m(w)*C,I=k**2/x**2+$**2/v**2;I>1&&(x*=g(I),v*=g(I));let D=(x**2*v**2-x**2*$**2-v**2*k**2)/(x**2*$**2+v**2*k**2);D=D<0?0:D;const _=(a!==i?1:-1)*g(D),O=_*(x*$/v),L=_*(-v*k/x),R=m(w)*O-f(w)*L+(n+o)/2,V=f(w)*O+m(w)*L+(t+l)/2,Y={x:(k-O)/x,y:($-L)/v},Q=UI({x:1,y:0},Y);let tt=UI(Y,{x:(-k-O)/x,y:(-$-L)/v});!i&&tt>0?tt-=2*b:i&&tt<0&&(tt+=2*b),tt%=2*b;const B=Q+tt*c,W=x*m(B),X=v*f(B);return{x:m(w)*W-f(w)*X+R,y:f(w)*W+m(w)*X+V}}function bG(n,t,e,s,r,a,i,o,l,c){const d=typeof c=="number";let f=n,m=t,g=0,b=[f,m,g],x=[f,m],v=0,w={x:0,y:0},T=[{x:f,y:m}];d&&c<=0&&(w={x:f,y:m});for(let C=0;C<=300;C+=1){if(v=C/300,{x:f,y:m}=yG(n,t,e,s,r,a,i,o,l,v),T=[...T,{x:f,y:m}],g+=c0(x,[f,m]),x=[f,m],d&&g>c&&c>b[2]){const k=(g-c)/(g-b[2]);w={x:x[0]*(1-k)+b[0]*k,y:x[1]*(1-k)+b[1]*k}}b=[f,m,g]}return d&&c>=g&&(w={x:o,y:l}),{length:g,point:w,min:{x:Math.min(...T.map(C=>C.x)),y:Math.min(...T.map(C=>C.y))},max:{x:Math.max(...T.map(C=>C.x)),y:Math.max(...T.map(C=>C.y))}}}function xG(n,t,e,s,r,a,i,o,l){const c=1-l;return{x:c**3*n+3*c**2*l*e+3*c*l**2*r+l**3*i,y:c**3*t+3*c**2*l*s+3*c*l**2*a+l**3*o}}function vG(n,t,e,s,r,a,i,o,l){const c=typeof l=="number";let d=n,f=t,m=0,g=[d,f,m],b=[d,f],x=0,v={x:0,y:0},w=[{x:d,y:f}];c&&l<=0&&(v={x:d,y:f});for(let T=0;T<=300;T+=1){if(x=T/300,{x:d,y:f}=xG(n,t,e,s,r,a,i,o,x),w=[...w,{x:d,y:f}],m+=c0(b,[d,f]),b=[d,f],c&&m>l&&l>g[2]){const C=(m-l)/(m-g[2]);v={x:b[0]*(1-C)+g[0]*C,y:b[1]*(1-C)+g[1]*C}}g=[d,f,m]}return c&&l>=m&&(v={x:i,y:o}),{length:m,point:v,min:{x:Math.min(...w.map(T=>T.x)),y:Math.min(...w.map(T=>T.y))},max:{x:Math.max(...w.map(T=>T.x)),y:Math.max(...w.map(T=>T.y))}}}function wG(n,t,e,s,r,a,i){const o=1-i;return{x:o**2*n+2*o*i*e+i**2*r,y:o**2*t+2*o*i*s+i**2*a}}function SG(n,t,e,s,r,a,i){const o=typeof i=="number";let l=n,c=t,d=0,f=[l,c,d],m=[l,c],g=0,b={x:0,y:0},x=[{x:l,y:c}];o&&i<=0&&(b={x:l,y:c});for(let v=0;v<=300;v+=1){if(g=v/300,{x:l,y:c}=wG(n,t,e,s,r,a,g),x=[...x,{x:l,y:c}],d+=c0(m,[l,c]),m=[l,c],o&&d>i&&i>f[2]){const w=(d-i)/(d-f[2]);b={x:m[0]*(1-w)+f[0]*w,y:m[1]*(1-w)+f[1]*w}}f=[l,c,d]}return o&&i>=d&&(b={x:r,y:a}),{length:d,point:b,min:{x:Math.min(...x.map(v=>v.x)),y:Math.min(...x.map(v=>v.y))},max:{x:Math.max(...x.map(v=>v.x)),y:Math.max(...x.map(v=>v.y))}}}function d0(n,t){const e=Ja(n),s=typeof t=="number";let r,a,i,o=[],l=0,c=0,d=0,f=0,m=[],g=[],b=0,x={x:0,y:0},v=x,w=x,T=x,C=0;for(let k=0,$=e.length;k<$;k+=1)i=e[k],[a]=i,r=a==="M",o=r?o:[l,c,...i.slice(1)],r?([,d,f]=i,x={x:d,y:f},v=x,b=0,s&&t<.001&&(T=x)):a==="L"?{length:b,min:x,max:v,point:w}=Jd(...o,(t||0)-C):a==="A"?{length:b,min:x,max:v,point:w}=bG(...o,(t||0)-C):a==="C"?{length:b,min:x,max:v,point:w}=vG(...o,(t||0)-C):a==="Q"?{length:b,min:x,max:v,point:w}=SG(...o,(t||0)-C):a==="Z"&&(o=[l,c,d,f],{length:b,min:x,max:v,point:w}=Jd(...o,(t||0)-C)),s&&C<t&&C+b>=t&&(T=w),g=[...g,v],m=[...m,x],C+=b,[l,c]=a!=="Z"?i.slice(-2):[d,f];return s&&t>=C&&(T={x:l,y:c}),{length:C,point:T,min:{x:Math.min(...m.map(k=>k.x)),y:Math.min(...m.map(k=>k.y))},max:{x:Math.max(...g.map(k=>k.x)),y:Math.max(...g.map(k=>k.y))}}}function DO(n){if(!n)return{x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};const{min:{x:t,y:e},max:{x:s,y:r}}=d0(n),a=s-t,i=r-e;return{width:a,height:i,x:t,y:e,x2:s,y2:r,cx:t+a/2,cy:e+i/2,cz:Math.max(a,i)+Math.min(a,i)/2}}function Pu(n){return d0(n).length}function Wd(n,t){return d0(n,t).point}Object.assign(Ps,{Version:"1.0.3"});class oy{constructor(t,e){const s=e||{},r=t===void 0;if(r||!t.length)throw TypeError(`${qa}: "pathValue" is ${r?"undefined":"empty"}`);const a=Yi(t);if(typeof a=="string")throw TypeError(a);this.segments=a;const{width:i,height:o,cx:l,cy:c,cz:d}=this.getBBox(),{round:f,origin:m}=s;let g,b;if(f==="auto"){const x=`${Math.floor(Math.max(i,o))}`.length;g=x>=4?0:4-x}else Number.isInteger(f)||f==="off"?g=f:{round:g}=Qd;if(Array.isArray(m)&&m.length>=2){const[x,v,w]=m.map(Number);b=[Number.isNaN(x)?l:x,Number.isNaN(v)?c:v,Number.isNaN(w)?d:w]}else b=[l,c,d];return this.round=g,this.origin=b,this}getBBox(){return DO(this.segments)}getTotalLength(){return Pu(this.segments)}getPointAtLength(t){return Wd(this.segments,t)}toAbsolute(){const{segments:t}=this;return this.segments=cc(t),this}toRelative(){const{segments:t}=this;return this.segments=a2(t),this}toCurve(){const{segments:t}=this;return this.segments=Ty(t),this}reverse(t){this.toAbsolute();const{segments:e}=this,s=SO(e),r=s.length>1?s:0,a=r&&Wr(r).map((o,l)=>t?l?iy(o):Yi(o):iy(o));let i=[];return i=r?a.flat(1):t?e:iy(e),this.segments=Wr(i),this}normalize(){const{segments:t}=this;return this.segments=Ja(t),this}optimize(){const{segments:t}=this;return this.segments=TO(t,this.round),this}transform(t){if(!t||typeof t!="object"||typeof t=="object"&&!["translate","rotate","skew","scale"].some(l=>l in t))return this;const e={};Object.keys(t).forEach(l=>{e[l]=Array.isArray(t[l])?[...t[l]]:Number(t[l])});const{segments:s}=this,[r,a,i]=this.origin,{origin:o}=e;if(Array.isArray(o)&&o.length>=2){const[l,c,d]=o.map(Number);e.origin=[Number.isNaN(l)?r:l,Number.isNaN(c)?a:c,d||i]}else e.origin=[r,a,i];return this.segments=RO(s,e),this}flipX(){return this.transform({rotate:[0,180,0]}),this}flipY(){return this.transform({rotate:[180,0,0]}),this}toString(){return Ho(this.segments,this.round)}}function WI(n){let t=0,e=0,s=0;return Ty(n).map(r=>r[0]==="M"?([,t,e]=r,0):(s=function(a,i,o,l,c,d,f,m){return 3*((m-i)*(o+c)-(f-a)*(l+d)+l*(a-c)-o*(i-d)+m*(c+a/3)-f*(d+i/3))/20}(t,e,...r.slice(1)),[t,e]=r.slice(-2),s)).reduce((r,a)=>r+a,0)}function Lw(n,t){const e=Yi(n);if(typeof e=="string")throw TypeError(e);let s=[...e],r=Pu(s),a=s.length-1,i=0,o=0,l=e[0];const[c,d]=l.slice(-2),f={x:c,y:d};if(a<=0||!t||!Number.isFinite(t))return{segment:l,index:0,length:o,point:f,lengthAtSegment:i};if(t>=r)return s=e.slice(0,-1),i=Pu(s),o=r-i,{segment:e[a],index:a,length:o,lengthAtSegment:i};const m=[];for(;a>0;)l=s[a],s=s.slice(0,-1),i=Pu(s),o=r-i,r=i,m.push({segment:l,index:a,length:o,lengthAtSegment:i}),a-=1;return m.find(({lengthAtSegment:g})=>g<=t)}function Mg(n,t){const e=Yi(n),s=Ja(e),r=Pu(e),a=C=>{const k=C.x-t.x,$=C.y-t.y;return k*k+$*$};let i,o,l,c,d=8,f=0,m=0,g=1/0;for(let C=0;C<=r;C+=d)i=Wd(s,C),f=a(i),f<g&&(o=i,m=C,g=f);d/=2;let b=0,x=0,v=0,w=0;for(;d>.5;)b=m-d,l=Wd(s,b),v=a(l),x=m+d,c=Wd(s,x),w=a(c),b>=0&&v<g?(o=l,m=b,g=v):x<=r&&w<g?(o=c,m=x,g=w):d/=2;const T=Lw(e,m);return{closest:o,distance:Math.sqrt(g),segment:T}}function GI(n){if(typeof n!="string")return!1;const t=new bO(n);for(Ud(t);t.index<t.max&&!t.err.length;)yO(t);return!t.err.length&&"mM".includes(t.segments[0][0])}const jI={line:["x1","y1","x2","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],rect:["width","height","x","y","rx","ry"],polygon:["points"],polyline:["points"],glyph:["d"]},TG={CSSMatrix:Ps,parsePathString:Yi,isPathArray:l0,isCurveArray:vO,isAbsoluteArray:r2,isRelativeArray:xO,isNormalizedArray:i2,isValidPath:GI,pathToAbsolute:cc,pathToRelative:a2,pathToCurve:Ty,pathToString:Ho,getDrawDirection:function(n){return WI(Ty(n))>=0},getPathArea:WI,getPathBBox:DO,pathLengthFactory:d0,getTotalLength:Pu,getPointAtLength:Wd,getClosestPoint:function(n,t){return Mg(n,t).closest},getSegmentOfPoint:function(n,t){return Mg(n,t).segment},getPropertiesAtPoint:Mg,getPropertiesAtLength:Lw,getSegmentAtLength:function(n,t){return Lw(n,t).segment},isPointInStroke:function(n,t){const{distance:e}=Mg(n,t);return Math.abs(e)<.001},clonePath:Wr,splitPath:SO,fixPath:function(n){const t=Yi(n),e=Ja(t),{length:s}=t,r=e.slice(-1)[0][0]==="Z",a=r?s-2:s-1,[i,o]=e[0].slice(1),[l,c]=e[a].slice(-2);return r&&i===l&&o===c?t.slice(0,-1):t},roundPath:Ny,optimizePath:TO,reverseCurve:function(n){const t=n.slice(1).map((e,s,r)=>s?[...r[s-1].slice(-2),...e.slice(1)]:[...n[0].slice(1),...e.slice(1)]).map(e=>e.map((s,r)=>e[e.length-r-2*(1-r%2)])).reverse();return[["M",...t[0].slice(0,2)],...t.map(e=>["C",...e.slice(2)])]},reversePath:iy,normalizePath:Ja,transformPath:RO,shapeToPath:function(n,t){const e=Object.keys(jI),{tagName:s}=n;if(s&&!e.some(d=>s===d))throw TypeError(`${qa}: "${s}" is not SVGElement`);const r=document.createElementNS("http://www.w3.org/2000/svg","path"),a=s||n.type,i={};i.type=a;const o=jI[a];let l;s?(o.forEach(d=>{i[d]=n.getAttribute(d)}),Object.values(n.attributes).forEach(({name:d,value:f})=>{o.includes(d)||r.setAttribute(d,f)})):(Object.assign(i,n),Object.keys(i).forEach(d=>{o.includes(d)||d==="type"||r.setAttribute(d.replace(/[A-Z]/g,f=>`-${f.toLowerCase()}`),i[d])}));const{round:c}=Qd;return a==="circle"?l=Ho(function(d){const{cx:f,cy:m,r:g}=d;return[["M",f-g,m],["a",g,g,0,1,0,2*g,0],["a",g,g,0,1,0,-2*g,0]]}(i),c):a==="ellipse"?l=Ho(function(d){const{cx:f,cy:m,rx:g,ry:b}=d;return[["M",f-g,m],["a",g,b,0,1,0,2*g,0],["a",g,b,0,1,0,-2*g,0]]}(i),c):["polyline","polygon"].includes(a)?l=Ho(function(d){const f=[],m=(d.points||"").trim().split(/[\s|,]/).map(Number);let g=0;for(;g<m.length;)f.push([g?"L":"M",m[g],m[g+1]]),g+=2;return d.type==="polygon"?[...f,["z"]]:f}(i),c):a==="rect"?l=Ho(function(d){const f=+d.x||0,m=+d.y||0,g=+d.width,b=+d.height;let x=+d.rx,v=+d.ry;return x||v?(x=x||v,v=v||x,2*x>g&&(x-=(2*x-g)/2),2*v>b&&(v-=(2*v-b)/2),[["M",f+x,m],["h",g-2*x],["s",x,0,x,v],["v",b-2*v],["s",0,v,-x,v],["h",2*x-g],["s",-x,0,-x,-v],["v",2*v-b],["s",0,-v,x,-v]]):[["M",f,m],["h",g],["v",b],["H",f],["Z"]]}(i),c):a==="line"?l=Ho(function(d){const{x1:f,y1:m,x2:g,y2:b}=d;return[["M",f,m],["L",g,b]]}(i),c):a==="glyph"&&(l=s?n.getAttribute("d"):n.d),!!GI(l)&&(r.setAttribute("d",l),t&&s&&(n.before(r,n),n.remove()),r)},options:Qd};Object.assign(oy,TG,{Version:"1.0.5"});const Vo=n=>n==null,OO=n=>{const{width:t,height:e,cx:s,cy:r,rx:a,ry:i,startOffset:o,reversed:l,text:c,svgProps:d,ellipseProps:f,textPathProps:m,textProps:g,tspanProps:b}=n,[x,v]=nt.useState(!1),w=nt.useId(),T=`ellipse-id${w.replaceAll(":","-").substring(0,w.length-1)}`,C=nt.useRef();if(nt.useEffect(()=>{if(C.current){const $={id:T,type:"ellipse",rx:a,ry:i,cx:s,cy:r,style:"fill: none;",...f},I=C.current,D=oy.shapeToPath($,!0),_=document.getElementById(T);if(_&&_.remove(),I.prepend(D),l){const O=D.getAttribute("d"),L=oy.reversePath(O),R=oy.pathToString(L);D.setAttribute("d",R)}v(!0)}},[C.current,l,t,e,d,s,r,a,i,f]),Vo(t))throw new Error("ReactCurvedText Error: width is required");if(Vo(e))throw new Error("ReactCurvedText Error: height is required");if(Vo(s))throw new Error("ReactCurvedText Error: cx is required");if(Vo(r))throw new Error("ReactCurvedText Error: cy is required");if(Vo(a))throw new Error("ReactCurvedText Error: rx is required");if(Vo(i))throw new Error("ReactCurvedText Error: ry is required");if(Vo(c))throw new Error("ReactCurvedText Error: text is required");const k=JSON.stringify({width:t,height:e,cx:s,cy:r,rx:a,ry:i,startOffset:o,reversed:l,text:c,svgProps:d,ellipseProps:f,textPathProps:m,textProps:g,tspanProps:b,rendered:x});return _g.createElement("svg",Bd({ref:C,height:e,width:t},d),_g.createElement("text",Bd({key:k},g),_g.createElement("textPath",Bd({xlinkHref:`#${T}`,startOffset:o},m),_g.createElement("tspan",b,c))))},NG=()=>q.jsx("div",{className:"pts-component",children:q.jsx("div",{className:"pts-wrapper",children:q.jsxs(Zd,{to:"/meditation_session",children:[q.jsx(OO,{width:250,height:250,cx:125,cy:125,rx:82.5,ry:82.5,startOffset:0,reversed:!0,text:"PRESS TO START PRESS TO START PRESS TO START PRESS TO START PRESS TO START PRESS TO START ",textProps:{style:{fontSize:10,fill:"white"},textLength:670,lengthAdjust:"spacing"},textPathProps:null,tspanProps:null,ellipseProps:null,svgProps:{className:"rotating-curved-text"}}),q.jsx("div",{className:"center-text",children:"Zen"})]})})});function CG({onClose:n}){return q.jsxs("div",{className:"instructions-comp",children:[q.jsx("div",{className:"dropdown",onMouseEnter:()=>setIsHovered(!0),onMouseLeave:()=>setIsHovered(!1),children:q.jsx("span",{children:"INSTRUCTIONS"})}),q.jsxs("div",{className:"dropdown-content",children:[q.jsx("p",{children:"1. Pick up the plant. "}),q.jsx("p",{children:"2. Put on the headphones. "}),q.jsx("p",{children:"3. Press Zen to start your meditation. "})]}),q.jsx("button",{className:"instruction-button",onClick:n,children:"Continue"})]})}function kG(){const[n,t]=nt.useState(!0),e=()=>{t(!1)};return q.jsxs("div",{className:"home-page",children:[q.jsx("div",{className:"home-background"}),n&&q.jsx("div",{className:"overlay",children:q.jsx(CG,{onClose:e})}),!n&&q.jsxs(q.Fragment,{children:[q.jsx("div",{className:"start-button",children:q.jsx(NG,{})}),q.jsx("div",{className:"title-container",children:q.jsx("h1",{className:"title-message",children:"Let's Meditate"})})]})]})}function _O({size:n=22,color:t="#2400FF"}){const s=n*.21568627450980393,r=n;return q.jsxs("svg",{height:r,width:s,viewBox:"0 0 22 102",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",className:"icon-svg",children:[q.jsx("path",{d:"M2.00977 2.32122V99.6613",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M11 2.32122V99.6613",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M19.9902 2.32122V99.6613",stroke:t,strokeLinecap:"round",strokeWidth:"3"})]})}function FO({size:n=102,color:t="#2400FF"}){return q.jsx("svg",{height:n,width:n,fill:"none",viewBox:"0 0 124 124",xmlns:"http://www.w3.org/2000/svg",children:q.jsx("path",{d:"M50.2295 43.1898C65.2821 42.974 96.2431 42.0243 99.6656 39.9524C103.944 37.3625 55.9336 53.5494 55.4583 52.2544C54.983 50.9595 102.518 54.1968 102.518 52.2544C102.518 50.312 45.9513 64.5565 43.0993 62.6141C40.2472 60.6716 97.7642 65.8514 98.2396 65.204C98.7149 64.5565 22.6594 77.506 21.7087 76.8585C20.758 76.211 100.141 72.3262 102.518 71.0312C104.894 69.7363 60.6872 84.6282 59.2611 83.9807C57.8351 83.3332 98.2395 83.9807 99.6656 83.9807",stroke:t,strokeLinecap:"round",strokeWidth:"3"})})}function LO({size:n=124,color:t="#2400FF"}){return q.jsxs("svg",{height:n,width:n,fill:"none",viewBox:"0 0 124 124",xmlns:"http://www.w3.org/2000/svg",children:[q.jsx("path",{d:"M41.8076 21.0712V102.911M61.5913 21.0712V102.911M82.1076 21.0712V99.2577",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("ellipse",{cx:"41.85",cy:"32.5412",fill:t,rx:"3.1",ry:"3.1"}),q.jsx("ellipse",{cx:"41.85",cy:"60.1312",fill:t,rx:"3.1",ry:"3.1"}),q.jsx("ellipse",{cx:"41.85",cy:"86.7913",fill:t,rx:"3.1",ry:"3.1"}),q.jsx("ellipse",{cx:"61.5775",cy:"29.4412",fill:t,rx:"3.1",ry:"3.1"}),q.jsx("ellipse",{cx:"82.1498",cy:"34.7112",fill:t,rx:"3.1",ry:"3.1"}),q.jsx("ellipse",{cx:"82.1498",cy:"58.2712",fill:t,rx:"3.1",ry:"3.1"}),q.jsx("ellipse",{cx:"82.1498",cy:"80.5912",fill:t,rx:"3.1",ry:"3.1"}),q.jsx("ellipse",{cx:"61.5775",cy:"51.3406",fill:t,rx:"3.1",ry:"3.21923"}),q.jsx("circle",{cx:"61.5775",cy:"75.1796",fill:t,r:"3.1"}),q.jsx("circle",{cx:"61.5775",cy:"94.7818",fill:t,r:"3.1"})]})}function MO({size:n=124,color:t="#2400FF"}){return q.jsxs("svg",{height:n,width:n,fill:"none",viewBox:"0 0 124 124",xmlns:"http://www.w3.org/2000/svg",children:[q.jsx("path",{d:"M15.5 46.5H108.5",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M15.5 62H108.5",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M15.5 77.5H108.5",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M27.9004 46.5V62",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M35.3398 62V77.5",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M58.9004 46.5V62",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M66.3398 62V77.5",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M89.9004 46.5V62",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M97.3398 62V77.5",stroke:t,strokeLinecap:"round",strokeWidth:"3"})]})}function zO({size:n=124,color:t="#2400FF"}){return q.jsxs("svg",{height:n,width:n,fill:"none",viewBox:"0 0 124 124",xmlns:"http://www.w3.org/2000/svg",children:[q.jsx("path",{d:"M80.8059 103.934C79.9988 82.1631 71.4965 41.0961 44.5381 30.623",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M76.8531 76.782C81.776 71.9334 84.2973 55.2541 79.6426 46.3326",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M68.3938 55.2541C59.7356 51.7233 53.0721 52.5388 45.7021 54.0904",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M78.4261 84.4494C71.109 85.1217 63.1572 81.0488 58.3086 76.3941",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M81.6346 43.3855C82.8113 45.7193 81.7515 46.9461 80.1007 47.7784C78.45 48.6107 76.8335 48.7334 75.6568 46.3996C74.4801 44.0658 74.1888 40.1593 75.8395 39.327C77.4902 38.4947 80.4579 41.0517 81.6346 43.3855Z",fill:t}),q.jsx("path",{d:"M45.3684 26.9706C48.3069 28.2708 48.2565 30.2633 47.3369 32.3418C46.4172 34.4203 44.9766 35.7977 42.038 34.4975C39.0995 33.1973 35.7758 29.7118 36.6955 27.6333C37.6151 25.5549 42.4299 25.6704 45.3684 26.9706Z",fill:t}),q.jsx("path",{d:"M59.2309 72.1609C60.6765 74.2118 59.8425 75.5258 58.3918 76.5483C56.9412 77.5708 55.4233 77.9146 53.9777 75.8637C52.5321 73.8128 51.7062 70.1439 53.1569 69.1214C54.6075 68.0989 57.7853 70.11 59.2309 72.1609Z",fill:t}),q.jsx("path",{d:"M42.5498 51.7029C45.0529 50.7544 46.1889 51.9653 46.8598 53.7359C47.5307 55.5064 47.4824 57.1661 44.9793 58.1146C42.4761 59.0631 38.4659 58.9412 37.795 57.1707C37.1241 55.4001 40.0466 52.6514 42.5498 51.7029Z",fill:t})]})}function PO({size:n=124,color:t="#2400FF"}){return q.jsx("svg",{height:n,width:n,fill:"none",viewBox:"0 0 124 124",xmlns:"http://www.w3.org/2000/svg",children:q.jsx("path",{d:"M27.435 44.64L98.425 43.4M27.435 58.435H93.93M26.04 71.61C48.515 71.0417 93.961 69.812 95.945 69.44M79.67 34.875V84.63M64.325 34.875V89.435M49.91 37.665V87.575M36.735 33.635V84.63",stroke:t,strokeLinecap:"round",strokeWidth:"3"})})}function BO({size:n=124,color:t="#2400FF"}){return q.jsxs("svg",{height:n,width:n,fill:"none",viewBox:"0 0 124 124",xmlns:"http://www.w3.org/2000/svg",children:[q.jsx("path",{d:"M39.3701 97.9522C40.3001 80.4372 53.4751 48.5072 70.2151 41.2222",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M70.37 41.2222L59.21 40.2922",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M70.4727 41.0393L64.209 31.7562",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M70.3358 40.9171L73.5586 30.1922",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M69.6627 40.5654L79.7861 35.7772",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M69.6656 40.7751L79.7383 45.6691",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("path",{d:"M69.8446 40.8126L72.4307 51.7086",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("circle",{cx:"58.7448",cy:"39.8272",fill:t,r:"2.945"}),q.jsx("circle",{cx:"80.4219",cy:"35.9465",fill:t,r:"2.945",transform:"rotate(149.923 80.4219 35.9465)"}),q.jsx("circle",{cx:"72.1333",cy:"52.2951",fill:t,r:"2.945",transform:"rotate(-108.115 72.1333 52.2951)"}),q.jsx("ellipse",{cx:"64.2806",cy:"31.1025",fill:t,rx:"2.945",ry:"2.945",transform:"rotate(51.2274 64.2806 31.1025)"}),q.jsx("ellipse",{cx:"74.1101",cy:"29.8336",fill:t,rx:"2.945",ry:"2.945",transform:"rotate(101.962 74.1101 29.8336)"}),q.jsx("ellipse",{cx:"80.0045",cy:"46.2706",fill:t,rx:"2.945",ry:"2.945",transform:"rotate(-158.85 80.0045 46.2706)"})]})}function VO({size:n=124,color:t="#2400FF"}){return q.jsxs("svg",{height:n,width:n,fill:"none",viewBox:"0 0 124 124",xmlns:"http://www.w3.org/2000/svg",children:[q.jsx("circle",{cx:"50.6847",cy:"50.685",r:"15.965",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("circle",{cx:"50.6847",cy:"73.315",r:"15.965",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("circle",{cx:"73.3146",cy:"50.685",r:"15.965",stroke:t,strokeLinecap:"round",strokeWidth:"3"}),q.jsx("circle",{cx:"73.3146",cy:"73.315",r:"15.965",stroke:t,strokeLinecap:"round",strokeWidth:"3"})]})}function UO({size:n=54,color:t="#2400FF"}){const e=1.4444444444444444,s=n,r=n*e;return q.jsxs("svg",{height:s,width:r,fill:"none",viewBox:"0 0 124 124",xmlns:"http://www.w3.org/2000/svg",children:[q.jsx("path",{d:"M25.4199 37.2L63.6977 65.3429L98.5799 37.2",stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3"}),q.jsx("path",{d:"M25.4199 44.3524L63.6977 72.4953L98.5799 44.3524",stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3"}),q.jsx("path",{d:"M25.4199 51.5047L63.6977 79.6476L98.5799 51.5047",stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3"}),q.jsx("path",{d:"M25.4199 58.657L63.6977 86.8L98.5799 58.657",stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3"})]})}function WO({size:n=124,color:t="#2400FF"}){return q.jsxs("svg",{height:n,width:n,fill:"none",viewBox:"0 0 124 124",xmlns:"http://www.w3.org/2000/svg",children:[q.jsx("ellipse",{cx:"39.3695",cy:"38.7422",fill:t,rx:"10.85",ry:"10.85"}),q.jsx("ellipse",{cx:"60.9146",cy:"66.7972",fill:t,rx:"3.565",ry:"3.565"}),q.jsx("ellipse",{cx:"83.8541",cy:"85.0872",fill:t,rx:"3.565",ry:"3.565"}),q.jsx("ellipse",{cx:"67.4248",cy:"40.7572",fill:t,rx:"6.665",ry:"6.665"}),q.jsx("ellipse",{cx:"89.5892",cy:"63.2322",fill:t,rx:"5.89",ry:"5.89"}),q.jsx("circle",{cx:"46.4991",cy:"88.6522",fill:t,r:"7.13"})]})}function GO({size:n,emotions:t,triggers:e}){const s=t.slice(0,3),r=e.slice(0,3),a=`radial-gradient(circle,${s.join(", ")})`,i=n/2.1,o=22/102,l=n*o,c={Family:q.jsx(_O,{size:i/1.2,color:"white"}),News:q.jsx(FO,{size:i,color:"white"}),Health:q.jsx(LO,{size:i,color:"white"}),Work:q.jsx(MO,{size:i,color:"white"}),Friends:q.jsx(zO,{size:i,color:"white"}),Participation:q.jsx(PO,{size:i,color:"white"}),Self:q.jsx(BO,{size:i,color:"white"}),Relationships:q.jsx(VO,{size:i,color:"white"}),Activities:q.jsx(UO,{size:i,color:"white"}),Independence:q.jsx(WO,{size:i,color:"white"})},d=Math.max(2,n/2e3),f=[{top:`${n*.03}px`,left:`${n*.5-i/2}px`},{bottom:`${n*.1}px`,left:`${n*.03}px`},{bottom:`${n*.1}px`,right:`${n*.03}px`}];return q.jsx("div",{style:{width:n,height:n,borderRadius:"50%",background:a,filter:`blur(${d})`,position:"relative"},children:r.map((m,g)=>{const b=c[m],x=m==="Family";let v=f[g];return x&&(g==0?v={top:`${n*.08}px`,left:`${n*.5-l/4}px`}:g==1?v={bottom:`${n*.15}px`,left:`${n*.2}px`}:g==2&&(v={bottom:`${n*.15}px`,right:`${n*.2}px`})),q.jsx("div",{className:"absolute w-8 h-8 flex items-center justify-center",style:{position:"absolute",...v},children:b},m)})})}function $G(){const[n,t]=nt.useState([]),[e,s]=nt.useState(0),r=nt.useRef(null),a=uc(),i=18,o=[];nt.useEffect(()=>{const f=localStorage.getItem("bubbles");f&&t(JSON.parse(f))},[]);for(let f=0;f<n.length;f+=i)o.push(n.slice(f,f+i));const l=f=>{const m=r.current;if(!m)return;const g=m.offsetWidth;m.scrollTo({left:g*f,behavior:"smooth"})},c=()=>{const f=r.current;if(!f)return;const m=f.offsetWidth,g=Math.round(f.scrollLeft/m);s(g)},d=()=>{a("/")};return q.jsxs("div",{className:"emotion-page",children:[q.jsx("div",{className:"emotion-page-background"}),n.length>0?q.jsx("div",{className:"bubbles-scroll-wrapper",ref:r,onScroll:c,children:o.map((f,m)=>q.jsx("div",{className:"bubble-page",children:f.map((g,b)=>q.jsxs("div",{className:"submitted-bubble",children:[q.jsx(GO,{size:150,emotions:g.emotions,triggers:g.triggers}),q.jsx("h4",{className:"bubble-name",children:g.name})]},b))},m))}):q.jsx("p",{className:"empty-message",children:"No session results to display."}),q.jsx("button",{className:"finished-button",onClick:()=>d(),children:"Done"}),q.jsx("div",{className:"page-indicator",children:o.map((f,m)=>q.jsx("span",{className:`dot ${m===e?"active":""}`,onClick:()=>l(m)},m))})]})}const l2=nt.createContext({});function u2(n){const t=nt.useRef(null);return t.current===null&&(t.current=n()),t.current}const c2=typeof window<"u",jO=c2?nt.useLayoutEffect:nt.useEffect,f0=nt.createContext(null),h2=nt.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class EG extends nt.Component{getSnapshotBeforeUpdate(t){const e=this.props.childRef.current;if(e&&t.isPresent&&!this.props.isPresent){const s=e.offsetParent,r=s instanceof HTMLElement&&s.offsetWidth||0,a=this.props.sizeRef.current;a.height=e.offsetHeight||0,a.width=e.offsetWidth||0,a.top=e.offsetTop,a.left=e.offsetLeft,a.right=r-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function IG({children:n,isPresent:t,anchorX:e}){const s=nt.useId(),r=nt.useRef(null),a=nt.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:i}=nt.useContext(h2);return nt.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:d,right:f}=a.current;if(t||!r.current||!o||!l)return;const m=e==="left"?`left: ${d}`:`right: ${f}`;r.current.dataset.motionPopId=s;const g=document.createElement("style");return i&&(g.nonce=i),document.head.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${m}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.removeChild(g)}},[t]),q.jsx(EG,{isPresent:t,childRef:r,sizeRef:a,children:nt.cloneElement(n,{ref:r})})}const AG=({children:n,initial:t,isPresent:e,onExitComplete:s,custom:r,presenceAffectsLayout:a,mode:i,anchorX:o})=>{const l=u2(RG),c=nt.useId();let d=!0,f=nt.useMemo(()=>(d=!1,{id:c,initial:t,isPresent:e,custom:r,onExitComplete:m=>{l.set(m,!0);for(const g of l.values())if(!g)return;s&&s()},register:m=>(l.set(m,!1),()=>l.delete(m))}),[e,l,s]);return a&&d&&(f={...f}),nt.useMemo(()=>{l.forEach((m,g)=>l.set(g,!1))},[e]),nt.useEffect(()=>{!e&&!l.size&&s&&s()},[e]),i==="popLayout"&&(n=q.jsx(IG,{isPresent:e,anchorX:o,children:n})),q.jsx(f0.Provider,{value:f,children:n})};function RG(){return new Map}function HO(n=!0){const t=nt.useContext(f0);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:s,register:r}=t,a=nt.useId();nt.useEffect(()=>{if(n)return r(a)},[n]);const i=nt.useCallback(()=>n&&s&&s(a),[a,s,n]);return!e&&s?[!1,i]:[!0]}const zg=n=>n.key||"";function HI(n){const t=[];return nt.Children.forEach(n,e=>{nt.isValidElement(e)&&t.push(e)}),t}const qI=({children:n,custom:t,initial:e=!0,onExitComplete:s,presenceAffectsLayout:r=!0,mode:a="sync",propagate:i=!1,anchorX:o="left"})=>{const[l,c]=HO(i),d=nt.useMemo(()=>HI(n),[n]),f=i&&!l?[]:d.map(zg),m=nt.useRef(!0),g=nt.useRef(d),b=u2(()=>new Map),[x,v]=nt.useState(d),[w,T]=nt.useState(d);jO(()=>{m.current=!1,g.current=d;for(let $=0;$<w.length;$++){const I=zg(w[$]);f.includes(I)?b.delete(I):b.get(I)!==!0&&b.set(I,!1)}},[w,f.length,f.join("-")]);const C=[];if(d!==x){let $=[...d];for(let I=0;I<w.length;I++){const D=w[I],_=zg(D);f.includes(_)||($.splice(I,0,D),C.push(D))}return a==="wait"&&C.length&&($=C),T(HI($)),v(d),null}const{forceRender:k}=nt.useContext(l2);return q.jsx(q.Fragment,{children:w.map($=>{const I=zg($),D=i&&!l?!1:d===w||f.includes(I),_=()=>{if(b.has(I))b.set(I,!0);else return;let O=!0;b.forEach(L=>{L||(O=!1)}),O&&(k==null||k(),T(g.current),i&&(c==null||c()),s&&s())};return q.jsx(AG,{isPresent:D,initial:!m.current||e?void 0:!1,custom:t,presenceAffectsLayout:r,mode:a,onExitComplete:D?void 0:_,anchorX:o,children:$},I)})})};function d2(n,t){n.indexOf(t)===-1&&n.push(t)}function f2(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const ti=(n,t,e)=>e>t?t:e<n?n:e;let p2=()=>{};const ei={},qO=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),KO=n=>/^0[^.\s]+$/u.test(n);function m2(n){let t;return()=>(t===void 0&&(t=n()),t)}const Tr=n=>n,DG=(n,t)=>e=>t(n(e)),Of=(...n)=>n.reduce(DG),tf=(n,t,e)=>{const s=t-n;return s===0?1:(e-n)/s};class g2{constructor(){this.subscriptions=[]}add(t){return d2(this.subscriptions,t),()=>f2(this.subscriptions,t)}notify(t,e,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,e,s);else for(let a=0;a<r;a++){const i=this.subscriptions[a];i&&i(t,e,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const la=n=>n*1e3,ua=n=>n/1e3;function XO(n,t){return t?n*(1e3/t):0}const YO=(n,t,e)=>(((1-3*e+3*t)*n+(3*e-6*t))*n+3*t)*n,OG=1e-7,_G=12;function FG(n,t,e,s,r){let a,i,o=0;do i=t+(e-t)/2,a=YO(i,s,r)-n,a>0?e=i:t=i;while(Math.abs(a)>OG&&++o<_G);return i}function _f(n,t,e,s){if(n===t&&e===s)return Tr;const r=a=>FG(a,0,1,n,e);return a=>a===0||a===1?a:YO(r(a),t,s)}const ZO=n=>t=>t<=.5?n(2*t)/2:(2-n(2*(1-t)))/2,QO=n=>t=>1-n(1-t),JO=_f(.33,1.53,.69,.99),y2=QO(JO),t_=ZO(y2),e_=n=>(n*=2)<1?.5*y2(n):.5*(2-Math.pow(2,-10*(n-1))),b2=n=>1-Math.sin(Math.acos(n)),n_=QO(b2),s_=ZO(b2),LG=_f(.42,0,1,1),MG=_f(0,0,.58,1),r_=_f(.42,0,.58,1),zG=n=>Array.isArray(n)&&typeof n[0]!="number",a_=n=>Array.isArray(n)&&typeof n[0]=="number",PG={linear:Tr,easeIn:LG,easeInOut:r_,easeOut:MG,circIn:b2,circInOut:s_,circOut:n_,backIn:y2,backInOut:t_,backOut:JO,anticipate:e_},BG=n=>typeof n=="string",KI=n=>{if(a_(n)){p2(n.length===4);const[t,e,s,r]=n;return _f(t,e,s,r)}else if(BG(n))return PG[n];return n},Pg=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],XI={value:null};function VG(n,t){let e=new Set,s=new Set,r=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(f){i.has(f)&&(d.schedule(f),n()),l++,f(o)}const d={schedule:(f,m=!1,g=!1)=>{const x=g&&r?e:s;return m&&i.add(f),x.has(f)||x.add(f),f},cancel:f=>{s.delete(f),i.delete(f)},process:f=>{if(o=f,r){a=!0;return}r=!0,[e,s]=[s,e],e.forEach(c),t&&XI.value&&XI.value.frameloop[t].push(l),l=0,e.clear(),r=!1,a&&(a=!1,d.process(f))}};return d}const UG=40;function i_(n,t){let e=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},a=()=>e=!0,i=Pg.reduce((C,k)=>(C[k]=VG(a,t?k:void 0),C),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:d,update:f,preRender:m,render:g,postRender:b}=i,x=()=>{const C=ei.useManualTiming?r.timestamp:performance.now();e=!1,ei.useManualTiming||(r.delta=s?1e3/60:Math.max(Math.min(C-r.timestamp,UG),1)),r.timestamp=C,r.isProcessing=!0,o.process(r),l.process(r),c.process(r),d.process(r),f.process(r),m.process(r),g.process(r),b.process(r),r.isProcessing=!1,e&&t&&(s=!1,n(x))},v=()=>{e=!0,s=!0,r.isProcessing||n(x)};return{schedule:Pg.reduce((C,k)=>{const $=i[k];return C[k]=(I,D=!1,_=!1)=>(e||v(),$.schedule(I,D,_)),C},{}),cancel:C=>{for(let k=0;k<Pg.length;k++)i[Pg[k]].cancel(C)},state:r,steps:i}}const{schedule:Fe,cancel:Zi,state:qn,steps:Qv}=i_(typeof requestAnimationFrame<"u"?requestAnimationFrame:Tr,!0);let ly;function WG(){ly=void 0}const _s={now:()=>(ly===void 0&&_s.set(qn.isProcessing||ei.useManualTiming?qn.timestamp:performance.now()),ly),set:n=>{ly=n,queueMicrotask(WG)}},o_=n=>t=>typeof t=="string"&&t.startsWith(n),x2=o_("--"),GG=o_("var(--"),v2=n=>GG(n)?jG.test(n.split("/*")[0].trim()):!1,jG=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,hc={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},ef={...hc,transform:n=>ti(0,1,n)},Bg={...hc,default:1},Gd=n=>Math.round(n*1e5)/1e5,w2=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function HG(n){return n==null}const qG=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,S2=(n,t)=>e=>!!(typeof e=="string"&&qG.test(e)&&e.startsWith(n)||t&&!HG(e)&&Object.prototype.hasOwnProperty.call(e,t)),l_=(n,t,e)=>s=>{if(typeof s!="string")return s;const[r,a,i,o]=s.match(w2);return{[n]:parseFloat(r),[t]:parseFloat(a),[e]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},KG=n=>ti(0,255,n),Jv={...hc,transform:n=>Math.round(KG(n))},el={test:S2("rgb","red"),parse:l_("red","green","blue"),transform:({red:n,green:t,blue:e,alpha:s=1})=>"rgba("+Jv.transform(n)+", "+Jv.transform(t)+", "+Jv.transform(e)+", "+Gd(ef.transform(s))+")"};function XG(n){let t="",e="",s="",r="";return n.length>5?(t=n.substring(1,3),e=n.substring(3,5),s=n.substring(5,7),r=n.substring(7,9)):(t=n.substring(1,2),e=n.substring(2,3),s=n.substring(3,4),r=n.substring(4,5),t+=t,e+=e,s+=s,r+=r),{red:parseInt(t,16),green:parseInt(e,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const Mw={test:S2("#"),parse:XG,transform:el.transform},Ff=n=>({test:t=>typeof t=="string"&&t.endsWith(n)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${n}`}),Ui=Ff("deg"),ca=Ff("%"),Vt=Ff("px"),YG=Ff("vh"),ZG=Ff("vw"),YI={...ca,parse:n=>ca.parse(n)/100,transform:n=>ca.transform(n*100)},_u={test:S2("hsl","hue"),parse:l_("hue","saturation","lightness"),transform:({hue:n,saturation:t,lightness:e,alpha:s=1})=>"hsla("+Math.round(n)+", "+ca.transform(Gd(t))+", "+ca.transform(Gd(e))+", "+Gd(ef.transform(s))+")"},es={test:n=>el.test(n)||Mw.test(n)||_u.test(n),parse:n=>el.test(n)?el.parse(n):_u.test(n)?_u.parse(n):Mw.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?el.transform(n):_u.transform(n)},QG=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function JG(n){var t,e;return isNaN(n)&&typeof n=="string"&&(((t=n.match(w2))==null?void 0:t.length)||0)+(((e=n.match(QG))==null?void 0:e.length)||0)>0}const u_="number",c_="color",t6="var",e6="var(",ZI="${}",n6=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function nf(n){const t=n.toString(),e=[],s={color:[],number:[],var:[]},r=[];let a=0;const o=t.replace(n6,l=>(es.test(l)?(s.color.push(a),r.push(c_),e.push(es.parse(l))):l.startsWith(e6)?(s.var.push(a),r.push(t6),e.push(l)):(s.number.push(a),r.push(u_),e.push(parseFloat(l))),++a,ZI)).split(ZI);return{values:e,split:o,indexes:s,types:r}}function h_(n){return nf(n).values}function d_(n){const{split:t,types:e}=nf(n),s=t.length;return r=>{let a="";for(let i=0;i<s;i++)if(a+=t[i],r[i]!==void 0){const o=e[i];o===u_?a+=Gd(r[i]):o===c_?a+=es.transform(r[i]):a+=r[i]}return a}}const s6=n=>typeof n=="number"?0:n;function r6(n){const t=h_(n);return d_(n)(t.map(s6))}const Qi={test:JG,parse:h_,createTransformer:d_,getAnimatableNone:r6};function tw(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+(t-n)*6*e:e<1/2?t:e<2/3?n+(t-n)*(2/3-e)*6:n}function a6({hue:n,saturation:t,lightness:e,alpha:s}){n/=360,t/=100,e/=100;let r=0,a=0,i=0;if(!t)r=a=i=e;else{const o=e<.5?e*(1+t):e+t-e*t,l=2*e-o;r=tw(l,o,n+1/3),a=tw(l,o,n),i=tw(l,o,n-1/3)}return{red:Math.round(r*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:s}}function Cy(n,t){return e=>e>0?t:n}const je=(n,t,e)=>n+(t-n)*e,ew=(n,t,e)=>{const s=n*n,r=e*(t*t-s)+s;return r<0?0:Math.sqrt(r)},i6=[Mw,el,_u],o6=n=>i6.find(t=>t.test(n));function QI(n){const t=o6(n);if(!t)return!1;let e=t.parse(n);return t===_u&&(e=a6(e)),e}const JI=(n,t)=>{const e=QI(n),s=QI(t);if(!e||!s)return Cy(n,t);const r={...e};return a=>(r.red=ew(e.red,s.red,a),r.green=ew(e.green,s.green,a),r.blue=ew(e.blue,s.blue,a),r.alpha=je(e.alpha,s.alpha,a),el.transform(r))},zw=new Set(["none","hidden"]);function l6(n,t){return zw.has(n)?e=>e<=0?n:t:e=>e>=1?t:n}function u6(n,t){return e=>je(n,t,e)}function T2(n){return typeof n=="number"?u6:typeof n=="string"?v2(n)?Cy:es.test(n)?JI:d6:Array.isArray(n)?f_:typeof n=="object"?es.test(n)?JI:c6:Cy}function f_(n,t){const e=[...n],s=e.length,r=n.map((a,i)=>T2(a)(a,t[i]));return a=>{for(let i=0;i<s;i++)e[i]=r[i](a);return e}}function c6(n,t){const e={...n,...t},s={};for(const r in e)n[r]!==void 0&&t[r]!==void 0&&(s[r]=T2(n[r])(n[r],t[r]));return r=>{for(const a in s)e[a]=s[a](r);return e}}function h6(n,t){const e=[],s={color:0,var:0,number:0};for(let r=0;r<t.values.length;r++){const a=t.types[r],i=n.indexes[a][s[a]],o=n.values[i]??0;e[r]=o,s[a]++}return e}const d6=(n,t)=>{const e=Qi.createTransformer(t),s=nf(n),r=nf(t);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?zw.has(n)&&!r.values.length||zw.has(t)&&!s.values.length?l6(n,t):Of(f_(h6(s,r),r.values),e):Cy(n,t)};function p_(n,t,e){return typeof n=="number"&&typeof t=="number"&&typeof e=="number"?je(n,t,e):T2(n)(n,t)}const f6=n=>{const t=({timestamp:e})=>n(e);return{start:()=>Fe.update(t,!0),stop:()=>Zi(t),now:()=>qn.isProcessing?qn.timestamp:_s.now()}},m_=(n,t,e=10)=>{let s="";const r=Math.max(Math.round(t/e),2);for(let a=0;a<r;a++)s+=n(a/(r-1))+", ";return`linear(${s.substring(0,s.length-2)})`},ky=2e4;function N2(n){let t=0;const e=50;let s=n.next(t);for(;!s.done&&t<ky;)t+=e,s=n.next(t);return t>=ky?1/0:t}function p6(n,t=100,e){const s=e({...n,keyframes:[0,t]}),r=Math.min(N2(s),ky);return{type:"keyframes",ease:a=>s.next(r*a).value/t,duration:ua(r)}}const m6=5;function g_(n,t,e){const s=Math.max(t-m6,0);return XO(e-n(s),t-s)}const Ze={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},tA=.001;function g6({duration:n=Ze.duration,bounce:t=Ze.bounce,velocity:e=Ze.velocity,mass:s=Ze.mass}){let r,a,i=1-t;i=ti(Ze.minDamping,Ze.maxDamping,i),n=ti(Ze.minDuration,Ze.maxDuration,ua(n)),i<1?(r=c=>{const d=c*i,f=d*n,m=d-e,g=Pw(c,i),b=Math.exp(-f);return tA-m/g*b},a=c=>{const f=c*i*n,m=f*e+e,g=Math.pow(i,2)*Math.pow(c,2)*n,b=Math.exp(-f),x=Pw(Math.pow(c,2),i);return(-r(c)+tA>0?-1:1)*((m-g)*b)/x}):(r=c=>{const d=Math.exp(-c*n),f=(c-e)*n+1;return-.001+d*f},a=c=>{const d=Math.exp(-c*n),f=(e-c)*(n*n);return d*f});const o=5/n,l=b6(r,a,o);if(n=la(n),isNaN(l))return{stiffness:Ze.stiffness,damping:Ze.damping,duration:n};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:i*2*Math.sqrt(s*c),duration:n}}}const y6=12;function b6(n,t,e){let s=e;for(let r=1;r<y6;r++)s=s-n(s)/t(s);return s}function Pw(n,t){return n*Math.sqrt(1-t*t)}const x6=["duration","bounce"],v6=["stiffness","damping","mass"];function eA(n,t){return t.some(e=>n[e]!==void 0)}function w6(n){let t={velocity:Ze.velocity,stiffness:Ze.stiffness,damping:Ze.damping,mass:Ze.mass,isResolvedFromDuration:!1,...n};if(!eA(n,v6)&&eA(n,x6))if(n.visualDuration){const e=n.visualDuration,s=2*Math.PI/(e*1.2),r=s*s,a=2*ti(.05,1,1-(n.bounce||0))*Math.sqrt(r);t={...t,mass:Ze.mass,stiffness:r,damping:a}}else{const e=g6(n);t={...t,...e,mass:Ze.mass},t.isResolvedFromDuration=!0}return t}function $y(n=Ze.visualDuration,t=Ze.bounce){const e=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:t}:n;let{restSpeed:s,restDelta:r}=e;const a=e.keyframes[0],i=e.keyframes[e.keyframes.length-1],o={done:!1,value:a},{stiffness:l,damping:c,mass:d,duration:f,velocity:m,isResolvedFromDuration:g}=w6({...e,velocity:-ua(e.velocity||0)}),b=m||0,x=c/(2*Math.sqrt(l*d)),v=i-a,w=ua(Math.sqrt(l/d)),T=Math.abs(v)<5;s||(s=T?Ze.restSpeed.granular:Ze.restSpeed.default),r||(r=T?Ze.restDelta.granular:Ze.restDelta.default);let C;if(x<1){const $=Pw(w,x);C=I=>{const D=Math.exp(-x*w*I);return i-D*((b+x*w*v)/$*Math.sin($*I)+v*Math.cos($*I))}}else if(x===1)C=$=>i-Math.exp(-w*$)*(v+(b+w*v)*$);else{const $=w*Math.sqrt(x*x-1);C=I=>{const D=Math.exp(-x*w*I),_=Math.min($*I,300);return i-D*((b+x*w*v)*Math.sinh(_)+$*v*Math.cosh(_))/$}}const k={calculatedDuration:g&&f||null,next:$=>{const I=C($);if(g)o.done=$>=f;else{let D=$===0?b:0;x<1&&(D=$===0?la(b):g_(C,$,I));const _=Math.abs(D)<=s,O=Math.abs(i-I)<=r;o.done=_&&O}return o.value=o.done?i:I,o},toString:()=>{const $=Math.min(N2(k),ky),I=m_(D=>k.next($*D).value,$,30);return $+"ms "+I},toTransition:()=>{}};return k}$y.applyToOptions=n=>{const t=p6(n,100,$y);return n.ease=t.ease,n.duration=la(t.duration),n.type="keyframes",n};function Bw({keyframes:n,velocity:t=0,power:e=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:l,restDelta:c=.5,restSpeed:d}){const f=n[0],m={done:!1,value:f},g=_=>o!==void 0&&_<o||l!==void 0&&_>l,b=_=>o===void 0?l:l===void 0||Math.abs(o-_)<Math.abs(l-_)?o:l;let x=e*t;const v=f+x,w=i===void 0?v:i(v);w!==v&&(x=w-f);const T=_=>-x*Math.exp(-_/s),C=_=>w+T(_),k=_=>{const O=T(_),L=C(_);m.done=Math.abs(O)<=c,m.value=m.done?w:L};let $,I;const D=_=>{g(m.value)&&($=_,I=$y({keyframes:[m.value,b(m.value)],velocity:g_(C,_,m.value),damping:r,stiffness:a,restDelta:c,restSpeed:d}))};return D(0),{calculatedDuration:null,next:_=>{let O=!1;return!I&&$===void 0&&(O=!0,k(_),D(_)),$!==void 0&&_>=$?I.next(_-$):(!O&&k(_),m)}}}function S6(n,t,e){const s=[],r=e||ei.mix||p_,a=n.length-1;for(let i=0;i<a;i++){let o=r(n[i],n[i+1]);if(t){const l=Array.isArray(t)?t[i]||Tr:t;o=Of(l,o)}s.push(o)}return s}function T6(n,t,{clamp:e=!0,ease:s,mixer:r}={}){const a=n.length;if(p2(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=n[0]===n[1];n[0]>n[a-1]&&(n=[...n].reverse(),t=[...t].reverse());const o=S6(t,s,r),l=o.length,c=d=>{if(i&&d<n[0])return t[0];let f=0;if(l>1)for(;f<n.length-2&&!(d<n[f+1]);f++);const m=tf(n[f],n[f+1],d);return o[f](m)};return e?d=>c(ti(n[0],n[a-1],d)):c}function N6(n,t){const e=n[n.length-1];for(let s=1;s<=t;s++){const r=tf(0,t,s);n.push(je(e,1,r))}}function C6(n){const t=[0];return N6(t,n.length-1),t}function k6(n,t){return n.map(e=>e*t)}function $6(n,t){return n.map(()=>t||r_).splice(0,n.length-1)}function jd({duration:n=300,keyframes:t,times:e,ease:s="easeInOut"}){const r=zG(s)?s.map(KI):KI(s),a={done:!1,value:t[0]},i=k6(e&&e.length===t.length?e:C6(t),n),o=T6(i,t,{ease:Array.isArray(r)?r:$6(t,r)});return{calculatedDuration:n,next:l=>(a.value=o(l),a.done=l>=n,a)}}const E6=n=>n!==null;function C2(n,{repeat:t,repeatType:e="loop"},s,r=1){const a=n.filter(E6),o=r<0||t&&e!=="loop"&&t%2===1?0:a.length-1;return!o||s===void 0?a[o]:s}const I6={decay:Bw,inertia:Bw,tween:jd,keyframes:jd,spring:$y};function y_(n){typeof n.type=="string"&&(n.type=I6[n.type])}class k2{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,e){return this.finished.then(t,e)}}const A6=n=>n/100;class b_ extends k2{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:e}=this.options;if(e&&e.updatedAt!==_s.now()&&this.tick(_s.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:s}=this.options;s&&s()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;y_(t);const{type:e=jd,repeat:s=0,repeatDelay:r=0,repeatType:a,velocity:i=0}=t;let{keyframes:o}=t;const l=e||jd;l!==jd&&typeof o[0]!="number"&&(this.mixKeyframes=Of(A6,p_(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});a==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-i})),c.calculatedDuration===null&&(c.calculatedDuration=N2(c));const{calculatedDuration:d}=c;this.calculatedDuration=d,this.resolvedDuration=d+r,this.totalDuration=this.resolvedDuration*(s+1)-r,this.generator=c}updateTime(t){const e=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=e}tick(t,e=!1){const{generator:s,totalDuration:r,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return s.next(0);const{delay:c=0,keyframes:d,repeat:f,repeatType:m,repeatDelay:g,type:b,onUpdate:x,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-r/this.speed,this.startTime)),e?this.currentTime=t:this.updateTime(t);const w=this.currentTime-c*(this.playbackSpeed>=0?1:-1),T=this.playbackSpeed>=0?w<0:w>r;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let C=this.currentTime,k=s;if(f){const _=Math.min(this.currentTime,r)/o;let O=Math.floor(_),L=_%1;!L&&_>=1&&(L=1),L===1&&O--,O=Math.min(O,f+1),!!(O%2)&&(m==="reverse"?(L=1-L,g&&(L-=g/o)):m==="mirror"&&(k=i)),C=ti(0,1,L)*o}const $=T?{done:!1,value:d[0]}:k.next(C);a&&($.value=a($.value));let{done:I}=$;!T&&l!==null&&(I=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&I);return D&&b!==Bw&&($.value=C2(d,this.options,v,this.speed)),x&&x($.value),D&&this.finish(),$}then(t,e){return this.finished.then(t,e)}get duration(){return ua(this.calculatedDuration)}get time(){return ua(this.currentTime)}set time(t){t=la(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(_s.now());const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=ua(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=f6,onPlay:e,startTime:s}=this.options;this.driver||(this.driver=t(a=>this.tick(a))),e&&e();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.state==="finished"?(this.updateFinished(),this.startTime=r):this.startTime||(this.startTime=s??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(_s.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function R6(n){for(let t=1;t<n.length;t++)n[t]??(n[t]=n[t-1])}const nl=n=>n*180/Math.PI,Vw=n=>{const t=nl(Math.atan2(n[1],n[0]));return Uw(t)},D6={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:Vw,rotateZ:Vw,skewX:n=>nl(Math.atan(n[1])),skewY:n=>nl(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},Uw=n=>(n=n%360,n<0&&(n+=360),n),nA=Vw,sA=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),rA=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),O6={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:sA,scaleY:rA,scale:n=>(sA(n)+rA(n))/2,rotateX:n=>Uw(nl(Math.atan2(n[6],n[5]))),rotateY:n=>Uw(nl(Math.atan2(-n[2],n[0]))),rotateZ:nA,rotate:nA,skewX:n=>nl(Math.atan(n[4])),skewY:n=>nl(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function aA(n){return n.includes("scale")?1:0}function Ww(n,t){if(!n||n==="none")return aA(t);const e=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,r;if(e)s=O6,r=e;else{const o=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=D6,r=o}if(!r)return aA(t);const a=s[t],i=r[1].split(",").map(F6);return typeof a=="function"?a(i):i[a]}const _6=(n,t)=>{const{transform:e="none"}=getComputedStyle(n);return Ww(e,t)};function F6(n){return parseFloat(n.trim())}const dc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],kl=new Set(dc),iA=n=>n===hc||n===Vt,L6=new Set(["x","y","z"]),M6=dc.filter(n=>!L6.has(n));function z6(n){const t=[];return M6.forEach(e=>{const s=n.getValue(e);s!==void 0&&(t.push([e,s.get()]),s.set(e.startsWith("scale")?1:0))}),t}const ju={width:({x:n},{paddingLeft:t="0",paddingRight:e="0"})=>n.max-n.min-parseFloat(t)-parseFloat(e),height:({y:n},{paddingTop:t="0",paddingBottom:e="0"})=>n.max-n.min-parseFloat(t)-parseFloat(e),top:(n,{top:t})=>parseFloat(t),left:(n,{left:t})=>parseFloat(t),bottom:({y:n},{top:t})=>parseFloat(t)+(n.max-n.min),right:({x:n},{left:t})=>parseFloat(t)+(n.max-n.min),x:(n,{transform:t})=>Ww(t,"x"),y:(n,{transform:t})=>Ww(t,"y")};ju.translateX=ju.x;ju.translateY=ju.y;const al=new Set;let Gw=!1,jw=!1,Hw=!1;function x_(){if(jw){const n=Array.from(al).filter(s=>s.needsMeasurement),t=new Set(n.map(s=>s.element)),e=new Map;t.forEach(s=>{const r=z6(s);r.length&&(e.set(s,r),s.render())}),n.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const r=e.get(s);r&&r.forEach(([a,i])=>{var o;(o=s.getValue(a))==null||o.set(i)})}),n.forEach(s=>s.measureEndState()),n.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}jw=!1,Gw=!1,al.forEach(n=>n.complete(Hw)),al.clear()}function v_(){al.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(jw=!0)})}function P6(){Hw=!0,v_(),x_(),Hw=!1}class $2{constructor(t,e,s,r,a,i=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=s,this.motionValue=r,this.element=a,this.isAsync=i}scheduleResolve(){this.isScheduled=!0,this.isAsync?(al.add(this),Gw||(Gw=!0,Fe.read(v_),Fe.resolveKeyframes(x_))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:s,motionValue:r}=this;if(t[0]===null){const a=r==null?void 0:r.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(s&&e){const o=s.readValue(e,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),r&&a===void 0&&r.set(t[0])}R6(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),al.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,al.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const B6=n=>n.startsWith("--");function V6(n,t,e){B6(t)?n.style.setProperty(t,e):n.style[t]=e}const U6=m2(()=>window.ScrollTimeline!==void 0),W6={};function G6(n,t){const e=m2(n);return()=>W6[t]??e()}const w_=G6(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Rd=([n,t,e,s])=>`cubic-bezier(${n}, ${t}, ${e}, ${s})`,oA={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Rd([0,.65,.55,1]),circOut:Rd([.55,0,1,.45]),backIn:Rd([.31,.01,.66,-.59]),backOut:Rd([.33,1.53,.69,.99])};function S_(n,t){if(n)return typeof n=="function"?w_()?m_(n,t):"ease-out":a_(n)?Rd(n):Array.isArray(n)?n.map(e=>S_(e,t)||oA.easeOut):oA[n]}function j6(n,t,e,{delay:s=0,duration:r=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:l}={},c=void 0){const d={[t]:e};l&&(d.offset=l);const f=S_(o,r);Array.isArray(f)&&(d.easing=f);const m={delay:s,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return c&&(m.pseudoElement=c),n.animate(d,m)}function T_(n){return typeof n=="function"&&"applyToOptions"in n}function H6({type:n,...t}){return T_(n)&&w_()?n.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class q6 extends k2{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:e,name:s,keyframes:r,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,p2(typeof t.type!="string");const l=H6(t);this.animation=j6(e,s,r,l,a),l.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const c=C2(r,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(c):V6(e,s,c),this.animation.cancel()}this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,e;(e=(t=this.animation).finish)==null||e.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,e;this.isPseudoElement||(e=(t=this.animation).commitStyles)==null||e.call(t)}get duration(){var e,s;const t=((s=(e=this.animation.effect)==null?void 0:e.getComputedTiming)==null?void 0:s.call(e).duration)||0;return ua(Number(t))}get time(){return ua(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=la(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:e}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&U6()?(this.animation.timeline=t,Tr):e(this)}}const N_={anticipate:e_,backInOut:t_,circInOut:s_};function K6(n){return n in N_}function X6(n){typeof n.ease=="string"&&K6(n.ease)&&(n.ease=N_[n.ease])}const lA=10;class Y6 extends q6{constructor(t){X6(t),y_(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:e,onUpdate:s,onComplete:r,element:a,...i}=this.options;if(!e)return;if(t!==void 0){e.set(t);return}const o=new b_({...i,autoplay:!1}),l=la(this.finishedTime??this.time);e.setWithVelocity(o.sample(l-lA).value,o.sample(l).value,lA),o.stop()}}const uA=(n,t)=>t==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Qi.test(n)||n==="0")&&!n.startsWith("url("));function Z6(n){const t=n[0];if(n.length===1)return!0;for(let e=0;e<n.length;e++)if(n[e]!==t)return!0}function Q6(n,t,e,s){const r=n[0];if(r===null)return!1;if(t==="display"||t==="visibility")return!0;const a=n[n.length-1],i=uA(r,t),o=uA(a,t);return!i||!o?!1:Z6(n)||(e==="spring"||T_(e))&&s}const J6=new Set(["opacity","clipPath","filter","transform"]),tj=m2(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function ej(n){const{motionValue:t,name:e,repeatDelay:s,repeatType:r,damping:a,type:i}=n;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return tj()&&e&&J6.has(e)&&(e!=="transform"||!l)&&!o&&!s&&r!=="mirror"&&a!==0&&i!=="inertia"}const nj=40;class sj extends k2{constructor({autoplay:t=!0,delay:e=0,type:s="keyframes",repeat:r=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:l,motionValue:c,element:d,...f}){var b;super(),this.stop=()=>{var x,v;this._animation?(this._animation.stop(),(x=this.stopTimeline)==null||x.call(this)):(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=_s.now();const m={autoplay:t,delay:e,type:s,repeat:r,repeatDelay:a,repeatType:i,name:l,motionValue:c,element:d,...f},g=(d==null?void 0:d.KeyframeResolver)||$2;this.keyframeResolver=new g(o,(x,v,w)=>this.onKeyframesResolved(x,v,m,!w),l,c,d),(b=this.keyframeResolver)==null||b.scheduleResolve()}onKeyframesResolved(t,e,s,r){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:l,isHandoff:c,onUpdate:d,onComplete:f}=s;this.resolvedAt=_s.now(),Q6(t,a,i,o)||((ei.instantAnimations||!l)&&(d==null||d(C2(t,s,e))),t[0]=t[t.length-1],s.duration=0,s.repeat=0);const g={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>nj?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:e,...s,keyframes:t},b=!c&&ej(g)?new Y6({...g,element:g.motionValue.owner.current}):new b_(g);b.finished.then(()=>{f==null||f(),this.notifyFinished()}).catch(Tr),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(t,e){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||P6(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const rj=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function aj(n){const t=rj.exec(n);if(!t)return[,];const[,e,s,r]=t;return[`--${e??s}`,r]}function C_(n,t,e=1){const[s,r]=aj(n);if(!s)return;const a=window.getComputedStyle(t).getPropertyValue(s);if(a){const i=a.trim();return qO(i)?parseFloat(i):i}return v2(r)?C_(r,t,e+1):r}function E2(n,t){return(n==null?void 0:n[t])??(n==null?void 0:n.default)??n}const k_=new Set(["width","height","top","left","right","bottom",...dc]),ij={test:n=>n==="auto",parse:n=>n},$_=n=>t=>t.test(n),E_=[hc,Vt,ca,Ui,ZG,YG,ij],cA=n=>E_.find($_(n));function oj(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||KO(n):!0}const lj=new Set(["brightness","contrast","saturate","opacity"]);function uj(n){const[t,e]=n.slice(0,-1).split("(");if(t==="drop-shadow")return n;const[s]=e.match(w2)||[];if(!s)return n;const r=e.replace(s,"");let a=lj.has(t)?1:0;return s!==e&&(a*=100),t+"("+a+r+")"}const cj=/\b([a-z-]*)\(.*?\)/gu,qw={...Qi,getAnimatableNone:n=>{const t=n.match(cj);return t?t.map(uj).join(" "):n}},hA={...hc,transform:Math.round},hj={rotate:Ui,rotateX:Ui,rotateY:Ui,rotateZ:Ui,scale:Bg,scaleX:Bg,scaleY:Bg,scaleZ:Bg,skew:Ui,skewX:Ui,skewY:Ui,distance:Vt,translateX:Vt,translateY:Vt,translateZ:Vt,x:Vt,y:Vt,z:Vt,perspective:Vt,transformPerspective:Vt,opacity:ef,originX:YI,originY:YI,originZ:Vt},I2={borderWidth:Vt,borderTopWidth:Vt,borderRightWidth:Vt,borderBottomWidth:Vt,borderLeftWidth:Vt,borderRadius:Vt,radius:Vt,borderTopLeftRadius:Vt,borderTopRightRadius:Vt,borderBottomRightRadius:Vt,borderBottomLeftRadius:Vt,width:Vt,maxWidth:Vt,height:Vt,maxHeight:Vt,top:Vt,right:Vt,bottom:Vt,left:Vt,padding:Vt,paddingTop:Vt,paddingRight:Vt,paddingBottom:Vt,paddingLeft:Vt,margin:Vt,marginTop:Vt,marginRight:Vt,marginBottom:Vt,marginLeft:Vt,backgroundPositionX:Vt,backgroundPositionY:Vt,...hj,zIndex:hA,fillOpacity:ef,strokeOpacity:ef,numOctaves:hA},dj={...I2,color:es,backgroundColor:es,outlineColor:es,fill:es,stroke:es,borderColor:es,borderTopColor:es,borderRightColor:es,borderBottomColor:es,borderLeftColor:es,filter:qw,WebkitFilter:qw},I_=n=>dj[n];function A_(n,t){let e=I_(n);return e!==qw&&(e=Qi),e.getAnimatableNone?e.getAnimatableNone(t):void 0}const fj=new Set(["auto","none","0"]);function pj(n,t,e){let s=0,r;for(;s<n.length&&!r;){const a=n[s];typeof a=="string"&&!fj.has(a)&&nf(a).values.length&&(r=n[s]),s++}if(r&&e)for(const a of t)n[a]=A_(e,r)}class mj extends $2{constructor(t,e,s,r,a){super(t,e,s,r,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:s}=this;if(!e||!e.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),v2(c))){const d=C_(c,e.current);d!==void 0&&(t[l]=d),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!k_.has(s)||t.length!==2)return;const[r,a]=t,i=cA(r),o=cA(a);if(i!==o)if(iA(i)&&iA(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,s=[];for(let r=0;r<t.length;r++)(t[r]===null||oj(t[r]))&&s.push(r);s.length&&pj(t,s,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ju[s](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const r=e[e.length-1];r!==void 0&&t.getValue(s,r).jump(r,!1)}measureEndState(){var o;const{element:t,name:e,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const r=t.getValue(e);r&&r.jump(this.measuredOrigin,!1);const a=s.length-1,i=s[a];s[a]=ju[e](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const{schedule:A2}=i_(queueMicrotask,!1),_r={x:!1,y:!1};function R_(){return _r.x||_r.y}function gj(n){return n==="x"||n==="y"?_r[n]?null:(_r[n]=!0,()=>{_r[n]=!1}):_r.x||_r.y?null:(_r.x=_r.y=!0,()=>{_r.x=_r.y=!1})}function yj(n,t,e){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let s=document;const r=(e==null?void 0:e[n])??s.querySelectorAll(n);return r?Array.from(r):[]}return Array.from(n)}function D_(n,t){const e=yj(n),s=new AbortController,r={passive:!0,...t,signal:s.signal};return[e,r,()=>s.abort()]}function dA(n){return!(n.pointerType==="touch"||R_())}function bj(n,t,e={}){const[s,r,a]=D_(n,e),i=o=>{if(!dA(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const d=f=>{dA(f)&&(c(f),l.removeEventListener("pointerleave",d))};l.addEventListener("pointerleave",d,r)};return s.forEach(o=>{o.addEventListener("pointerenter",i,r)}),a}const O_=(n,t)=>t?n===t?!0:O_(n,t.parentElement):!1,R2=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,xj=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function vj(n){return xj.has(n.tagName)||n.tabIndex!==-1}const Dd=new WeakSet;function fA(n){return t=>{t.key==="Enter"&&n(t)}}function nw(n,t){n.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const wj=(n,t)=>{const e=n.currentTarget;if(!e)return;const s=fA(()=>{if(Dd.has(e))return;nw(e,"down");const r=fA(()=>{nw(e,"up")}),a=()=>nw(e,"cancel");e.addEventListener("keyup",r,t),e.addEventListener("blur",a,t)});e.addEventListener("keydown",s,t),e.addEventListener("blur",()=>e.removeEventListener("keydown",s),t)};function pA(n){return R2(n)&&!R_()}function Sj(n,t,e={}){const[s,r,a]=D_(n,e),i=o=>{const l=o.currentTarget;if(!pA(o)||Dd.has(l))return;Dd.add(l);const c=t(l,o),d=(g,b)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),!(!pA(g)||!Dd.has(l))&&(Dd.delete(l),typeof c=="function"&&c(g,{success:b}))},f=g=>{d(g,l===window||l===document||e.useGlobalTarget||O_(l,g.target))},m=g=>{d(g,!1)};window.addEventListener("pointerup",f,r),window.addEventListener("pointercancel",m,r)};return s.forEach(o=>{(e.useGlobalTarget?window:o).addEventListener("pointerdown",i,r),o instanceof HTMLElement&&(o.addEventListener("focus",c=>wj(c,r)),!vj(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}const mA=30,Tj=n=>!isNaN(parseFloat(n));class Nj{constructor(t,e={}){this.version="12.8.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{const a=_s.now();this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){this.current=t,this.updatedAt=_s.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=Tj(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new g2);const s=this.events[t].add(e);return t==="change"?()=>{s(),Fe.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t,e=!0){t==="none"&&console.trace(),!e||!this.passiveEffect?this.updateAndNotify(t,e):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,e,s){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=_s.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>mA)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,mA);return XO(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function sf(n,t){return new Nj(n,t)}const Cj=[...E_,es,Qi],kj=n=>Cj.find($_(n)),__=(n,t)=>t&&typeof n=="number"?t.transform(n):n,F_=nt.createContext({strict:!1}),gA={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Hu={};for(const n in gA)Hu[n]={isEnabled:t=>gA[n].some(e=>!!t[e])};function $j(n){for(const t in n)Hu[t]={...Hu[t],...n[t]}}const Ej=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ey(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||Ej.has(n)}let L_=n=>!Ey(n);function Ij(n){n&&(L_=t=>t.startsWith("on")?!Ey(t):n(t))}try{Ij(require("@emotion/is-prop-valid").default)}catch{}function Aj(n,t,e){const s={};for(const r in n)r==="values"&&typeof n.values=="object"||(L_(r)||e===!0&&Ey(r)||!t&&!Ey(r)||n.draggable&&r.startsWith("onDrag"))&&(s[r]=n[r]);return s}function Rj(n){if(typeof Proxy>"u")return n;const t=new Map,e=(...s)=>n(...s);return new Proxy(e,{get:(s,r)=>r==="create"?n:(t.has(r)||t.set(r,n(r)),t.get(r))})}const p0=nt.createContext({});function m0(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function rf(n){return typeof n=="string"||Array.isArray(n)}const D2=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],O2=["initial",...D2];function g0(n){return m0(n.animate)||O2.some(t=>rf(n[t]))}function M_(n){return!!(g0(n)||n.variants)}function Dj(n,t){if(g0(n)){const{initial:e,animate:s}=n;return{initial:e===!1||rf(e)?e:void 0,animate:rf(s)?s:void 0}}return n.inherit!==!1?t:{}}function Oj(n){const{initial:t,animate:e}=Dj(n,nt.useContext(p0));return nt.useMemo(()=>({initial:t,animate:e}),[yA(t),yA(e)])}function yA(n){return Array.isArray(n)?n.join(" "):n}const _j=Symbol.for("motionComponentSymbol");function Fu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Fj(n,t,e){return nt.useCallback(s=>{s&&n.onMount&&n.onMount(s),t&&(s?t.mount(s):t.unmount()),e&&(typeof e=="function"?e(s):Fu(e)&&(e.current=s))},[t])}const _2=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Lj="framerAppearId",z_="data-"+_2(Lj),P_=nt.createContext({});function Mj(n,t,e,s,r){var x,v;const{visualElement:a}=nt.useContext(p0),i=nt.useContext(F_),o=nt.useContext(f0),l=nt.useContext(h2).reducedMotion,c=nt.useRef(null);s=s||i.renderer,!c.current&&s&&(c.current=s(n,{visualState:t,parent:a,props:e,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const d=c.current,f=nt.useContext(P_);d&&!d.projection&&r&&(d.type==="html"||d.type==="svg")&&zj(c.current,e,r,f);const m=nt.useRef(!1);nt.useInsertionEffect(()=>{d&&m.current&&d.update(e,o)});const g=e[z_],b=nt.useRef(!!g&&!((x=window.MotionHandoffIsComplete)!=null&&x.call(window,g))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,g)));return jO(()=>{d&&(m.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),A2.render(d.render),b.current&&d.animationState&&d.animationState.animateChanges())}),nt.useEffect(()=>{d&&(!b.current&&d.animationState&&d.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)==null||w.call(window,g)}),b.current=!1))}),d}function zj(n,t,e,s){const{layoutId:r,layout:a,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=t;n.projection=new e(n.latestValues,t["data-framer-portal-id"]?void 0:B_(n.parent)),n.projection.setOptions({layoutId:r,layout:a,alwaysMeasureLayout:!!i||o&&Fu(o),visualElement:n,animationType:typeof a=="string"?a:"both",initialPromotionConfig:s,crossfade:d,layoutScroll:l,layoutRoot:c})}function B_(n){if(n)return n.options.allowProjection!==!1?n.projection:B_(n.parent)}function Pj({preloadedFeatures:n,createVisualElement:t,useRender:e,useVisualState:s,Component:r}){n&&$j(n);function a(o,l){let c;const d={...nt.useContext(h2),...o,layoutId:Bj(o)},{isStatic:f}=d,m=Oj(o),g=s(o,f);if(!f&&c2){Vj();const b=Uj(d);c=b.MeasureLayout,m.visualElement=Mj(r,g,d,t,b.ProjectionNode)}return q.jsxs(p0.Provider,{value:m,children:[c&&m.visualElement?q.jsx(c,{visualElement:m.visualElement,...d}):null,e(r,o,Fj(g,m.visualElement,l),g,f,m.visualElement)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${r.displayName??r.name??""})`}`;const i=nt.forwardRef(a);return i[_j]=r,i}function Bj({layoutId:n}){const t=nt.useContext(l2).id;return t&&n!==void 0?t+"-"+n:n}function Vj(n,t){nt.useContext(F_).strict}function Uj(n){const{drag:t,layout:e}=Hu;if(!t&&!e)return{};const s={...t,...e};return{MeasureLayout:t!=null&&t.isEnabled(n)||e!=null&&e.isEnabled(n)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const af={};function Wj(n){for(const t in n)af[t]=n[t],x2(t)&&(af[t].isCSSVariable=!0)}function V_(n,{layout:t,layoutId:e}){return kl.has(n)||n.startsWith("origin")||(t||e!==void 0)&&(!!af[n]||n==="opacity")}const os=n=>!!(n&&n.getVelocity),Gj={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},jj=dc.length;function Hj(n,t,e){let s="",r=!0;for(let a=0;a<jj;a++){const i=dc[a],o=n[i];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(i.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||e){const c=__(o,I2[i]);if(!l){r=!1;const d=Gj[i]||i;s+=`${d}(${c}) `}e&&(t[i]=c)}}return s=s.trim(),e?s=e(t,r?"":s):r&&(s="none"),s}function F2(n,t,e){const{style:s,vars:r,transformOrigin:a}=n;let i=!1,o=!1;for(const l in t){const c=t[l];if(kl.has(l)){i=!0;continue}else if(x2(l)){r[l]=c;continue}else{const d=__(c,I2[l]);l.startsWith("origin")?(o=!0,a[l]=d):s[l]=d}}if(t.transform||(i||e?s.transform=Hj(t,n.transform,e):s.transform&&(s.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:d=0}=a;s.transformOrigin=`${l} ${c} ${d}`}}const L2=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function U_(n,t,e){for(const s in t)!os(t[s])&&!V_(s,e)&&(n[s]=t[s])}function qj({transformTemplate:n},t){return nt.useMemo(()=>{const e=L2();return F2(e,t,n),Object.assign({},e.vars,e.style)},[t])}function Kj(n,t){const e=n.style||{},s={};return U_(s,e,n),Object.assign(s,qj(n,t)),s}function Xj(n,t){const e={},s=Kj(n,t);return n.drag&&n.dragListener!==!1&&(e.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(e.tabIndex=0),e.style=s,e}const Yj=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function M2(n){return typeof n!="string"||n.includes("-")?!1:!!(Yj.indexOf(n)>-1||/[A-Z]/u.test(n))}const Zj={offset:"stroke-dashoffset",array:"stroke-dasharray"},Qj={offset:"strokeDashoffset",array:"strokeDasharray"};function Jj(n,t,e=1,s=0,r=!0){n.pathLength=1;const a=r?Zj:Qj;n[a.offset]=Vt.transform(-s);const i=Vt.transform(t),o=Vt.transform(e);n[a.array]=`${i} ${o}`}function bA(n,t,e){return typeof n=="string"?n:Vt.transform(t+e*n)}function t5(n,t,e){const s=bA(t,n.x,n.width),r=bA(e,n.y,n.height);return`${s} ${r}`}function z2(n,{attrX:t,attrY:e,attrScale:s,originX:r,originY:a,pathLength:i,pathSpacing:o=1,pathOffset:l=0,...c},d,f){if(F2(n,c,f),d){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:g,dimensions:b}=n;m.transform&&(b&&(g.transform=m.transform),delete m.transform),b&&(r!==void 0||a!==void 0||g.transform)&&(g.transformOrigin=t5(b,r!==void 0?r:.5,a!==void 0?a:.5)),t!==void 0&&(m.x=t),e!==void 0&&(m.y=e),s!==void 0&&(m.scale=s),i!==void 0&&Jj(m,i,o,l,!1)}const W_=()=>({...L2(),attrs:{}}),P2=n=>typeof n=="string"&&n.toLowerCase()==="svg";function e5(n,t,e,s){const r=nt.useMemo(()=>{const a=W_();return z2(a,t,P2(s),n.transformTemplate),{...a.attrs,style:{...a.style}}},[t]);if(n.style){const a={};U_(a,n.style,n),r.style={...a,...r.style}}return r}function n5(n=!1){return(e,s,r,{latestValues:a},i)=>{const l=(M2(e)?e5:Xj)(s,a,i,e),c=Aj(s,typeof e=="string",n),d=e!==nt.Fragment?{...c,...l,ref:r}:{},{children:f}=s,m=nt.useMemo(()=>os(f)?f.get():f,[f]);return nt.createElement(e,{...d,children:m})}}function xA(n){const t=[{},{}];return n==null||n.values.forEach((e,s)=>{t[0][s]=e.get(),t[1][s]=e.getVelocity()}),t}function B2(n,t,e,s){if(typeof t=="function"){const[r,a]=xA(s);t=t(e!==void 0?e:n.custom,r,a)}if(typeof t=="string"&&(t=n.variants&&n.variants[t]),typeof t=="function"){const[r,a]=xA(s);t=t(e!==void 0?e:n.custom,r,a)}return t}function uy(n){return os(n)?n.get():n}function s5({scrapeMotionValuesFromProps:n,createRenderState:t,onUpdate:e},s,r,a){const i={latestValues:r5(s,r,a,n),renderState:t()};return e&&(i.onMount=o=>e({props:s,current:o,...i}),i.onUpdate=o=>e(o)),i}const G_=n=>(t,e)=>{const s=nt.useContext(p0),r=nt.useContext(f0),a=()=>s5(n,t,s,r);return e?a():u2(a)};function r5(n,t,e,s){const r={},a=s(n,{});for(const m in a)r[m]=uy(a[m]);let{initial:i,animate:o}=n;const l=g0(n),c=M_(n);t&&c&&!l&&n.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let d=e?e.initial===!1:!1;d=d||i===!1;const f=d?o:i;if(f&&typeof f!="boolean"&&!m0(f)){const m=Array.isArray(f)?f:[f];for(let g=0;g<m.length;g++){const b=B2(n,m[g]);if(b){const{transitionEnd:x,transition:v,...w}=b;for(const T in w){let C=w[T];if(Array.isArray(C)){const k=d?C.length-1:0;C=C[k]}C!==null&&(r[T]=C)}for(const T in x)r[T]=x[T]}}}return r}function V2(n,t,e){var a;const{style:s}=n,r={};for(const i in s)(os(s[i])||t.style&&os(t.style[i])||V_(i,n)||((a=e==null?void 0:e.getValue(i))==null?void 0:a.liveStyle)!==void 0)&&(r[i]=s[i]);return r}const a5={useVisualState:G_({scrapeMotionValuesFromProps:V2,createRenderState:L2})};function j_(n,t){try{t.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}function H_(n,{style:t,vars:e},s,r){Object.assign(n.style,t,r&&r.getProjectionStyles(s));for(const a in e)n.style.setProperty(a,e[a])}const q_=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function K_(n,t,e,s){H_(n,t,void 0,s);for(const r in t.attrs)n.setAttribute(q_.has(r)?r:_2(r),t.attrs[r])}function X_(n,t,e){const s=V2(n,t,e);for(const r in n)if(os(n[r])||os(t[r])){const a=dc.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[a]=n[r]}return s}const vA=["x","y","width","height","cx","cy","r"],i5={useVisualState:G_({scrapeMotionValuesFromProps:X_,createRenderState:W_,onUpdate:({props:n,prevProps:t,current:e,renderState:s,latestValues:r})=>{if(!e)return;let a=!!n.drag;if(!a){for(const o in r)if(kl.has(o)){a=!0;break}}if(!a)return;let i=!t;if(t)for(let o=0;o<vA.length;o++){const l=vA[o];n[l]!==t[l]&&(i=!0)}i&&Fe.read(()=>{j_(e,s),Fe.render(()=>{z2(s,r,P2(e.tagName),n.transformTemplate),K_(e,s)})})}})};function o5(n,t){return function(s,{forwardMotionProps:r}={forwardMotionProps:!1}){const i={...M2(s)?i5:a5,preloadedFeatures:n,useRender:n5(r),createVisualElement:t,Component:s};return Pj(i)}}function of(n,t,e){const s=n.getProps();return B2(s,t,e!==void 0?e:s.custom,n)}const Kw=n=>Array.isArray(n);function l5(n,t,e){n.hasValue(t)?n.getValue(t).set(e):n.addValue(t,sf(e))}function u5(n){return Kw(n)?n[n.length-1]||0:n}function c5(n,t){const e=of(n,t);let{transitionEnd:s={},transition:r={},...a}=e||{};a={...a,...s};for(const i in a){const o=u5(a[i]);l5(n,i,o)}}function h5(n){return!!(os(n)&&n.add)}function Xw(n,t){const e=n.getValue("willChange");if(h5(e))return e.add(t);if(!e&&ei.WillChange){const s=new ei.WillChange("auto");n.addValue("willChange",s),s.add(t)}}function Y_(n){return n.props[z_]}const d5=n=>n!==null;function f5(n,{repeat:t,repeatType:e="loop"},s){const r=n.filter(d5),a=t&&e!=="loop"&&t%2===1?0:r.length-1;return r[a]}const p5={type:"spring",stiffness:500,damping:25,restSpeed:10},m5=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),g5={type:"keyframes",duration:.8},y5={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},b5=(n,{keyframes:t})=>t.length>2?g5:kl.has(n)?n.startsWith("scale")?m5(t[1]):p5:y5;function x5({when:n,delay:t,delayChildren:e,staggerChildren:s,staggerDirection:r,repeat:a,repeatType:i,repeatDelay:o,from:l,elapsed:c,...d}){return!!Object.keys(d).length}const U2=(n,t,e,s={},r,a)=>i=>{const o=E2(s,n)||{},l=o.delay||s.delay||0;let{elapsed:c=0}=s;c=c-la(l);const d={keyframes:Array.isArray(e)?e:[null,e],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:m=>{t.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:n,motionValue:t,element:a?void 0:r};x5(o)||Object.assign(d,b5(n,d)),d.duration&&(d.duration=la(d.duration)),d.repeatDelay&&(d.repeatDelay=la(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(f=!0)),(ei.instantAnimations||ei.skipAnimations)&&(f=!0,d.duration=0,d.delay=0),d.allowFlatten=!o.type&&!o.ease,f&&!a&&t.get()!==void 0){const m=f5(d.keyframes,o);if(m!==void 0){Fe.update(()=>{d.onUpdate(m),d.onComplete()});return}}return new sj(d)};function v5({protectedKeys:n,needsAnimating:t},e){const s=n.hasOwnProperty(e)&&t[e]!==!0;return t[e]=!1,s}function Z_(n,t,{delay:e=0,transitionOverride:s,type:r}={}){let{transition:a=n.getDefaultTransition(),transitionEnd:i,...o}=t;s&&(a=s);const l=[],c=r&&n.animationState&&n.animationState.getState()[r];for(const d in o){const f=n.getValue(d,n.latestValues[d]??null),m=o[d];if(m===void 0||c&&v5(c,d))continue;const g={delay:e,...E2(a||{},d)};let b=!1;if(window.MotionHandoffAnimation){const v=Y_(n);if(v){const w=window.MotionHandoffAnimation(v,d,Fe);w!==null&&(g.startTime=w,b=!0)}}Xw(n,d),f.start(U2(d,f,m,n.shouldReduceMotion&&k_.has(d)?{type:!1}:g,n,b));const x=f.animation;x&&l.push(x)}return i&&Promise.all(l).then(()=>{Fe.update(()=>{i&&c5(n,i)})}),l}function Yw(n,t,e={}){var l;const s=of(n,t,e.type==="exit"?(l=n.presenceContext)==null?void 0:l.custom:void 0);let{transition:r=n.getDefaultTransition()||{}}=s||{};e.transitionOverride&&(r=e.transitionOverride);const a=s?()=>Promise.all(Z_(n,s,e)):()=>Promise.resolve(),i=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:m}=r;return w5(n,t,d+c,f,m,e)}:()=>Promise.resolve(),{when:o}=r;if(o){const[c,d]=o==="beforeChildren"?[a,i]:[i,a];return c().then(()=>d())}else return Promise.all([a(),i(e.delay)])}function w5(n,t,e=0,s=0,r=1,a){const i=[],o=(n.variantChildren.size-1)*s,l=r===1?(c=0)=>c*s:(c=0)=>o-c*s;return Array.from(n.variantChildren).sort(S5).forEach((c,d)=>{c.notify("AnimationStart",t),i.push(Yw(c,t,{...a,delay:e+l(d)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(i)}function S5(n,t){return n.sortNodePosition(t)}function T5(n,t,e={}){n.notify("AnimationStart",t);let s;if(Array.isArray(t)){const r=t.map(a=>Yw(n,a,e));s=Promise.all(r)}else if(typeof t=="string")s=Yw(n,t,e);else{const r=typeof t=="function"?of(n,t,e.custom):t;s=Promise.all(Z_(n,r,e))}return s.then(()=>{n.notify("AnimationComplete",t)})}function Q_(n,t){if(!Array.isArray(t))return!1;const e=t.length;if(e!==n.length)return!1;for(let s=0;s<e;s++)if(t[s]!==n[s])return!1;return!0}const N5=O2.length;function J_(n){if(!n)return;if(!n.isControllingVariants){const e=n.parent?J_(n.parent)||{}:{};return n.props.initial!==void 0&&(e.initial=n.props.initial),e}const t={};for(let e=0;e<N5;e++){const s=O2[e],r=n.props[s];(rf(r)||r===!1)&&(t[s]=r)}return t}const C5=[...D2].reverse(),k5=D2.length;function $5(n){return t=>Promise.all(t.map(({animation:e,options:s})=>T5(n,e,s)))}function E5(n){let t=$5(n),e=wA(),s=!0;const r=l=>(c,d)=>{var m;const f=of(n,d,l==="exit"?(m=n.presenceContext)==null?void 0:m.custom:void 0);if(f){const{transition:g,transitionEnd:b,...x}=f;c={...c,...x,...b}}return c};function a(l){t=l(n)}function i(l){const{props:c}=n,d=J_(n.parent)||{},f=[],m=new Set;let g={},b=1/0;for(let v=0;v<k5;v++){const w=C5[v],T=e[w],C=c[w]!==void 0?c[w]:d[w],k=rf(C),$=w===l?T.isActive:null;$===!1&&(b=v);let I=C===d[w]&&C!==c[w]&&k;if(I&&s&&n.manuallyAnimateOnMount&&(I=!1),T.protectedKeys={...g},!T.isActive&&$===null||!C&&!T.prevProp||m0(C)||typeof C=="boolean")continue;const D=I5(T.prevProp,C);let _=D||w===l&&T.isActive&&!I&&k||v>b&&k,O=!1;const L=Array.isArray(C)?C:[C];let R=L.reduce(r(w),{});$===!1&&(R={});const{prevResolvedValues:V={}}=T,Y={...V,...R},Q=W=>{_=!0,m.has(W)&&(O=!0,m.delete(W)),T.needsAnimating[W]=!0;const X=n.getValue(W);X&&(X.liveStyle=!1)};for(const W in Y){const X=R[W],ot=V[W];if(g.hasOwnProperty(W))continue;let P=!1;Kw(X)&&Kw(ot)?P=!Q_(X,ot):P=X!==ot,P?X!=null?Q(W):m.add(W):X!==void 0&&m.has(W)?Q(W):T.protectedKeys[W]=!0}T.prevProp=C,T.prevResolvedValues=R,T.isActive&&(g={...g,...R}),s&&n.blockInitialAnimation&&(_=!1),_&&(!(I&&D)||O)&&f.push(...L.map(W=>({animation:W,options:{type:w}})))}if(m.size){const v={};if(typeof c.initial!="boolean"){const w=of(n,Array.isArray(c.initial)?c.initial[0]:c.initial);w&&w.transition&&(v.transition=w.transition)}m.forEach(w=>{const T=n.getBaseTarget(w),C=n.getValue(w);C&&(C.liveStyle=!0),v[w]=T??null}),f.push({animation:v})}let x=!!f.length;return s&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(x=!1),s=!1,x?t(f):Promise.resolve()}function o(l,c){var f;if(e[l].isActive===c)return Promise.resolve();(f=n.variantChildren)==null||f.forEach(m=>{var g;return(g=m.animationState)==null?void 0:g.setActive(l,c)}),e[l].isActive=c;const d=i(l);for(const m in e)e[m].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>e,reset:()=>{e=wA(),s=!0}}}function I5(n,t){return typeof t=="string"?t!==n:Array.isArray(t)?!Q_(t,n):!1}function Uo(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wA(){return{animate:Uo(!0),whileInView:Uo(),whileHover:Uo(),whileTap:Uo(),whileDrag:Uo(),whileFocus:Uo(),exit:Uo()}}class ho{constructor(t){this.isMounted=!1,this.node=t}update(){}}class A5 extends ho{constructor(t){super(t),t.animationState||(t.animationState=E5(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();m0(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:e}=this.node.prevProps||{};t!==e&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let R5=0;class D5 extends ho{constructor(){super(...arguments),this.id=R5++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:e}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const r=this.node.animationState.setActive("exit",!t);e&&!t&&r.then(()=>{e(this.id)})}mount(){const{register:t,onExitComplete:e}=this.node.presenceContext||{};e&&e(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const O5={animation:{Feature:A5},exit:{Feature:D5}};function lf(n,t,e,s={passive:!0}){return n.addEventListener(t,e,s),()=>n.removeEventListener(t,e)}function Lf(n){return{point:{x:n.pageX,y:n.pageY}}}const _5=n=>t=>R2(t)&&n(t,Lf(t));function Hd(n,t,e,s){return lf(n,t,_5(e),s)}function t3({top:n,left:t,right:e,bottom:s}){return{x:{min:t,max:e},y:{min:n,max:s}}}function F5({x:n,y:t}){return{top:t.min,right:n.max,bottom:t.max,left:n.min}}function L5(n,t){if(!t)return n;const e=t({x:n.left,y:n.top}),s=t({x:n.right,y:n.bottom});return{top:e.y,left:e.x,bottom:s.y,right:s.x}}const e3=1e-4,M5=1-e3,z5=1+e3,n3=.01,P5=0-n3,B5=0+n3;function ps(n){return n.max-n.min}function V5(n,t,e){return Math.abs(n-t)<=e}function SA(n,t,e,s=.5){n.origin=s,n.originPoint=je(t.min,t.max,n.origin),n.scale=ps(e)/ps(t),n.translate=je(e.min,e.max,n.origin)-n.originPoint,(n.scale>=M5&&n.scale<=z5||isNaN(n.scale))&&(n.scale=1),(n.translate>=P5&&n.translate<=B5||isNaN(n.translate))&&(n.translate=0)}function qd(n,t,e,s){SA(n.x,t.x,e.x,s?s.originX:void 0),SA(n.y,t.y,e.y,s?s.originY:void 0)}function TA(n,t,e){n.min=e.min+t.min,n.max=n.min+ps(t)}function U5(n,t,e){TA(n.x,t.x,e.x),TA(n.y,t.y,e.y)}function NA(n,t,e){n.min=t.min-e.min,n.max=n.min+ps(t)}function Kd(n,t,e){NA(n.x,t.x,e.x),NA(n.y,t.y,e.y)}const CA=()=>({translate:0,scale:1,origin:0,originPoint:0}),Lu=()=>({x:CA(),y:CA()}),kA=()=>({min:0,max:0}),on=()=>({x:kA(),y:kA()});function br(n){return[n("x"),n("y")]}function sw(n){return n===void 0||n===1}function Zw({scale:n,scaleX:t,scaleY:e}){return!sw(n)||!sw(t)||!sw(e)}function qo(n){return Zw(n)||s3(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function s3(n){return $A(n.x)||$A(n.y)}function $A(n){return n&&n!=="0%"}function Iy(n,t,e){const s=n-e,r=t*s;return e+r}function EA(n,t,e,s,r){return r!==void 0&&(n=Iy(n,r,s)),Iy(n,e,s)+t}function Qw(n,t=0,e=1,s,r){n.min=EA(n.min,t,e,s,r),n.max=EA(n.max,t,e,s,r)}function r3(n,{x:t,y:e}){Qw(n.x,t.translate,t.scale,t.originPoint),Qw(n.y,e.translate,e.scale,e.originPoint)}const IA=.999999999999,AA=1.0000000000001;function W5(n,t,e,s=!1){const r=e.length;if(!r)return;t.x=t.y=1;let a,i;for(let o=0;o<r;o++){a=e[o],i=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&a.options.layoutScroll&&a.scroll&&a!==a.root&&zu(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,r3(n,i)),s&&qo(a.latestValues)&&zu(n,a.latestValues))}t.x<AA&&t.x>IA&&(t.x=1),t.y<AA&&t.y>IA&&(t.y=1)}function Mu(n,t){n.min=n.min+t,n.max=n.max+t}function RA(n,t,e,s,r=.5){const a=je(n.min,n.max,r);Qw(n,t,e,a,s)}function zu(n,t){RA(n.x,t.x,t.scaleX,t.scale,t.originX),RA(n.y,t.y,t.scaleY,t.scale,t.originY)}function a3(n,t){return t3(L5(n.getBoundingClientRect(),t))}function G5(n,t,e){const s=a3(n,e),{scroll:r}=t;return r&&(Mu(s.x,r.offset.x),Mu(s.y,r.offset.y)),s}const i3=({current:n})=>n?n.ownerDocument.defaultView:null,DA=(n,t)=>Math.abs(n-t);function j5(n,t){const e=DA(n.x,t.x),s=DA(n.y,t.y);return Math.sqrt(e**2+s**2)}class o3{constructor(t,e,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:a=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=aw(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,g=j5(f.offset,{x:0,y:0})>=3;if(!m&&!g)return;const{point:b}=f,{timestamp:x}=qn;this.history.push({...b,timestamp:x});const{onStart:v,onMove:w}=this.handlers;m||(v&&v(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=rw(m,this.transformPagePoint),Fe.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:g,onSessionEnd:b,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=aw(f.type==="pointercancel"?this.lastMoveEventInfo:rw(m,this.transformPagePoint),this.history);this.startEvent&&g&&g(f,v),b&&b(f,v)},!R2(t))return;this.dragSnapToOrigin=a,this.handlers=e,this.transformPagePoint=s,this.contextWindow=r||window;const i=Lf(t),o=rw(i,this.transformPagePoint),{point:l}=o,{timestamp:c}=qn;this.history=[{...l,timestamp:c}];const{onSessionStart:d}=e;d&&d(t,aw(o,this.history)),this.removeListeners=Of(Hd(this.contextWindow,"pointermove",this.handlePointerMove),Hd(this.contextWindow,"pointerup",this.handlePointerUp),Hd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Zi(this.updatePoint)}}function rw(n,t){return t?{point:t(n.point)}:n}function OA(n,t){return{x:n.x-t.x,y:n.y-t.y}}function aw({point:n},t){return{point:n,delta:OA(n,l3(t)),offset:OA(n,H5(t)),velocity:q5(t,.1)}}function H5(n){return n[0]}function l3(n){return n[n.length-1]}function q5(n,t){if(n.length<2)return{x:0,y:0};let e=n.length-1,s=null;const r=l3(n);for(;e>=0&&(s=n[e],!(r.timestamp-s.timestamp>la(t)));)e--;if(!s)return{x:0,y:0};const a=ua(r.timestamp-s.timestamp);if(a===0)return{x:0,y:0};const i={x:(r.x-s.x)/a,y:(r.y-s.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function K5(n,{min:t,max:e},s){return t!==void 0&&n<t?n=s?je(t,n,s.min):Math.max(n,t):e!==void 0&&n>e&&(n=s?je(e,n,s.max):Math.min(n,e)),n}function _A(n,t,e){return{min:t!==void 0?n.min+t:void 0,max:e!==void 0?n.max+e-(n.max-n.min):void 0}}function X5(n,{top:t,left:e,bottom:s,right:r}){return{x:_A(n.x,e,r),y:_A(n.y,t,s)}}function FA(n,t){let e=t.min-n.min,s=t.max-n.max;return t.max-t.min<n.max-n.min&&([e,s]=[s,e]),{min:e,max:s}}function Y5(n,t){return{x:FA(n.x,t.x),y:FA(n.y,t.y)}}function Z5(n,t){let e=.5;const s=ps(n),r=ps(t);return r>s?e=tf(t.min,t.max-s,n.min):s>r&&(e=tf(n.min,n.max-r,t.min)),ti(0,1,e)}function Q5(n,t){const e={};return t.min!==void 0&&(e.min=t.min-n.min),t.max!==void 0&&(e.max=t.max-n.min),e}const Jw=.35;function J5(n=Jw){return n===!1?n=0:n===!0&&(n=Jw),{x:LA(n,"left","right"),y:LA(n,"top","bottom")}}function LA(n,t,e){return{min:MA(n,t),max:MA(n,e)}}function MA(n,t){return typeof n=="number"?n:n[t]||0}const tH=new WeakMap;class eH{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=on(),this.visualElement=t}start(t,{snapToCursor:e=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),e&&this.snapToCursor(Lf(d).point)},a=(d,f)=>{const{drag:m,dragPropagation:g,onDragStart:b}=this.getProps();if(m&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=gj(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),br(v=>{let w=this.getAxisMotionValue(v).get()||0;if(ca.test(w)){const{projection:T}=this.visualElement;if(T&&T.layout){const C=T.layout.layoutBox[v];C&&(w=ps(C)*(parseFloat(w)/100))}}this.originPoint[v]=w}),b&&Fe.postRender(()=>b(d,f)),Xw(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},i=(d,f)=>{const{dragPropagation:m,dragDirectionLock:g,onDirectionLock:b,onDrag:x}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:v}=f;if(g&&this.currentDirection===null){this.currentDirection=nH(v),this.currentDirection!==null&&b&&b(this.currentDirection);return}this.updateAxis("x",f.point,v),this.updateAxis("y",f.point,v),this.visualElement.render(),x&&x(d,f)},o=(d,f)=>this.stop(d,f),l=()=>br(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)==null?void 0:f.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new o3(t,{onSessionStart:r,onStart:a,onMove:i,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:i3(this.visualElement)})}stop(t,e){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:r}=e;this.startAnimation(r);const{onDragEnd:a}=this.getProps();a&&Fe.postRender(()=>a(t,e))}cancel(){this.isDragging=!1;const{projection:t,animationState:e}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),e&&e.setActive("whileDrag",!1)}updateAxis(t,e,s){const{drag:r}=this.getProps();if(!s||!Vg(t,r,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(i=K5(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){var a;const{dragConstraints:t,dragElastic:e}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,r=this.constraints;t&&Fu(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=X5(s.layoutBox,t):this.constraints=!1,this.elastic=J5(e),r!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&br(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=Q5(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:e}=this.getProps();if(!t||!Fu(t))return!1;const s=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const a=G5(s,r.root,this.visualElement.getTransformPagePoint());let i=Y5(r.layout.layoutBox,a);if(e){const o=e(F5(i));this.hasMutatedConstraints=!!o,o&&(i=t3(o))}return i}startAnimation(t){const{drag:e,dragMomentum:s,dragElastic:r,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=br(d=>{if(!Vg(d,e,this.currentDirection))return;let f=l&&l[d]||{};i&&(f={min:0,max:0});const m=r?200:1e6,g=r?40:1e7,b={type:"inertia",velocity:s?t[d]:0,bounceStiffness:m,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,b)});return Promise.all(c).then(o)}startAxisValueAnimation(t,e){const s=this.getAxisMotionValue(t);return Xw(this.visualElement,t),s.start(U2(t,s,0,e,this.visualElement,!1))}stopAnimation(){br(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){br(t=>{var e;return(e=this.getAxisMotionValue(t).animation)==null?void 0:e.pause()})}getAnimationState(t){var e;return(e=this.getAxisMotionValue(t).animation)==null?void 0:e.state}getAxisMotionValue(t){const e=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),r=s[e];return r||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){br(e=>{const{drag:s}=this.getProps();if(!Vg(e,s,this.currentDirection))return;const{projection:r}=this.visualElement,a=this.getAxisMotionValue(e);if(r&&r.layout){const{min:i,max:o}=r.layout.layoutBox[e];a.set(t[e]-je(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:e}=this.getProps(),{projection:s}=this.visualElement;if(!Fu(e)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};br(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const l=o.get();r[i]=Z5({min:l,max:l},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),br(i=>{if(!Vg(i,t,null))return;const o=this.getAxisMotionValue(i),{min:l,max:c}=this.constraints[i];o.set(je(l,c,r[i]))})}addListeners(){if(!this.visualElement.current)return;tH.set(this.visualElement,this);const t=this.visualElement.current,e=Hd(t,"pointerdown",l=>{const{drag:c,dragListener:d=!0}=this.getProps();c&&d&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();Fu(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,a=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Fe.read(s);const i=lf(window,"resize",()=>this.scalePositionWithinConstraints()),o=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(br(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=l[d].translate,f.set(f.get()+l[d].translate))}),this.visualElement.render())});return()=>{i(),e(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:e=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:a=!1,dragElastic:i=Jw,dragMomentum:o=!0}=t;return{...t,drag:e,dragDirectionLock:s,dragPropagation:r,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function Vg(n,t,e){return(t===!0||t===n)&&(e===null||e===n)}function nH(n,t=10){let e=null;return Math.abs(n.y)>t?e="y":Math.abs(n.x)>t&&(e="x"),e}class sH extends ho{constructor(t){super(t),this.removeGroupControls=Tr,this.removeListeners=Tr,this.controls=new eH(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Tr}unmount(){this.removeGroupControls(),this.removeListeners()}}const zA=n=>(t,e)=>{n&&Fe.postRender(()=>n(t,e))};class rH extends ho{constructor(){super(...arguments),this.removePointerDownListener=Tr}onPointerDown(t){this.session=new o3(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:i3(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:e,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:zA(t),onStart:zA(e),onMove:s,onEnd:(a,i)=>{delete this.session,r&&Fe.postRender(()=>r(a,i))}}}mount(){this.removePointerDownListener=Hd(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const cy={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function PA(n,t){return t.max===t.min?0:n/(t.max-t.min)*100}const kd={correct:(n,t)=>{if(!t.target)return n;if(typeof n=="string")if(Vt.test(n))n=parseFloat(n);else return n;const e=PA(n,t.target.x),s=PA(n,t.target.y);return`${e}% ${s}%`}},aH={correct:(n,{treeScale:t,projectionDelta:e})=>{const s=n,r=Qi.parse(n);if(r.length>5)return s;const a=Qi.createTransformer(n),i=typeof r[0]!="number"?1:0,o=e.x.scale*t.x,l=e.y.scale*t.y;r[0+i]/=o,r[1+i]/=l;const c=je(o,l,.5);return typeof r[2+i]=="number"&&(r[2+i]/=c),typeof r[3+i]=="number"&&(r[3+i]/=c),a(r)}};class iH extends nt.Component{componentDidMount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:s,layoutId:r}=this.props,{projection:a}=t;Wj(oH),a&&(e.group&&e.group.add(a),s&&s.register&&r&&s.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),cy.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:e,visualElement:s,drag:r,isPresent:a}=this.props,i=s.projection;return i&&(i.isPresent=a,r||t.layoutDependency!==e||e===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||Fe.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),A2.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:s}=this.props,{projection:r}=t;r&&(r.scheduleCheckAfterUnmount(),e&&e.group&&e.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function u3(n){const[t,e]=HO(),s=nt.useContext(l2);return q.jsx(iH,{...n,layoutGroup:s,switchLayoutGroup:nt.useContext(P_),isPresent:t,safeToRemove:e})}const oH={borderRadius:{...kd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:kd,borderTopRightRadius:kd,borderBottomLeftRadius:kd,borderBottomRightRadius:kd,boxShadow:aH};function lH(n,t,e){const s=os(n)?n:sf(n);return s.start(U2("",s,t,e)),s.animation}function uH(n){return n instanceof SVGElement&&n.tagName!=="svg"}const cH=(n,t)=>n.depth-t.depth;class hH{constructor(){this.children=[],this.isDirty=!1}add(t){d2(this.children,t),this.isDirty=!0}remove(t){f2(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(cH),this.isDirty=!1,this.children.forEach(t)}}function dH(n,t){const e=_s.now(),s=({timestamp:r})=>{const a=r-e;a>=t&&(Zi(s),n(a-t))};return Fe.setup(s,!0),()=>Zi(s)}const c3=["TopLeft","TopRight","BottomLeft","BottomRight"],fH=c3.length,BA=n=>typeof n=="string"?parseFloat(n):n,VA=n=>typeof n=="number"||Vt.test(n);function pH(n,t,e,s,r,a){r?(n.opacity=je(0,e.opacity??1,mH(s)),n.opacityExit=je(t.opacity??1,0,gH(s))):a&&(n.opacity=je(t.opacity??1,e.opacity??1,s));for(let i=0;i<fH;i++){const o=`border${c3[i]}Radius`;let l=UA(t,o),c=UA(e,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||VA(l)===VA(c)?(n[o]=Math.max(je(BA(l),BA(c),s),0),(ca.test(c)||ca.test(l))&&(n[o]+="%")):n[o]=c}(t.rotate||e.rotate)&&(n.rotate=je(t.rotate||0,e.rotate||0,s))}function UA(n,t){return n[t]!==void 0?n[t]:n.borderRadius}const mH=h3(0,.5,n_),gH=h3(.5,.95,Tr);function h3(n,t,e){return s=>s<n?0:s>t?1:e(tf(n,t,s))}function WA(n,t){n.min=t.min,n.max=t.max}function mr(n,t){WA(n.x,t.x),WA(n.y,t.y)}function GA(n,t){n.translate=t.translate,n.scale=t.scale,n.originPoint=t.originPoint,n.origin=t.origin}function jA(n,t,e,s,r){return n-=t,n=Iy(n,1/e,s),r!==void 0&&(n=Iy(n,1/r,s)),n}function yH(n,t=0,e=1,s=.5,r,a=n,i=n){if(ca.test(t)&&(t=parseFloat(t),t=je(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=je(a.min,a.max,s);n===a&&(o-=t),n.min=jA(n.min,t,e,o,r),n.max=jA(n.max,t,e,o,r)}function HA(n,t,[e,s,r],a,i){yH(n,t[e],t[s],t[r],t.scale,a,i)}const bH=["x","scaleX","originX"],xH=["y","scaleY","originY"];function qA(n,t,e,s){HA(n.x,t,bH,e?e.x:void 0,s?s.x:void 0),HA(n.y,t,xH,e?e.y:void 0,s?s.y:void 0)}function KA(n){return n.translate===0&&n.scale===1}function d3(n){return KA(n.x)&&KA(n.y)}function XA(n,t){return n.min===t.min&&n.max===t.max}function vH(n,t){return XA(n.x,t.x)&&XA(n.y,t.y)}function YA(n,t){return Math.round(n.min)===Math.round(t.min)&&Math.round(n.max)===Math.round(t.max)}function f3(n,t){return YA(n.x,t.x)&&YA(n.y,t.y)}function ZA(n){return ps(n.x)/ps(n.y)}function QA(n,t){return n.translate===t.translate&&n.scale===t.scale&&n.originPoint===t.originPoint}class wH{constructor(){this.members=[]}add(t){d2(this.members,t),t.scheduleRender()}remove(t){if(f2(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(t){const e=this.members.findIndex(r=>t===r);if(e===0)return!1;let s;for(let r=e;r>=0;r--){const a=this.members[r];if(a.isPresent!==!1){s=a;break}}return s?(this.promote(s),!0):!1}promote(t,e){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,e&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:e,resumingFrom:s}=t;e.onExitComplete&&e.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function SH(n,t,e){let s="";const r=n.x.translate/t.x,a=n.y.translate/t.y,i=(e==null?void 0:e.z)||0;if((r||a||i)&&(s=`translate3d(${r}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),e){const{transformPerspective:c,rotate:d,rotateX:f,rotateY:m,skewX:g,skewY:b}=e;c&&(s=`perspective(${c}px) ${s}`),d&&(s+=`rotate(${d}deg) `),f&&(s+=`rotateX(${f}deg) `),m&&(s+=`rotateY(${m}deg) `),g&&(s+=`skewX(${g}deg) `),b&&(s+=`skewY(${b}deg) `)}const o=n.x.scale*t.x,l=n.y.scale*t.y;return(o!==1||l!==1)&&(s+=`scale(${o}, ${l})`),s||"none"}const iw=["","X","Y","Z"],TH={visibility:"hidden"},JA=1e3;let NH=0;function ow(n,t,e,s){const{latestValues:r}=t;r[n]&&(e[n]=r[n],t.setStaticValue(n,0),s&&(s[n]=0))}function p3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:t}=n.options;if(!t)return;const e=Y_(t);if(window.MotionHasOptimisedAnimation(e,"transform")){const{layout:r,layoutId:a}=n.options;window.MotionCancelOptimisedAnimation(e,"transform",Fe,!(r||a))}const{parent:s}=n;s&&!s.hasCheckedOptimisedAppear&&p3(s)}function m3({attachResizeListener:n,defaultParent:t,measureScroll:e,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(i={},o=t==null?void 0:t()){this.id=NH++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach($H),this.nodes.forEach(DH),this.nodes.forEach(OH),this.nodes.forEach(EH)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new hH)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new g2),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const l=this.eventHandlers.get(i);l&&l.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=uH(i),this.instance=i;const{layoutId:l,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),n){let f;const m=()=>this.root.updateBlockedByResize=!1;n(i,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=dH(m,250),cy.hasAnimatedSinceResize&&(cy.hasAnimatedSinceResize=!1,this.nodes.forEach(eR))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||c)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeLayoutChanged:g,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||zH,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=d.getProps(),T=!this.targetLayout||!f3(this.targetLayout,b),C=!m&&g;if(this.options.layoutRoot||this.resumeFrom||C||m&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,C);const k={...E2(x,"layout"),onPlay:v,onComplete:w};(d.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k)}else m||eR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Zi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(_H),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&p3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(tR);return}this.isUpdating||this.nodes.forEach(AH),this.isUpdating=!1,this.nodes.forEach(RH),this.nodes.forEach(CH),this.nodes.forEach(kH),this.clearAllSnapshots();const o=_s.now();qn.delta=ti(0,1e3/60,o-qn.timestamp),qn.timestamp=o,qn.isProcessing=!0,Qv.update.process(qn),Qv.preRender.process(qn),Qv.render.process(qn),qn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,A2.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(IH),this.sharedNodes.forEach(FH)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Fe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Fe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ps(this.snapshot.measuredBox.x)&&!ps(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=on(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:e(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!d3(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,d=c!==this.prevTransformTemplateValue;i&&(o||qo(this.latestValues)||d)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return i&&(l=this.removeTransform(l)),PH(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:i}=this.options;if(!i)return on();const o=i.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(BH))){const{scroll:d}=this.root;d&&(Mu(o.x,d.offset.x),Mu(o.y,d.offset.y))}return o}removeElementScroll(i){var l;const o=on();if(mr(o,i),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:f,options:m}=d;d!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&mr(o,i),Mu(o.x,f.offset.x),Mu(o.y,f.offset.y))}return o}applyTransform(i,o=!1){const l=on();mr(l,i);for(let c=0;c<this.path.length;c++){const d=this.path[c];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&zu(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),qo(d.latestValues)&&zu(l,d.latestValues)}return qo(this.latestValues)&&zu(l,this.latestValues),l}removeTransform(i){const o=on();mr(o,i);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!qo(c.latestValues))continue;Zw(c.latestValues)&&c.updateSnapshot();const d=on(),f=c.measurePageBox();mr(d,f),qA(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,d)}return qo(this.latestValues)&&qA(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==qn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var m;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(i||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=qn.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=on(),this.relativeTargetOrigin=on(),Kd(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),mr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=on(),this.targetWithTransforms=on()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),U5(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):mr(this.target,this.layout.layoutBox),r3(this.target,this.targetDelta)):mr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=on(),this.relativeTargetOrigin=on(),Kd(this.relativeTargetOrigin,this.target,g.target),mr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Zw(this.parent.latestValues)||s3(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var b;const i=this.getLead(),o=!!this.resumingFrom||this!==i;let l=!0;if((this.isProjectionDirty||(b=this.parent)!=null&&b.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===qn.timestamp&&(l=!1),l)return;const{layout:c,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||d))return;mr(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;W5(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=on());const{target:g}=i;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(GA(this.prevProjectionDelta.x,this.projectionDelta.x),GA(this.prevProjectionDelta.y,this.projectionDelta.y)),qd(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==m||!QA(this.projectionDelta.x,this.prevProjectionDelta.x)||!QA(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Lu(),this.projectionDelta=Lu(),this.projectionDeltaWithTransform=Lu()}setAnimationOrigin(i,o=!1){const l=this.snapshot,c=l?l.latestValues:{},d={...this.latestValues},f=Lu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=on(),g=l?l.source:void 0,b=this.layout?this.layout.source:void 0,x=g!==b,v=this.getStack(),w=!v||v.members.length<=1,T=!!(x&&!w&&this.options.crossfade===!0&&!this.path.some(MH));this.animationProgress=0;let C;this.mixTargetDelta=k=>{const $=k/1e3;nR(f.x,i.x,$),nR(f.y,i.y,$),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Kd(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),LH(this.relativeTarget,this.relativeTargetOrigin,m,$),C&&vH(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=on()),mr(C,this.relativeTarget)),x&&(this.animationValues=d,pH(d,c,this.latestValues,$,T,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=$},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Zi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Fe.update(()=>{cy.hasAnimatedSinceResize=!0,this.currentAnimation=lH(0,JA,{...i,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(JA),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:d}=i;if(!(!o||!l||!c)){if(this!==i&&this.layout&&c&&g3(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||on();const f=ps(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+f;const m=ps(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+m}mr(o,l),zu(o,d),qd(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new wH),this.sharedNodes.get(i).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var o;const{layoutId:i}=this.options;return i?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:i}=this.options;return i?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&ow("z",i,c,this.animationValues);for(let d=0;d<iw.length;d++)ow(`rotate${iw[d]}`,i,c,this.animationValues),ow(`skew${iw[d]}`,i,c,this.animationValues);i.render();for(const d in c)i.setStaticValue(d,c[d]),this.animationValues&&(this.animationValues[d]=c[d]);i.scheduleRender()}getProjectionStyles(i){if(!this.instance||this.isSVG)return;if(!this.isVisible)return TH;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=uy(i==null?void 0:i.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=uy(i==null?void 0:i.pointerEvents)||""),this.hasProjected&&!qo(this.latestValues)&&(g.transform=l?l({},""):"none",this.hasProjected=!1),g}const d=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=SH(this.projectionDeltaWithTransform,this.treeScale,d),l&&(o.transform=l(d,o.transform));const{x:f,y:m}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,c.animationValues?o.opacity=c===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:o.opacity=c===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in af){if(d[g]===void 0)continue;const{correct:b,applyTo:x,isCSSVariable:v}=af[g],w=o.transform==="none"?d[g]:b(d[g],c);if(x){const T=x.length;for(let C=0;C<T;C++)o[x[C]]=w}else v?this.options.visualElement.renderState.vars[g]=w:o[g]=w}return this.options.layoutId&&(o.pointerEvents=c===this?uy(i==null?void 0:i.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(tR),this.root.sharedNodes.clear()}}}function CH(n){n.updateLayout()}function kH(n){var e;const t=((e=n.resumeFrom)==null?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=n.layout,{animationType:a}=n.options,i=t.source!==n.layout.source;a==="size"?br(f=>{const m=i?t.measuredBox[f]:t.layoutBox[f],g=ps(m);m.min=s[f].min,m.max=m.min+g}):g3(a,t.layoutBox,s)&&br(f=>{const m=i?t.measuredBox[f]:t.layoutBox[f],g=ps(s[f]);m.max=m.min+g,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+g)});const o=Lu();qd(o,s,t.layoutBox);const l=Lu();i?qd(l,n.applyTransform(r,!0),t.measuredBox):qd(l,s,t.layoutBox);const c=!d3(o);let d=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:g}=f;if(m&&g){const b=on();Kd(b,t.layoutBox,m.layoutBox);const x=on();Kd(x,s,g.layoutBox),f3(b,x)||(d=!0),f.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=b,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:s}=n.options;s&&s()}n.options.transition=void 0}function $H(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function EH(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function IH(n){n.clearSnapshot()}function tR(n){n.clearMeasurements()}function AH(n){n.isLayoutDirty=!1}function RH(n){const{visualElement:t}=n.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),n.resetTransform()}function eR(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function DH(n){n.resolveTargetDelta()}function OH(n){n.calcProjection()}function _H(n){n.resetSkewAndRotation()}function FH(n){n.removeLeadSnapshot()}function nR(n,t,e){n.translate=je(t.translate,0,e),n.scale=je(t.scale,1,e),n.origin=t.origin,n.originPoint=t.originPoint}function sR(n,t,e,s){n.min=je(t.min,e.min,s),n.max=je(t.max,e.max,s)}function LH(n,t,e,s){sR(n.x,t.x,e.x,s),sR(n.y,t.y,e.y,s)}function MH(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const zH={duration:.45,ease:[.4,0,.1,1]},rR=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),aR=rR("applewebkit/")&&!rR("chrome/")?Math.round:Tr;function iR(n){n.min=aR(n.min),n.max=aR(n.max)}function PH(n){iR(n.x),iR(n.y)}function g3(n,t,e){return n==="position"||n==="preserve-aspect"&&!V5(ZA(t),ZA(e),.2)}function BH(n){var t;return n!==n.root&&((t=n.scroll)==null?void 0:t.wasRoot)}const VH=m3({attachResizeListener:(n,t)=>lf(n,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),lw={current:void 0},y3=m3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!lw.current){const n=new VH({});n.mount(window),n.setOptions({layoutScroll:!0}),lw.current=n}return lw.current},resetTransform:(n,t)=>{n.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),UH={pan:{Feature:rH},drag:{Feature:sH,ProjectionNode:y3,MeasureLayout:u3}};function oR(n,t,e){const{props:s}=n;n.animationState&&s.whileHover&&n.animationState.setActive("whileHover",e==="Start");const r="onHover"+e,a=s[r];a&&Fe.postRender(()=>a(t,Lf(t)))}class WH extends ho{mount(){const{current:t}=this.node;t&&(this.unmount=bj(t,(e,s)=>(oR(this.node,s,"Start"),r=>oR(this.node,r,"End"))))}unmount(){}}class GH extends ho{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Of(lf(this.node.current,"focus",()=>this.onFocus()),lf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function lR(n,t,e){const{props:s}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&s.whileTap&&n.animationState.setActive("whileTap",e==="Start");const r="onTap"+(e==="End"?"":e),a=s[r];a&&Fe.postRender(()=>a(t,Lf(t)))}class jH extends ho{mount(){const{current:t}=this.node;t&&(this.unmount=Sj(t,(e,s)=>(lR(this.node,s,"Start"),(r,{success:a})=>lR(this.node,r,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const tS=new WeakMap,uw=new WeakMap,HH=n=>{const t=tS.get(n.target);t&&t(n)},qH=n=>{n.forEach(HH)};function KH({root:n,...t}){const e=n||document;uw.has(e)||uw.set(e,{});const s=uw.get(e),r=JSON.stringify(t);return s[r]||(s[r]=new IntersectionObserver(qH,{root:n,...t})),s[r]}function XH(n,t,e){const s=KH(t);return tS.set(n,e),s.observe(n),()=>{tS.delete(n),s.unobserve(n)}}const YH={some:0,all:1};class ZH extends ho{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:e,margin:s,amount:r="some",once:a}=t,i={root:e?e.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:YH[r]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,a&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),m=c?d:f;m&&m(l)};return XH(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:e}=this.node;["amount","margin","root"].some(QH(t,e))&&this.startObserver()}unmount(){}}function QH({viewport:n={}},{viewport:t={}}={}){return e=>n[e]!==t[e]}const JH={inView:{Feature:ZH},tap:{Feature:jH},focus:{Feature:GH},hover:{Feature:WH}},t8={layout:{ProjectionNode:y3,MeasureLayout:u3}},eS={current:null},b3={current:!1};function e8(){if(b3.current=!0,!!c2)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),t=()=>eS.current=n.matches;n.addListener(t),t()}else eS.current=!1}const n8=new WeakMap;function s8(n,t,e){for(const s in t){const r=t[s],a=e[s];if(os(r))n.addValue(s,r);else if(os(a))n.addValue(s,sf(r,{owner:n}));else if(a!==r)if(n.hasValue(s)){const i=n.getValue(s);i.liveStyle===!0?i.jump(r):i.hasAnimated||i.set(r)}else{const i=n.getStaticValue(s);n.addValue(s,sf(i!==void 0?i:r,{owner:n}))}}for(const s in e)t[s]===void 0&&n.removeValue(s);return t}const uR=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class r8{scrapeMotionValuesFromProps(t,e,s){return{}}constructor({parent:t,props:e,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=$2,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=_s.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,Fe.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:d}=i;this.onUpdate=d,this.latestValues=l,this.baseTarget={...l},this.initialValues=e.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=e,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=g0(e),this.isVariantNode=M_(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:f,...m}=this.scrapeMotionValuesFromProps(e,{},this);for(const g in m){const b=m[g];l[g]!==void 0&&os(b)&&b.set(l[g],!1)}}mount(t){this.current=t,n8.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,s)=>this.bindToMotionValue(s,e)),b3.current||e8(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:eS.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Zi(this.notifyUpdate),Zi(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}bindToMotionValue(t,e){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=kl.has(t);s&&this.onBindTransform&&this.onBindTransform();const r=e.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&Fe.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),a=e.on("renderRequest",this.scheduleRender);let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,e)),this.valueSubscriptions.set(t,()=>{r(),a(),i&&i(),e.owner&&e.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Hu){const e=Hu[t];if(!e)continue;const{isEnabled:s,Feature:r}=e;if(!this.features[t]&&r&&s(this.props)&&(this.features[t]=new r(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):on()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let s=0;s<uR.length;s++){const r=uR[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const a="on"+r,i=t[a];i&&(this.propEventSubscriptions[r]=this.on(r,i))}this.prevMotionValues=s8(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const s=this.values.get(t);e!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&e!==void 0&&(s=sf(e===null?void 0:e,{owner:this}),this.addValue(t,s)),s}readValue(t,e){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(qO(s)||KO(s))?s=parseFloat(s):!kj(s)&&Qi.test(e)&&(s=A_(t,e)),this.setBaseTarget(t,os(s)?s.get():s)),os(s)?s.get():s}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){var a;const{initial:e}=this.props;let s;if(typeof e=="string"||typeof e=="object"){const i=B2(this.props,e,(a=this.presenceContext)==null?void 0:a.custom);i&&(s=i[t])}if(e&&s!==void 0)return s;const r=this.getBaseTargetFromProps(this.props,t);return r!==void 0&&!os(r)?r:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,e){return this.events[t]||(this.events[t]=new g2),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}}class x3 extends r8{constructor(){super(...arguments),this.KeyframeResolver=mj}sortInstanceNodePosition(t,e){return t.compareDocumentPosition(e)&2?1:-1}getBaseTargetFromProps(t,e){return t.style?t.style[e]:void 0}removeValueFromRenderState(t,{vars:e,style:s}){delete e[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;os(t)&&(this.childSubscription=t.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}function a8(n){return window.getComputedStyle(n)}class i8 extends x3{constructor(){super(...arguments),this.type="html",this.renderInstance=H_}readValueFromInstance(t,e){if(kl.has(e))return _6(t,e);{const s=a8(t),r=(x2(e)?s.getPropertyValue(e):s[e])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(t,{transformPagePoint:e}){return a3(t,e)}build(t,e,s){F2(t,e,s.transformTemplate)}scrapeMotionValuesFromProps(t,e,s){return V2(t,e,s)}}class o8 extends x3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=on,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&j_(this.current,this.renderState)}}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(kl.has(e)){const s=I_(e);return s&&s.default||0}return e=q_.has(e)?e:_2(e),t.getAttribute(e)}scrapeMotionValuesFromProps(t,e,s){return X_(t,e,s)}onBindTransform(){this.current&&!this.renderState.dimensions&&Fe.postRender(this.updateDimensions)}build(t,e,s){z2(t,e,this.isSVGTag,s.transformTemplate)}renderInstance(t,e,s,r){K_(t,e,s,r)}mount(t){this.isSVGTag=P2(t.tagName),super.mount(t)}}const l8=(n,t)=>M2(n)?new o8(t):new i8(t,{allowProjection:n!==nt.Fragment}),u8=o5({...O5,...JH,...UH,...t8},l8),cR=Rj(u8);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c8=1e-7,h8=1e-4;class W2{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class y0{refCount(t){return As("refCount")}incRef(t){return As("incRef")}timerAvailable(){return!0}time(t){return As("time")}read(t){return As("read")}readSync(t){return As("readSync")}readToGPU(t,e){return As("readToGPU")}numDataIds(){return As("numDataIds")}disposeData(t,e){return As("disposeData")}write(t,e,s){return As("write")}move(t,e,s,r,a){return As("move")}createTensorFromGPUData(t,e,s){return As("createTensorFromGPUData")}memory(){return As("memory")}floatPrecision(){return As("floatPrecision")}epsilon(){return this.floatPrecision()===32?c8:h8}dispose(){return As("dispose")}}function As(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G2(n){let t=n.length,e=0;for(;t>0;)e=Math.random()*t|0,t--,Ka(n,t,e)}function d8(n,t){if(n.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${n.length}Second array length was ${t.length}`);let e=n.length,s=0;for(;e>0;)s=Math.random()*e|0,e--,Ka(n,e,s),Ka(t,e,s)}function Ji(n,t,e){return Math.max(n,Math.min(t,e))}function b0(n){return n%2===0?n:n+1}function Ka(n,t,e){const s=n[t];n[t]=n[e],n[e]=s}function v3(n){let t=0;for(let e=0;e<n.length;e++)t+=n[e];return t}function f8(n,t){const e=Math.random();return t*e+(1-e)*n}function p8(n,t){let e=0;for(let s=0;s<n.length;s++){const r=Number(n[s])-Number(t[s]);e+=r*r}return e}function F(n,t){if(!n)throw new Error(typeof t=="string"?t:t())}function zn(n,t,e=""){F(te(n,t),()=>e+` Shapes ${n} and ${t} must match`)}function $l(n){F(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ft(n){if(n.length===0)return 1;let t=n[0];for(let e=1;e<n.length;e++)t*=n[e];return t}function m8(n){return n.length===0}function w3(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==null&&t[e]!==null&&n[e]!==t[e])return!1;return!0}function te(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function hl(n){return n%1===0}function g8(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{const t=Math.exp(2*n);return(t-1)/(t+1)}}function Ay(n){const t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function y8(n){const t=new Uint32Array(n);for(let e=0;e<n;++e)t[e]=e;return G2(t),t}function il(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function nS(n,t=r=>0,e,s){return new Promise((r,a)=>{let i=0;const o=()=>{if(n()){r();return}i++;const l=t(i);if(e!=null&&i>=e){a();return}s!=null?s(o,l):setTimeout(o,l)};o()})}function j2(n,t){let e=1,s=-1;for(let a=0;a<n.length;++a)if(n[a]>=0)e*=n[a];else if(n[a]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${a}`);s=a}else if(n[a]<0)throw Error(`Shapes can not be < 0. Found ${n[a]} at dim ${a}`);if(s===-1){if(t>0&&t!==e)throw Error(`Size(${t}) must match the product of shape ${n}`);return n}if(e===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(t%e!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${e}`);const r=n.slice();return r[s]=t/e,r}function Zt(n,t){const e=t.length;return n=n==null?t.map((s,r)=>r):[].concat(n),F(n.every(s=>s>=-e&&s<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${n}`),F(n.every(s=>hl(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?e+s:s)}function ui(n,t){const e=[],s=[],r=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||r?null:Zt(t,n).sort();let i=0;for(let o=0;o<n.length;++o){if(a!=null){if(a[i]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(a[i]==null||a[i]>o)&&n[o]===1&&(e.push(n[o]),s.push(o)),a[i]<=o&&i++}n[o]!==1&&(e.push(n[o]),s.push(o))}return{newShape:e,keptDims:s}}function kn(n,t){return He(n,t)}function He(n,t){let e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else if(n==="bool")e=new Uint8Array(t);else if(n==="string")e=new Array(t);else throw new Error(`Unknown data type ${n}`);return e}function S3(n,t){for(let e=0;e<n.length;e++){const s=n[e];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${t} being uploaded contains ${s}.`)}}function T3(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function H2(n,t){return!(t==="complex64"||t==="float32"&&n!=="complex64"||t==="int32"&&n!=="float32"&&n!=="complex64"||t==="bool"&&n==="bool")}function uf(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function N3(n){if(n==null)return 0;let t=0;return n.forEach(e=>t+=e.length),t}function ia(n){return typeof n=="string"||n instanceof String}function C3(n){return typeof n=="boolean"}function Ry(n){return typeof n=="number"}function El(n){return Array.isArray(n)?El(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":Ry(n)?"float32":ia(n)?"string":C3(n)?"bool":"float32"}function to(n){return!!(n&&n.constructor&&n.call&&n.apply)}function Dy(n,t){for(let e=t;e<n;++e)if(n%e===0)return e;return n}function Ft(n){const t=n.length;if(t<2)return[];const e=new Array(t-1);e[t-2]=n[t-1];for(let s=t-3;s>=0;--s)e[s]=e[s+1]*n[s+1];return e}function k3(n,t,e,s=!1){const r=new Array;if(t.length===1){const a=t[0]*(s?2:1);for(let i=0;i<a;i++)r[i]=e[n+i]}else{const a=t[0],i=t.slice(1),o=i.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<a;l++)r[l]=k3(n+l*o,i,e,s)}return r}function tr(n,t,e=!1){if(n.length===0)return t[0];const s=n.reduce((r,a)=>r*a)*(e?2:1);if(s===0)return[];if(s!==t.length)throw new Error(`[${n}] does not match the input size ${t.length}${e?" for a complex tensor":""}.`);return k3(0,n,t,e)}function $3(n,t){if(Array.isArray(n))return n;if(t==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(t==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${t}`)}function x0(n,t){const e=Mn(n,t);for(let s=0;s<e.length;s++)e[s]=1;return e}function Mn(n,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${t}`)}function q2(n,t){const e=n.reduce((s,r)=>s*r,1);if(t==null||t==="float32")return tr(n,new Float32Array(e));if(t==="int32")return tr(n,new Int32Array(e));if(t==="bool")return tr(n,new Uint8Array(e));throw new Error(`Unknown data type ${t}`)}function Bs(n){n.forEach(t=>{F(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function Br(n,t,e){if(t===0)return 0;if(t===1)return n[0];let s=n[n.length-1];for(let r=0;r<n.length-1;++r)s+=e[r]*n[r];return s}function Il(n,t,e){if(t===0)return[];if(t===1)return[n];const s=new Array(t);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(n/e[r]),n-=s[r]*e[r];return s[s.length-1]=n,s}function eo(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hR="tfjsflags";class E3{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=b8,this.populateURLFlags()}setPlatform(t,e){this.platform!=null&&(lt().getBool("IS_TEST")||lt().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,s){if(this.flagRegistry[t]={evaluationFn:e,setHook:s},this.urlFlags[t]!=null){const r=this.urlFlags[t];lt().getBool("IS_TEST")||lt().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${r}.`),this.set(t,r)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(eo(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);hR in t&&t[hR].split(",").forEach(s=>{const[r,a]=s.split(":");this.urlFlags[r]=v8(r,a)})}}function b8(n){const t={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...s)=>(x8(t,s[0],s[1]),s.join("="))),t}function x8(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}function v8(n,t){const e=t.toLowerCase();return e==="true"||e==="false"?e==="true":`${+e}`===e?+e:t}function lt(){return K2}let K2=null;function w8(n){K2=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let cw;function I3(){if(cw==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");cw=n}return cw}function S8(){const n=I3();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function X2(n,t){const e=S8();if(e.has(n))return e.get(n);{const s=t();return e.set(n,s),e.get(n)}}const Mf="Abs",fc="Acos",pc="Acosh",Al="Add",zf="AddN",v0="All",w0="Any",Pf="ArgMax",Bf="ArgMin",mc="Asin",gc="Asinh",yc="Atan",bc="Atanh",xc="Atan2",Vf="AvgPool",S0="AvgPoolGrad",Uf="AvgPool3D",T0="AvgPool3DGrad",Wf="BatchMatMul",Gf="BatchToSpaceND",N0="Bincount",jf="BitwiseAnd",A3="BroadcastTo",C0="BroadcastArgs",vc="Cast",wc="Ceil",Sc="ClipByValue",k0="Complex",Hf="ComplexAbs",qf="Concat",Kf="Conv2D",$0="Conv2DBackpropFilter",Xf="Conv2DBackpropInput",Yf="Conv3D",E0="Conv3DBackpropFilterV2",I0="Conv3DBackpropInputV2",Tc="Cos",Nc="Cosh",A0="Cumprod",Zf="Cumsum",R0="CropAndResize",D0="DenseBincount",O0="DepthToSpace",Qf="DepthwiseConv2dNative",_0="DepthwiseConv2dNativeBackpropFilter",F0="DepthwiseConv2dNativeBackpropInput",L0="Diag",Jf="Dilation2D",Oy="Dilation2DBackpropInput",_y="Dilation2DBackpropFilter",M0="Draw",Cc="RealDiv",z0="Einsum",kc="Elu",P0="EluGrad",$c="Erf",tp="Equal",Ec="Exp",ep="ExpandDims",Ic="Expm1",B0="FFT",V0="Fill",U0="FlipLeftRight",Ac="Floor",Rc="FloorDiv",np="FusedBatchNorm",sp="GatherV2",W0="GatherNd",rp="Greater",Dc="GreaterEqual",Oc="Identity",G0="IFFT",j0="Imag",_c="IsFinite",Fc="IsInf",Lc="IsNan",ap="LeakyRelu",ip="Less",op="LessEqual",H0="LinSpace",Mc="Log",zc="Log1p",lp="LogicalAnd",up="LogicalNot",cp="LogicalOr",T8="LogicalXor",R3="LogSoftmax",N8="LowerBound",hp="LRN",q0="LRNGrad",C8="MatrixBandPart",dp="Max",Pc="Maximum",fp="MaxPool",K0="MaxPoolGrad",pp="MaxPool3D",X0="MaxPool3DGrad",Y0="MaxPoolWithArgmax",mp="Mean",gp="Min",Bc="Minimum",yp="MirrorPad",Vc="Mod",Z0="Multinomial",Uc="Multiply",bp="Neg",xp="NotEqual",Q0="NonMaxSuppressionV3",J0="NonMaxSuppressionV4",tb="NonMaxSuppressionV5",vp="OnesLike",wp="OneHot",Sp="Pack",Tp="PadV2",k8="Pool",Wc="Pow",Np="Prelu",Cp="Prod",eb="RaggedGather",nb="RaggedRange",sb="RaggedTensorToTensor",rb="Range",ab="Real",Gc="Reciprocal",jc="Relu",kp="Reshape",$p="ResizeNearestNeighbor",ib="ResizeNearestNeighborGrad",Ep="ResizeBilinear",ob="ResizeBilinearGrad",Hc="Relu6",Ip="Reverse",qc="Round",Kc="Rsqrt",lb="ScatterNd",ub="TensorScatterUpdate",cb="SearchSorted",Ap="Select",Xc="Selu",Rp="Slice",Yc="Sin",Zc="Sinh",Qc="Sign",Jc="Sigmoid",th="Softplus",eh="Sqrt",Dp="Sum",Op="SpaceToBatchND",_p="SplitV",Fp="Softmax",hb="SparseFillEmptyRows",db="SparseReshape",fb="SparseSegmentMean",pb="SparseSegmentSum",mb="SparseToDense",nh="SquaredDifference",gb="Square",Lp="StaticRegexReplace",yb="StridedSlice",bb="StringNGrams",xb="StringSplit",vb="StringToHashBucketFast",sh="Sub",rh="Tan",ah="Tanh",ih="Tile",wb="TopK",Sb="Transform",ol="Transpose",Tb="Unique",Mp="Unpack",zp="UnsortedSegmentSum",$8="UpperBound",Pp="ZerosLike",oh="Step",Fy="FromPixels",Nb="RotateWithOffset",cf="_FusedMatMul",hf="FusedConv2D",df="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ys(...n){lt().getBool("IS_TEST")||lt().getBool("PROD")||console.warn(...n)}function E8(...n){lt().getBool("IS_TEST")||lt().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qu=X2("kernelRegistry",()=>new Map),ff=X2("gradRegistry",()=>new Map);function pf(n,t){const e=Y2(n,t);return qu.get(e)}function sS(n){return ff.get(n)}function Ly(n){const t=qu.entries(),e=[];for(;;){const{done:s,value:r}=t.next();if(s)break;const[a,i]=r,[o]=a.split("_");o===n&&e.push(i)}return e}function Cb(n){const{kernelName:t,backendName:e}=n,s=Y2(t,e);qu.has(s)&&Ys(`The kernel '${t}' for backend '${e}' is already registered`),qu.set(s,n)}function D3(n){const{kernelName:t}=n;ff.has(t)&&lt().getBool("DEBUG")&&Ys(`Overriding the gradient for '${t}'`),ff.set(t,n)}function I8(n,t){const e=Y2(n,t);if(!qu.has(e))throw new Error(`The kernel '${n}' for backend '${t}' is not registered`);qu.delete(e)}function A8(n){if(!ff.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);ff.delete(n)}function R8(n,t){Ly(n).forEach(s=>{const r=Object.assign({},s,{backendName:t});Cb(r)})}function Y2(n,t){return`${t}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O3(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var hw,dR;function D8(){if(dR)return hw;dR=1,hw=t;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(L,R,V){this.low=L|0,this.high=R|0,this.unsigned=!!V}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function e(L){return(L&&L.__isLong__)===!0}t.isLong=e;var s={},r={};function a(L,R){var V,Y,Q;return R?(L>>>=0,(Q=0<=L&&L<256)&&(Y=r[L],Y)?Y:(V=o(L,(L|0)<0?-1:0,!0),Q&&(r[L]=V),V)):(L|=0,(Q=-128<=L&&L<128)&&(Y=s[L],Y)?Y:(V=o(L,L<0?-1:0,!1),Q&&(s[L]=V),V))}t.fromInt=a;function i(L,R){if(isNaN(L))return R?T:w;if(R){if(L<0)return T;if(L>=b)return D}else{if(L<=-9223372036854776e3)return _;if(L+1>=x)return I}return L<0?i(-L,R).neg():o(L%g|0,L/g|0,R)}t.fromNumber=i;function o(L,R,V){return new t(L,R,V)}t.fromBits=o;var l=Math.pow;function c(L,R,V){if(L.length===0)throw Error("empty string");if(L==="NaN"||L==="Infinity"||L==="+Infinity"||L==="-Infinity")return w;if(typeof R=="number"?(V=R,R=!1):R=!!R,V=V||10,V<2||36<V)throw RangeError("radix");var Y;if((Y=L.indexOf("-"))>0)throw Error("interior hyphen");if(Y===0)return c(L.substring(1),R,V).neg();for(var Q=i(l(V,8)),tt=w,B=0;B<L.length;B+=8){var W=Math.min(8,L.length-B),X=parseInt(L.substring(B,B+W),V);if(W<8){var ot=i(l(V,W));tt=tt.mul(ot).add(i(X))}else tt=tt.mul(Q),tt=tt.add(i(X))}return tt.unsigned=R,tt}t.fromString=c;function d(L,R){return typeof L=="number"?i(L,R):typeof L=="string"?c(L,R):o(L.low,L.high,typeof R=="boolean"?R:L.unsigned)}t.fromValue=d;var f=65536,m=1<<24,g=f*f,b=g*g,x=b/2,v=a(m),w=a(0);t.ZERO=w;var T=a(0,!0);t.UZERO=T;var C=a(1);t.ONE=C;var k=a(1,!0);t.UONE=k;var $=a(-1);t.NEG_ONE=$;var I=o(-1,2147483647,!1);t.MAX_VALUE=I;var D=o(-1,-1,!0);t.MAX_UNSIGNED_VALUE=D;var _=o(0,-2147483648,!1);t.MIN_VALUE=_;var O=t.prototype;return O.toInt=function(){return this.unsigned?this.low>>>0:this.low},O.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},O.toString=function(R){if(R=R||10,R<2||36<R)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(_)){var V=i(R),Y=this.div(V),Q=Y.mul(V).sub(this);return Y.toString(R)+Q.toInt().toString(R)}else return"-"+this.neg().toString(R);for(var tt=i(l(R,6),this.unsigned),B=this,W="";;){var X=B.div(tt),ot=B.sub(X.mul(tt)).toInt()>>>0,P=ot.toString(R);if(B=X,B.isZero())return P+W;for(;P.length<6;)P="0"+P;W=""+P+W}},O.getHighBits=function(){return this.high},O.getHighBitsUnsigned=function(){return this.high>>>0},O.getLowBits=function(){return this.low},O.getLowBitsUnsigned=function(){return this.low>>>0},O.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var R=this.high!=0?this.high:this.low,V=31;V>0&&(R&1<<V)==0;V--);return this.high!=0?V+33:V+1},O.isZero=function(){return this.high===0&&this.low===0},O.eqz=O.isZero,O.isNegative=function(){return!this.unsigned&&this.high<0},O.isPositive=function(){return this.unsigned||this.high>=0},O.isOdd=function(){return(this.low&1)===1},O.isEven=function(){return(this.low&1)===0},O.equals=function(R){return e(R)||(R=d(R)),this.unsigned!==R.unsigned&&this.high>>>31===1&&R.high>>>31===1?!1:this.high===R.high&&this.low===R.low},O.eq=O.equals,O.notEquals=function(R){return!this.eq(R)},O.neq=O.notEquals,O.ne=O.notEquals,O.lessThan=function(R){return this.comp(R)<0},O.lt=O.lessThan,O.lessThanOrEqual=function(R){return this.comp(R)<=0},O.lte=O.lessThanOrEqual,O.le=O.lessThanOrEqual,O.greaterThan=function(R){return this.comp(R)>0},O.gt=O.greaterThan,O.greaterThanOrEqual=function(R){return this.comp(R)>=0},O.gte=O.greaterThanOrEqual,O.ge=O.greaterThanOrEqual,O.compare=function(R){if(e(R)||(R=d(R)),this.eq(R))return 0;var V=this.isNegative(),Y=R.isNegative();return V&&!Y?-1:!V&&Y?1:this.unsigned?R.high>>>0>this.high>>>0||R.high===this.high&&R.low>>>0>this.low>>>0?-1:1:this.sub(R).isNegative()?-1:1},O.comp=O.compare,O.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(C)},O.neg=O.negate,O.add=function(R){e(R)||(R=d(R));var V=this.high>>>16,Y=this.high&65535,Q=this.low>>>16,tt=this.low&65535,B=R.high>>>16,W=R.high&65535,X=R.low>>>16,ot=R.low&65535,P=0,j=0,rt=0,st=0;return st+=tt+ot,rt+=st>>>16,st&=65535,rt+=Q+X,j+=rt>>>16,rt&=65535,j+=Y+W,P+=j>>>16,j&=65535,P+=V+B,P&=65535,o(rt<<16|st,P<<16|j,this.unsigned)},O.subtract=function(R){return e(R)||(R=d(R)),this.add(R.neg())},O.sub=O.subtract,O.multiply=function(R){if(this.isZero())return w;if(e(R)||(R=d(R)),n){var V=n.mul(this.low,this.high,R.low,R.high);return o(V,n.get_high(),this.unsigned)}if(R.isZero())return w;if(this.eq(_))return R.isOdd()?_:w;if(R.eq(_))return this.isOdd()?_:w;if(this.isNegative())return R.isNegative()?this.neg().mul(R.neg()):this.neg().mul(R).neg();if(R.isNegative())return this.mul(R.neg()).neg();if(this.lt(v)&&R.lt(v))return i(this.toNumber()*R.toNumber(),this.unsigned);var Y=this.high>>>16,Q=this.high&65535,tt=this.low>>>16,B=this.low&65535,W=R.high>>>16,X=R.high&65535,ot=R.low>>>16,P=R.low&65535,j=0,rt=0,st=0,mt=0;return mt+=B*P,st+=mt>>>16,mt&=65535,st+=tt*P,rt+=st>>>16,st&=65535,st+=B*ot,rt+=st>>>16,st&=65535,rt+=Q*P,j+=rt>>>16,rt&=65535,rt+=tt*ot,j+=rt>>>16,rt&=65535,rt+=B*X,j+=rt>>>16,rt&=65535,j+=Y*P+Q*ot+tt*X+B*W,j&=65535,o(st<<16|mt,j<<16|rt,this.unsigned)},O.mul=O.multiply,O.divide=function(R){if(e(R)||(R=d(R)),R.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&R.low===-1&&R.high===-1)return this;var V=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,R.low,R.high);return o(V,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?T:w;var Y,Q,tt;if(this.unsigned){if(R.unsigned||(R=R.toUnsigned()),R.gt(this))return T;if(R.gt(this.shru(1)))return k;tt=T}else{if(this.eq(_)){if(R.eq(C)||R.eq($))return _;if(R.eq(_))return C;var B=this.shr(1);return Y=B.div(R).shl(1),Y.eq(w)?R.isNegative()?C:$:(Q=this.sub(R.mul(Y)),tt=Y.add(Q.div(R)),tt)}else if(R.eq(_))return this.unsigned?T:w;if(this.isNegative())return R.isNegative()?this.neg().div(R.neg()):this.neg().div(R).neg();if(R.isNegative())return this.div(R.neg()).neg();tt=w}for(Q=this;Q.gte(R);){Y=Math.max(1,Math.floor(Q.toNumber()/R.toNumber()));for(var W=Math.ceil(Math.log(Y)/Math.LN2),X=W<=48?1:l(2,W-48),ot=i(Y),P=ot.mul(R);P.isNegative()||P.gt(Q);)Y-=X,ot=i(Y,this.unsigned),P=ot.mul(R);ot.isZero()&&(ot=C),tt=tt.add(ot),Q=Q.sub(P)}return tt},O.div=O.divide,O.modulo=function(R){if(e(R)||(R=d(R)),n){var V=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,R.low,R.high);return o(V,n.get_high(),this.unsigned)}return this.sub(this.div(R).mul(R))},O.mod=O.modulo,O.rem=O.modulo,O.not=function(){return o(~this.low,~this.high,this.unsigned)},O.and=function(R){return e(R)||(R=d(R)),o(this.low&R.low,this.high&R.high,this.unsigned)},O.or=function(R){return e(R)||(R=d(R)),o(this.low|R.low,this.high|R.high,this.unsigned)},O.xor=function(R){return e(R)||(R=d(R)),o(this.low^R.low,this.high^R.high,this.unsigned)},O.shiftLeft=function(R){return e(R)&&(R=R.toInt()),(R&=63)===0?this:R<32?o(this.low<<R,this.high<<R|this.low>>>32-R,this.unsigned):o(0,this.low<<R-32,this.unsigned)},O.shl=O.shiftLeft,O.shiftRight=function(R){return e(R)&&(R=R.toInt()),(R&=63)===0?this:R<32?o(this.low>>>R|this.high<<32-R,this.high>>R,this.unsigned):o(this.high>>R-32,this.high>=0?0:-1,this.unsigned)},O.shr=O.shiftRight,O.shiftRightUnsigned=function(R){if(e(R)&&(R=R.toInt()),R&=63,R===0)return this;var V=this.high;if(R<32){var Y=this.low;return o(Y>>>R|V<<32-R,V>>>R,this.unsigned)}else return R===32?o(V,0,this.unsigned):o(V>>>R-32,0,this.unsigned)},O.shru=O.shiftRightUnsigned,O.shr_u=O.shiftRightUnsigned,O.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},O.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},O.toBytes=function(R){return R?this.toBytesLE():this.toBytesBE()},O.toBytesLE=function(){var R=this.high,V=this.low;return[V&255,V>>>8&255,V>>>16&255,V>>>24,R&255,R>>>8&255,R>>>16&255,R>>>24]},O.toBytesBE=function(){var R=this.high,V=this.low;return[R>>>24,R>>>16&255,R>>>8&255,R&255,V>>>24,V>>>16&255,V>>>8&255,V&255]},t.fromBytes=function(R,V,Y){return Y?t.fromBytesLE(R,V):t.fromBytesBE(R,V)},t.fromBytesLE=function(R,V){return new t(R[0]|R[1]<<8|R[2]<<16|R[3]<<24,R[4]|R[5]<<8|R[6]<<16|R[7]<<24,V)},t.fromBytesBE=function(R,V){return new t(R[4]<<24|R[5]<<16|R[6]<<8|R[7],R[0]<<24|R[1]<<16|R[2]<<8|R[3],V)},hw}var _3=D8();const F3=tO(_3),O8=DU({__proto__:null,default:F3},[_3]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yo=F3||O8;function Bp(n){return Yo.fromString(n,!0,16)}const L3=Bp("c3a5c85c97cb3127"),Ko=Bp("b492b66fbe98f273"),rs=Bp("9ae16a3b2f90404f");function rS(n){return n.xor(n.shru(47))}function M3(n,t,e){const s=n.slice(t,t+e);return Yo.fromBytes(Array.from(s),!0,!0)}function Re(n,t){return M3(n,t,8)}function fR(n,t){return M3(n,t,4)}function Tn(n,t){return t===0?n:n.shru(t).or(n.shl(64-t))}function qi(n,t,e=Bp("9ddfea08eb382d69")){let s=n.xor(t).mul(e);s=s.xor(s.shru(47));let r=t.xor(s).mul(e);return r=r.xor(r.shru(47)),r=r.mul(e),r}function _8(n,t,e,s,r,a){r=r.add(n),a=Tn(a.add(r).add(s),21);const i=r;return r=r.add(t),r=r.add(e),a=a.add(Tn(r,44)),[r.add(s),a.add(i)]}function Ug(n,t,e,s){return _8(Re(n,t),Re(n,t+8),Re(n,t+16),Re(n,t+24),e,s)}function F8(n,t=n.length){if(t>=8){const e=rs.add(t*2),s=Re(n,0).add(rs),r=Re(n,t-8),a=Tn(r,37).mul(e).add(s),i=Tn(s,25).add(r).mul(e);return qi(a,i,e)}if(t>=4){const e=rs.add(t*2),s=fR(n,0);return qi(s.shl(3).add(t),fR(n,t-4),e)}if(t>0){const e=n[0],s=n[t>>1],r=n[t-1],a=e+(s<<8),i=t+(r<<2);return rS(rs.mul(a).xor(L3.mul(i))).mul(rs)}return rs}function L8(n,t=n.length){const e=rs.add(t*2),s=Re(n,0).mul(Ko),r=Re(n,8),a=Re(n,t-8).mul(e),i=Re(n,t-16).mul(rs);return qi(Tn(s.add(r),43).add(Tn(a,30)).add(i),s.add(Tn(r.add(rs),18)).add(a),e)}function M8(n,t=n.length){const e=rs.add(t*2),s=Re(n,0).mul(rs),r=Re(n,8),a=Re(n,t-8).mul(e),i=Re(n,t-16).mul(rs),o=Tn(s.add(r),43).add(Tn(a,30)).add(i),l=qi(o,s.add(Tn(r.add(rs),18)).add(a),e),c=Re(n,16).mul(e),d=Re(n,24),f=o.add(Re(n,t-32)).mul(e),m=l.add(Re(n,t-24)).mul(e);return qi(Tn(c.add(d),43).add(Tn(f,30)).add(m),c.add(Tn(d.add(s),18)).add(f),e)}function z3(n,t=n.length){const e=Yo.fromNumber(81,!0);if(t<=32)return t<=16?F8(n,t):L8(n,t);if(t<=64)return M8(n,t);let s=e,r=e.mul(Ko).add(113),a=rS(r.mul(rs).add(113)).mul(rs),i=[Yo.UZERO,Yo.UZERO],o=[Yo.UZERO,Yo.UZERO];s=s.mul(rs).add(Re(n,0));let l=0;const c=(t-1>>6)*64,d=c+(t-1&63)-63;do s=Tn(s.add(r).add(i[0]).add(Re(n,l+8)),37).mul(Ko),r=Tn(r.add(i[1]).add(Re(n,l+48)),42).mul(Ko),s=s.xor(o[1]),r=r.add(i[0]).add(Re(n,l+40)),a=Tn(a.add(o[0]),33).mul(Ko),i=Ug(n,l,i[1].mul(Ko),s.add(o[0])),o=Ug(n,l+32,a.add(o[1]),r.add(Re(n,l+16))),[a,s]=[s,a],l+=64;while(l!==c);const f=Ko.add(a.and(255).shl(1));return l=d,o[0]=o[0].add(t-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),s=Tn(s.add(r).add(i[0]).add(Re(n,l+8)),37).mul(f),r=Tn(r.add(i[1]).add(Re(n,l+48)),42).mul(f),s=s.xor(o[1].mul(9)),r=r.add(i[0].mul(9).add(Re(n,l+40))),a=Tn(a.add(o[0]),33).mul(f),i=Ug(n,l,i[1].mul(f),s.add(o[0])),o=Ug(n,l+32,a.add(o[1]),r.add(Re(n,l+16))),[a,s]=[s,a],qi(qi(i[0],o[0],f).add(rS(r).mul(L3)).add(a),qi(i[1],o[1],f).add(s),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ci(n,t){return t==="string"?ha(n):fo([n],t)}function z8(n,t){return n instanceof Float32Array&&t==="float32"||n instanceof Int32Array&&t==="int32"||n instanceof Uint8Array&&t==="bool"}function fo(n,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=ya(n)),lt().getBool("DEBUG")&&S3(n,t),z8(n,t))return n;if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool"){const e=new Uint8Array(n.length);for(let s=0;s<e.length;++s)Math.round(n[s])!==0&&(e[s]=1);return e}else throw new Error(`Unknown data type ${t}`)}function ns(){return lt().platform.now()}function P8(n,t){return lt().platform.fetch(n,t)}function ha(n,t="utf-8"){return t=t||"utf-8",lt().platform.encode(n,t)}function ni(n,t="utf-8"){return t=t||"utf-8",lt().platform.decode(n,t)}function Nn(n){return lt().platform.isTypedArray!=null?lt().platform.isTypedArray(n):O3(n)}function ya(n,t=[],e=!1){if(t==null&&(t=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||eo(n)||n==null||Nn(n)&&e)t.push(n);else if(Array.isArray(n)||Nn(n))for(let s=0;s<n.length;++s)ya(n[s],t,e);else{let s=-1;for(const r of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)ya(n[r],t,e)}return t}const B8=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:te,arraysEqualWithNull:w3,assert:F,assertNonNegativeIntegerDimensions:Bs,assertNonNull:$l,assertShapesMatch:zn,bytesFromStringArray:N3,bytesPerElement:uf,checkConversionForErrors:S3,clamp:Ji,computeStrides:Ft,convertBackendValuesAndArrayBuffer:$3,createScalarValue:ci,createShuffledIndices:y8,decodeString:ni,distSquared:p8,encodeString:ha,fetch:P8,fingerPrint64:z3,flatten:ya,getArrayFromDType:He,getTypedArrayFromDType:kn,hasEncodingLoss:H2,hexToLong:Bp,indexToLoc:Il,inferDtype:El,inferFromImplicitShape:j2,isBoolean:C3,isFunction:to,isInt:hl,isNumber:Ry,isPromise:eo,isScalarShape:m8,isString:ia,isTypedArray:Nn,isValidDtype:T3,locToIndex:Br,makeOnesTypedArray:x0,makeZerosNestedTypedArray:q2,makeZerosTypedArray:Mn,nearestDivisor:Dy,nearestLargerEven:b0,now:ns,parseAxisParam:Zt,randUniform:f8,repeatedTry:nS,rightPad:il,shuffle:G2,shuffleCombo:d8,sizeFromShape:ft,sizeToSquarishShape:Ay,squeezeShape:ui,sum:v3,swap:Ka,tanh:g8,toNestedArray:tr,toTypedArray:fo},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V8{constructor(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new W8)}profileKernel(t,e,s){let r;const a=()=>{r=s()};let i;const o=ns();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(const c of r)c.dataSync();i=Promise.resolve({kernelMs:ns()-o})}if(lt().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const d=r[c];d.data().then(f=>{U8(f,d.dtype,t)})}return{kernelName:t,outputs:r,inputs:e,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:e,outputs:s,timeMs:r,inputs:a,extraInfo:i}=t;s.forEach(o=>{Promise.all([o.data(),r,i]).then(l=>{this.logger.logKernelProfile(e,o,l[0],l[1],a,l[2])})})}}function U8(n,t,e){if(t!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${e}'`),!0}return!1}class W8{logKernelProfile(t,e,s,r,a,i){const o=typeof r=="number"?il(`${r}ms`,9):r.error,l=il(t,25),c=e.rank,d=e.size,f=il(e.shape.toString(),14);let m="";for(const g in a){const b=a[g];if(b!=null){const x=b.shape||e.shape,v=x.length;m+=`${g}: ${v}D ${v>0?x:""} `}}console.log(`%c${l}	%c${o}	%c${c}D ${f}	%c${d}	%c${m}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G8(n,t,e){const s={},r={};for(let l=0;l<t.length;l++)s[t[l].id]=!0;for(let l=0;l<n.length;l++){const c=n[l],d=c.inputs;for(const f in d){const m=d[f];let g=!1;for(let b=0;b<t.length;b++)if(s[m.id]){c.outputs.forEach(x=>s[x.id]=!0),g=!0,r[c.id]=!0;break}if(g)break}}const a={};a[e.id]=!0;const i={};for(let l=n.length-1;l>=0;l--){const c=n[l],d=c.inputs;for(let f=0;f<c.outputs.length;f++)if(a[c.outputs[f].id]){for(const m in d)a[d[m].id]=!0,i[c.id]=!0;break}}const o=[];for(let l=0;l<n.length;l++){const c=n[l];if(r[c.id]&&i[c.id]){const d={};for(const m in c.inputs){const g=c.inputs[m];s[g.id]&&(d[m]=g)}const f=Object.assign({},c);f.inputs=d,f.outputs=c.outputs,o.push(f)}}return o}function j8(n,t,e,s){for(let r=t.length-1;r>=0;r--){const a=t[r],i=[];if(a.outputs.forEach(l=>{const c=n[l.id];c!=null?i.push(c):i.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const o=a.gradient(i);for(const l in a.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const c=e(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const d=a.inputs[l];if(!te(c.shape,d.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${d.shape}'`);if(n[d.id]==null)n[d.id]=c;else{const f=n[d.id];n[d.id]=s(f,c),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pR=20,$d=3,dw=7;function H8(n,t,e,s){const r=Ft(t),a=q8(n,t,e,r),i=t.length,o=hy(n,t,e,r,a),l=["Tensor"];return s&&(l.push(`  dtype: ${e}`),l.push(`  rank: ${i}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function q8(n,t,e,s){const r=ft(t),a=s[s.length-1],i=new Array(a).fill(0),o=t.length,l=e==="complex64"?_d(n):n;if(o>1)for(let c=0;c<r/a;c++){const d=c*a;for(let f=0;f<a;f++)i[f]=Math.max(i[f],Od(l[d+f],0,e).length)}return i}function Od(n,t,e){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(dw))} + ${parseFloat(n[1].toFixed(dw))}j`:ia(n)?s=`'${n}'`:e==="bool"?s=P3(n):s=parseFloat(n.toFixed(dw)).toString(),il(s,t)}function P3(n){return n===0?"false":"true"}function hy(n,t,e,s,r,a=!0){const i=e==="complex64"?2:1,o=t[0],l=t.length;if(l===0){if(e==="complex64"){const x=_d(n);return[Od(x[0],0,e)]}return e==="bool"?[P3(n[0])]:[n[0].toString()]}if(l===1){if(o>pR){const v=$d*i;let w=Array.from(n.slice(0,v)),T=Array.from(n.slice((o-$d)*i,o*i));return e==="complex64"&&(w=_d(w),T=_d(T)),["["+w.map((C,k)=>Od(C,r[k],e)).join(", ")+", ..., "+T.map((C,k)=>Od(C,r[o-$d+k],e)).join(", ")+"]"]}return["["+(e==="complex64"?_d(n):Array.from(n)).map((v,w)=>Od(v,r[w],e)).join(", ")+"]"]}const c=t.slice(1),d=s.slice(1),f=s[0]*i,m=[];if(o>pR){for(let x=0;x<$d;x++){const v=x*f,w=v+f;m.push(...hy(n.slice(v,w),c,e,d,r,!1))}m.push("...");for(let x=o-$d;x<o;x++){const v=x*f,w=v+f;m.push(...hy(n.slice(v,w),c,e,d,r,x===o-1))}}else for(let x=0;x<o;x++){const v=x*f,w=v+f;m.push(...hy(n.slice(v,w),c,e,d,r,x===o-1))}const g=l===2?",":"";m[0]="["+(o>0?m[0]+g:"");for(let x=1;x<m.length-1;x++)m[x]=" "+m[x]+g;let b=`,
`;for(let x=2;x<l;x++)b+=`
`;return m[m.length-1]=" "+m[m.length-1]+"]"+(a?"":b),m}function _d(n){const t=[];for(let e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cn{constructor(t,e,s){if(this.dtype=e,this.shape=t.slice(),this.size=ft(t),s!=null){const r=s.length;F(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||He(e,this.size),this.strides=Ft(t)}set(t,...e){e.length===0&&(e=[0]),F(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const s=this.locToIndex(e);this.values[s]=t}get(...t){t.length===0&&(t=[0]);let e=0;for(const r of t){if(r<0||r>=this.shape[e]){const a=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(a)}e++}let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=this.strides[r]*t[r];return this.values[s]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let e=t[t.length-1];for(let s=0;s<t.length-1;++s)e+=this.strides[s]*t[s];return e}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const e=new Array(this.shape.length);for(let s=0;s<e.length-1;++s)e[s]=Math.floor(t/this.strides[s]),t-=e[s]*this.strides[s];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return Mr().makeTensor(this.values,this.shape,this.dtype)}}let Mr=null,Du=null;function K8(n){Mr=n}function X8(n){Du=n}class ge{constructor(t,e,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=ft(t),this.strides=Ft(t),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Du.buffer(this.shape,this.dtype,t)}bufferSync(){return Du.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return tr(this.shape,t,this.dtype==="complex64")}arraySync(){return tr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=Mr().read(this.dataId);if(this.dtype==="string"){const e=await t;try{return e.map(s=>ni(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),Mr().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Mr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(e=>ni(e))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await Mr().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Mr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Du.print(this,t)}clone(){return this.throwIfDisposed(),Du.clone(this)}toString(t=!1){const e=this.dataSync();return H8(e,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Du.cast(this,t)}variable(t=!0,e,s){return this.throwIfDisposed(),Mr().makeVariable(this,t,e,s)}}Object.defineProperty(ge,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function pt(){return X2("Tensor",()=>ge)}pt();class mf extends ge{constructor(t,e,s,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=s}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!te(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Mr().disposeTensor(this),this.dataId=t.dataId,Mr().incRef(this,null)}dispose(){Mr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(mf,Symbol.hasInstance,{value:n=>n instanceof ge&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var aS;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(aS||(aS={}));var iS;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(iS||(iS={}));var oS;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(oS||(oS={}));var lS;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(lS||(lS={}));var uS;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(uS||(uS={}));const Y8={float32:lS,int32:iS,bool:oS,complex64:uS};function ys(n,t){if(n==="string"||t==="string"){if(n==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${n} with ${t}`)}return Y8[n][t]}function kb(n){return ys(n,"int32")}function B3(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function V3(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ue(n,t){if(n.dtype===t.dtype)return[n,t];const e=ys(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function U3(n,t){F(n.dtype===t.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${t.dtype}) input must match`)}function Z8(n,t){return t.some(e=>e.id===n.id)}function Z2(n){const t=[];return W3(n,t,new Set),t}function W3(n,t,e){if(n==null)return;if(n instanceof ge){t.push(n);return}if(!Q8(n))return;const s=n;for(const r in s){const a=s[r];e.has(a)||(e.add(a),W3(a,t,e))}}function Q8(n){return Array.isArray(n)||typeof n=="object"}const J8=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:U3,getTensorsInContainer:Z2,isTensorInList:Z8,makeTypesMatch:Ue},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fw(n){return n.kernelName!=null}class mR{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Ku{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new mR}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const s=t[e];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:e}=this.initializeBackend(t);if(e)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,s=1){return t in this.registryFactory?(Ys(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:e,priority:s},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:e,asyncInit:s}=this.initializeBackend(t);if(!(s?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new V8(this.backendInstance),!0}setupRegisteredKernels(){Ly(this.backendName).forEach(e=>{e.setupFunc!=null&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){Ly(t).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(e==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const s=e.factory();if(s&&!(s instanceof y0)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,a=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[t]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Ys(`Initialization of backend ${t} failed`),Ys(i.stack||i.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(s){return Ys(`Initialization of backend ${t} failed`),Ys(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const s=t[e],{success:r,asyncInit:a}=this.initializeBackend(s);if(a||r)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const s=this.state.tensorInfo.get(e),r=s.backend,a=this.readSync(e),i=r.refCount(e);r.disposeData(e,!0),s.backend=t,t.move(e,a,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let s=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=t}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=e(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(t,e,s){t();try{const r=s();return e(),r}catch(r){throw e(),r}}nextTensorId(){return Ku.nextTensorId++}nextVariableId(){return Ku.nextVariableId++}clone(t){const e=U.runKernel(Oc,{x:t}),s={x:t},r=i=>({x:()=>{const o="float32",l={x:i},c={dtype:o};return U.runKernel(vc,l,c)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[e],r,a,{}),e}runKernel(t,e,s){if(this.backendName==null&&this.backend,!(pf(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:e,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,s){const r=this.backend.numDataIds();let a=0;s.forEach(l=>{a+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-a-i;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let e,s=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const c=fw(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(fw(t)){const{kernelName:b,inputs:x,attrs:v}=t;this.backendName==null&&this.backend;const w=pf(b,this.backendName);F(w!=null,()=>`Cannot find registered kernel '${b}' for backend '${this.backendName}'`),o=()=>{const T=this.backend.numDataIds();l=w.kernelFunc({inputs:x,attrs:v,backend:this.backend});const C=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(b,T,C);const k=C.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(r){const $=this.getTensorsForGradient(b,x,k);s=this.saveTensorsForBackwardMode($)}return k}}else{const{forwardFunc:b}=t,x=v=>{r&&(s=v.map(w=>this.keep(this.clone(w))))};o=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>b(this.backend,x));const w=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,v,w),w}}const{inputs:d,attrs:f}=t,m=fw(t)?null:t.backwardsFunc;let g;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?e=o():(g=this.profiler.profileKernel(c,d,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),e=g.outputs)}),r&&this.addTapeNode(c,d,e,m,s,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(d).map(b=>d[b]!=null?d[b].shape:null),outputShapes:e.map(b=>b.shape),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(l)?e:e[0]}saveTensorsForBackwardMode(t){return t.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(t,e,s){const r=sS(t);if(r!=null){const a=r.inputsToSave||[],i=r.outputsToSave||[];let o;r.saveAllInputs?(F(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(e).map(c=>e[c])):o=a.map(c=>e[c]);const l=s.filter((c,d)=>i[d]);return o.concat(l)}return[]}makeTensor(t,e,s,r){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let a=t;s==="string"&&ia(t[0])&&(a=t.map(l=>ha(l)));const i=r.write(a,e,s),o=new ge(e,s,i,this.nextTensorId());if(this.trackTensor(o,r),s==="string"){const l=this.state.tensorInfo.get(i),c=N3(a);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(t,e,s,r){s=s||"float32";const a={dataId:t,shape:e,dtype:s};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(t,e){const{dataId:s,shape:r,dtype:a}=t,i=new ge(r,a,s,this.nextTensorId());return this.trackTensor(i,e),i}makeVariable(t,e=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==t.dtype&&(t=t.cast(r));const a=new mf(t,e,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(t,e){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let s=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(s=t.size*uf(t.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:s})),t instanceof mf||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const s=t.size*uf(t.dtype);this.state.numBytes-=s}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,e,s,r,a,i){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:s,saved:a},l=sS(t);l!=null&&(r=l.gradFunc),r!=null&&(o.gradient=c=>(c=c.map((d,f)=>{if(d==null){const m=s[f],g=Mn(m.size,m.dtype);return this.makeTensor(g,m.shape,m.dtype)}return d}),r(c.length>1?c:c[0],a,i))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=Z2(t),s=new Set(e.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const i=this.state.activeScope.track[a];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(t,e,s,r=!1){if(F(e.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));F(a instanceof ge,()=>"The result y returned by f() must be a tensor.");const i=G8(this.state.activeTape,e,a);if(!r&&i.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[a.id]=s??tq(a.shape),j8(o,i,c=>this.tidy(c),eq);const l=e.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const d of c.saved)d.dispose()}),this.state.activeTape=null),{value:a,grads:l}})}customGrad(t){return F(to(t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{F(e.every(o=>o instanceof ge),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};e.forEach((o,l)=>{r[l]=o});const a=(o,l)=>(s=t(...e,l),F(s.value instanceof ge,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),F(to(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(o,l)=>{const c=s.gradFunc(o,l),d=Array.isArray(c)?c:[c];F(d.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),F(d.every(m=>m instanceof ge),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return d.forEach((m,g)=>{f[g]=()=>m}),f};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)}async time(t){const e=ns(),s=await this.backend.time(t);return s.wallMs=ns()-e,s}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new mR;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Ku.nextTensorId=0;Ku.nextVariableId=0;function tq(n){const t=x0(ft(n),"float32");return U.makeTensor(t,n,"float32")}function G3(){const n=I3();if(n._tfengine==null){const t=new E3(n);n._tfengine=new Ku(t)}return w8(n._tfengine.ENV),K8(()=>n._tfengine),n._tfengine}const U=G3();function eq(n,t){const e={a:n,b:t};return U.runKernel(Al,e)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nq(){return typeof navigator<"u"&&navigator!=null}let cS;function sq(n){cS=n}function Q2(n){if(cS!==void 0)return cS;if(n||nq()){if(n||(n=navigator),n.product==="ReactNative")return!0;const t=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!t){const e=n;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function J2(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const rq=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:J2,isMobile:Q2,mockIsMobile:sq},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bs=lt();bs.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});bs.registerFlag("IS_BROWSER",()=>J2());bs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");bs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));bs.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));bs.registerFlag("PROD",()=>!1);bs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>bs.getBool("DEBUG"));bs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);bs.registerFlag("IS_TEST",()=>!1);bs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>bs.getBool("DEBUG"));bs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);bs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);bs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ba(n,t){let e=n;if(Nn(n))return t==="string"?[]:[n.length];if(B3(n)){const r=n.channels||"RGBA";return[n.height,n.width*r.length]}else if(V3(n))return[n.buffer.size/(t==null?4:uf(t))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(e)||Nn(e)&&t!=="string";)s.push(e.length),e=e[0];return Array.isArray(n)&&lt().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&j3(n,s,[]),s}function j3(n,t,e){if(e=e||[],!Array.isArray(n)&&!Nn(n)){F(t.length===0,()=>`Element arr[${e.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}F(t.length>0,()=>`Element arr[${e.join("][")}] should be a primitive, but is an array of ${n.length} elements`),F(n.length===t[0],()=>`Element arr[${e.join("][")}] should have ${t[0]} elements, but has ${n.length} elements`);const s=t.slice(1);for(let r=0;r<n.length;++r)j3(n[r],s,e.concat(r))}function gR(n,t,e,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==t||n==="numeric"&&t==="string")throw new Error(`Argument '${e}' passed to '${s}' must be ${n} tensor, but got ${t} tensor`)}}function M(n,t,e,s="numeric"){if(n instanceof pt())return gR(s,n.dtype,t,e),n;let r=El(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),gR(s,r,t,e),n==null||!Nn(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${t}' passed to '${e}' must be a Tensor or TensorLike, but got '${l}'`)}const a=ba(n,r);!Nn(n)&&!Array.isArray(n)&&(n=[n]);const o=r!=="string"?fo(n,r):ya(n,[],!0);return U.makeTensor(o,a,r)}function gf(n,t,e,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${t} passed to ${e} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((a,i)=>M(a,`${t}[${i}]`,e,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tT="__op";function G(n){const t=Object.keys(n);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let e=t[0];const s=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1)),e=e+tT;const r=(...a)=>{U.startScope(e);try{const i=s(...a);return eo(i)&&console.error("Cannot return a Promise inside of tidy."),U.endScope(i),i}catch(i){throw U.endScope(null),i}};return Object.defineProperty(r,"name",{value:e,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aq(n,t){const e=M(n,"real","complex"),s=M(t,"imag","complex");zn(e.shape,s.shape,`real and imag shapes, ${e.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:e,imag:s};return U.runKernel(k0,r)}const si=G({complex_:aq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function po(n,t,e,s){if(s==null)s=El(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(V3(n)||B3(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return U.backend.createTensorFromGPUData(n,t||e,s)}if(!Nn(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Bs(t);const r=ft(t),a=ft(e);F(r===a,()=>`Based on the provided shape, [${t}], the tensor should have ${r} values but has ${a}`);for(let i=0;i<e.length;++i){const o=e[i],l=i===e.length-1?o!==ft(t.slice(i)):!0;F(e[i]===t[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${e}) does not match the provided shape (${t}). `)}}return!Nn(n)&&!Array.isArray(n)&&(n=[n]),t=t||e,n=s!=="string"?fo(n,s):ya(n,[],!0),U.makeTensor(n,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nr(n,t,e){const s=ba(n,e);return po(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dl={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Kr{static join(t){return new Kr(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(s=>Nn(s)?s.buffer:s),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let e=0;for(let s=0;s<t.length;s++){const r=t[s];s!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=e+r.byteLength;this.shards.push({buffer:r,start:e,end:a}),e=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,e=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),e=Math.min(this.byteLength,e),e<=t)return new ArrayBuffer(0);const s=this.findShardForByte(t);if(s===-1)throw new Error(`Could not find start shard for byte ${t}`);const r=e-t,a=new ArrayBuffer(r),i=new Uint8Array(a);let o=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],f=t+o-c.start,m=o,b=Math.min(e,c.end)-c.start,x=new Uint8Array(c.buffer,f,b-f);if(i.set(x,m),o+=x.length,e<c.end)break}return a}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(r){return t<r.start?-1:t>=r.end?1:0}if(e(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=iq(this.shards,e);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function iq(n,t){let e=0,s=n.length;for(;e<=s;){const r=Math.floor((s-e)/2)+e,a=t(n[r]);if(a===0)return r;a<0?s=r:e=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(){lt().set("PROD",!0)}function lq(){lt().set("DEBUG",!0)}function uq(){lt().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function cq(n){lt().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function hq(){U.disposeVariables()}function Lr(){return U}function hS(){return U.memory()}function dq(n){return U.profile(n)}function it(n,t){return U.tidy(n,t)}function Yt(n){Z2(n).forEach(e=>e.dispose())}function pn(n){return U.keep(n)}function fq(n){return U.time(n)}function pq(n){return U.setBackend(n)}function mq(){return U.ready()}function H3(){return U.backendName}function gq(n){U.removeBackend(n)}function yq(n){return U.findBackend(n)}function bq(n){return U.findBackendFactory(n)}function eT(n,t,e=1){return U.registerBackend(n,t,e)}function nT(){return U.backend}function xq(n,t){lt().setPlatform(n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const no=4;async function dS(n,t){const e=[],s=[],r=Array.isArray(n)?n.map(i=>i.name):Object.keys(n);for(let i=0;i<r.length;++i){const o=r[i],l=Array.isArray(n)?n[i].tensor:n[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const d=new Promise(async f=>{const m=await l.bytes(),g=m.reduce((v,w)=>v+w.length,0)+no*m.length,b=new Uint8Array(g);let x=0;for(let v=0;v<m.length;v++){const w=m[v],T=new Uint8Array(new Uint32Array([w.length]).buffer);b.set(T,x),x+=no,b.set(w,x),x+=w.length}f(b)});s.push(d)}else s.push(l.data());t!=null&&(c.group=t),e.push(c)}const a=await Promise.all(s);return{data:Sq(a),specs:e}}function q3(n,t){const e=new Kr(n),s={};let r=0;for(const a of t){const i=vq(a,(o,l)=>e.slice(r+o,r+l));s[a.name]=K3(a,e.slice(r,r+i)),r+=i}return s}function vq(n,t){const e=ft(n.shape);let s;if("quantization"in n){const r=n.quantization;s=dl[r.dtype]}else if(n.dtype==="string"){let r=0;for(let a=0;a<e;a++)r+=no+new Uint32Array(t(r,r+no))[0];return r}else s=dl[n.dtype];return e*s}async function wq(n,t){const e=ft(n.shape);let s;if("quantization"in n){const r=n.quantization;s=dl[r.dtype]}else if(n.dtype==="string"){let r=0;for(let a=0;a<e;a++)r+=no+new Uint32Array(await t(r,r+no))[0];return r}else s=dl[n.dtype];return e*s}function K3(n,t){const e=n.name,s=n.dtype,r=n.shape,a=ft(r);let i,o=0;if("quantization"in n){const l=n.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${n.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${n.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${n.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=dl[l.dtype],d=l.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(d.length);for(let f=0;f<d.length;f++){const m=d[f];i[f]=m*l.scale+l.min}}else if(l.dtype==="float16")i=Eq()(d);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(d.length);for(let f=0;f<d.length;f++){const m=d[f];i[f]=Math.round(m*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${e}': ${s}`);o+=a*c}else if(s==="string"){const l=ft(n.shape);i=[];for(let c=0;c<l;c++){const d=new Uint32Array(t.slice(o,o+no))[0];o+=no;const f=new Uint8Array(t.slice(o,o+d));i.push(f),o+=d}}else{const l=dl[s];if(s==="float32")i=new Float32Array(t);else if(s==="int32")i=new Int32Array(t);else if(s==="bool")i=new Uint8Array(t);else if(s==="complex64"){i=new Float32Array(t);const c=new Float32Array(i.length/2),d=new Float32Array(i.length/2);for(let b=0;b<c.length;b++)c[b]=i[b*2],d[b]=i[b*2+1];const f=Nr(c,r,"float32"),m=Nr(d,r,"float32"),g=si(f,m);return f.dispose(),m.dispose(),g}else throw new Error(`Unsupported dtype in weight '${e}': ${s}`);o+=a*l}return Nr(i,r,s)}async function yR(n,t,e){let s=new Uint8Array(t);for(;s.byteLength<e;){const{done:r,value:a}=await n.read();if(r&&a==null){const o=e-s.byteLength;throw new Error(`Reader is done but ${o} bytes are still expected`)}const i=new Uint8Array(s.length+a.byteLength);i.set(s,0),i.set(new Uint8Array(a),s.length),s=i}return s.buffer}async function X3(n,t){const e={},s=n.getReader();let r=new ArrayBuffer(0);for(const a of t){const i=await wq(a,async(c,d)=>(r=await yR(s,r,d),r.slice(c,d)));r=await yR(s,r,i);const o=r.slice(0,i);r=r.slice(i);const l=K3(a,o);if(e[a.name]=l,H3()==="webgpu"){const c=nT();"uploadToGPU"in c&&ft(l.shape)>=lt().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return e}function Sq(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let t=0;const e=[];n.forEach(a=>{if(t+=a.byteLength,e.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const s=new Uint8Array(t);let r=0;return e.forEach(a=>{s.set(new Uint8Array(a.buffer),r),r+=a.byteLength}),s.buffer}const sT=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function bR(n){return sT?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function Tq(n){if(sT)return Buffer.from(n).toString("base64");const t=new Uint8Array(n);let e="";for(let s=0,r=t.length;s<r;s++)e+=String.fromCharCode(t[s]);return btoa(e)}function Nq(n){if(sT){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const t=atob(n),e=new Uint8Array(t.length);for(let s=0;s<t.length;++s)e.set([t.charCodeAt(s)],s);return e.buffer}function Y3(n){return Kr.join(n)}function xR(n){const t="/";for(n=n.trim();n.endsWith(t);)n=n.slice(0,n.length-1);const e=n.split(t);return e[e.length-1]}function Z3(n,t){const e={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:t};return n.signature!=null&&(e.signature=n.signature),n.userDefinedMetadata!=null&&(e.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(e.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(e.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(e.trainingConfig=n.trainingConfig),e}function rT(n,t,e){const s={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(s.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!e)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=t,s.weightData=e}return n.signature!=null&&(s.signature=n.signature),n.userDefinedMetadata!=null&&(s.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(s.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(s.initializerSignature=n.initializerSignature),s}async function aT(n,t){let e,s;return n.weightsManifest!=null&&([e,s]=await t(n.weightsManifest)),rT(n,e,s)}function Vp(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:bR(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:bR(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new Kr(n.weightData).byteLength}}function My(n){const t=[];for(const e of n)t.push(...e.weights);return t}function Cq(){const n=e=>{let s=e<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},t=new Uint32Array(2048);t[0]=0;for(let e=1;e<1024;e++)t[e]=n(e);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}function kq(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let t=1;t<31;t++)n[t]=t<<23;for(let t=33;t<63;t++)n[t]=2147483648+(t-32<<23);return n}function $q(){const n=new Uint32Array(64);for(let t=0;t<64;t++)n[t]=1024;return n[0]=n[32]=0,n}function Eq(){const n=Cq(),t=kq(),e=$q();return s=>{const r=new ArrayBuffer(4*s.length),a=new Uint32Array(r);for(let i=0;i<s.length;i++){const o=s[i],l=n[e[o>>10]+(o&1023)]+t[o>>10];a[i]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pe{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Pe.instance==null&&(Pe.instance=new Pe),Pe.instance}static registerSaveRouter(t){Pe.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Pe.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Pe.getHandlers(t,"save")}static getLoadHandlers(t,e){return Pe.getHandlers(t,"load",e)}static getHandlers(t,e,s){const r=[];return(e==="load"?Pe.getInstance().loadRouters:Pe.getInstance().saveRouters).forEach(i=>{const o=i(t,s);o!==null&&r.push(o)}),r}}const Iq=n=>Pe.registerSaveRouter(n),Aq=n=>Pe.registerLoadRouter(n),Q3=n=>Pe.getSaveHandlers(n),Rq=(n,t)=>Pe.getLoadHandlers(n,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fS="tensorflowjs",pS=1,sl="models_store",Gi="model_info_store";function J3(){if(!lt().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function mS(n){const t=n.result;t.createObjectStore(sl,{keyPath:"modelPath"}),t.createObjectStore(Gi,{keyPath:"modelPath"})}class fl{constructor(t){if(this.indexedDB=J3(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((s,r)=>{const a=this.indexedDB.open(fS,pS);a.onupgradeneeded=()=>mS(a),a.onsuccess=()=>{const i=a.result;if(e==null){const o=i.transaction(sl,"readonly"),c=o.objectStore(sl).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=d=>(i.close(),r(c.error)),o.oncomplete=()=>i.close()}else{e.weightData=Kr.join(e.weightData);const o=Vp(e),l=i.transaction(Gi,"readwrite");let c=l.objectStore(Gi),d;try{d=c.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(m){return r(m)}let f;d.onsuccess=()=>{f=i.transaction(sl,"readwrite");const m=f.objectStore(sl);let g;try{g=m.put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:o})}catch(b){return r(b)}g.onsuccess=()=>s({modelArtifactsInfo:o}),g.onerror=b=>{c=l.objectStore(Gi);const x=c.delete(this.modelPath);x.onsuccess=()=>(i.close(),r(g.error)),x.onerror=v=>(i.close(),r(g.error))}},d.onerror=m=>(i.close(),r(d.error)),l.oncomplete=()=>{f==null?i.close():f.oncomplete=()=>i.close()}}},a.onerror=i=>r(a.error)})}}fl.URL_SCHEME="indexeddb://";const tF=n=>lt().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(fl.URL_SCHEME)?Dq(n.slice(fl.URL_SCHEME.length)):null;Pe.registerSaveRouter(tF);Pe.registerLoadRouter(tF);function Dq(n){return new fl(n)}function Oq(n){return n.startsWith(fl.URL_SCHEME)?n.slice(fl.URL_SCHEME.length):n}class _q{constructor(){this.indexedDB=J3()}async listModels(){return new Promise((t,e)=>{const s=this.indexedDB.open(fS,pS);s.onupgradeneeded=()=>mS(s),s.onsuccess=()=>{const r=s.result,a=r.transaction(Gi,"readonly"),o=a.objectStore(Gi).getAll();o.onsuccess=()=>{const l={};for(const c of o.result)l[c.modelPath]=c.modelArtifactsInfo;t(l)},o.onerror=l=>(r.close(),e(o.error)),a.oncomplete=()=>r.close()},s.onerror=r=>e(s.error)})}async removeModel(t){return t=Oq(t),new Promise((e,s)=>{const r=this.indexedDB.open(fS,pS);r.onupgradeneeded=()=>mS(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(Gi,"readwrite"),o=i.objectStore(Gi),l=o.get(t);let c;l.onsuccess=()=>{if(l.result==null)return a.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const d=o.delete(t),f=()=>{c=a.transaction(sl,"readwrite");const g=c.objectStore(sl).delete(t);g.onsuccess=()=>e(l.result.modelArtifactsInfo),g.onerror=b=>s(l.error)};d.onsuccess=f,d.onerror=m=>(f(),a.close(),s(l.error))}},l.onerror=d=>(a.close(),s(l.error)),i.oncomplete=()=>{c==null?a.close():c.oncomplete=()=>a.close()}},r.onerror=a=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xa="/",Ou="tensorflowjs_models",eF="info",Fq="model_topology",Lq="weight_specs",Mq="weight_data",zq="model_metadata";function nF(n){return{info:[Ou,n,eF].join(Xa),topology:[Ou,n,Fq].join(Xa),weightSpecs:[Ou,n,Lq].join(Xa),weightData:[Ou,n,Mq].join(Xa),modelMetadata:[Ou,n,zq].join(Xa)}}function sF(n){for(const t of Object.values(n))window.localStorage.removeItem(t)}function Pq(n){const t=n.split(Xa);if(t.length<3)throw new Error(`Invalid key format: ${n}`);return t.slice(1,t.length-1).join(Xa)}function Bq(n){return n.startsWith(pl.URL_SCHEME)?n.slice(pl.URL_SCHEME.length):n}class pl{constructor(t){if(!lt().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=nF(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const e=JSON.stringify(t.modelTopology),s=JSON.stringify(t.weightSpecs),r=Vp(t),a=Kr.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,Tq(a));const i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw sF(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const o=JSON.parse(a);e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy,o.signature!=null&&(e.signature=o.signature),o.userDefinedMetadata!=null&&(e.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(e.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(e.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(e.trainingConfig=o.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=Nq(i),e}}pl.URL_SCHEME="localstorage://";const rF=n=>lt().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(pl.URL_SCHEME)?Vq(n.slice(pl.URL_SCHEME.length)):null;Pe.registerSaveRouter(rF);Pe.registerLoadRouter(rF);function Vq(n){return new pl(n)}class Uq{constructor(){F(lt().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),F(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},e=Ou+Xa,s=Xa+eF;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(e)&&a.endsWith(s)){const i=Pq(a);t[i]=JSON.parse(this.LS.getItem(a))}}return t}async removeModel(t){t=Bq(t);const e=nF(t);if(this.LS.getItem(e.info)==null)throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(this.LS.getItem(e.info));return sF(e),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bu="://";class ss{constructor(){this.managers={}}static getInstance(){return ss.instance==null&&(ss.instance=new ss),ss.instance}static registerManager(t,e){F(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(Bu)&&(t=t.slice(0,t.indexOf(Bu))),F(t.length>0,()=>"scheme must not be an empty string.");const s=ss.getInstance();F(s.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),s.managers[t]=e}static getManager(t){const e=ss.getInstance().managers[t];if(e==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(ss.getInstance().managers)}}function dy(n){if(n.indexOf(Bu)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ss.getSchemes().join(",")}`);return{scheme:n.split(Bu)[0],path:n.split(Bu)[1]}}async function aF(n,t,e=!1){F(n!==t,()=>`Old path and new path are the same: '${n}'`);const s=Pe.getLoadHandlers(n);F(s.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),F(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${n}.`);const r=s[0],a=Pe.getSaveHandlers(t);F(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),F(a.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${t}.`);const i=a[0],o=dy(n).scheme,l=dy(n).path,c=o===dy(n).scheme,d=await r.load();e&&c&&await ss.getManager(o).removeModel(l);const f=await i.save(d);return e&&!c&&await ss.getManager(o).removeModel(l),f.modelArtifactsInfo}async function Wq(){const n=ss.getSchemes(),t={};for(const e of n){const s=await ss.getManager(e).listModels();for(const r in s){const a=e+Bu+r;t[a]=s[r]}}return t}async function Gq(n){const t=dy(n);return ss.getManager(t.scheme).removeModel(t.path)}async function jq(n,t){return aF(n,t,!1)}async function Hq(n,t){return aF(n,t,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qq{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){if(typeof window>"u"||!lt().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,e);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return O3(t)}}if(lt().get("IS_BROWSER")){lt().setPlatform("browser",new qq);try{ss.registerManager(pl.URL_SCHEME,new Uq)}catch{}try{ss.registerManager(fl.URL_SCHEME,new _q)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kq={importFetch:()=>require("node-fetch")};let pw;class Xq{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return lt().global.fetch!=null?lt().global.fetch(t,e):(pw==null&&(pw=Kq.importFetch()),pw(t,e))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}lt().get("IS_NODE")&&!lt().get("IS_BROWSER")&&lt().setPlatform("node",new Xq);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(n,t="float32",e){return t=t||"float32",Bs(n),new cn(n,t,e)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(n,t){const e=M(n,"x","cast");if(!T3(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:e},r={dtype:t};return U.runKernel(vc,s,r)}const Tt=G({cast_:Yq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zq(n){const e={x:M(n,"x","clone","string_or_numeric")};return U.runKernel(Oc,e)}const da=G({clone_:Zq});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iT(n,t=!1){console.log(n.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */G3();const Qq={buffer:Ht,cast:Tt,clone:da,print:iT};X8(Qq);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jq(n,t){let e=M(n,"a","add"),s=M(t,"b","add");[e,s]=Ue(e,s);const r={a:e,b:s};return U.runKernel(Al,r)}const wt=G({add_:Jq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t7(n,t){let e=M(n,"a","floorDiv"),s=M(t,"b","floorDiv");[e,s]=Ue(e,s);const r={a:e,b:s};return U.runKernel(Rc,r)}const $b=G({floorDiv_:t7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e7(n,t){let e=M(n,"a","div"),s=M(t,"b","div");if([e,s]=Ue(e,s),e.dtype==="int32"&&s.dtype==="int32")return $b(e,s);const r={a:e,b:s},a={};return U.runKernel(Cc,r,a)}const Ot=G({div_:e7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7(n,t){let e=M(n,"a","mul"),s=M(t,"b","mul");[e,s]=Ue(e,s);const r={a:e,b:s};return U.runKernel(Uc,r)}const K=G({mul_:n7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s7(n){const t=M(n,"x","abs");if(t.dtype==="complex64"){const e={x:t};return U.runKernel(Hf,e)}else{const e={x:t};return U.runKernel(Mf,e)}}const ln=G({abs_:s7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r7(n){const e={x:M(n,"x","acos")};return U.runKernel(fc,e)}const oT=G({acos_:r7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a7(n){const e={x:M(n,"x","acosh")};return U.runKernel(pc,e)}const lT=G({acosh_:a7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(n){F(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),F(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const t=n.map((r,a)=>M(r,`tensors${a}`,"addN")),e=t[0];t.forEach(r=>{if(r.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(r=>{if(!te(r.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=t;return U.runKernel(zf,s)}const iF=G({addN_:i7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o7(n,t=null,e=!1){const r={x:M(n,"x","all","bool")},a={axis:t,keepDims:e};return U.runKernel(v0,r,a)}const Eb=G({all_:o7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(n,t=null,e=!1){const r={x:M(n,"x","any","bool")},a={axis:t,keepDims:e};return U.runKernel(w0,r,a)}const yf=G({any_:l7});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(n,t=0){const s={x:M(n,"x","argMax")},r={axis:t};return U.runKernel(Pf,s,r)}const ml=G({argMax_:u7});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c7(n,t=0){const s={x:M(n,"x","argMin")},r={axis:t};return U.runKernel(Bf,s,r)}const uT=G({argMin_:c7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h7(n){const e={x:M(n,"x","asin")};return U.runKernel(mc,e)}const cT=G({asin_:h7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(n){const e={x:M(n,"x","asinh")};return U.runKernel(gc,e)}const hT=G({asinh_:d7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f7(n){const e={x:M(n,"x","atan")};return U.runKernel(yc,e)}const dT=G({atan_:f7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p7(n,t){let e=M(n,"a","atan2"),s=M(t,"b","atan2");[e,s]=Ue(e,s);const r={a:e,b:s};return U.runKernel(xc,r)}const fT=G({atan2_:p7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(n){const e={x:M(n,"x","atanh")};return U.runKernel(bc,e)}const pT=G({atanh_:m7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Up(n,t,e,s,r="NHWC",a){const i=n[3],o=[...t,i],l=di(r);return En(n,o,e,a,s,null,null,l)}function kr(n,t,e,s,r,a,i="channelsLast"){const[o,l]=bf(t);let c;if(i==="channelsLast")c=[o,l,n[3],n[3]];else if(i==="channelsFirst")c=[o,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return En(n,c,e,s,r,a,!1,i)}function hi(n,t,e,s,r,a,i="NDHWC"){const[o,l,c]=gS(t);let d,f;if(i==="NDHWC")f="channelsLast",d=[o,l,c,n[4],n[4]];else if(i==="NCDHW")f="channelsFirst",d=[o,l,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return mo(n,d,e,s,r,!1,f,a)}function En(n,t,e,s,r,a,i=!1,o="channelsLast"){let[l,c,d,f]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,d,f]=n;else if(o==="channelsFirst")[l,f,c,d]=n;else throw new Error(`Unknown dataFormat ${o}`);const[m,g,,b]=t,[x,v]=bf(e),[w,T]=bf(s),C=Vu(m,w),k=Vu(g,T),{padInfo:$,outHeight:I,outWidth:D}=b7(r,c,d,x,v,C,k,a,o),_=i?b*f:b;let O;return o==="channelsFirst"?O=[l,_,I,D]:o==="channelsLast"&&(O=[l,I,D,_]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:d,inChannels:f,outHeight:I,outWidth:D,outChannels:_,padInfo:$,strideHeight:x,strideWidth:v,filterHeight:m,filterWidth:g,effectiveFilterHeight:C,effectiveFilterWidth:k,dilationHeight:w,dilationWidth:T,inShape:n,outShape:O,filterShape:t}}function mo(n,t,e,s,r,a=!1,i="channelsLast",o){let[l,c,d,f,m]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,d,f,m]=n;else if(i==="channelsFirst")[l,m,c,d,f]=n;else throw new Error(`Unknown dataFormat ${i}`);const[g,b,x,,v]=t,[w,T,C]=gS(e),[k,$,I]=gS(s),D=Vu(g,k),_=Vu(b,$),O=Vu(x,I),{padInfo:L,outDepth:R,outHeight:V,outWidth:Y}=x7(r,c,d,f,w,T,C,D,_,O,o),Q=a?v*m:v;let tt;return i==="channelsFirst"?tt=[l,Q,R,V,Y]:i==="channelsLast"&&(tt=[l,R,V,Y,Q]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:d,inWidth:f,inChannels:m,outDepth:R,outHeight:V,outWidth:Y,outChannels:Q,padInfo:L,strideDepth:w,strideHeight:T,strideWidth:C,filterDepth:g,filterHeight:b,filterWidth:x,effectiveFilterDepth:D,effectiveFilterHeight:_,effectiveFilterWidth:O,dilationDepth:k,dilationHeight:$,dilationWidth:I,inShape:n,outShape:tt,filterShape:t}}function g7(n,t,e,s,r){s==null&&(s=mT(n,t,e));const a=n[0],i=n[1],o=xf((a-t+2*s)/e+1,r),l=xf((i-t+2*s)/e+1,r);return[o,l]}function y7(n,t,e,s,r,a){r==null&&(r=mT(n,t[0],s[0]));const i=[0,0,0,e];for(let o=0;o<3;o++)n[o]+2*r>=t[o]&&(i[o]=xf((n[o]-t[o]+2*r)/s[o]+1,a));return i}function mT(n,t,e,s=1){const r=Vu(t,s);return Math.floor((n[0]*(e-1)-e+r)/2)}function bf(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function gS(n){return typeof n=="number"?[n,n,n]:n}function Vu(n,t){return t<=1?n:n+(n-1)*(t-1)}function b7(n,t,e,s,r,a,i,o,l){let c,d,f;if(typeof n=="number"){c={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const g=g7([t,e],a,s,n,o);d=g[0],f=g[1]}else if(n==="same"){d=Math.ceil(t/s),f=Math.ceil(e/r);const m=Math.max(0,(d-1)*s+a-t),g=Math.max(0,(f-1)*r+i-e),b=Math.floor(m/2),x=m-b,v=Math.floor(g/2),w=g-v;c={top:b,bottom:x,left:v,right:w,type:"SAME"}}else if(n==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((t-a+1)/s),f=Math.ceil((e-i+1)/r);else if(typeof n=="object"){const m=l==="channelsLast"?n[1][0]:n[2][0],g=l==="channelsLast"?n[1][1]:n[2][1],b=l==="channelsLast"?n[2][0]:n[3][0],x=l==="channelsLast"?n[2][1]:n[3][1];c={top:m,bottom:g,left:b,right:x,type:m===0&&g===0&&b===0&&x===0?"VALID":"EXPLICIT"},d=xf((t-a+m+g)/s+1,o),f=xf((e-i+b+x)/r+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:c,outHeight:d,outWidth:f}}function x7(n,t,e,s,r,a,i,o,l,c,d){let f,m,g,b;if(n==="valid"&&(n=0),typeof n=="number"){f={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const v=y7([t,e,s,1],[o,l,c],1,[r,a,i],n,d);m=v[0],g=v[1],b=v[2]}else if(n==="same"){m=Math.ceil(t/r),g=Math.ceil(e/a),b=Math.ceil(s/i);const x=(m-1)*r+o-t,v=(g-1)*a+l-e,w=(b-1)*i+c-s,T=Math.floor(x/2),C=x-T,k=Math.floor(v/2),$=v-k,I=Math.floor(w/2),D=w-I;f={top:k,bottom:$,left:I,right:D,front:T,back:C,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:f,outDepth:m,outHeight:g,outWidth:b}}function xf(n,t){if(!t)return Math.trunc(n);switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${t}`)}}function so(n){const[t,e,s]=bf(n);return t===1&&e===1&&s===1}function Pn(n,t){return so(n)||so(t)}function gl(n){return bf(n).every(t=>t>0)}function di(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function us(n,t,e){if(e!=null){if(typeof t=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);if(typeof t=="number")F(hl(t),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);else if(typeof t=="object")t.forEach(s=>{s.forEach(r=>{F(hl(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v7(n,t){const s={x:M(n,"x","reshape","string_or_numeric")},r={shape:t};return U.runKernel(kp,s,r)}const Z=G({reshape_:v7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w7(n,t,e,s,r){const a=M(n,"x","avgPool","float32"),i=1;F(Pn(e,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`);let o=a,l=!1;a.rank===3&&(l=!0,o=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),F(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),us("avgPool",s,r);const c={x:o},d={filterSize:t,strides:e,pad:s,dimRoundingMode:r};let f=U.runKernel(Vf,c,d);return f=Tt(f,a.dtype),l?Z(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Wp=G({avgPool_:w7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S7(n,t,e,s,r,a="NDHWC"){const i=M(n,"x","avgPool3d","float32");let o=i,l=!1;i.rank===4&&(l=!0,o=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),F(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),F(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),F(typeof e=="number"&&e>0||Array.isArray(e)&&e[0]>0&&e[1]>0&&e[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${e}'`),us("avgPool3d",s,r);const c={x:o},d={filterSize:t,strides:e,pad:s,dimRoundingMode:r,dataFormat:a};let f=U.runKernel(Uf,c,d);return f=Tt(f,o.dtype),l?Z(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const gT=G({avgPool3d_:S7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(n,t=0){F(n.length>=1,()=>"Pass at least one tensor to concat");const e=gf(n,"tensors","concat","string_or_numeric");if(e[0].dtype==="complex64"&&e.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),e.length===1)return da(e[0]);const s=e,r={axis:t};return U.runKernel(qf,s,r)}const Qe=G({concat_:T7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N7(n,t,e=!1,s=!1){let r=M(n,"a","matMul"),a=M(t,"b","matMul");[r,a]=Ue(r,a);const i={a:r,b:a},o={transposeA:e,transposeB:s};return U.runKernel(Wf,i,o)}const Xt=G({matMul_:N7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7(n){const e={x:M(n,"x","sigmoid","float32")};return U.runKernel(Jc,e)}const Vr=G({sigmoid_:C7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k7(n,t,e){const s=M(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},a={begin:t,size:e};return U.runKernel(Rp,r,a)}const ae=G({slice_:k7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(n){const e={x:M(n,"x","tanh","float32")};return U.runKernel(ah,e)}const ro=G({tanh_:$7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7(n,t,e,s,r,a){const i=M(n,"forgetBias","basicLSTMCell"),o=M(t,"lstmKernel","basicLSTMCell"),l=M(e,"lstmBias","basicLSTMCell"),c=M(s,"data","basicLSTMCell"),d=M(r,"c","basicLSTMCell"),f=M(a,"h","basicLSTMCell"),m=Qe([c,f],1),g=Xt(m,o),b=wt(g,l),x=b.shape[0],v=b.shape[1]/4,w=[x,v],T=ae(b,[0,0],w),C=ae(b,[0,v],w),k=ae(b,[0,v*2],w),$=ae(b,[0,v*3],w),I=wt(K(Vr(T),ro(C)),K(d,Vr(wt(i,k)))),D=K(ro(I),Vr($));return[I,D]}const oF=G({basicLSTMCell_:E7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(n,t,e){const s=M(n,"x","batchToSpaceND"),r=t.reduce((o,l)=>o*l);F(s.rank>=1+t.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`),F(e.length===t.length,()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${t.length}`),F(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${r}`);const a={x:s},i={blockShape:t,crops:e};return U.runKernel(Gf,a,i)}const Gp=G({batchToSpaceND_:I7});function A7(n){let t;return n.rank===0||n.rank===1?t=Z(n,[1,1,1,n.size]):n.rank===2?t=Z(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?t=Z(n,[1,n.shape[0],n.shape[1],n.shape[2]]):t=n,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R7(n,t,e,s,r,a){a==null&&(a=.001);const i=M(n,"x","batchNorm"),o=M(t,"mean","batchNorm"),l=M(e,"variance","batchNorm");let c;r!=null&&(c=M(r,"scale","batchNorm"));let d;s!=null&&(d=M(s,"offset","batchNorm")),F(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(d==null||o.rank===d.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const m={x:A7(i),scale:c,offset:d,mean:o,variance:l},g={varianceEpsilon:a},b=U.runKernel(np,m,g);return Z(b,i.shape)}const lh=G({batchNorm_:R7});function D7(n,t,e,s,r,a){const i=M(n,"x","batchNorm"),o=M(t,"mean","batchNorm"),l=M(e,"variance","batchNorm");let c;r!=null&&(c=M(r,"scale","batchNorm"));let d;return s!=null&&(d=M(s,"offset","batchNorm")),F(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),F(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),F(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&F(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),d!=null&&F(d.rank===2||d.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`),lh(i,o,l,d,c,a)}const yT=G({batchNorm2d_:D7});function O7(n,t,e,s,r,a){const i=M(n,"x","batchNorm"),o=M(t,"mean","batchNorm"),l=M(e,"variance","batchNorm");let c;r!=null&&(c=M(r,"scale","batchNorm"));let d;return s!=null&&(d=M(s,"offset","batchNorm")),F(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),F(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),F(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&F(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),d!=null&&F(d.rank===3||d.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`),lh(i,o,l,d,c,a)}const bT=G({batchNorm3d_:O7});function _7(n,t,e,s,r,a){const i=M(n,"x","batchNorm"),o=M(t,"mean","batchNorm"),l=M(e,"variance","batchNorm");let c;r!=null&&(c=M(r,"scale","batchNorm"));let d;return s!=null&&(d=M(s,"offset","batchNorm")),F(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),F(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),F(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&F(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),d!=null&&F(d.rank===4||d.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`),lh(i,o,l,d,c,a)}const xT=G({batchNorm4d_:_7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F7(n,t,e){const s=M(n,"x","bincount"),r=M(t,"weights","bincount");F(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),F(e>=0,()=>`size must be non-negative, but got ${e}.`),F(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const a={x:s,weights:r},i={size:e};return U.runKernel(N0,a,i)}const vT=G({bincount_:F7});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7(n,t){const e=M(n,"x","bitwiseAnd"),s=M(t,"y","bitwiseAnd");if(!te(e.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${e.shape}, y: ${s.shape}`);if(e.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${e.dtype} and type of y: ${s.dtype}`);const r={a:e,b:s};return U.runKernel(jf,r)}const lF=G({bitwiseAnd_:L7});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(n,t){const e=M(n,"s0","broadcastArgs","int32"),s=M(t,"s1","broadcastArgs","int32");if(e.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${e.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:e,s1:s};return U.runKernel(C0,r)}const uF=G({broadcastArgs_:M7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(n,t){let e=M(n,"broadcastTo","x");const s=e.shape;if(Bs(t),t.length<e.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${e.rank}.`);if(t.length>e.rank){const c=e.shape.slice();for(;c.length<t.length;)c.unshift(1);e=Z(e,c)}const r=e.shape,a=Array.from(t);for(let c=t.length-1;c>=0;c--)if(r[c]===t[c])a[c]=1;else if(e.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${t}].`);if(a.map((c,d)=>c>1?d:-1).filter(c=>c>=0).length===0)return da(e);const o={x:e},l={reps:a};return U.runKernel(ih,o,l)}const ll=G({broadcastTo_:z7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(n){const e={x:M(n,"x","ceil","float32")};return U.runKernel(wc,e)}const wT=G({ceil_:P7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rl(n,t,e){Bs(n),e=e||El(t);const s={shape:n,value:t,dtype:e};return U.runKernel(V0,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7(n,t,e){const s=M(n,"x","clipByValue");if(F(t<=e,()=>`Error in clip: min (${t}) must be less than or equal to max (${e}).`),t===e)return Rl(s.shape,t,s.dtype);const r={x:s},a={clipValueMin:t,clipValueMax:e};return U.runKernel(Sc,r,a)}const xs=G({clipByValue_:B7});function V7(n){return Qe(n,0)}const ST=G({concat1d_:V7});function U7(n,t){return Qe(n,t)}const TT=G({concat2d_:U7});function W7(n,t){return Qe(n,t)}const NT=G({concat3d_:W7});function G7(n,t){return Qe(n,t)}const CT=G({concat4d_:G7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j7(n,t,e,s,r="NHWC",a=[1,1],i){const o=M(n,"x","conv2d","float32"),l=M(t,"filter","conv2d","float32");let c=o,d=!1;o.rank===3&&(d=!0,c=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]])),F(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),F(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),us("conv2d",s,i);const f=r==="NHWC"?c.shape[3]:c.shape[1];F(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),F(Pn(e,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${a}'`),F(gl(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),F(gl(e),()=>"Error in conv2D: Strides should be larger than 0.");const m={x:c,filter:l},g={strides:e,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},b=U.runKernel(Kf,m,g);return d?Z(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const ri=G({conv2d_:j7});function H7(n,t,e,s,r="NWC",a=1,i){const o=M(n,"x","conv1d"),l=M(t,"filter","conv1d");let c=o,d=!1;o.rank===2&&(d=!0,c=Z(o,[1,o.shape[0],o.shape[1]])),F(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),F(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),us("conv1d",s,i),F(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),F(Pn(e,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${a}'`),F(gl(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),F(gl(e),()=>"Error in conv1D: Stride should be larger than 0."),F(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const f=Z(l,[1,l.shape[0],l.shape[1],l.shape[2]]),m=Z(c,[c.shape[0],1,c.shape[1],c.shape[2]]),v=ri(m,f,[1,e],s,"NHWC",[1,a],i);return d?Z(v,[v.shape[2],v.shape[3]]):Z(v,[v.shape[0],v.shape[2],v.shape[3]])}const Ib=G({conv1d_:H7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(n,t,e,s,r,a="NHWC",i){F(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let o=n,l=t,c=!1;t.rank===3&&(c=!0,l=Z(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,n[0],n[1],n[2]]),F(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),F(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),F(e.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`);const d=a==="NHWC"?o[3]:o[1],f=a==="NHWC"?l.shape[3]:l.shape[1];F(d===e.shape[2],()=>`Error in conv2dDerInput: depth of input (${d}) must match input depth for filter ${e.shape[2]}.`),F(f===e.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${e.shape[3]}.`),us("conv2dDerInput",r,i);const m={dy:l,filter:e},g={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,inputShape:o},b=U.runKernel(Xf,m,g);return c?Z(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const kT=G({conv2DBackpropInput_:q7});function K7(n,t,e,s,r,a){const i=M(n,"x","conv2dTranspose"),o=M(t,"filter","conv2dTranspose");return kT(e,i,o,s,r,"NHWC",a)}const Ab=G({conv2dTranspose_:K7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(n,t,e,s,r="NDHWC",a=[1,1,1]){const i=M(n,"x","conv3d"),o=M(t,"filter","conv3d");let l=i,c=!1;i.rank===4&&(c=!0,l=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),F(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),F(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),F(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),F(Pn(e,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${a}'`),F(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),F(gl(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),F(gl(e),()=>"Error in conv3D: Strides should be larger than 0.");const d={x:l,filter:o},f={strides:e,pad:s,dataFormat:r,dilations:a},m=U.runKernel(Yf,d,f);return c?Z(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const $T=G({conv3d_:X7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(n,t,e,s,r){F(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let a=n,i=t,o=!1;t.rank===4&&(o=!0,i=Z(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,n[0],n[1],n[2],n[3]]);const l=a[4],c=i.shape[4];F(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),F(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),F(e.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`),F(l===e.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${e.shape[3]}.`),F(c===e.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${e.shape[4]}.`);const d={dy:i,filter:e},f={pad:r,strides:s,inputShape:a},m=U.runKernel(I0,d,f);return o?Z(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const cF=G({conv3DBackpropInput_:Y7});function Z7(n,t,e,s,r){const a=M(n,"x","conv3dTranspose"),i=M(t,"filter","conv3dTranspose");return cF(e,a,i,s,r)}const ET=G({conv3dTranspose_:Z7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q7(n){const e={x:M(n,"x","cos","float32")};return U.runKernel(Tc,e)}const jp=G({cos_:Q7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J7(n){const e={x:M(n,"x","cosh","float32")};return U.runKernel(Nc,e)}const Rb=G({cosh_:J7});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9(n,t=0,e=!1,s=!1){const a={x:M(n,"x","cumprod")},i={axis:t,exclusive:e,reverse:s};return U.runKernel(A0,a,i)}const vf=G({cumprod_:t9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(n,t=0,e=!1,s=!1){const a={x:M(n,"x","cumsum")},i={axis:t,exclusive:e,reverse:s};return U.runKernel(Zf,a,i)}const Db=G({cumsum_:e9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n9(n,t,e,s=!1){const r=M(n,"x","denseBincount"),a=M(t,"weights","denseBincount");F(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),F(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),F(e>=0,()=>`size must be non-negative, but got ${e}.`),F(a.size===r.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${a.shape}.`);const i={x:r,weights:a},o={size:e,binaryOutput:s};return U.runKernel(D0,i,o)}const zy=G({denseBincount_:n9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(n,t,e="NHWC"){const s=M(n,"x","depthToSpace","float32"),r=e==="NHWC"?s.shape[1]:s.shape[2],a=e==="NHWC"?s.shape[2]:s.shape[3],i=e==="NHWC"?s.shape[3]:s.shape[1];F(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),F(r*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${t}  for depthToSpace with input shape
    ${s.shape}`),F(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t} for depthToSpace with input shape
        ${s.shape}`),F(i%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${i} for depthToSpace with input shape ${s.shape}`);const o={x:s},l={blockSize:t,dataFormat:e};return U.runKernel(O0,o,l)}const IT=G({depthToSpace_:s9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r9(n,t,e,s,r="NHWC",a=[1,1],i){const o=M(n,"x","depthwiseConv2d","float32"),l=M(t,"filter","depthwiseConv2d","float32");let c=o,d=!1;o.rank===3&&(d=!0,c=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]])),F(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),F(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=r==="NHWC"?c.shape[3]:c.shape[1];F(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),us("depthwiseConv2d",s,i);const m={x:c,filter:l},g={strides:e,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},b=U.runKernel(Qf,m,g);return d?Z(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const uh=G({depthwiseConv2d_:r9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a9(n){const e={x:M(n,"x","diag")};return U.runKernel(L0,e)}const hF=G({diag_:a9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9(n,t,e,s,r=[1,1],a="NHWC"){const i=M(n,"x","dilation2d"),o=M(t,"filter","dilation2d");F(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),F(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),F(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let l=i,c=!1;i.rank===3&&(l=Z(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),F(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const d={x:l,filter:o},f={strides:e,pad:s,dilations:r},m=U.runKernel(Jf,d,f);return c?Z(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const AT=G({dilation2d_:i9});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yl(n,t){const e=n.length,s=[];for(let r=0;r<e;r++){const a=e-1-r,i=n[a]||1;(t[t.length-1-r]||1)>1&&i===1&&s.unshift(a)}return s}function hn(n,t){const e=[];for(let s=0;s<t.length;s++){const r=n[n.length-s-1],a=t.length-s-1,i=t[a];(r==null||r===1&&i>1)&&e.unshift(a)}return e}function jt(n,t){const e=Math.max(n.length,t.length),s=new Array(e);for(let r=0;r<e;r++){let a=n[n.length-r-1];a==null&&(a=1);let i=t[t.length-r-1];if(i==null&&(i=1),a===1)s[e-r-1]=i;else if(i===1)s[e-r-1]=a;else if(a!==i){const o=`Operands could not be broadcast together with shapes ${n} and ${t}.`;throw Error(o)}else s[e-r-1]=a}return s}const o9=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:jt,getBroadcastDims:yl,getReductionAxes:hn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(n,t){let e=M(n,"a","equal","string_or_numeric"),s=M(t,"b","equal","string_or_numeric");[e,s]=Ue(e,s),jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(tp,r)}const Cr=G({equal_:l9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u9(n,t,e){const s=M(t,"a","where"),r=M(e,"b","where"),a=M(n,"condition","where","bool"),i=jt(jt(a.shape,s.shape),r.shape),o=ll(a,i),l=ll(s,i),c=ll(r,i),d={condition:o,t:l,e:c};return U.runKernel(Ap,d)}const Ln=G({where_:u9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c9(n){const e={x:M(n,"x","zerosLike")};return U.runKernel(Pp,e)}const ie=G({zerosLike_:c9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(n,t){let e=M(n,"a","div"),s=M(t,"b","div");[e,s]=Ue(e,s);const r=Ot(e,s),a=ie(r),i=Cr(s,a);return Ln(i,a,r)}const RT=G({divNoNan_:h9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d9(n,t){const e=M(n,"t1","dot"),s=M(t,"t2","dot");F((e.rank===1||e.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${s.rank}.`);const r=e.rank===1?e.size:e.shape[1],a=s.rank===1?s.size:s.shape[0];if(F(r===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${a}.`),e.rank===1&&s.rank===1){const i=Z(e,[1,-1]),o=Z(s,[-1,1]),l=Xt(i,o);return Z(l,[])}else if(e.rank===1&&s.rank===2){const i=Z(e,[1,-1]),o=Z(s,[s.shape[0],s.shape[1]]),l=Xt(i,o);return Z(l,[l.size])}else if(e.rank===2&&s.rank===1){const i=Z(s,[-1,1]),o=Xt(e,i);return Z(o,[o.size])}else{const i=Z(s,[s.shape[0],s.shape[1]]);return Xt(e,i)}}const DT=G({dot_:d9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(n,...t){const e=t.map((r,a)=>M(r,`tensors${a}`,"einsum")),s={equation:n};return U.runKernel(z0,e,s)}const Zo=G({einsum_:f9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p9(n){const e={x:M(n,"x","elu","float32")};return U.runKernel(kc,e)}const ch=G({elu_:p9});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9(n,t){const e=M(n,"x","ensureShape","string_or_numeric");if(!w3(e.shape,t))throw new Error(`EnsureShape: Shape of tensor ${e.shape} is not compatible with expected shape ${t}`);return n}const dF=G({ensureShape_:m9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(n){let t=M(n,"x","erf");F(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Tt(t,"float32"));const e={x:t};return U.runKernel($c,e)}const Ob=G({erf_:g9});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OT(n,t){for(let e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function fF(n,t,e){const s=n.length+t.length,r=[];let a=0,i=0;for(let o=0;o<s;o++)e.indexOf(o)===-1?r.push(n[a++]):r.push(t[i++]);return r}function In(n,t){const e=[],s=n.length;for(let a=0;a<s;a++)t.indexOf(a)===-1&&e.push(n[a]);const r=t.map(a=>n[a]);return[e,r]}function Je(n,t){const e=t.map(s=>1);return fF(n,e,t)}function Bn(n,t,e){F(OT(t,e),()=>`${n} supports only inner-most axes for now. Got axes ${t} and rank-${e} input.`)}function We(n,t){if(OT(n,t))return null;const e=[];for(let s=0;s<t;++s)n.indexOf(s)===-1&&e.push(s);return n.forEach(s=>e.push(s)),e}function go(n){return n.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function tn(n,t){const e=[];for(let s=t-n;s<t;++s)e.push(s);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y9(n,t=null,e=!1){const r={x:M(n,"x","max")},a={reductionIndices:t,keepDims:e};return U.runKernel(dp,r,a)}const er=G({max_:y9});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9(n,t=null,e=!1){const r={x:M(n,"x","min")},a={axis:t,keepDims:e};return U.runKernel(gp,r,a)}const Xu=G({min_:b9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9(n,t){let e=M(n,"base","pow"),s=M(t,"exp","pow");[e,s]=Ue(e,s);const r={a:e,b:s};return U.runKernel(Wc,r)}const xa=G({pow_:x9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lt(n,t){if((Nn(n)&&t!=="string"||Array.isArray(n))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Nn(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return po(n,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9(n){const e={x:M(n,"x","sqrt","float32")};return U.runKernel(eh,e)}const $n=G({sqrt_:v9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(n){const t=M(n,"x","square"),e={};return U.runKernel("Square",{x:t},e)}const Se=G({square_:w9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9(n,t=null,e=!1){let s=M(n,"x","sum");s.dtype==="bool"&&(s=Tt(s,"int32"));const r={x:s},a={axis:t,keepDims:e};return U.runKernel(Dp,r,a)}const It=G({sum_:S9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T9(n,t="euclidean",e=null,s=!1){n=M(n,"x","norm");const r=pF(n,t,e);let a=r.shape;if(s){const i=Zt(e,n.shape);a=Je(r.shape,i)}return Z(r,a)}function pF(n,t,e=null){if(n.rank===0)return ln(n);if(n.rank!==1&&e===null)return pF(Z(n,[-1]),t,e);if(n.rank===1||typeof e=="number"||Array.isArray(e)&&e.length===1){if(t===1)return It(ln(n),e);if(t===1/0)return er(ln(n),e);if(t===-1/0)return Xu(ln(n),e);if(t==="euclidean"||t===2)return $n(It(xa(ln(n),Lt(2,"int32")),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(e)&&e.length===2){if(t===1)return er(It(ln(n),e[0]),e[1]-1);if(t===1/0)return er(It(ln(n),e[1]),e[0]);if(t===-1/0)return Xu(It(ln(n),e[1]),e[0]);if(t==="fro"||t==="euclidean")return $n(It(Se(n),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${e}`)}const hh=G({norm_:T9});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N9(n,t=null,e=!1){return hh(n,"euclidean",t,e)}const _T=G({euclideanNorm_:N9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9(n){const e={x:M(n,"x","exp")};return U.runKernel(Ec,e)}const vs=G({exp_:C9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k9(n,t=0){const e=M(n,"x","expandDims","string_or_numeric");F(t<=e.rank,()=>"Axis must be <= rank of the tensor");const s={input:e},r={dim:t};return U.runKernel(ep,s,r)}const Kn=G({expandDims_:k9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $9(n){const e={x:M(n,"x","expm1")};return U.runKernel(Ic,e)}const FT=G({expm1_:$9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9(n,t){const e=M(n,"x","tile","string_or_numeric");F(e.rank===t.length,()=>`Error in transpose: rank of input ${e.rank} must match length of reps ${t}.`);const s={x:e},r={reps:t};return U.runKernel(ih,s,r)}const Qs=G({tile_:E9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I9(n,t,e,s="float32"){t==null&&(t=n);const r=Ht([n,t],s),a=n<=t?n:t;for(let o=0;o<a;++o)r.set(1,o,o);const i=Z(r.toTensor(),[n,t]);if(e==null)return i;if(e.length===1)return Qs(Kn(i,0),[e[0],1,1]);if(e.length===2)return Qs(Kn(Kn(i,0),0),[e[0],e[1],1,1]);if(e.length===3)return Qs(Kn(Kn(Kn(i,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}const _b=G({eye_:I9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9(n){const e={x:M(n,"x","floor","float32")};return U.runKernel(Ac,e)}const dh=G({floor_:A9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(n,t,e=0,s=0){const r=M(n,"x","gather"),a=M(t,"indices","gather","int32"),i={x:r,indices:a},o={axis:e,batchDims:s};return U.runKernel(sp,i,o)}const fh=G({gather_:R9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(n,t){let e=M(n,"a","greater","string_or_numeric"),s=M(t,"b","greater","string_or_numeric");[e,s]=Ue(e,s),jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(rp,r)}const Ts=G({greater_:D9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(n,t){let e=M(n,"a","greaterEqual","string_or_numeric"),s=M(t,"b","greaterEqual","string_or_numeric");[e,s]=Ue(e,s),jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(Dc,r)}const fi=G({greaterEqual_:O9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9(n){const e={input:M(n,"input","imag")};return U.runKernel(j0,e)}const Hp=G({imag_:_9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F9(n){const e={x:M(n,"x","isFinite")};return U.runKernel(_c,e)}const LT=G({isFinite_:F9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(n){const e={x:M(n,"x","isInf")};return U.runKernel(Fc,e)}const MT=G({isInf_:L9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(n){const e={x:M(n,"x","isNaN")};return U.runKernel(Lc,e)}const zT=G({isNaN_:M9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(n,t=.2){const s={x:M(n,"x","leakyRelu")},r={alpha:t};return U.runKernel(ap,s,r)}const qp=G({leakyRelu_:z9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9(n,t){let e=M(n,"a","less","string_or_numeric"),s=M(t,"b","less","string_or_numeric");[e,s]=Ue(e,s),jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(ip,r)}const Yu=G({less_:P9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(n,t){let e=M(n,"a","lessEqual","string_or_numeric"),s=M(t,"b","lessEqual","string_or_numeric");[e,s]=Ue(e,s),jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(op,r)}const yo=G({lessEqual_:B9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mF(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");const s={start:n,stop:t,num:e};return U.runKernel(H0,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V9(n,t=5,e=1,s=1,r=.5){const a=M(n,"x","localResponseNormalization");F(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),F(hl(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let i=a,o=!1;a.rank===3&&(o=!0,i=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l={x:i},c={depthRadius:t,bias:e,alpha:s,beta:r},d=U.runKernel(hp,l,c);return o?Z(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const PT=G({localResponseNormalization_:V9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(n){const e={x:M(n,"x","log","float32")};return U.runKernel(Mc,e)}const Fs=G({log_:U9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9(n){const e={x:M(n,"x","log1p")};return U.runKernel(zc,e)}const Kp=G({log1p_:W9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(n){return F(to(n),()=>"The f passed in grad(f) must be a function"),(t,e)=>{const s=M(t,"x","tf.grad","string_or_numeric"),r=e!=null?M(e,"dy","tf.grad"):null;return U.tidy(()=>{const{value:a,grads:i}=U.gradients(()=>n(s),[s],r);return r!=null&&zn(a.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Fb(i),i[0]})}}function j9(n){return F(to(n),()=>"The f passed in grads(f) must be a function"),(t,e)=>{F(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=gf(t,"args","tf.grads","string_or_numeric"),r=e!=null?M(e,"dy","tf.grads"):null;return U.tidy(()=>{const{value:a,grads:i}=U.gradients(()=>n(...s),s,r);return r!=null&&zn(a.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Fb(i),i})}}function H9(n){return F(to(n),()=>"The f passed in valueAndGrad(f) must be a function"),(t,e)=>{F(t instanceof ge,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),F(e==null||e instanceof ge,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=U.gradients(()=>n(t),[t],e);return Fb(s),{grad:s[0],value:r}}}function q9(n){return F(to(n),()=>"The f passed in valueAndGrads(f) must be a function"),(t,e)=>{F(Array.isArray(t)&&t.every(r=>r instanceof ge),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),F(e==null||e instanceof ge,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=U.gradients(()=>n(...t),t,e);return e!=null&&zn(s.value.shape,e.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Fb(s.grads),s}}function gF(n,t){F(to(n),()=>"The f passed in variableGrads(f) must be a function"),F(t==null||Array.isArray(t)&&t.every(c=>c instanceof mf),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const e=t!=null;if(!e){t=[];for(const c in U.registeredVariables)t.push(U.registeredVariables[c])}const s=e?t.filter(c=>!c.trainable):null,r=t.length;t=t.filter(c=>c.trainable),F(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const a=!0,{value:i,grads:o}=U.gradients(n,t,null,a);F(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),F(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return t.forEach((c,d)=>{o[d]!=null&&(l[c.name]=o[d])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:i,grads:l}}function va(n){return U.customGrad(n)}function Fb(n){if(n.filter(e=>e==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(n){const e={x:M(n,"x","neg")};return U.runKernel(bp,e)}const De=G({neg_:K9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(n){const e={x:M(n,"x","softplus")};return U.runKernel(th,e)}const Dl=G({softplus_:X9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(n){const t=M(n,"x","logSigmoid");return va(s=>({value:De(Dl(De(s))),gradFunc:i=>K(i,Vr(De(s)))}))(t)}const BT=G({logSigmoid_:Y9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(n,t){let e=M(n,"a","sub"),s=M(t,"b","sub");[e,s]=Ue(e,s);const r={a:e,b:s};return U.runKernel(sh,r)}const Et=G({sub_:Z9});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9(n,t=-1){const e=M(n,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${t}`);return va((r,a)=>{const o=er(r,t,!0),l=Et(r,o),c=Et(Tt(l,"float32"),Fs(It(vs(l),t,!0)));return a([c]),{value:c,gradFunc:(f,m)=>{const[g]=m,b=!0,x=vs(g);return Et(f,K(It(f,t,b),x))}}})(e)}const Lb=G({logSoftmax_:Q9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(n,t=null,e=!1){const s=M(n,"x","logSumExp"),r=Zt(t,s.shape),a=er(s,r,!0),i=Et(s,a),o=vs(i),l=It(o,r),c=Fs(l),d=wt(Z(a,c.shape),c);if(e){const f=Je(d.shape,r);return Z(d,f)}return d}const Xp=G({logSumExp_:J9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tK(n,t){const e=M(n,"a","logicalAnd","bool"),s=M(t,"b","logicalAnd","bool");jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(lp,r)}const Gr=G({logicalAnd_:tK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eK(n){const e={x:M(n,"x","logicalNot","bool")};return U.runKernel(up,e)}const Yp=G({logicalNot_:eK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nK(n,t){const e=M(n,"a","logicalOr","bool"),s=M(t,"b","logicalOr","bool");jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(cp,r)}const Mb=G({logicalOr_:nK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sK(n,t){const e=M(n,"a","logicalXor","bool"),s=M(t,"b","logicalXor","bool");return jt(e.shape,s.shape),Gr(Mb(n,t),Yp(Gr(n,t)))}const VT=G({logicalXor_:sK});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wg=2147483648;function rK(n,t,e="left"){const s=M(n,"sortedSequence","searchSorted"),r=M(t,"values","searchSorted"),a=s.shape[s.shape.length-1],i=r.shape[r.shape.length-1],o=Z(s,[-1,a]),l=Z(r,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(ft(l.shape)>=Wg)throw new Error(`values tensor size must less than ${Wg}`);if(o.shape[1]>=Wg)throw new Error(`trailing dim_size must less than ${Wg} for int32 output type, was ${o.shape[1]}`);const c={sortedSequence:o,values:l},d={side:e};return U.runKernel(cb,c,d)}const zb=G({searchSorted_:rK});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yF(n,t){return zb(n,t,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aK(n,t,e,s,r){const a=M(n,"x","maxPool"),i=1;let o=a,l=!1;a.rank===3&&(l=!0,o=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),F(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),F(Pn(e,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`),us("maxPool",s,r);const c={x:o},d={filterSize:t,strides:e,pad:s,dimRoundingMode:r},f=U.runKernel(fp,c,d);return l?Z(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Zp=G({maxPool_:aK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(n,t=[1,1,1],e,s,r,a="NDHWC"){const i=M(n,"x","maxPool3d");let o=i,l=!1;i.rank===4&&(l=!0,o=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),F(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),F(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),us("maxPool3d",s,r);const c={x:o},d={filterSize:t,strides:e,pad:s,dimRoundingMode:r,dataFormat:a},f=U.runKernel(pp,c,d);return l?Z(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const UT=G({maxPool3d_:iK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oK(n,t,e,s,r=!1){const i={x:M(n,"x","maxPoolWithArgmax")},o={filterSize:t,strides:e,pad:s,includeBatchInIndex:r},l=U.runKernel(Y0,i,o);return{result:l[0],indexes:l[1]}}const bF=G({maxPoolWithArgmax_:oK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(n,t){let e=M(n,"a","maximum"),s=M(t,"b","maximum");[e,s]=Ue(e,s),e.dtype==="bool"&&(e=Tt(e,"int32"),s=Tt(s,"int32")),jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(Pc,r)}const Na=G({maximum_:lK});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uK(n,t=null,e=!1){const r={x:M(n,"x","mean")},a={axis:t,keepDims:e};return U.runKernel(mp,r,a)}const Be=G({mean_:uK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function un(n,t="float32"){if(Bs(n),t==="complex64"){const s=un(n,"float32"),r=un(n,"float32");return si(s,r)}const e=Mn(ft(n),t);return U.makeTensor(e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ms(n,t="float32"){if(Bs(n),t==="complex64"){const s=ms(n,"float32"),r=un(n,"float32");return si(s,r)}const e=x0(ft(n),t);return U.makeTensor(e,n,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xF(n,t,{indexing:e="xy"}={}){if(e!=="xy"&&e!=="ij")throw new TypeError(`${e} is not a valid third argument to meshgrid`);if(n===void 0)return[];let s=M(n,"x","meshgrid",n instanceof ge?n.dtype:"float32");if(t===void 0)return[s];let r=M(t,"y","meshgrid",t instanceof ge?t.dtype:"float32");const a=ft(s.shape),i=ft(r.shape);return e==="xy"?(s=Z(s,[1,-1]),r=Z(r,[-1,1]),[Xt(ms([i,1],s.dtype),s),Xt(r,ms([1,a],r.dtype))]):(s=Z(s,[-1,1]),r=Z(r,[1,-1]),[Xt(s,ms([1,i],s.dtype)),Xt(ms([a,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cK(n,t){let e=M(n,"a","minimum"),s=M(t,"b","minimum");[e,s]=Ue(e,s),e.dtype==="bool"&&(e=Tt(e,"int32"),s=Tt(s,"int32")),jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(Bc,r)}const ao=G({minimum_:cK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hK(n,t,e){F(e==="reflect"||e==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`);const s=M(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");F(t.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`);const r=e==="reflect"?1:0;for(let o=0;o<s.rank;o++)F(t[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),F(t[o][0]>=0&&t[o][0]<=s.shape[o]-r&&t[o][1]>=0&&t[o][1]<=s.shape[o]-r,()=>`Padding in dimension ${o} cannot be greater than or equal to ${s.shape[o]-r} or less than 0 for input of shape ${s.shape}`);const a={paddings:t,mode:e},i={x:s};return U.runKernel(yp,i,a)}const WT=G({mirrorPad_:hK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dK(n,t){let e=M(n,"a","mod"),s=M(t,"b","mod");[e,s]=Ue(e,s);const r={a:e,b:s};return U.runKernel(Vc,r)}const GT=G({mod_:dK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fK(n,t=null,e=!1){n=M(n,"x","moments");const s=Zt(t,n.shape),r=Be(n,s,e);let a=r.shape;e||(a=Je(r.shape,s));const i=Se(Et(Tt(n,"float32"),Z(r,a))),o=Be(i,s,e);return{mean:r,variance:o}}const Qp=G({moments_:fK});function pK(n,t,e,s){const r=M(t,"data","multiRNNCell"),a=gf(e,"c","multiRNNCell"),i=gf(s,"h","multiRNNCell");let o=r;const l=[];for(let f=0;f<n.length;f++){const m=n[f](o,a[f],i[f]);l.push(m[0]),l.push(m[1]),o=m[1]}const c=[],d=[];for(let f=0;f<l.length;f+=2)c.push(l[f]),d.push(l[f+1]);return[c,d]}const vF=G({multiRNNCell_:pK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mK(n,t,e,s=!1){const r=M(n,"logits","multinomial"),a=r.size,i=r.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);e=e||Math.random();const l={logits:i===1?Z(r,[1,-1]):r},c={numSamples:t,seed:e,normalized:s},d=U.runKernel(Z0,l,c);return i===1?Z(d,[d.size]):d}const wF=G({multinomial_:mK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gK(n,t){let e=M(n,"a","notEqual","string_or_numeric"),s=M(t,"b","notEqual","string_or_numeric");[e,s]=Ue(e,s),jt(e.shape,s.shape);const r={a:e,b:s};return U.runKernel(xp,r)}const bl=G({notEqual_:gK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yK(n,t,e=1,s=0,r="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const i={indices:M(n,"indices","oneHot","int32")},o={dtype:r,depth:t,onValue:e,offValue:s};return U.runKernel(wp,i,o)}const Zu=G({oneHot_:yK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bK(n){const e={x:M(n,"x","onesLike")};return U.runKernel(vp,e)}const Ls=G({onesLike_:bK});function xK(n,t){const e=M(n,"v1","outerProduct"),s=M(t,"v2","outerProduct");F(e.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${e.rank} and ${s.rank}.`);const r=Z(e,[-1,1]),a=Z(s,[1,-1]);return Xt(r,a)}const SF=G({outerProduct_:xK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vK(n,t,e=0){const s=M(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:t,constantValue:e},a={x:s};return U.runKernel(Tp,a,r)}const pi=G({pad_:vK});function wK(n,t,e=0){return F(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),pi(n,[t],e)}const TF=G({pad1d_:wK});function SK(n,t,e=0){return F(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),pi(n,t,e)}const NF=G({pad2d_:SK});function TK(n,t,e=0){return F(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),pi(n,t,e)}const CF=G({pad3d_:TK});function NK(n,t,e=0){return F(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),pi(n,t,e)}const kF=G({pad4d_:NK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CK(n,t,e){const s=M(n,"x","spaceToBatchND");F(s.rank>=1+t.length,()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`),F(e.length===t.length,()=>`paddings.shape[0] ${e.length} must be equal to [blockShape] ${t.length}`),F(s.shape.reduce((i,o,l)=>l>0&&l<=t.length?i&&(o+e[l-1][0]+e[l-1][1])%t[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${e.toString()} must be divisible by blockShapes ${t.toString()}`);const r={x:s},a={blockShape:t,paddings:e};return U.runKernel(Op,r,a)}const Jp=G({spaceToBatchND_:CK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kK(n,t,e,s,r,a,i){r==null&&(r=[1,1]),a==null&&(a=1),s===0&&(s="valid");const o=M(n,"x","maxPool");let l=o,c=!1;o.rank===3&&(c=!0,l=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]])),F(Pn(a,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${r}'`);const d=kr(l.shape,t,a,r,s),f=[d.dilationHeight,d.dilationWidth];let m;s==="same"?m=EK([d.filterHeight,d.filterWidth],f):m=[[0,0],[0,0]];const g=f[0]===1&&f[1]===1,[b,x]=$K([d.inHeight,d.inWidth],f,m),v=g?s:"valid",w=g?l:Jp(l,f,b),C=(e==="avg"?()=>Wp(w,t,a,v,i):()=>Zp(w,t,a,v,i))(),k=g?C:Gp(C,f,x);return c?Z(k,[k.shape[1],k.shape[2],k.shape[3]]):k}function $K(n,t,e){const s=e.map(d=>d[0]),r=e.map(d=>d[1]),a=n.concat(s,r),i=t.map((d,f)=>(d-a[f]%d)%d),o=r.map((d,f)=>d+i[f]),l=t.map((d,f)=>[s[f],o[f]]),c=t.map((d,f)=>[0,i[f]]);return[l,c]}function EK(n,t){const s=n.map((i,o)=>i+(i-1)*(t[o]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),a=s.map((i,o)=>i-r[o]);return s.map((i,o)=>[r[o],a[o]])}const jT=G({pool_:kK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IK(n,t){const e=M(n,"x","prelu"),s=M(t,"alpha","prelu"),r={x:e,alpha:s};return U.runKernel(Np,r)}const tm=G({prelu_:IK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AK(n,t=null,e=!1){let s=M(n,"x","prod");s.dtype==="bool"&&(s=Tt(s,"int32"));const r={x:s},a={axis:t,keepDims:e};return U.runKernel(Cp,r,a)}const HT=G({prod_:AK});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RK(n,t,e,s){const r=n.map((d,f)=>M(d,`tensors${f}`,"raggedGather","int32")),a=M(t,"paramsDenseValues","raggedGather"),i=M(e,"indices","raggedGather","int32"),o={paramsNestedSplits:r,paramsDenseValues:a,indices:i},l={outputRaggedRank:s},c=U.runKernel(eb,o,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const $F=G({raggedGather_:RK});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DK(n,t,e){const s=M(n,"starts","raggedRange"),r=M(t,"limits","raggedRange",s.dtype),a=M(e,"deltas","raggedRange",s.dtype),i={starts:s,limits:r,deltas:a},o=U.runKernel(nb,i);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}const EF=G({raggedRange_:DK});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OK(n,t,e,s,r){const a=M(n,"shape","raggedTensorToTensor","int32"),i=M(t,"values","raggedTensorToTensor"),o=M(e,"defaultValue","raggedTensorToTensor",i.dtype),l=s.map((f,m)=>M(f,`tensors${m}`,"raggedTensorToTensor","int32")),c={shape:a,values:i,defaultValue:o,rowPartitionTensors:l},d={rowPartitionTypes:r};return U.runKernel(sb,c,d)}const IF=G({raggedTensorToTensor_:OK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _K(n,t,e){Bs(n);const s=ft(n);let r=null;if(e==null||e==="float32")r=new Float32Array(s);else if(e==="int32")r=new Int32Array(s);else if(e==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${e}`);for(let a=0;a<s;a++)r[a]=t();return U.makeTensor(r,n,e)}const AF=G({rand_:_K});var fy={exports:{}},FK=fy.exports,vR;function LK(){return vR||(vR=1,function(n){(function(t,e,s){function r(l){var c=this,d=o();c.next=function(){var f=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=f-(c.c=f|0)},c.c=1,c.s0=d(" "),c.s1=d(" "),c.s2=d(" "),c.s0-=d(l),c.s0<0&&(c.s0+=1),c.s1-=d(l),c.s1<0&&(c.s1+=1),c.s2-=d(l),c.s2<0&&(c.s2+=1),d=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var d=new r(l),f=c&&c.state,m=d.next;return m.int32=function(){return d.next()*4294967296|0},m.double=function(){return m()+(m()*2097152|0)*11102230246251565e-32},m.quick=m,f&&(typeof f=="object"&&a(f,d),m.state=function(){return a(d,{})}),m}function o(){var l=4022871197,c=function(d){d=String(d);for(var f=0;f<d.length;f++){l+=d.charCodeAt(f);var m=.02519603282416938*l;l=m>>>0,m-=l,m*=l,l=m>>>0,m-=l,l+=m*4294967296}return(l>>>0)*23283064365386963e-26};return c}e&&e.exports?e.exports=i:this.alea=i})(FK,n)}(fy)),fy.exports}var py={exports:{}},MK=py.exports,wR;function zK(){return wR||(wR=1,function(n){(function(t,e,s){function r(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},o===(o|0)?l.x=o:c+=o;for(var d=0;d<c.length+64;d++)l.x^=c.charCodeAt(d)|0,l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function i(o,l){var c=new r(o),d=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},f.int32=c.next,f.quick=f,d&&(typeof d=="object"&&a(d,c),f.state=function(){return a(c,{})}),f}e&&e.exports?e.exports=i:this.xor128=i})(MK,n)}(py)),py.exports}var my={exports:{}},PK=my.exports,SR;function BK(){return SR||(SR=1,function(n){(function(t,e,s){function r(o){var l=this,c="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var d=0;d<c.length+64;d++)l.x^=c.charCodeAt(d)|0,d==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function i(o,l){var c=new r(o),d=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},f.int32=c.next,f.quick=f,d&&(typeof d=="object"&&a(d,c),f.state=function(){return a(c,{})}),f}e&&e.exports?e.exports=i:this.xorwow=i})(PK,n)}(my)),my.exports}var gy={exports:{}},VK=gy.exports,TR;function UK(){return TR||(TR=1,function(n){(function(t,e,s){function r(o){var l=this;l.next=function(){var d=l.x,f=l.i,m,g;return m=d[f],m^=m>>>7,g=m^m<<24,m=d[f+1&7],g^=m^m>>>10,m=d[f+3&7],g^=m^m>>>3,m=d[f+4&7],g^=m^m<<7,m=d[f+7&7],m=m^m<<13,g^=m^m<<9,d[f]=g,l.i=f+1&7,g};function c(d,f){var m,g=[];if(f===(f|0))g[0]=f;else for(f=""+f,m=0;m<f.length;++m)g[m&7]=g[m&7]<<15^f.charCodeAt(m)+g[m+1&7]<<13;for(;g.length<8;)g.push(0);for(m=0;m<8&&g[m]===0;++m);for(m==8?g[7]=-1:g[m],d.x=g,d.i=0,m=256;m>0;--m)d.next()}c(l,o)}function a(o,l){return l.x=o.x.slice(),l.i=o.i,l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),d=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},f.int32=c.next,f.quick=f,d&&(d.x&&a(d,c),f.state=function(){return a(c,{})}),f}e&&e.exports?e.exports=i:this.xorshift7=i})(VK,n)}(gy)),gy.exports}var yy={exports:{}},WK=yy.exports,NR;function GK(){return NR||(NR=1,function(n){(function(t,e,s){function r(o){var l=this;l.next=function(){var d=l.w,f=l.X,m=l.i,g,b;return l.w=d=d+1640531527|0,b=f[m+34&127],g=f[m=m+1&127],b^=b<<13,g^=g<<17,b^=b>>>15,g^=g>>>12,b=f[m]=b^g,l.i=m,b+(d^d>>>16)|0};function c(d,f){var m,g,b,x,v,w=[],T=128;for(f===(f|0)?(g=f,f=null):(f=f+"\0",g=0,T=Math.max(T,f.length)),b=0,x=-32;x<T;++x)f&&(g^=f.charCodeAt((x+32)%f.length)),x===0&&(v=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,x>=0&&(v=v+1640531527|0,m=w[x&127]^=g+v,b=m==0?b+1:0);for(b>=128&&(w[(f&&f.length||0)&127]=-1),b=127,x=4*128;x>0;--x)g=w[b+34&127],m=w[b=b+1&127],g^=g<<13,m^=m<<17,g^=g>>>15,m^=m>>>12,w[b]=g^m;d.w=v,d.X=w,d.i=b}c(l,o)}function a(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),d=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},f.int32=c.next,f.quick=f,d&&(d.X&&a(d,c),f.state=function(){return a(c,{})}),f}e&&e.exports?e.exports=i:this.xor4096=i})(WK,n)}(yy)),yy.exports}var by={exports:{}},jK=by.exports,CR;function HK(){return CR||(CR=1,function(n){(function(t,e,s){function r(o){var l=this,c="";l.next=function(){var f=l.b,m=l.c,g=l.d,b=l.a;return f=f<<25^f>>>7^m,m=m-g|0,g=g<<24^g>>>8^b,b=b-f|0,l.b=f=f<<20^f>>>12^m,l.c=m=m-g|0,l.d=g<<16^m>>>16^b,l.a=b-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var d=0;d<c.length+20;d++)l.b^=c.charCodeAt(d)|0,l.next()}function a(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function i(o,l){var c=new r(o),d=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},f.int32=c.next,f.quick=f,d&&(typeof d=="object"&&a(d,c),f.state=function(){return a(c,{})}),f}e&&e.exports?e.exports=i:this.tychei=i})(jK,n)}(by)),by.exports}var xy={exports:{}};const qK={},KK=Object.freeze(Object.defineProperty({__proto__:null,default:qK},Symbol.toStringTag,{value:"Module"})),XK=ZS(KK);var YK=xy.exports,kR;function ZK(){return kR||(kR=1,function(n){(function(t,e,s){var r=256,a=6,i=52,o="random",l=s.pow(r,a),c=s.pow(2,i),d=c*2,f=r-1,m;function g(k,$,I){var D=[];$=$==!0?{entropy:!0}:$||{};var _=w(v($.entropy?[k,C(e)]:k??T(),3),D),O=new b(D),L=function(){for(var R=O.g(a),V=l,Y=0;R<c;)R=(R+Y)*r,V*=r,Y=O.g(1);for(;R>=d;)R/=2,V/=2,Y>>>=1;return(R+Y)/V};return L.int32=function(){return O.g(4)|0},L.quick=function(){return O.g(4)/4294967296},L.double=L,w(C(O.S),e),($.pass||I||function(R,V,Y,Q){return Q&&(Q.S&&x(Q,O),R.state=function(){return x(O,{})}),Y?(s[o]=R,V):R})(L,_,"global"in $?$.global:this==s,$.state)}function b(k){var $,I=k.length,D=this,_=0,O=D.i=D.j=0,L=D.S=[];for(I||(k=[I++]);_<r;)L[_]=_++;for(_=0;_<r;_++)L[_]=L[O=f&O+k[_%I]+($=L[_])],L[O]=$;(D.g=function(R){for(var V,Y=0,Q=D.i,tt=D.j,B=D.S;R--;)V=B[Q=f&Q+1],Y=Y*r+B[f&(B[Q]=B[tt=f&tt+V])+(B[tt]=V)];return D.i=Q,D.j=tt,Y})(r)}function x(k,$){return $.i=k.i,$.j=k.j,$.S=k.S.slice(),$}function v(k,$){var I=[],D=typeof k,_;if($&&D=="object")for(_ in k)try{I.push(v(k[_],$-1))}catch{}return I.length?I:D=="string"?k:k+"\0"}function w(k,$){for(var I=k+"",D,_=0;_<I.length;)$[f&_]=f&(D^=$[f&_]*19)+I.charCodeAt(_++);return C($)}function T(){try{var k;return m&&(k=m.randomBytes)?k=k(r):(k=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(k)),C(k)}catch{var $=t.navigator,I=$&&$.plugins;return[+new Date,t,I,t.screen,C(e)]}}function C(k){return String.fromCharCode.apply(0,k)}if(w(s.random(),e),n.exports){n.exports=g;try{m=XK}catch{}}else s["seed"+o]=g})(typeof self<"u"?self:YK,[],Math)}(xy)),xy.exports}var mw,$R;function QK(){if($R)return mw;$R=1;var n=LK(),t=zK(),e=BK(),s=UK(),r=GK(),a=HK(),i=ZK();return i.alea=n,i.xor128=t,i.xorwow=e,i.xorshift7=s,i.xor4096=r,i.tychei=a,mw=i,mw}var Pb=QK();/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JK=.001,RF=.1;function tX(n,t,e){return e==null&&(e=qT()),yS(n,t,(s,r)=>KT(s,r,e))}function qT(){return U.backend.floatPrecision()===32?JK:RF}function yS(n,t,e){let s=!0;if((Nn(n)||Nn(t))&&(s=!1),Nn(n)&&Nn(t)&&(s=!0),s){const i=n.constructor.name,o=t.constructor.name;if(i!==o)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${o}`)}if(Array.isArray(n)&&Array.isArray(t)){const i=ba(n),o=ba(t);if(!te(i,o))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${o}]`)}const r=Nn(n)?n:ya(n),a=Nn(t)?t:ya(t);if(r.length!==a.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${a.length}.
Actual:   ${r}.
Expected: ${a}.`);for(let i=0;i<a.length;++i){const o=r[i],l=a[i];if(!e(o,l))throw new Error(`Arrays differ: actual[${i}] = ${o}, expected[${i}] = ${l}.
Actual:   ${r}.
Expected: ${a}.`)}typeof expect<"u"&&expect().nothing()}function eX(n,t){n().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function nX(n,t){const e=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return ia(n)||ia(n[0])||ia(t)||ia(t[0])?yS(n,e,(s,r)=>s==r):yS(n,t,(s,r)=>KT(s,r,0))}function sX(n,t,e){if(e==null&&(e=qT()),!KT(n,t,e))throw new Error(`Numbers differ: actual === ${n}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function KT(n,t,e){return!isFinite(n)&&!isFinite(t)?!0:!(isNaN(n)||isNaN(t)||Math.abs(n-t)>e)}function rX(n,t,e){for(let s=0;s<n.length;s++)if(n[s]<t||n[s]>e)throw new Error(`Value out of range:${n[s]} low: ${t}, high: ${e}`)}function aX(n,t){const e=new Float32Array(n),s=new Float32Array(t);if(e.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${e.length}`);for(let r=0;r<s.length;r++)if(e[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${e[r]} instead`)}function DF(n){for(let t=0;t<n.length;t++){const e=n[t];Array.isArray(e)?DF(e):n[t]=ha(e)}return n}function iX(n){const t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(n),new Promise(e=>{t.addEventListener("loadeddata",s=>e(t)),t.load()})}async function oX(n){await n.play(),"requestVideoFrameCallback"in n&&await new Promise(t=>{n.requestVideoFrameCallback(t)})}const lX=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:RF,createVideoElement:iX,encodeStrings:DF,expectArrayBuffersEqual:aX,expectArraysClose:tX,expectArraysEqual:nX,expectNumbersClose:sX,expectPromiseToFail:eX,expectValuesInRange:rX,play:oX,testEpsilon:qT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XT{constructor(t,e,s,r,a){this.mean=t,this.stdDev=e,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=a||Math.random();this.random=Pb.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let t,e,s=!1;for(;!s;){let r,a,i;do r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a;while(i>=1||i===0);const o=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*r*o,e=this.mean+this.stdDev*a*o,(!this.truncated||this.isValidTruncated(t))&&(s=!0)}return(!this.truncated||this.isValidTruncated(e))&&(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class uX{constructor(t,e,s,r){this.alpha=t,this.beta=1/e,this.dtype=s;const a=r||Math.random();this.randu=Pb.alea(a.toString()),this.randn=new XT(0,1,s,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,s,r,a,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,t=r*r,e=1-.331*t*t,s=.5*t+this.d*(1-i+Math.log(i)),a=this.randu(),a<e||Math.log(a)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class cX{constructor(t=0,e=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=e-t,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=Pb.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hX(n,t,e=1,s="float32",r){if(Bs(n),e==null&&(e=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const a=new uX(t,e,s,r),i=Ht(n,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const OF=G({randomGamma_:hX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dX(n,t=0,e=1,s,r){if(Bs(n),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const a=new XT(t,e,s,!1,r),i=Ht(n,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const Bb=G({randomNormal_:dX});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fX(n,t,e){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return Bb(n,0,1,t,e)}const _F=G({randomStandardNormal_:fX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pX(n,t=0,e=1,s="float32",r){Bs(n);const a=Ht(n,s),i=new cX(t,e,null,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const bo=G({randomUniform_:pX});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mX(n,t,e,s){return bo(n,t,e,"int32",s)}const FF=G({randomUniformInt_:mX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xl(n,t,e=1,s="float32"){if(e===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:t,step:e,dtype:s};return U.runKernel(rb,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gX(n){const e={input:M(n,"input","real")};return U.runKernel(ab,e)}const Qu=G({real_:gX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yX(n){const e={x:M(n,"x","reciprocal")};return U.runKernel(Gc,e)}const YT=G({reciprocal_:yX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bX(n){const e={x:M(n,"x","relu")};return U.runKernel(jc,e)}const Xr=G({relu_:bX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xX(n){const e={x:M(n,"x","relu6")};return U.runKernel(Hc,e)}const Vb=G({relu6_:xX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vX(n,t){const s={x:M(n,"x","reverse")},r={dims:t};return U.runKernel(Ip,s,r)}const nr=G({reverse_:vX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wX(n){const t=M(n,"x","reverse");return F(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),nr(t,0)}const LF=G({reverse1d_:wX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SX(n,t){const e=M(n,"x","reverse");return F(e.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${e.rank}.`),nr(e,t)}const MF=G({reverse2d_:SX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TX(n,t){const e=M(n,"x","reverse");return F(e.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${e.rank}.`),nr(e,t)}const zF=G({reverse3d_:TX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NX(n,t){const e=M(n,"x","reverse");return F(e.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${e.rank}.`),nr(e,t)}const PF=G({reverse4d_:NX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CX(n){const e={x:M(n,"x","round")};return U.runKernel(qc,e)}const Ub=G({round_:CX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kX(n){const e={x:M(n,"x","rsqrt","float32")};return U.runKernel(Kc,e)}const Wb=G({rsqrt_:kX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(n){const e={x:M(n,"x","selu")};return U.runKernel(Xc,e)}const Gb=G({selu_:$X});function EX(n,t,e,s,r,a=[1,1],i="NHWC"){const o=M(n,"x","separableConv2d"),l=M(t,"depthwiseFilter","separableConv2d"),c=M(e,"pointwiseFilter","separableConv2d");let d=o,f=!1;if(o.rank===3&&(f=!0,d=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");F(d.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${d.rank}.`),F(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),F(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),F(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),F(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const m=l.shape[2],g=l.shape[3];F(c.shape[2]===m*g,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${m*g}, but got ${c.shape[2]}.`);const b=uh(d,l,s,r,i,a),v=ri(b,c,1,"valid",i);return f?Z(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const jb=G({separableConv2d_:EX});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function IX(n,t){const e=M(n,"x","setdiff1d"),s=M(t,"y","setdiff1d");F(e.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${e.dtype}) and y (${s.dtype}).`),F(e.rank===1,()=>`x should be 1D tensor, but got x (${e.shape}).`),F(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await e.data(),a=await s.data(),i=new Set(a);let o=0;for(let d=0;d<r.length;d++)i.has(r[d])||o++;const l=new cn([o],e.dtype),c=new cn([o],"int32");for(let d=0,f=0;d<r.length;d++)i.has(r[d])||(l.values[f]=r[d],c.values[f]=d,f++);return[l.toTensor(),c.toTensor()]}const BF=IX;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AX(n){const e={x:M(n,"x","sign")};return U.runKernel(Qc,e)}const ZT=G({sign_:AX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RX(n){const e={x:M(n,"x","sin","float32")};return U.runKernel(Yc,e)}const Hb=G({sin_:RX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DX(n){const e={x:M(n,"x","sinh")};return U.runKernel(Zc,e)}const qb=G({sinh_:DX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OX(n,t,e){const s=M(n,"x","slice1d");return F(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),ae(s,[t],[e])}const em=G({slice1d_:OX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _X(n,t,e){const s=M(n,"x","slice2d");return F(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),ae(s,t,e)}const Kb=G({slice2d_:_X});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FX(n,t,e){const s=M(n,"x","slice3d");return F(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),ae(s,t,e)}const nm=G({slice3d_:FX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LX(n,t,e){const s=M(n,"x","slice4d");return F(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),ae(s,t,e)}const Ju=G({slice4d_:LX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MX(n,t=-1){const e=M(n,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and dim was ${t}`);const s={logits:e},r={dim:t};return U.runKernel(Fp,s,r)}const sm=G({softmax_:MX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zX(n){F(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const t={input:n};return U.runKernel(B0,t)}const rm=G({fft_:zX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PX(n){F(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const t={input:n};return U.runKernel(G0,t)}const tc=G({ifft_:PX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BX(n){const t=n.shape[n.shape.length-1],e=n.size/t;let s;if(t<=2){const r=Z(n,[e,t]);s=tc(r)}else{const r=[e,2*(t-1)],a=Z(Qu(n),[e,t]),i=Z(Hp(n),[e,t]),o=nr(ae(a,[0,1],[e,t-2]),1),l=K(nr(ae(i,[0,1],[e,t-2]),1),Lt(-1)),c=Qe([a,o],1),d=Qe([i,l],1),f=Z(si(c,d),[r[0],r[1]]);s=tc(f)}if(s=Qu(s),n.rank===3&&n.shape[0]!==0){const r=s,a=n.shape[0];s=Z(s,[a,s.shape[0]/a,s.shape[1]]),r.dispose()}return s}const Xb=G({irfft_:BX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VX(n,t,e=0){const r={x:M(n,"x","split")},a={numOrSizeSplits:t,axis:e};return U.runKernel(_p,r,a)}const gs=G({split_:VX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UX(n,t){F(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let e=n.shape[n.shape.length-1];const s=n.size/e;let r;if(t!=null&&t<e){const b=n.shape.map(v=>0),x=n.shape.map(v=>v);x[n.shape.length-1]=t,r=ae(n,b,x),e=t}else if(t!=null&&t>e){const b=n.shape.map(x=>x);b[n.shape.length-1]=t-e,r=Qe([n,un(b)],n.shape.length-1),e=t}else r=n;const a=ie(r),i=Z(si(r,a),[s,e]),o=rm(i),l=Math.floor(e/2)+1,c=Qu(o),d=Hp(o),f=gs(c,[l,e-l],c.shape.length-1),m=gs(d,[l,e-l],d.shape.length-1),g=r.shape.slice();return g[r.shape.length-1]=l,Z(si(f[0],m[0]),g)}const am=G({rfft_:UX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WX(n,t){let e=M(n,"a","squaredDifference"),s=M(t,"b","squaredDifference");[e,s]=Ue(e,s),jt(e.shape,s.shape);const r={a:e,b:s},a={};return U.runKernel(nh,r,a)}const Yb=G({squaredDifference_:WX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GX(n,t){const e=M(n,"x","squeeze","string_or_numeric");return Z(e,ui(e.shape,t).newShape)}const xo=G({squeeze_:GX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jX(n,t=0){const e=gf(n,"tensors","stack","string_or_numeric");F(e.length>=1,()=>"Pass at least one tensor to tf.stack"),e.length>0&&F(t<=e[0].rank,()=>"Axis must be <= rank of the tensor");const s=e,r={axis:t};return U.runKernel(Sp,s,r)}const ws=G({stack_:jX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HX(n,t=0){const s={x:M(n,"x","step")},r={alpha:t};return U.runKernel(oh,s,r)}const Ol=G({step_:HX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qX(n,t,e,s,r=0,a=0,i=0,o=0,l=0){const d={x:M(n,"x","stridedSlice","string_or_numeric")},f={begin:t,end:e,strides:s,beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};return U.runKernel(yb,d,f)}const QT=G({stridedSlice_:qX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KX(n){const e={x:M(n,"x","tan","float32")};return U.runKernel(rh,e)}const JT=G({tan_:KX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xn(n,t){$l(n);const e=ba(n,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return po(n,null,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uu(n,t,e){if($l(n),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=ba(n,e);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return po(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tN(n,t,e){if($l(n),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=ba(n,e);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return po(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VF(n,t,e){if($l(n),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=ba(n,e);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return po(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UF(n,t,e){if($l(n),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=ba(n,e);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return po(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WF(n,t,e){if($l(n),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=ba(n,e);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||s,po(n,t,s,e)}function eN(n,t,e){const s=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${e.shape}, indices.shape: ${t.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(e.rank<r)throw new Error(a+` update.rank < ${r}. `);if(n.length<s+(e.rank-r))throw new Error(a+` Output shape length < ${s+(e.rank-r)}`);if(e.rank!==r+n.length-s)throw new Error(a+` update.rank != ${r+n.length-s}`);for(let i=0;i<r;++i)if(e.shape[i]!==t.shape[i])throw new Error(a+` updates.shape[${i}] (${e.shape[i]}) != indices.shape[${i}] (${t.shape[i]}).`);for(let i=0;i<e.rank-r;++i)if(e.shape[i+r]!==n[i+s])throw new Error(a+` updates.shape[${i+r}] (${e.shape[i+r]}) != shape[${i+r}] (${n[i+r]})`)}function Zb(n,t,e){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(e.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${e}`);if(e.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}eN(e,t,n)}function vo(n,t,e){const s=t.shape.length,r=s>1?t.shape[s-1]:1,a=e.length;let i=1;for(let f=r;f<a;++f)i*=e[f];const o=r<1?1:r,l=ft(t.shape)/o,c=[...Ft(e.slice(0,r)),1],d=ft(e);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:c,outputSize:d}}const XX=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:vo,validateInput:Zb,validateUpdateShape:eN},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YX(n,t,e){const s=M(n,"tensor","tensorScatterupdate"),r=M(t,"indices","tensorScatterupdate","int32"),a=M(e,"updates","tensorScatterupdate");if(Zb(a,r,s.shape),s.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${a.dtype}.`);const i={tensor:s,indices:r,updates:a},o={};return U.runKernel(ub,i,o)}const GF=G({tensorScatterUpdate_:YX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZX(n,t=1,e=!0){const s=M(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${t}`);const a={x:s},i={k:t,sorted:e},[o,l]=U.runKernel(wb,a,i);return{values:o,indices:l}}const nN=G({topk_:ZX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QX(n,t=0,e=1,s,r){if(Bs(n),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new XT(t,e,s,!0,r),i=Ht(n,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const Qb=G({truncatedNormal_:QX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JX(n,t=0){const e=M(n,"x","unique","string_or_numeric");F(e.rank>0,()=>"The input tensor must be at least 1D");const s={x:e},r={axis:t},[a,i]=U.runKernel(Tb,s,r);return{values:a,indices:i}}const sN=G({unique_:JX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tY(n,t,e){const s=M(n,"x","unsortedSegmentSum"),r=M(t,"segmentIds","unsortedSegmentSum","int32");F(hl(e),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:r},i={numSegments:e};return U.runKernel(zp,a,i)}const Jb=G({unsortedSegmentSum_:tY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eY(n,t=0){const e=M(n,"x","unstack","string_or_numeric");F(t>=-e.shape.length&&t<e.shape.length,()=>`Axis = ${t} is not in [-${e.shape.length}, ${e.shape.length})`);const s={value:e},r={axis:t};return U.runKernel(Mp,s,r)}const sr=G({unstack_:eY});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jF(n,t){return zb(n,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rN(n,t=!0,e,s){return U.makeVariable(n,t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tx(n,t){const e=[];for(let a=0;a<t.length;a++)t[a]&&e.push(a);const s=Ht(n,"int32"),r=Ht([e.length,n.length],"int32");for(let a=0;a<e.length;a++){const i=s.indexToLoc(e[a]),o=a*n.length;r.values.set(i,o)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nY(n){const t=M(n,"condition","whereAsync","bool"),e=await t.data(),s=tx(t.shape,e);return n!==t&&t.dispose(),s}const aN=nY;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function sY(n,t,e){const s=M(n,"tensor","boolMask"),r=M(t,"mask","boolMask","bool"),a=e??0,i=r.rank,o=s.shape;F(i>0,()=>"mask cannot be scalar"),zn(o.slice(a,a+i),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let x=a;x<a+i;x++)l*=o[x];const c=o.slice(0,a).concat([l],o.slice(a+i)),d=Z(s,c),f=Z(r,[-1]),m=await aN(f),g=xo(m,[1]),b=fh(d,g,a);return n!==s&&s.dispose(),t!==r&&r.dispose(),g.dispose(),d.dispose(),f.dispose(),m.dispose(),b}const HF=sY;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rY(n,t,e){const s=M(n,"x","transpose");if(t==null&&(t=s.shape.map((i,o)=>o).reverse()),F(s.rank===t.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${t}.`),t.forEach(i=>{F(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${t}`)}),s.rank<=1)return s.clone();const r={x:s},a={perm:t};return s.dtype==="complex64"?it(()=>{let i=Qu(s),o=Hp(s);return i=U.runKernel(ol,{x:i},a),o=U.runKernel(ol,{x:o},a),e&&(o=De(o)),si(i,o)}):U.runKernel(ol,r,a)}const ne=G({transpose_:rY});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aY(n,t,e,s,r=!0){const a=M(n,"v","movingAverage"),i=M(t,"x","movingAverage"),o=M(e,"decay","movingAverage");U3(a,i),F(te(a.shape,i.shape),()=>"Shape mismatch in v and x");const l=Lt(1),c=Et(l,o);let d=K(Et(i,a),c);if(r){F(s!=null,()=>"When using zeroDebias: true, step is required.");const f=M(s,"step","movingAverage");d=Ot(d,Et(l,xa(o,f)))}return wt(a,d)}const qF=G({movingAverage_:aY});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iY(n,t,e){Bs(e);const s=M(n,"indices","scatterND","int32"),r=M(t,"updates","scatterND");Zb(r,s,e);const a={indices:s,updates:r},i={shape:e};return U.runKernel(lb,a,i)}const KF=G({scatterND_:iY});function oY(n,t,e,s){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const r=n.rank>0?n.shape[0]:1,a=n.rank>1?n.shape[1]:1;if(e.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${e.length}, should be: ${a}.`);const i=t.size;if(!(t.rank===0||t.rank===1&&i===r))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${r}]`);if(t.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lY(n,t,e,s=0){Bs(e);const r=M(n,"sparseIndices","sparseToDense","int32"),a=M(t,"sparseValues","sparseToDense","string_or_numeric"),i=M(s,"defaultValue","sparseToDense",a.dtype);oY(r,a,e,i);const o={sparseIndices:r,sparseValues:a,defaultValue:i},l={outputShape:e};return U.runKernel(mb,o,l)}const XF=G({sparseToDense_:lY});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uY(n,t){const e=M(t,"indices","gatherND","int32"),r={params:M(n,"x","gatherND","string_or_numeric"),indices:e};return U.runKernel(W0,r)}const YF=G({gatherND_:uY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cY(n,t){if(t==null)return n.shape.slice();if(te(n.shape,t))return t;if(n.shape.length===t.length){const e=[];for(let s=0;s<n.shape.length;s++)t[s]==null&&n.shape[s]!=null?e.push(n.shape[s]):e.push(t[s]);return e}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hY(n,t,e,s){const r=M(n,"x","dropout");if(F(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),F(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return n instanceof ge?r.clone():r;const a=cY(r,e),i=1-t,o=Ot(dh(wt(bo(a,0,1,"float32",s),i)),i);return K(r,o)}const iN=G({dropout_:hY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oN(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function ex(n,t,e){const s=1-n%2,r=new Float32Array(n);for(let a=0;a<n;++a){const i=2*Math.PI*a/(n+s-1);r[a]=t-e*Math.cos(i)}return Xn(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function dY(n,t,e=1){const s=M(n,"predictions","inTopK"),r=M(t,"targets","inTopK");F(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),F(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),zn(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=s.shape[s.shape.length-1];F(e>0&&e<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${e}`);const i=await s.data(),o=await r.data(),[l,c]=[i.length/a,a],d=kn("bool",l);for(let f=0;f<l;f++){const m=f*c,g=i.subarray(m,m+c),b=[];for(let x=0;x<g.length;x++)b.push({value:g[x],index:x});b.sort((x,v)=>v.value-x.value),d[f]=0;for(let x=0;x<e;x++)if(b[x].index===o[f]){d[f]=1;break}}return n!==s&&s.dispose(),t!==r&&r.dispose(),Nr(d,r.shape,"bool")}const ZF=dY;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fY(n,t,e,s,r,a="NHWC",i){let o=n;n.rank===3&&(o=Z(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=t;l.rank===3&&(l=Z(t,[1,t.shape[0],t.shape[1],t.shape[2]])),F(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),F(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),F(e.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`);const c=a==="NHWC"?o.shape[3]:o.shape[1],d=a==="NHWC"?l.shape[3]:l.shape[1];F(c===e[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${e[2]}.`),F(d===e[3],()=>`Error in conv2dDerFilter: depth of dy (${d}) must match output depth for filter (${e[3]}).`),us("conv2dDerFilter",r,i);const f={x:o,dy:l},m={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,filterShape:e};return U.runKernel($0,f,m)}const lN=G({conv2DBackpropFilter_:fY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nx(n,t,e){if(e==null||e==="linear")return n;if(e==="relu")return K(n,Ol(t));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function sx(n,t){let e=t;const s=hn(n.shape,t.shape);return s.length>0&&(e=It(e,s)),Z(e,n.shape)}function rx(n,t,e,s){if(t==="linear")return n;if(t==="relu")return Xr(n);if(t==="elu")return ch(n);if(t==="relu6")return Vb(n);if(t==="prelu")return tm(n,e);if(t==="leakyrelu")return qp(n,s);if(t==="sigmoid")return Vr(n);throw new Error(`Unknown fused activation ${t}.`)}const ax=(n,t)=>!(n>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pY({x:n,filter:t,strides:e,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:d}){if(l=l||"linear",ax(U.state.gradientDepth,l)===!1){F(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let I=ri(n,t,e,s,r,a,i);return o!=null&&(I=wt(I,o)),rx(I,l,c,d)}const f=M(n,"x","conv2d","float32"),m=M(t,"filter","conv2d","float32");let g=f,b=!1;f.rank===3&&(b=!0,g=Z(f,[1,f.shape[0],f.shape[1],f.shape[2]])),F(g.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${g.rank}.`),F(m.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${m.rank}.`),us("fused conv2d",s,i);const x=r==="NHWC"?g.shape[3]:g.shape[1];F(m.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${m.shape[2]}.`),F(Pn(e,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${a}'`);const v=En(g.shape,m.shape,e,a,s,i);let w;o!=null&&(w=M(o,"bias","fused conv2d"),[w]=Ue(w,f),r==="NHWC"?jt(v.outShape,w.shape):(F(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),F(w.shape.length===0||w.shape[0]===v.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let T;if(c!=null){const I=c.shape;if(F(I.length<=1||I.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${I.length}.`),I.length===1)F(I[0]===1||I[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the number of output channels (${v.outChannels}).`);else if(I.length===3)try{jt(I,v.outShape)}catch{const _=`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(_)}T=M(c,"prelu weights","fused conv2d")}const C=(I,D)=>{F(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[_,O,L,R]=D,V=nx(I,L,l);F(so(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const Y=kT(O.shape,V,_,e,s),Q=lN(O,V,_.shape,e,s),tt=[Y,Q];if(R!=null){const B=sx(R,V);tt.push(B)}return tt},k={x:g,filter:m,bias:w,preluActivationWeights:T},$={strides:e,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:l,leakyreluAlpha:d};return o==null?va((D,_,O)=>{let L=U.runKernel(hf,k,$);return O([_,D,L]),b&&(L=Z(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:C}})(g,m):va((D,_,O,L)=>{let R=U.runKernel(hf,k,$);return L([_,D,R,O]),b&&(R=Z(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:C}})(g,m,w)}const QF=G({fusedConv2d_:pY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mY(n,t,e,s,r,a=[1,1],i){let o=n;n.rank===3&&(o=Z(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=t;l.rank===3&&(l=Z(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:o,dy:l},d={strides:s,pad:r,dimRoundingMode:i,dilations:a,filterShape:e};return U.runKernel(_0,c,d)}const JF=G({depthwiseConv2dNativeBackpropFilter_:mY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gY(n,t,e,s,r,a=[1,1],i){let o=t,l=!1;t.rank===3&&(l=!0,o=Z(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:o,filter:e},d={strides:s,pad:r,dimRoundingMode:i,dilations:a,inputShape:n},f=U.runKernel(F0,c,d);return l?Z(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const tL=G({depthwiseConv2dNativeBackpropInput_:gY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yY({x:n,filter:t,strides:e,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:d}){if(ax(U.state.gradientDepth,l)===!1){let $=uh(n,t,e,s,r,a,i);return o!=null&&($=wt($,o)),rx($,l,c,d)}const f=M(n,"x","depthwiseConv2d","float32"),m=M(t,"filter","depthwiseConv2d","float32");let g=f,b=!1;f.rank===3&&(b=!0,g=Z(f,[1,f.shape[0],f.shape[1],f.shape[2]])),F(g.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${g.rank}.`),F(m.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${m.rank}.`),F(g.shape[3]===m.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${g.shape[3]}) must match the inChannels dimension in filter ${m.shape[2]}.`),a==null&&(a=[1,1]),F(Pn(e,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${e} and dilations '${a}'`),us("fused depthwiseConv2d",s,i);const x=En(g.shape,m.shape,e,a,s,i,!0);let v;o!=null&&(v=M(o,"bias","fused conv2d"),[v]=Ue(v,f),jt(x.outShape,v.shape));let w;c!=null&&(w=M(c,"prelu weights","fused depthwiseConv2d"));const T=($,I)=>{F(so(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[D,_,O,L]=I,R=nx($,O,l),V=tL(_.shape,R,D,e,s,a,i),Y=JF(_,R,D.shape,e,s,a,i);if(L!=null){const Q=sx(v,R);return[V,Y,Q]}return[V,Y]},C={x:g,filter:m,bias:v,preluActivationWeights:w},k={strides:e,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:l,leakyreluAlpha:d};return o==null?va((I,D,_)=>{let O=U.runKernel(df,C,k);return _([D,I,O]),b&&(O=Z(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:T}})(g,m):va((I,D,_,O)=>{let L=U.runKernel(df,C,k);return O([D,I,L,_]),b&&(L=Z(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:T}})(g,m,v)}const bY=G({fusedDepthwiseConv2d_:yY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xY({a:n,b:t,transposeA:e=!1,transposeB:s=!1,bias:r,activation:a="linear",preluActivationWeights:i,leakyreluAlpha:o=.2}){if(ax(U.state.gradientDepth,a)===!1){let R=Xt(n,t,e,s);return r!=null&&(R=wt(R,r)),rx(R,a,i,o)}let l=M(n,"a","fused matMul"),c=M(t,"b","fused matMul");[l,c]=Ue(l,c);const d=e?l.shape[l.rank-2]:l.shape[l.rank-1],f=s?c.shape[c.rank-1]:c.shape[c.rank-2],m=e?l.shape[l.rank-1]:l.shape[l.rank-2],g=s?c.shape[c.rank-2]:c.shape[c.rank-1],b=l.shape.slice(0,-2),x=c.shape.slice(0,-2),v=ft(b),w=ft(x);F(d===f,()=>`Error in fused matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${e} and transposeB=${s} must match.`);const C=jt(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([m,g]),k=e?Z(l,[v,d,m]):Z(l,[v,m,d]),$=s?Z(c,[w,g,f]):Z(c,[w,f,g]);let I;r!=null&&(I=M(r,"bias","fused matMul"),[I]=Ue(I,l),jt(C,I.shape));let D;i!=null&&(D=M(i,"prelu weights","fused matMul"));const _=(R,V)=>{const[Y,Q,tt,B]=V,W=nx(Z(R,tt.shape),tt,a);let X,ot;if(!e&&!s?(X=Xt(W,Q,!1,!0),ot=Xt(Y,W,!0,!1)):!e&&s?(X=Xt(W,Q,!1,!1),ot=Xt(W,Y,!0,!1)):e&&!s?(X=Xt(Q,W,!1,!0),ot=Xt(Y,W,!1,!1)):(X=Xt(Q,W,!0,!0),ot=Xt(W,Y,!0,!0)),r!=null){const P=sx(B,W);return[X,ot,P]}else return[X,ot]},O={a:k,b:$,bias:I,preluActivationWeights:D},L={transposeA:e,transposeB:s,activation:a,leakyreluAlpha:o};return r==null?va((V,Y,Q)=>{const tt=U.runKernel(cf,O,L);return Q([V,Y,tt]),{value:Z(tt,C),gradFunc:_}})(k,$):va((V,Y,Q,tt)=>{const B=U.runKernel(cf,O,L);return tt([V,Y,B,Q]),{value:Z(B,C),gradFunc:_}})(k,$,I)}const bS=G({fusedMatMul_:xY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eL=Object.freeze(Object.defineProperty({__proto__:null,conv2d:QF,depthwiseConv2d:bY,matMul:bS},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vY(n){return ex(n,.54,.46)}const wY=G({hammingWindow_:vY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SY(n){return ex(n,.5,.5)}const nL=G({hannWindow_:SY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TY(n,t,e,s=!1,r=0){let a=0;const i=[];for(;a+t<=n.size;)i.push(ae(n,a,t)),a+=e;if(s)for(;a<n.size;){const o=a+t-n.size,l=Qe([ae(n,a,t-o),Rl([o],r)]);i.push(l),a+=e}return i.length===0?Uu([],[0,t]):Z(Qe(i),[i.length,t])}const sL=G({frame_:TY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NY(n,t,e,s,r=nL){s==null&&(s=oN(t));const a=sL(n,t,e),i=K(a,r(t));return am(i,s)}const CY=G({stft_:NY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kY(n,t,e,s,r="bilinear",a=0){const i=M(n,"image","cropAndResize"),o=M(t,"boxes","cropAndResize","float32"),l=M(e,"boxInd","cropAndResize","int32"),c=o.shape[0];F(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),F(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),F(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),F(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),F(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),F(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const d={image:i,boxes:o,boxInd:l},f={method:r,extrapolationValue:a,cropSize:s};return U.runKernel(R0,d,f)}const $Y=G({cropAndResize_:kY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EY(n){const t=M(n,"image","flipLeftRight","float32");F(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const e={image:t};return U.runKernel(U0,e,{})}const IY=G({flipLeftRight_:EY});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AY(n){const t=M(n,"image","grayscaleToRGB"),e=t.rank-1,s=t.shape[e];F(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),F(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(t.rank);return r.fill(1,0,e),r[e]=3,Qs(t,r)}const RY=G({grayscaleToRGB_:AY});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DY(n){const t=M(n,"image","RGBToGrayscale"),e=t.rank-1,s=t.shape[e];F(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),F(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=t.dtype,a=Tt(t,"float32"),i=Xn([.2989,.587,.114]);let o;switch(t.rank){case 2:o=Zo("ij,j->i",a,i);break;case 3:o=Zo("ijk,k->ij",a,i);break;case 4:o=Zo("ijkl,l->ijk",a,i);break;case 5:o=Zo("ijklm,m->ijkl",a,i);break;case 6:o=Zo("ijklmn,n->ijklm",a,i);break;default:throw new Error("Not a valid tensor rank.")}return o=Kn(o,-1),Tt(o,r)}const OY=G({rgbToGrayscale_:DY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Y(n,t,e=0,s=.5){const r=M(n,"image","rotateWithOffset","float32");F(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const a={image:r},i={radians:t,fillValue:e,center:s};return U.runKernel(Nb,a,i)}const FY=G({rotateWithOffset_:_Y});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ph(n,t,e,s,r,a){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),a==null&&(a=0);const i=n.shape[0];return e=Math.min(e,i),F(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),F(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),F(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),F(t.rank===1,()=>"scores must be a 1D tensor"),F(t.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${t.shape[0]}`),F(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:e,iouThreshold:s,scoreThreshold:r,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LY(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY){const a=M(n,"boxes","nonMaxSuppression","float32"),i=M(t,"scores","nonMaxSuppression","float32"),o=ph(a,i,e,s,r);e=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l={maxOutputSize:e,iouThreshold:s,scoreThreshold:r};return U.runKernel(Q0,{boxes:a,scores:i},l)}const MY=G({nonMaxSuppression_:LY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zY(n,t,e){const s=PY(n,t,e),r=s<0?-(s+1):s;n.splice(r,0,t)}function PY(n,t,e){return VY(n,t,e||BY)}function BY(n,t){return n>t?1:n<t?-1:0}function VY(n,t,e){let s=0,r=n.length,a=0,i=!1;for(;s<r;){a=s+(r-s>>>1);const o=e(t,n[a]);o>0?s=a+1:(r=a,i=!o)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ix(n,t,e,s,r){return uN(n,t,e,s,r,0)}function ox(n,t,e,s,r,a){return uN(n,t,e,s,r,0,!1,a,!0)}function lx(n,t,e,s,r,a){return uN(n,t,e,s,r,a,!0)}function uN(n,t,e,s,r,a,i=!1,o=!1,l=!1){const c=[];for(let v=0;v<t.length;v++)t[v]>r&&c.push({score:t[v],boxIndex:v,suppressBeginIndex:0});c.sort(ER);const d=a>0?-.5/a:0,f=[],m=[];for(;f.length<e&&c.length>0;){const v=c.pop(),{score:w,boxIndex:T,suppressBeginIndex:C}=v;if(w<r)break;let k=!1;for(let $=f.length-1;$>=C;--$){const I=UY(n,T,f[$]);if(I>=s){k=!0;break}if(v.score=v.score*WY(s,d,I),v.score<=r)break}v.suppressBeginIndex=f.length,k||(v.score===w?(f.push(T),m.push(v.score)):v.score>r&&zY(c,v,ER))}const g=f.length,b=e-g;o&&b>0&&(f.push(...new Array(b).fill(0)),m.push(...new Array(b).fill(0)));const x={selectedIndices:f};return i&&(x.selectedScores=m),l&&(x.validOutputs=g),x}function UY(n,t,e){const s=n.subarray(t*4,t*4+4),r=n.subarray(e*4,e*4+4),a=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),o=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),d=Math.min(r[1],r[3]),f=Math.max(r[0],r[2]),m=Math.max(r[1],r[3]),g=(o-a)*(l-i),b=(f-c)*(m-d);if(g<=0||b<=0)return 0;const x=Math.max(a,c),v=Math.max(i,d),w=Math.min(o,f),T=Math.min(l,m),C=Math.max(w-x,0)*Math.max(T-v,0);return C/(g+b-C)}function WY(n,t,e){const s=Math.exp(t*e*e);return e<=n?s:0}function ER(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function GY(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY){const a=M(n,"boxes","nonMaxSuppressionAsync"),i=M(t,"scores","nonMaxSuppressionAsync"),o=ph(a,i,e,s,r);e=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l=await Promise.all([a.data(),i.data()]),c=l[0],d=l[1],{selectedIndices:f}=ix(c,d,e,s,r);return a!==n&&a.dispose(),i!==t&&i.dispose(),Xn(f,"int32")}const jY=GY;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HY(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=M(n,"boxes","nonMaxSuppression"),o=M(t,"scores","nonMaxSuppression"),l=ph(i,o,e,s,r,a);e=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,a=l.softNmsSigma;const c={boxes:i,scores:o},d={maxOutputSize:e,iouThreshold:s,scoreThreshold:r,softNmsSigma:a},f=U.runKernel(tb,c,d);return{selectedIndices:f[0],selectedScores:f[1]}}const qY=G({nonMaxSuppressionWithScore_:HY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function KY(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=M(n,"boxes","nonMaxSuppressionAsync"),o=M(t,"scores","nonMaxSuppressionAsync"),l=ph(i,o,e,s,r,a);e=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,a=l.softNmsSigma;const c=await Promise.all([i.data(),o.data()]),d=c[0],f=c[1],{selectedIndices:m,selectedScores:g}=lx(d,f,e,s,r,a);return i!==n&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:Xn(m,"int32"),selectedScores:Xn(g)}}const XY=KY;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YY(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=M(n,"boxes","nonMaxSuppression"),o=M(t,"scores","nonMaxSuppression"),l=ph(i,o,e,s,r,null),c=l.maxOutputSize,d=l.iouThreshold,f=l.scoreThreshold,m={boxes:i,scores:o},g={maxOutputSize:c,iouThreshold:d,scoreThreshold:f,padToMaxOutputSize:a},b=U.runKernel(J0,m,g);return{selectedIndices:b[0],validOutputs:b[1]}}const ZY=G({nonMaxSuppressionPadded_:YY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function QY(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=M(n,"boxes","nonMaxSuppressionAsync"),o=M(t,"scores","nonMaxSuppressionAsync"),l=ph(i,o,e,s,r,null),c=l.maxOutputSize,d=l.iouThreshold,f=l.scoreThreshold,[m,g]=await Promise.all([i.data(),o.data()]),{selectedIndices:b,validOutputs:x}=ox(m,g,c,d,f,a);return i!==n&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:Xn(b,"int32"),validOutputs:Lt(x,"int32")}}const JY=QY;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tZ(n,t,e=!1,s=!1){const r=M(n,"images","resizeBilinear");F(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),F(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),F(s===!1||e===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=Z(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:a},l={alignCorners:e,halfPixelCenters:s,size:t},c=U.runKernel(Ep,o,l);return i?Z(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const rL=G({resizeBilinear_:tZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eZ(n,t,e=!1,s=!1){const r=M(n,"images","resizeNearestNeighbor");F(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),F(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),F(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),F(s===!1||e===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=Z(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:a},l={alignCorners:e,halfPixelCenters:s,size:t},c=U.runKernel($p,o,l);return i?Z(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const aL=G({resizeNearestNeighbor_:eZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nZ(n,t="binary",e=!1,s=.5){const r=M(n,"image","threshold"),a=.2989,i=.587,o=.114,l=r.shape[0]*r.shape[1];let c=K(Xn([s]),255),d,f,m,g;if(F(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),F(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),F(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),F(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),r.shape[2]===3){[d,f,m]=gs(r,[1,1,1],-1);const v=K(d,a),w=K(f,i),T=K(m,o);g=wt(wt(v,w),T)}else g=n;if(t==="otsu"){const v=vT(Tt(Ub(g),"int32"),Nr([]),256);c=sZ(v,l)}const b=e?yo(g,c):Ts(g,c);return Tt(K(b,255),"int32")}function sZ(n,t){let e=Xn([-1]),s=Xn([0]),r=Xn([0]),a,i,o,l,c,d;for(let f=0;f<n.size-1;f++){a=ae(n,0,f+1),i=ae(n,f+1),c=Ot(It(a),t),d=Ot(It(i),t);const m=It(K(a,xl(0,a.size)));o=Ot(m,It(a));const g=Rl(i.shape,a.size),b=wt(xl(0,i.size),g),x=K(i,b);l=Ot(It(x),It(i));const v=Et(o,l),w=Et(o,l),T=K(c,d);r=K(K(T,v),w);const C=Ts(r,s);s=Ln(C,r,s),e=Ln(C,Xn([f]),e)}return e}const rZ=G({threshold_:nZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aZ(n,t,e="nearest",s="constant",r=0,a){const i=M(n,"image","transform","float32"),o=M(t,"transforms","transform","float32");F(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),F(o.rank===2&&(o.shape[0]===i.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),F(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const l={image:i,transforms:o},c={interpolation:e,fillMode:s,fillValue:r,outputShape:a};return U.runKernel(Sb,l,c)}const iZ=G({transform_:aZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oZ(n,t,e){const s=M(n,"a","bandPart");F(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[a,i]=s.shape.slice(-2);let o,l;typeof t=="number"?(F(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),F(t<=a,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${a}).`),o=M(t<0?a:t,"numLower","bandPart")):(F(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Ln(Yu(t,0),a,ao(t,a))),typeof e=="number"?(F(e%1===0,()=>`bandPart(): numUpper must be an integer, got ${e}.`),F(e<=i,()=>`bandPart(): numUpper (${e}) must not be greater than the number of columns (${i}).`),l=M(e<0?i:e,"numUpper","bandPart")):(F(e.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Ln(Yu(e,0),i,ao(e,i)));const c=Z(xl(0,a,1,"int32"),[-1,1]),d=xl(0,i,1,"int32"),f=Et(c,d),m=Gr(yo(f,o),fi(f,De(l))),g=un([a,i],s.dtype);return Z(ws(sr(Z(s,[-1,a,i])).map(b=>Ln(m,b,g))),r)}const lZ=G({bandPart_:oZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uZ(n){let t;if(Array.isArray(n)){t=!1,F(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let a=1;a<n.length;++a)F(n[a].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[a].shape[0]} vs. ${r})`)}else t=!0,n=gs(n,n.shape[0],0).map(r=>xo(r,[0]));F(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const e=[],s=n;for(let r=0;r<n.length;++r)e.push(U.tidy(()=>{let a=s[r];if(r>0)for(let i=0;i<r;++i){const o=K(It(K(e[i],a)),e[i]);a=Et(a,o)}return Ot(a,hh(a,"euclidean"))}));return t?ws(e,0):e}const cZ=G({gramSchmidt_:uZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hZ(n,t=!1){if(F(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return IR(n,t);{const e=n.shape.slice(0,n.shape.length-2).reduce((l,c)=>l*c),s=sr(Z(n,[e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],a=[];s.forEach(l=>{const[c,d]=IR(l,t);r.push(c),a.push(d)});const i=Z(ws(r,0),n.shape),o=Z(ws(a,0),n.shape);return[i,o]}}function IR(n,t=!1){return U.tidy(()=>{F(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const e=n.shape[0],s=n.shape[1];let r=_b(e),a=da(n);const i=Uu([[1]],[1,1]);let o=da(i);const l=e>=s?s:e;for(let c=0;c<l;++c){const d=a,f=o,m=r;[o,a,r]=U.tidy(()=>{const g=ae(a,[c,c],[e-c,1]),b=hh(g),x=ae(a,[c,c],[1,1]),v=Ln(Ts(x,0),Uu([[-1]]),Uu([[1]])),w=Et(x,K(v,b)),T=Ot(g,w);T.shape[0]===1?o=da(i):o=Qe([i,ae(T,[1,0],[T.shape[0]-1,T.shape[1]])],0);const C=De(Ot(Xt(v,w),b)),k=ae(a,[c,0],[e-c,s]),$=K(C,o),I=ne(o);if(c===0)a=Et(k,Xt($,Xt(I,k)));else{const O=Et(k,Xt($,Xt(I,k)));a=Qe([ae(a,[0,0],[c,s]),O],0)}const D=ne($),_=ae(r,[0,c],[e,r.shape[1]-c]);if(c===0)r=Et(_,Xt(Xt(_,o),D));else{const O=Et(_,Xt(Xt(_,o),D));r=Qe([ae(r,[0,0],[e,c]),O],1)}return[o,a,r]}),Yt([d,f,m])}return!t&&e>s&&(r=ae(r,[0,0],[e,s]),a=ae(a,[0,0],[s,s])),[r,a]})}const dZ=G({qr_:hZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var as;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(as||(as={}));function fZ(n,t,e=as.SUM_BY_NONZERO_WEIGHTS){const s=M(n,"losses","computeWeightedLoss");let r=null;t!=null&&(r=M(t,"weights","computeWeightedLoss"));const a=r==null?s:K(s,r);if(e===as.NONE)return a;if(e===as.SUM)return It(a);if(e===as.MEAN){if(r==null)return Be(a);{const i=s.size/r.size,o=Ot(It(a),It(r));return i>1?Ot(o,Lt(i)):o}}if(e===as.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Ot(It(a),Lt(s.size));{const i=K(r,ms(s.shape)),o=Tt(It(bl(i,Lt(0))),"float32");return Ot(It(a),o)}}throw Error(`Unknown reduction: ${e}`)}const mi=G({computeWeightedLoss_:fZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pZ(n,t,e,s=as.SUM_BY_NONZERO_WEIGHTS){const r=M(n,"labels","absoluteDifference"),a=M(t,"predictions","absoluteDifference");let i=null;e!=null&&(i=M(e,"weights","absoluteDifference")),zn(r.shape,a.shape,"Error in absoluteDifference: ");const o=ln(Et(r,a));return mi(o,i,s)}const mZ=G({absoluteDifference_:pZ});function gZ(n,t,e,s,r=as.SUM_BY_NONZERO_WEIGHTS){const a=M(n,"labels","cosineDistance"),i=M(t,"predictions","cosineDistance");let o=null;s!=null&&(o=M(s,"weights","cosineDistance")),zn(a.shape,i.shape,"Error in cosineDistance: ");const l=Lt(1),c=Et(l,It(K(a,i),e,!0));return mi(c,o,r)}const yZ=G({cosineDistance_:gZ});function bZ(n,t,e,s=as.SUM_BY_NONZERO_WEIGHTS){let r=M(n,"labels","hingeLoss");const a=M(t,"predictions","hingeLoss");let i=null;e!=null&&(i=M(e,"weights","hingeLoss")),zn(r.shape,a.shape,"Error in hingeLoss: ");const o=Lt(1);r=Et(K(Lt(2),r),o);const l=Xr(Et(o,K(r,a)));return mi(l,i,s)}const xZ=G({hingeLoss_:bZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vZ(n,t,e,s=1,r=as.SUM_BY_NONZERO_WEIGHTS){const a=M(n,"labels","huberLoss"),i=M(t,"predictions","huberLoss");let o=null;e!=null&&(o=M(e,"weights","huberLoss")),zn(a.shape,i.shape,"Error in huberLoss: ");const l=Lt(s),c=ln(Et(i,a)),d=ao(c,l),f=Et(c,d),m=wt(K(Lt(.5),Se(d)),K(l,f));return mi(m,o,r)}const wZ=G({huberLoss_:vZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SZ(n,t,e,s=1e-7,r=as.SUM_BY_NONZERO_WEIGHTS){const a=M(n,"labels","logLoss"),i=M(t,"predictions","logLoss");let o=null;e!=null&&(o=M(e,"weights","logLoss")),zn(a.shape,i.shape,"Error in logLoss: ");const l=Lt(1),c=Lt(s),d=De(K(a,Fs(wt(i,c)))),f=K(Et(l,a),Fs(wt(Et(l,i),c))),m=Et(d,f);return mi(m,o,r)}const TZ=G({logLoss_:SZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NZ(n,t,e,s=as.SUM_BY_NONZERO_WEIGHTS){const r=M(n,"labels","meanSquaredError"),a=M(t,"predictions","meanSquaredError");let i=null;e!=null&&(i=M(e,"weights","meanSquaredError")),zn(r.shape,a.shape,"Error in meanSquaredError: ");const o=Yb(r,a);return mi(o,i,s)}const CZ=G({meanSquaredError_:NZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kZ(n,t){const e=M(n,"labels","sigmoidCrossEntropyWithLogits"),s=M(t,"logits","sigmoidCrossEntropyWithLogits");zn(e.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Xr(s),a=K(s,e),i=Kp(vs(De(ln(s))));return wt(Et(r,a),i)}function $Z(n,t,e,s=0,r=as.SUM_BY_NONZERO_WEIGHTS){let a=M(n,"multiClassLabels","sigmoidCrossEntropy");const i=M(t,"logits","sigmoidCrossEntropy");let o=null;if(e!=null&&(o=M(e,"weights","sigmoidCrossEntropy")),zn(a.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=Lt(s),d=Lt(1),f=Lt(.5);a=wt(K(a,Et(d,c)),K(f,c))}const l=kZ(a,i);return mi(l,o,r)}const EZ=G({sigmoidCrossEntropy_:$Z});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IZ(n,t,e=-1){if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${e}`);return va((r,a,i)=>{const l=Xp(a,[e],!0),c=Et(Tt(a,"float32"),l);i([r,c]);const d=De(K(c,r));return{value:It(d,[e]),gradFunc:(g,b)=>{const[x,v]=b,w=Je(g.shape,[e]);return[K(Z(g,w),Et(Tt(x,"float32"),vs(v))),K(Z(g,w),Et(vs(v),Tt(x,"float32")))]}}})(n,t)}function AZ(n,t,e,s=0,r=as.SUM_BY_NONZERO_WEIGHTS){let a=M(n,"onehotLabels","softmaxCrossEntropy");const i=M(t,"logits","softmaxCrossEntropy");let o=null;if(e!=null&&(o=M(e,"weights","softmaxCrossEntropy")),zn(a.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const c=Lt(s),d=Lt(1),f=Lt(a.shape[1]);a=wt(K(a,Et(d,c)),Ot(c,f))}const l=IZ(a,i);return mi(l,o,r)}const RZ=G({softmaxCrossEntropy_:AZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DZ(n,t,e,s){const r=M(n,"indices","sparseFillEmptyRows","int32"),a=M(t,"values","sparseFillEmptyRows"),i=M(e,"denseShape","sparseFillEmptyRows","int32"),o=M(s,"defaultValue","sparseFillEmptyRows",a.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:r,values:a,denseShape:i,defaultValue:o},c=U.runKernel(hb,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const OZ=G({sparseFillEmptyRows_:DZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Z(n,t,e){const s=M(n,"inputIndices","sparseReshape","int32"),r=M(t,"inputShape","sparseReshape","int32"),a=M(e,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const i={inputIndices:s,inputShape:r,newShape:a},o=U.runKernel(db,i);return{outputIndices:o[0],outputShape:o[1]}}const FZ=G({sparseReshape_:_Z});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LZ(n,t,e){const s=M(n,"data","sparseSegmentMean"),r=M(t,"indices","sparseSegmentMean","int32"),a=M(e,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return U.runKernel(fb,i)}const MZ=G({sparseSegmentMean_:LZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zZ(n,t,e){const s=M(n,"data","sparseSegmentSum"),r=M(t,"indices","sparseSegmentSum","int32"),a=M(e,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return U.runKernel(pb,i)}const PZ=G({sparseSegmentSum_:zZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BZ(n,t,e,s,r,a,i,o){const l=M(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=M(t,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const d={separator:e,nGramWidths:s,leftPad:r,rightPad:a,padWidth:i,preserveShortSequences:o},f={data:l,dataSplits:c},m=U.runKernel(bb,f,d);return{nGrams:m[0],nGramsSplits:m[1]}}const VZ=G({stringNGrams_:BZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UZ(n,t,e=!0){const s=M(n,"input","stringSplit","string"),r=M(t,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const a={skipEmpty:e},i={input:s,delimiter:r},o=U.runKernel(xb,i,a);return{indices:o[0],values:o[1],shape:o[2]}}const WZ=G({stringSplit_:UZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GZ(n,t){const e=M(n,"input","stringToHashBucketFast","string"),s={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const r={input:e};return U.runKernel(vb,r,s)}const jZ=G({stringToHashBucketFast_:GZ});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HZ(n,t,e,s=!0){const r=M(n,"input","staticRegexReplace","string"),a={pattern:t,rewrite:e,replaceGlobal:s};return U.runKernel(Lp,{x:r},a)}const qZ=G({staticRegexReplace_:HZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iL={fft:rm,ifft:tc,rfft:am,irfft:Xb},oL={hammingWindow:wY,hannWindow:nL,frame:sL,stft:CY},Pr={flipLeftRight:IY,grayscaleToRGB:RY,resizeNearestNeighbor:aL,resizeBilinear:rL,rgbToGrayscale:OY,rotateWithOffset:FY,cropAndResize:$Y,nonMaxSuppression:MY,nonMaxSuppressionAsync:jY,nonMaxSuppressionWithScore:qY,nonMaxSuppressionWithScoreAsync:XY,nonMaxSuppressionPadded:ZY,nonMaxSuppressionPaddedAsync:JY,threshold:rZ,transform:iZ},cN={bandPart:lZ,gramSchmidt:cZ,qr:dZ},lL={absoluteDifference:mZ,computeWeightedLoss:mi,cosineDistance:yZ,hingeLoss:xZ,huberLoss:wZ,logLoss:TZ,meanSquaredError:CZ,sigmoidCrossEntropy:EZ,softmaxCrossEntropy:RZ},uL={sparseFillEmptyRows:OZ,sparseReshape:FZ,sparseSegmentMean:MZ,sparseSegmentSum:PZ},cL={stringNGrams:VZ,stringSplit:WZ,stringToHashBucketFast:jZ,staticRegexReplace:qZ};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KZ=new Map,xS=new Map;class _l{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class Zs{constructor(){this.classNameMap={}}static getMap(){return Zs.instance==null&&(Zs.instance=new Zs),Zs.instance}static register(t){Zs.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function St(n,t,e){F(n.className!=null,()=>"Class being registered does not have the static className property defined."),F(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),F(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof e>"u"&&(e=n.className);const s=e,r=t+">"+s;return Zs.register(n),KZ.set(r,n),xS.set(n,r),n}function XZ(n){return xS.has(n)?xS.get(n):n.className}const YZ=Object.freeze(Object.defineProperty({__proto__:null,Serializable:_l,SerializationMap:Zs,getRegisteredName:XZ,registerClass:St},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gi extends _l{minimize(t,e=!1,s){const{value:r,grads:a}=this.computeGradients(t,s);if(s!=null){const i=s.map(o=>({name:o.name,tensor:a[o.name]}));this.applyGradients(i)}else this.applyGradients(a);return Yt(a),e?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return gF(t,e)}dispose(){this.iterations_!=null&&Yt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Lt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(gi,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hN extends gi{static get className(){return"Adadelta"}constructor(t,e,s=null){super(),this.learningRate=t,this.rho=e,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=U.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=U.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:it(()=>ie(a).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:it(()=>ie(a).variable(i))});const o=Array.isArray(t)?t[r].tensor:t[s];if(o==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;it(()=>{const d=wt(K(l,this.rho),K(Se(o),1-this.rho)),f=K(Ot($n(wt(c,this.epsilon)),$n(wt(l,this.epsilon))),o),m=wt(K(c,this.rho),K(Se(f),1-this.rho));l.assign(d),c.assign(m);const g=wt(K(f,-this.learningRate),a);a.assign(g)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Yt(this.accumulatedGrads.map(t=>t.variable)),Yt(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=t.length/2,s=!1;this.accumulatedGrads=t.slice(0,e).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=t.slice(e,e*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dN extends gi{static get className(){return"Adagrad"}constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=U.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:it(()=>Rl(a.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(t)?t[r].tensor:t[s];if(i==null)return;const o=this.accumulatedGrads[r].variable;it(()=>{const l=wt(o,Se(i));o.assign(l);const c=wt(K(Ot(i,$n(wt(l,U.backend.epsilon()))),-this.learningRate),a);a.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Yt(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulatedGrads=t.map(s=>({originalName:s.name,variable:s.tensor.variable(e)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fN extends gi{static get className(){return"Adam"}constructor(t,e,s,r=null){super(),this.learningRate=t,this.beta1=e,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],it(()=>{this.accBeta1=Lt(e).variable(),this.accBeta2=Lt(s).variable()}),r==null&&(this.epsilon=U.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);it(()=>{const s=Et(1,this.accBeta1),r=Et(1,this.accBeta2);e.forEach((a,i)=>{const o=U.registeredVariables[a],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:it(()=>ie(o).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${a}/v`,variable:it(()=>ie(o).variable(l))});const c=Array.isArray(t)?t[i].tensor:t[a];if(c==null)return;const d=this.accumulatedFirstMoment[i].variable,f=this.accumulatedSecondMoment[i].variable,m=wt(K(d,this.beta1),K(c,1-this.beta1)),g=wt(K(f,this.beta2),K(Se(c),1-this.beta2)),b=Ot(m,s),x=Ot(g,r);d.assign(m),f.assign(g);const v=wt(K(Ot(b,wt($n(x),this.epsilon)),-this.learningRate),o);o.assign(v)}),this.accBeta1.assign(K(this.accBeta1,this.beta1)),this.accBeta2.assign(K(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Yt(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&Yt(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(t){t=await this.extractIterations(t),it(()=>{this.accBeta1.assign(xa(this.beta1,this.iterations_+1)),this.accBeta2.assign(xa(this.beta2,this.iterations_+1))});const e=t.length/2,s=!1;this.accumulatedFirstMoment=t.slice(0,e).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=t.slice(e,e*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pN extends gi{static get className(){return"Adamax"}constructor(t,e,s,r=null,a=0){super(),this.learningRate=t,this.beta1=e,this.beta2=s,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],it(()=>{this.iteration=Lt(0).variable(),this.accBeta1=Lt(e).variable()}),r==null&&(this.epsilon=U.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);it(()=>{const s=Et(1,this.accBeta1),r=Ot(-this.learningRate,wt(K(this.iteration,this.decay),1));e.forEach((a,i)=>{const o=U.registeredVariables[a],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:ie(o).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${a}/v`,variable:ie(o).variable(l)});const c=Array.isArray(t)?t[i].tensor:t[a];if(c==null)return;const d=this.accumulatedFirstMoment[i].variable,f=this.accumulatedWeightedInfNorm[i].variable,m=wt(K(d,this.beta1),K(c,1-this.beta1)),g=K(f,this.beta2),b=ln(c),x=Na(g,b);d.assign(m),f.assign(x);const v=wt(K(Ot(r,s),Ot(m,wt(x,this.epsilon))),o);o.assign(v)}),this.iteration.assign(wt(this.iteration,1)),this.accBeta1.assign(K(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Yt(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&Yt(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ux extends gi{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=Array.isArray(t)?t[r].tensor:t[s];if(a==null)return;const i=U.registeredVariables[s];it(()=>{const o=wt(K(this.c,a),i);i.assign(o)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=pn(Lt(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mN extends ux{static get className(){return"Momentum"}constructor(t,e,s=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=s,this.accumulations=[],this.m=Lt(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=U.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:it(()=>ie(a).variable(!1))});const i=this.accumulations[r].variable,o=Array.isArray(t)?t[r].tensor:t[s];o!=null&&it(()=>{let l;const c=wt(K(this.m,i),o);this.useNesterov?l=wt(K(this.c,wt(o,K(c,this.m))),a):l=wt(K(this.c,c),a),i.assign(c),a.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Yt(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulations=t.map(s=>({originalName:s.name,variable:s.tensor.variable(e)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gN extends gi{static get className(){return"RMSProp"}constructor(t,e=.9,s=0,r=null,a=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=U.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=U.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:it(()=>ie(a).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:it(()=>ie(a).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:it(()=>ie(a).variable(i))});const o=Array.isArray(t)?t[r].tensor:t[s];if(o==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;it(()=>{const d=wt(K(l,this.decay),K(Se(o),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[r].variable,m=wt(K(f,this.decay),K(o,1-this.decay)),g=Ot(K(o,this.learningRate),$n(Et(d,wt(Se(m),this.epsilon)))),b=wt(K(c,this.momentum),g);l.assign(d),f.assign(m),c.assign(b);const x=Et(a,b);a.assign(x)}else{const f=wt(K(l,this.decay),K(Se(o),1-this.decay)),m=wt(K(c,this.momentum),Ot(K(o,this.learningRate),$n(wt(f,this.epsilon))));l.assign(f),c.assign(m);const g=Et(a,m);a.assign(g)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Yt(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Yt(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&Yt(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,s=!1;this.accumulatedMeanSquares=t.slice(0,e).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=t.slice(e,e*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=t.slice(e*2,e*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZZ=[hN,dN,fN,pN,mN,gN,ux];function QZ(){for(const n of ZZ)St(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JZ="model",tQ=".json",eQ=".weights.bin";function AR(n){return new Promise(t=>setTimeout(t)).then(n)}class vl{constructor(t){if(!lt().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(vl.URL_SCHEME)&&(t=t.slice(vl.URL_SCHEME.length)),(t==null||t.length===0)&&(t=JZ),this.modelJsonFileName=t+tQ,this.weightDataFileName=t+eQ}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=Kr.join(t.weightData),s=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a=Z3(t,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await AR(()=>o.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await AR(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Vp(t)}}}}vl.URL_SCHEME="downloads://";class nQ{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,e)=>{const s=new FileReader;s.onload=r=>{const a=JSON.parse(r.target.result),i=a.modelTopology;if(i==null){e(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){e(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:i});return}const l=aT(a,c=>this.loadWeights(c));t(l)},s.onerror=r=>e(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(t){const e=[],s=[];for(const i of t)e.push(...i.weights),s.push(...i.paths);const r=this.checkManifestAndWeightFiles(t),a=s.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(a).then(i=>[e,i])}loadWeightsFile(t,e){return new Promise((s,r)=>{const a=new FileReader;a.onload=i=>{const o=i.target.result;s(o)},a.onerror=i=>r(`Failed to weights data from file of path '${t}'.`),a.readAsArrayBuffer(e)})}checkManifestAndWeightFiles(t){const e=[],s=this.weightsFiles.map(a=>xR(a.name)),r={};for(const a of t)a.paths.forEach(i=>{const o=xR(i);if(e.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(e.push(o),s.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);r[i]=this.weightsFiles[s.indexOf(o)]});if(e.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${e.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const sQ=n=>lt().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(vl.URL_SCHEME)?rQ(n.slice(vl.URL_SCHEME.length)):null;Pe.registerSaveRouter(sQ);function rQ(n="model"){return new vl(n)}function aQ(n){return new nQ(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RR(n,t,e,s){i(n),e=e??0,s=s??1,o(e,s);let r=0;const a=l=>(l.then(c=>{const d=e+ ++r/n.length*(s-e);return t(d),c}),l);function i(l){F(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,c){F(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),F(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),F(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(n.map(a))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hL(n,t){t==null&&(t={});const e=t.fetchFunc==null?lt().platform.fetch:t.fetchFunc,s=n.map(f=>e(f,t.requestInit,{isBinary:!0})),o=(t.onProgress==null?await Promise.all(s):await RR(s,t.onProgress,0,.5)).map(f=>f.arrayBuffer());return t.onProgress==null?await Promise.all(o):await RR(o,t.onProgress,.5,1)}function iQ(n,t){var e;const s=t.fetchFunc==null?lt().platform.fetch:t.fetchFunc;let r=0,a;return(e=t.onProgress)===null||e===void 0||e.call(t,0),new ReadableStream({pull:async i=>{for(var o;r<n.length;){a||(a=(await s(n[r],t.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await a.read();if(l){r++,a=void 0,(o=t.onProgress)===null||o===void 0||o.call(t,r/n.length);continue}i.enqueue(c);return}i.close()}})}async function oQ(n,t="",e,s){return dL(i=>hL(i,{requestInit:s}))(n,t,e)}function dL(n){return async(t,e="",s)=>{const r=t.map(()=>!1),a={},i=s!=null?s.map(()=>!1):[],o=[];if(t.forEach((g,b)=>{let x=0;g.weights.forEach(v=>{const w="quantization"in v?v.quantization.dtype:v.dtype,T=dl[w]*ft(v.shape),C=()=>{r[b]=!0,a[b]==null&&(a[b]=[]),a[b].push({manifestEntry:v,groupOffset:x,sizeBytes:T})};s!=null?s.forEach((k,$)=>{k===v.name&&(C(),i[$]=!0)}):C(),o.push(v.name),x+=T})}),!i.every(g=>g)){const g=s.filter((b,x)=>!i[x]);throw new Error(`Could not find weights in manifest with names: ${g.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=r.reduce((g,b,x)=>(b&&g.push(x),g),[]),c=[];l.forEach(g=>{t[g].paths.forEach(b=>{const x=e+(e.endsWith("/")?"":"/")+b;c.push(x)})});const d=await n(c),f={};let m=0;return l.forEach(g=>{const b=t[g].paths.length,x=new Kr(d.slice(m,m+b));a[g].forEach(w=>{const T=x.slice(w.groupOffset,w.groupOffset+w.sizeBytes),C=q3(T,[w.manifestEntry]);for(const k in C)f[k]=C[k]}),m+=b}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lQ="application/octet-stream",uQ="application/json";class yN{constructor(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.weightUrlConverter=e.weightUrlConverter,e.fetchFunc!=null?(F(typeof e.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=lt().platform.fetch,F(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&F(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{},this.loadOptions=e}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=Z3(t,s);if(e.body.append("model.json",new Blob([JSON.stringify(r)],{type:uQ}),"model.json"),t.weightData!=null){const i=Kr.join(t.weightData);e.body.append("model.weights.bin",new Blob([i],{type:lQ}),"model.weights.bin")}const a=await this.fetch(this.path,e);if(a.ok)return{modelArtifactsInfo:Vp(t),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let e;try{e=await t.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=e.modelTopology,r=e.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return e}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return aT(t,e=>this.loadWeights(e))}async loadStream(){const t=await this.loadModelJSON(),e=await this.getWeightUrls(t.weightsManifest),s=My(t.weightsManifest),r=()=>iQ(e,this.loadOptions);return Object.assign(Object.assign({},t),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=cQ(e),a=this.weightPathPrefix||s,i=[],o=[];for(const l of t)for(const c of l.paths)this.weightUrlConverter!=null?o.push(this.weightUrlConverter(c)):i.push(a+c+r);return this.weightUrlConverter&&i.push(...await Promise.all(o)),i}async loadWeights(t){const e=await this.getWeightUrls(t),s=My(t),r=await hL(e,this.loadOptions);return[s,r]}}yN.URL_SCHEME_REGEX=/^https?:\/\//;function cQ(n){const t=n.lastIndexOf("/"),e=n.lastIndexOf("?"),s=n.substring(0,t),r=e>t?n.substring(e):"";return[s+"/",r]}function vS(n){return n.match(yN.URL_SCHEME_REGEX)!=null}const fL=(n,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let e=!0;if(Array.isArray(n)?e=n.every(s=>vS(s)):e=vS(n),e)return bN(n,t)}return null};Pe.registerSaveRouter(fL);Pe.registerLoadRouter(fL);function bN(n,t){return new yN(n,t)}function hQ(n,t){return bN(n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gw{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class pL{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class dQ{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=e=>Promise.resolve(t.save(e)))}}function fQ(n,t,e,s){const r=arguments;return new dQ(Py(...r))}function Py(n,t,e,s){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new gw(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new gw({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new gw({modelTopology:n,weightSpecs:t,weightData:e,trainingConfig:s}))}function pQ(n){return new pL(n)}function mQ(n){return new pL(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xN=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Kr,browserFiles:aQ,browserHTTPRequest:hQ,concatenateArrayBuffers:Y3,copyModel:jq,decodeWeights:q3,decodeWeightsStream:X3,encodeWeights:dS,fromMemory:fQ,fromMemorySync:Py,getLoadHandlers:Rq,getModelArtifactsForJSON:aT,getModelArtifactsForJSONSync:rT,getModelArtifactsInfoForJSON:Vp,getSaveHandlers:Q3,getWeightSpecs:My,http:bN,isHTTPScheme:vS,listModels:Wq,loadWeights:oQ,moveModel:Hq,registerLoadRouter:Aq,registerSaveRouter:Iq,removeModel:Gq,weightsLoaderFactory:dL,withSaveHandler:pQ,withSaveHandlerSync:mQ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(n,t,e){const s=M(n,"labels","confusionMatrix"),r=M(t,"predictions","confusionMatrix");F(e==null||e>0&&Number.isInteger(e),()=>`If provided, numClasses must be a positive integer, but got ${e}`),F(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),F(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),F(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),F(e>0&&Number.isInteger(e),()=>`numClasses is required to be a positive integer, but got ${e}`);const a=Zu(Tt(s,"int32"),e),i=Zu(Tt(r,"int32"),e),o=ne(a),l=Xt(o,i);return Tt(l,"int32")}const yQ=G({confusionMatrix_:gQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bQ=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:yQ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Wo,DR=!1;function mL(n,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let e=!1,s=!1,r=!1,a=!1,i=!1,o=!1;if(n.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)a=!0;else if(n.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(pf(Fy,U.backendName)!=null){const b={pixels:n},x={numChannels:t};return U.runKernel(Fy,b,x)}const[c,d]=r?[n.videoWidth,n.videoHeight]:[n.width,n.height];let f;if(i)f=n.getContext("2d").getImageData(0,0,c,d).data;else if(s||e)f=n.data;else if(a||r||o){if(Wo==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Wo=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Wo=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Wo.canvas.width=c,Wo.canvas.height=d,Wo.drawImage(n,0,0,c,d),f=Wo.getImageData(0,0,c,d).data}let m;if(t===4)m=new Int32Array(f);else{const b=c*d;m=new Int32Array(b*t);for(let x=0;x<b;x++)for(let v=0;v<t;++v)m[x*t+v]=f[x*4+v]}return tN(m,[d,c,t],"int32")}function xQ(n){return n!=null&&n.data instanceof Uint8Array}function vQ(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function wQ(n){return n!=null&&n.width!==0&&n.height!==0}function SQ(n){return vQ()&&!(n instanceof ImageBitmap)&&wQ(n)&&!xQ(n)}async function TQ(n,t=3){let e=null;if(lt().getBool("WRAP_TO_IMAGEBITMAP")&&SQ(n)){let s;try{s=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===n.width&&s.height===n.height?e=s:e=n}else e=n;return mL(e,t)}function gL(n){if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const t=n.rank===2?1:n.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`)}function NQ(n){const t=(n==null?void 0:n.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function CQ(n,t){let e=M(n,"img","toPixels");if(!(n instanceof ge)){const c=e;e=Tt(c,"int32"),c.dispose()}gL(e);const[s,r]=e.shape.slice(0,2),a=e.rank===2?1:e.shape[2],i=await e.data(),o=e.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let c=0;c<s*r;++c){const d=[0,0,0,255];for(let m=0;m<a;m++){const g=i[c*a+m];if(e.dtype==="float32"){if(g<0||g>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${g}.`)}else if(e.dtype==="int32"&&(g<0||g>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${g}.`);a===1?(d[0]=g*o,d[1]=g*o,d[2]=g*o):d[m]=g*o}const f=c*4;l[f+0]=Math.round(d[0]),l[f+1]=Math.round(d[1]),l[f+2]=Math.round(d[2]),l[f+3]=Math.round(d[3])}if(t!=null){DR||pf(M0,U.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),DR=!0),t.width=r,t.height=s;const c=t.getContext("2d"),d=new ImageData(l,r,s);c.putImageData(d,0,0)}return e!==n&&e.dispose(),l}function kQ(n,t,e){let s=M(n,"img","draw");if(!(n instanceof ge)){const i=s;s=Tt(i,"int32"),i.dispose()}gL(s),NQ(e==null?void 0:e.imageOptions);const r={image:s},a={canvas:t,options:e};U.runKernel(M0,r,a)}const $Q=G({fromPixels_:mL}),EQ=Object.freeze(Object.defineProperty({__proto__:null,draw:kQ,fromPixels:$Q,fromPixelsAsync:TQ,toPixels:CQ},Symbol.toStringTag,{value:"Module"}));function cx(n,t){const e=n.shape.length,s=t.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[s-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[s-1]} vs. ${e}`);if(ft(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const r=t.shape,a=r[r.length-1];let i=1;for(let f=0;f<r.length-1;++f)i*=r[f];const o=n.shape,l=r.slice();l.pop();let c=1;for(let f=a;f<e;++f)c*=o[f],l.push(o[f]);const d=[...Ft(n.shape).map(f=>f/c),1].slice(0,a);return[l,i,c,d]}const IQ=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:cx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wS=-2,AQ=-1;function vN(n,t,e){const s=n.shape.length;F(s===t.length,()=>`Error in slice${s}D: Length of begin ${t} must match the rank of the array (${s}).`),F(s===e.length,()=>`Error in slice${s}D: Length of size ${e} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)F(t[r]+e[r]<=n.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${t[r]+e[r]}) would overflow input.shape[${r}] (${n.shape[r]})`)}function RQ(n){const t=[];let e=0;for(;n>0;)n&1&&t.push(e),n/=2,e++;return t}function wN(n,t,e){const s=[];for(let r=0;r<n.length;r++)s[r]=Math.ceil((t[r]-n[r])/e[r]);return s}function yL(n,t,e,s){const r=[...n];for(let a=r.length;a<s.length;a++)r.push(1);for(let a=0;a<e;a++)a===0?r[t]=1:(r.splice(t,0,1),r.pop());return r}function bL(n,t,e){return e<=n?e:e-(t-1)}function xL(n,t){const e=[];for(let s=0;s<n;s++)e.push(t+s);return e}function DQ(n,t,e,s,r,a,i,o,l){const c=n.length;let d=new Array(c),f=new Array(c),m=new Array(c);if(t.length&&e>0){const g=t[0],b=e+1;d=vL(i,g,b,s,n),f=wL(o,g,b,r,n),m=yL(a,g,b,n)}else for(let g=0;g<c;g++)d[g]=TL(i,s,a,n,g,l),f[g]=NL(o,r,a,n,g,l),m[g]=SL(a,g,l);return{begin:d,end:f,strides:m}}function vL(n,t,e,s,r){const a=[...r],i=xL(e,t);for(let o=0;o<a.length;o++)if(i.indexOf(o)>-1)a[o]=0;else{const l=bL(t,e,o);let c=s[l];n&1<<l&&(c=0),a[o]=c}return a}function wL(n,t,e,s,r){const a=[...r],i=xL(e,t);for(let o=0;o<a.length;o++)if(i.indexOf(o)>-1)a[o]=Number.MAX_SAFE_INTEGER;else{const l=bL(t,e,o);let c=s[l];n&1<<l&&(c=Number.MAX_SAFE_INTEGER),a[o]=c}for(let o=0;o<a.length;o++){const l=r[o];a[o]<0&&(a[o]+=l),a[o]=Ji(0,a[o],r[o])}return a}function SL(n,t,e){let s=n[t];return(e&1<<t||s==null)&&(s=1),s}function TL(n,t,e,s,r,a){let i=t[r];const o=e[r]||1;(n&1<<r||a&1<<r||i==null)&&(o>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),i=Ji(0,i,l-1),i}function NL(n,t,e,s,r,a){let i=t[r];const o=e[r]||1;(n&1<<r||a&1<<r||i==null)&&(o>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),o>0?i=Ji(0,i,l):i=Ji(-1,i,l-1),i}function SN(n,t,e){let s=e.length;for(let r=0;r<e.length;r++)if(e[r]>1){s=r;break}for(let r=s+1;r<e.length;r++)if(t[r]>0||e[r]!==n[r])return!1;return!0}function TN(n,t){let e=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)e+=n[s]*t[s];return e}function hx(n,t,e){let s;const r=n.shape.length;typeof t=="number"?s=[t,...new Array(r-1).fill(0)]:t.length<r?s=t.concat(new Array(r-t.length).fill(0)):s=t.slice(),s.forEach(i=>{F(i!==-1,()=>"slice() does not support negative begin indexing.")});let a;return e==null?a=new Array(r).fill(-1):typeof e=="number"?a=[e,...new Array(r-1).fill(-1)]:e.length<r?a=e.concat(new Array(r-e.length).fill(-1)):a=e,a=a.map((i,o)=>i>=0?i:(F(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${o}.`),n.shape[o]-s[o])),[s,a]}function NN(n,t,e,s,r,a,i,o,l){let c;if(s==null?(c=new Array(t.length),c.fill(1)):c=s,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let d=!1;const f={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:e.slice(),strides:c.slice(),beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};for(let C=0;C<f.dims;C++)d&&(1<<C&o)!==0&&f.numAddAxisAfterEllipsis++,1<<C&i&&(d=!0);d||(f.ellipsisMask|=1<<f.dims,f.dims++);const m={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};OQ(f,m);let g=!0,b=!0,x=!0;const v=[],w=[];for(let C=0;C<n.length;++C){if(m.strides[C]===0)throw Error(`strides[${C}] must be non-zero`);const k=!!(m.shrinkAxisMask&1<<C),$=n[C];if($===-1){v.push(k?1:-1);continue}const I=[m.beginMask&1<<C,m.endMask&1<<C],D=[m.strides[C]>0?0:-1,m.strides[C]>0?$:$-1];if(k&&m.strides[C]<=0)throw Error("only stride 1 allowed on non-range indexing.");x=x&&m.strides[C]===1;const _=!!(m.beginMask&1<<C&&m.endMask&1<<C);if(m.beginValid&&m.endValid){if(k){const V=m.begin[C]<0?$+m.begin[C]:m.begin[C];if(m.begin[C]=V,m.end[C]=m.begin[C]+1,V<0||V>=$)throw Error(`slice index ${m.begin[C]} of dimension ${C} out of bounds.`)}else m.begin[C]=OR(m.begin[C],0,m.strides[C],$,I,D),m.end[C]=OR(m.end[C],1,m.strides[C],$,I,D);const R=m.strides[C]===1&&m.begin[C]===0&&m.end[C]===$;g=g&&R,b=b&&(C===0&&m.strides[C]===1||R)}else g=g&&m.strides[C]===1&&_,b=b&&(C===0&&m.strides[C]===1||_);let O,L=!1;if(m.beginValid&&m.endValid?(O=m.end[C]-m.begin[C],L=!0):k?(O=1,L=!0):_&&$>=0&&(m.strides[C]<0?O=-$:O=$,L=!0),L){let R;O===0||O<0!=m.strides[C]<0?R=0:R=Math.trunc(O/m.strides[C])+(O%m.strides[C]!==0?1:0),v.push(R)}else v.push(-1)}for(let C=0;C<m.finalShapeGatherIndices.length;++C){const k=m.finalShapeGatherIndices[C];k>=0?w.push(v[k]):k===wS&&w.push(1)}return{finalShapeSparse:w.filter((C,k)=>m.finalShapeGatherIndices[k]!==wS),finalShape:w,isIdentity:g,sliceDim0:b,isSimpleSlice:x,begin:m.begin,end:m.end,strides:m.strides}}function OQ(n,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let e=0;t.beginValid=n.begin!=null,t.endValid=n.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const r=Math.min(t.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,t.dims);for(;e<r;e++)t.begin[e]=0,t.end[e]=0,t.strides[e]=1,t.beginMask|=1<<e,t.endMask|=1<<e,t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[e]=s}else if(1<<s&n.newAxisMask)t.finalShapeGatherIndices.push(wS),t.finalShapeGatherIndicesSparse.push(-1);else{if(e===t.begin.length)throw Error(`Index out of range using input dim ${e}; input has only ${t.dims} dims, ${t.begin.length}.`);n.begin!=null&&(t.begin[e]=n.begin[s]),n.end!=null&&(t.end[e]=n.end[s]),t.strides[e]=n.strides[s],n.beginMask&1<<s&&(t.beginMask|=1<<e),n.endMask&1<<s&&(t.endMask|=1<<e),n.shrinkAxisMask&1<<s?(t.finalShapeGatherIndices.push(AQ),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<e):(t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(s)),t.inputShapeGatherIndicesSparse[e]=s,e++}}function OR(n,t,e,s,r,a){if(r[t])return e>0?a[t]:a[t+1&1];{const i=n<0?s+n:n;return i<a[0]?a[0]:i>a[1]?a[1]:i}}const CL=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:vN,computeFlatOffset:TN,computeOutShape:wN,getNormalizedAxes:DQ,isSliceContinous:SN,maskToAxes:RQ,parseSliceParams:hx,sliceInfo:NN,startForAxis:TL,startIndicesWithElidedDims:vL,stopForAxis:NL,stopIndicesWithElidedDims:wL,stridesForAxis:SL,stridesWithElidedDims:yL},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const _Q="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kL{static sgd(t){return new ux(t)}static momentum(t,e,s=!1){return new mN(t,e,s)}static rmsprop(t,e=.9,s=0,r=null,a=!1){return new gN(t,e,s,r,a)}static adam(t=.001,e=.9,s=.999,r=null){return new fN(t,e,s,r)}static adadelta(t=.001,e=.95,s=null){return new hN(t,e,s)}static adamax(t=.002,e=.9,s=.999,r=null,a=0){return new pN(t,e,s,r,a)}static adagrad(t,e=.1){return new dN(t,e)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xo=kL;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FQ=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function CN(){return new Promise(n=>FQ(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kN(n,t){const e=n[0].length;n.forEach((r,a)=>{F(r.length===e,()=>`Error in concat${e}D: rank of tensors[${a}] must be the same as the rank of the rest (${e})`)}),F(t>=0&&t<e,()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`);const s=n[0];n.forEach((r,a)=>{for(let i=0;i<e;i++)F(i===t||r[i]===s[i],()=>`Error in concat${e}D: Shape of tensors[${a}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${a}.`)})}function fa(n,t){const e=n[0].slice();for(let s=1;s<n.length;s++)e[t]+=n[s][t];return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zr;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(zr||(zr={}));function $L(n,t,e){let s=new Array;if(e==null&&t==null)return s;if(t==null)for(;s.length<n+e.length;)s.push(-1);else s=t.slice();if(e==null)return s;if(n+e.length!==s.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${n+e.length}, but shape.rank = ${s.length}`);for(let r=1;r<e.length;++r){const a=e[r],i=s[s.length-e.length+r],o=s[i];if(a>=0)if(o>=0){if(o!==a)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${r+n}] = ${a} but shape[${r+n}] = ${o}`)}else s[i]=a}return s}function EL(n){const t={FIRST_DIM_SIZE:zr.FIRST_DIM_SIZE,VALUE_ROWIDS:zr.VALUE_ROWIDS,ROW_LENGTHS:zr.ROW_LENGTHS,ROW_SPLITS:zr.ROW_SPLITS,ROW_LIMITS:zr.ROW_LIMITS,ROW_STARTS:zr.ROW_STARTS},e=[];for(const s of n)if(s in t)e.push(t[s]);else break;return e}function IL(n){return n.length===0?0:n[0]===zr.FIRST_DIM_SIZE?n.length-1:n.length}function AL(n,t){if(n==null||t==null)return;const e=n.length,s=t.length;if(e>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${e} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(e,s-1);++r){const a=n[r],i=t[r+1];if(a>=0&&i>=0&&a!==1&&a!==i)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${r-n.length}] = ${a} but ragged tensor input.flatValues.shape[${r-n.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $N=30;function dx(n){return n<=$N?n:Dy(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EN(n,t,e){const s=e*(typeof n=="number"?n:n[0]),r=t*(typeof n=="number"?n:n[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function im(n,t,e,s=!0){let r=[];if(s)r=r.concat(t.slice(0)),r.push(n[0]/e),r=r.concat(n.slice(1));else{r=r.concat(n[0]);const a=t.length;for(let i=0;i<a;++i)r=r.concat([n[i+1]/t[i],t[i]]);r=r.concat(n.slice(a+1))}return r}function om(n,t,e=!0){const s=[];if(e){s.push(t);for(let r=t+1;r<n;++r)r<=2*t?(s.push(r),s.push(r-(t+1))):s.push(r)}else{const r=[],a=[];for(let i=1;i<n;++i)i>=t*2+1||i%2===1?a.push(i):r.push(i);s.push(...r),s.push(0),s.push(...a)}return s}function lm(n,t,e,s=!0){const r=[];s?r.push(n[0]/e):r.push(n[0]*e);for(let a=1;a<n.length;++a)a<=t.length?s?r.push(t[a-1]*n[a]):r.push(n[a]/t[a-1]):r.push(n[a]);return r}function IN(n,t){const e=[0];for(let s=0;s<t;++s)e.push(n[s][0]);return e}function AN(n,t,e){const s=n.slice(0,1);for(let r=0;r<e;++r)s.push(n[r+1]-t[r][0]-t[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fx=1.7580993408473768,px=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RN=.3275911,DN=.254829592,ON=-.284496736,_N=1.421413741,FN=-1.453152027,LN=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ai(n,t){if(n.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${t.length}.`);const e=new Float32Array(n.length*2);for(let s=0;s<e.length;s+=2)e[s]=n[s/2],e[s+1]=t[s/2];return e}function RL(n){const t=new Float32Array(n.length/2),e=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)t[s/2]=n[s],e[s/2]=n[s+1];return{real:t,imag:e}}function DL(n){const t=Math.ceil(n.length/4),e=new Float32Array(t),s=new Float32Array(t);for(let r=0;r<n.length;r+=4)e[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:e,imag:s}}function OL(n){const t=Math.floor(n.length/4),e=new Float32Array(t),s=new Float32Array(t);for(let r=2;r<n.length;r+=4)e[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:e,imag:s}}function MN(n,t){const e=n[t*2],s=n[t*2+1];return{real:e,imag:s}}function _L(n,t,e,s){n[s*2]=t,n[s*2+1]=e}function FL(n,t){const e=new Float32Array(n/2),s=new Float32Array(n/2);for(let r=0;r<Math.ceil(n/2);r++){const a=(t?2:-2)*Math.PI*(r/n);e[r]=Math.cos(a),s[r]=Math.sin(a)}return{real:e,imag:s}}function LL(n,t,e){const s=(e?2:-2)*Math.PI*(n/t),r=Math.cos(s),a=Math.sin(s);return{real:r,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yw="->",LQ=/->/g,_R=",",FR="...";function zN(n,t){n=n.replace(/\s/g,"");const e=(n.length-n.replace(LQ,"").length)/yw.length;if(e<1)throw new Error("Equations without an arrow are not supported.");if(e>1)throw new Error(`Equation must contain exactly one arrow ("${yw}").`);const[s,r]=n.split(yw);F(s.indexOf(FR)===-1,()=>`The ellipsis notation ("${FR}") is not supported yet.`);const a=s.split(_R),i=a.length;if(t!==i)throw new Error(`Expected ${i} input tensors, received ${t}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let m=0;m<r.length;++m){const g=r[m];if(!a.some(b=>b.indexOf(g)!==-1))throw new Error(`Output subscripts contain the label ${g} not present in the input subscripts.`);o.indexOf(g)===-1&&o.push(g)}for(let m=0;m<s.length;++m){const g=s[m];o.indexOf(g)===-1&&g!==_R&&o.push(g)}const l=new Array(a.length);for(let m=0;m<i;++m){if(new Set(a[m].split("")).size!==a[m].length)throw new Error(`Found duplicate axes in input component ${a[m]}. Support for duplicate axes in input is not implemented yet.`);l[m]=[];for(let g=0;g<a[m].length;++g)l[m].push(o.indexOf(a[m][g]))}const c=o.length,d=r.length,f=[];for(let m=d;m<c;++m)f.push(m);return{allDims:o,summedDims:f,idDims:l}}function PN(n,t){let e=new Array(n);e.fill(-1);for(let r=0;r<t.length;++r)e[t[r]]=r;const s=[];for(let r=0;r<n;++r)e[r]===-1&&s.push(r);return e=e.filter(r=>r!==-1),{permutationIndices:e,expandDims:s}}function BN(n,t,e){const s=new Array(n);for(let r=0;r<e.length;++r){const a=e[r].shape;for(let i=0;i<t[r].length;++i)s[t[r][i]]===void 0?s[t[r][i]]=a[i]:F(s[t[r][i]]===a[i],()=>`Expected dimension ${s[t[r][i]]} at axis ${i} of input shaped ${JSON.stringify(a)}, but got dimension ${a[i]}`)}}function VN(n,t){const e=n,s=[];let r=0;n.length===0&&e.push(-1),r=n.length+1;for(let i=0;i<r;++i)s.push([]);const a=[];for(let i=0;i<e.length;++i){const o=e[i],l=MQ(t,o);for(const c of l)a.indexOf(c)===-1&&(s[i].push(c),a.push(c))}return{path:e,steps:s}}function UN(n){return n.every((t,e)=>t===e)}function MQ(n,t){const e=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(t)!==-1||t===-1)&&e.push(s);return e}function WN(n,t,e=0){let s=[];if(typeof t=="number")F(n.shape[e]%t===0,()=>"Number of splits must evenly divide the axis."),s=new Array(t).fill(n.shape[e]/t);else{const r=t.reduce((i,o)=>(o===-1&&(i+=1),i),0);F(r<=1,()=>"There should be only one negative value in split array.");const a=t.indexOf(-1);if(a!==-1){const i=t.reduce((o,l)=>l>0?o+l:o);t[a]=n.shape[e]-i}F(n.shape[e]===t.reduce((i,o)=>i+o),()=>"The sum of sizes must match the size of the axis dimension."),s=t}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ML(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function zL(n,t){return`indices(${n}, 0) is invalid: ${t} < 0`}function PL(n,t,e){return`indices(${n}, 0) is invalid: ${t} >= ${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BL(n,t){return`only one output dimension may be -1, not both ${n} and ${t}`}function VL(n,t){return`size ${n} must be non-negative, not ${t}`}function UL(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function WL(n,t){const e=ft(n),s=ft(t);return`Input to reshape is a SparseTensor with ${e}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${t}`}function GL(n,t){const e=ft(n),s=ft(t);return`Input to reshape is a tensor with ${e} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SS(){return"segment ids must be >= 0"}function jL(){return"segment ids are not increasing"}function HL(n,t){return`Segment id ${n} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function qL(n,t,e){return`Bad: indices[${n}] == ${t} out of range [0, ${e})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KL(n,t){let e=!1,s;for(n<=$N?(s=n,e=!0):s=Dy(n,Math.floor(Math.sqrt(n)));!e;)s>t||s===n?e=!0:s=Dy(n,s+1);return s}function XL(n,t,e){const s=[],r=n.length;for(let a=0;a<r;a++)a!==t?s.push(n[a]):s.push(e);return s}function GN(n,t,e,s){const r=t.shape.length,a=n.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>a)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${a}).`);if(e<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${e}).`);for(let f=0;f<s;++f)if(n.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${n.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);const i=n.shape[e],o=[];let l=1,c=1,d=1;for(let f=0;f<s;++f)o.push(n.shape[f]),l*=n.shape[f];for(let f=s;f<e;f++)o.push(n.shape[f]),c*=n.shape[f];for(let f=s;f<r;f++)o.push(t.shape[f]);for(let f=e+1;f<a;f++)o.push(n.shape[f]),d*=n.shape[f];return{batchSize:l,sliceSize:d,outerSize:c,dimSize:i,outputShape:o}}const zQ=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:GN,computeOutShape:XL,segOpComputeOptimalWindowSize:KL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ii(n){try{return n.map(t=>ni(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function YL(n){return n.map(t=>ha(t))}const ZL=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:DN,ERF_A2:ON,ERF_A3:_N,ERF_A4:FN,ERF_A5:LN,ERF_P:RN,PARALLELIZE_THRESHOLD:$N,get RowPartitionType(){return zr},SELU_SCALE:px,SELU_SCALEALPHA:fx,applyActivation:rx,assertAndGetBroadcastShape:jt,assertAxesAreInnerMostDims:Bn,assertParamsConsistent:kN,assignToTypedArray:_L,axesAreInnerMostDims:OT,calculateShapes:vo,checkEinsumDimSizes:BN,checkPadOnDimRoundingMode:us,combineLocations:fF,combineRaggedTensorToTensorShapes:$L,complexWithEvenIndex:DL,complexWithOddIndex:OL,computeConv2DInfo:En,computeConv3DInfo:mo,computeDefaultPad:mT,computeDilation2DInfo:Up,computeOptimalWindowSize:dx,computeOutAndReduceShapes:In,computeOutShape:fa,computePool2DInfo:kr,computePool3DInfo:hi,convertConv2DDataFormat:di,decodeEinsumEquation:zN,eitherStridesOrDilationsAreOne:Pn,expandShapeToKeepDim:Je,exponent:LL,exponents:FL,fromStringArrayToUint8:YL,fromUint8ToStringArray:ii,getAxesPermutation:We,getBroadcastDims:yl,getComplexWithIndex:MN,getEinsumComputePath:VN,getEinsumPermutation:PN,getFusedBiasGradient:sx,getFusedDyActivation:nx,getImageCenter:EN,getInnerMostAxes:tn,getPermuted:om,getRaggedRank:IL,getReductionAxes:hn,getReshaped:im,getReshapedPermuted:lm,getRowPartitionTypesHelper:EL,getSliceBeginCoords:IN,getSliceSize:AN,getSparseFillEmptyRowsIndicesDenseShapeMismatch:ML,getSparseFillEmptyRowsNegativeIndexErrorMessage:zL,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:PL,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:UL,getSparseReshapeInputOutputMismatchErrorMessage:GL,getSparseReshapeInputOutputMultipleErrorMessage:WL,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:BL,getSparseReshapeNegativeOutputDimErrorMessage:VL,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:qL,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:SS,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:jL,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:HL,getUndoAxesPermutation:go,isIdentityPermutation:UN,log:E8,mergeRealAndImagArrays:ai,prepareAndValidate:cx,prepareSplitSize:WN,segment_util:zQ,shouldFuse:ax,slice_util:CL,splitRealAndImagArrays:RL,stridesOrDilationsArePositive:gl,tupleValuesAreOne:so,upcastType:ys,validateDefaultValueShape:AL,validateInput:Zb,validateUpdateShape:eN,warn:Ys},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PQ=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:ix,nonMaxSuppressionV4Impl:ox,nonMaxSuppressionV5Impl:lx,whereImpl:tx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */QZ();const BQ=Object.freeze(Object.defineProperty({__proto__:null,Abs:Mf,Acos:fc,Acosh:pc,AdadeltaOptimizer:hN,AdagradOptimizer:dN,AdamOptimizer:fN,AdamaxOptimizer:pN,Add:Al,AddN:zf,All:v0,Any:w0,ArgMax:Pf,ArgMin:Bf,Asin:mc,Asinh:gc,Atan:yc,Atan2:xc,Atanh:bc,AvgPool:Vf,AvgPool3D:Uf,AvgPool3DGrad:T0,AvgPoolGrad:S0,BatchMatMul:Wf,BatchToSpaceND:Gf,Bincount:N0,BitwiseAnd:jf,BroadcastArgs:C0,BroadcastTo:A3,Cast:vc,Ceil:wc,ClipByValue:Sc,Complex:k0,ComplexAbs:Hf,Concat:qf,Conv2D:Kf,Conv2DBackpropFilter:$0,Conv2DBackpropInput:Xf,Conv3D:Yf,Conv3DBackpropFilterV2:E0,Conv3DBackpropInputV2:I0,Cos:Tc,Cosh:Nc,CropAndResize:R0,Cumprod:A0,Cumsum:Zf,DataStorage:W2,DenseBincount:D0,DepthToSpace:O0,DepthwiseConv2dNative:Qf,DepthwiseConv2dNativeBackpropFilter:_0,DepthwiseConv2dNativeBackpropInput:F0,Diag:L0,Dilation2D:Jf,Dilation2DBackpropFilter:_y,Dilation2DBackpropInput:Oy,Draw:M0,get ENV(){return K2},Einsum:z0,Elu:kc,EluGrad:P0,Environment:E3,Equal:tp,Erf:$c,Exp:Ec,ExpandDims:ep,Expm1:Ic,FFT:B0,Fill:V0,FlipLeftRight:U0,Floor:Ac,FloorDiv:Rc,FromPixels:Fy,FusedBatchNorm:np,FusedConv2D:hf,FusedDepthwiseConv2D:df,GatherNd:W0,GatherV2:sp,Greater:rp,GreaterEqual:Dc,IFFT:G0,Identity:Oc,Imag:j0,IsFinite:_c,IsInf:Fc,IsNan:Lc,KernelBackend:y0,LRN:hp,LRNGrad:q0,LeakyRelu:ap,Less:ip,LessEqual:op,LinSpace:H0,Log:Mc,Log1p:zc,LogSoftmax:R3,LogicalAnd:lp,LogicalNot:up,LogicalOr:cp,LogicalXor:T8,LowerBound:N8,MatrixBandPart:C8,Max:dp,MaxPool:fp,MaxPool3D:pp,MaxPool3DGrad:X0,MaxPoolGrad:K0,MaxPoolWithArgmax:Y0,Maximum:Pc,Mean:mp,Min:gp,Minimum:Bc,MirrorPad:yp,Mod:Vc,MomentumOptimizer:mN,Multinomial:Z0,Multiply:Uc,Neg:bp,NonMaxSuppressionV3:Q0,NonMaxSuppressionV4:J0,NonMaxSuppressionV5:tb,NotEqual:xp,OP_SCOPE_SUFFIX:tT,OneHot:wp,OnesLike:vp,Optimizer:gi,OptimizerConstructors:kL,Pack:Sp,PadV2:Tp,Pool:k8,Pow:Wc,Prelu:Np,Prod:Cp,RMSPropOptimizer:gN,RaggedGather:eb,RaggedRange:nb,RaggedTensorToTensor:sb,Range:rb,get Rank(){return aS},Real:ab,RealDiv:Cc,Reciprocal:Gc,get Reduction(){return as},Relu:jc,Relu6:Hc,Reshape:kp,ResizeBilinear:Ep,ResizeBilinearGrad:ob,ResizeNearestNeighbor:$p,ResizeNearestNeighborGrad:ib,Reverse:Ip,RotateWithOffset:Nb,Round:qc,Rsqrt:Kc,SGDOptimizer:ux,ScatterNd:lb,SearchSorted:cb,Select:Ap,Selu:Xc,Sigmoid:Jc,Sign:Qc,Sin:Yc,Sinh:Zc,Slice:Rp,Softmax:Fp,Softplus:th,SpaceToBatchND:Op,SparseFillEmptyRows:hb,SparseReshape:db,SparseSegmentMean:fb,SparseSegmentSum:pb,SparseToDense:mb,SplitV:_p,Sqrt:eh,Square:gb,SquaredDifference:nh,StaticRegexReplace:Lp,Step:oh,StridedSlice:yb,StringNGrams:bb,StringSplit:xb,StringToHashBucketFast:vb,Sub:sh,Sum:Dp,Tan:rh,Tanh:ah,Tensor:ge,TensorBuffer:cn,TensorScatterUpdate:ub,Tile:ih,TopK:wb,Transform:Sb,Transpose:ol,Unique:Tb,Unpack:Mp,UnsortedSegmentSum:zp,UpperBound:$8,Variable:mf,ZerosLike:Pp,_FusedMatMul:cf,abs:ln,acos:oT,acosh:lT,add:wt,addN:iF,all:Eb,any:yf,argMax:ml,argMin:uT,asin:cT,asinh:hT,atan:dT,atan2:fT,atanh:pT,avgPool:Wp,avgPool3d:gT,backend:nT,backend_util:ZL,basicLSTMCell:oF,batchNorm:lh,batchNorm2d:yT,batchNorm3d:bT,batchNorm4d:xT,batchToSpaceND:Gp,bincount:vT,bitwiseAnd:lF,booleanMaskAsync:HF,broadcastArgs:uF,broadcastTo:ll,broadcast_util:o9,browser:EQ,buffer:Ht,cast:Tt,ceil:wT,clipByValue:xs,clone:da,complex:si,concat:Qe,concat1d:ST,concat2d:TT,concat3d:NT,concat4d:CT,conv1d:Ib,conv2d:ri,conv2dTranspose:Ab,conv3d:$T,conv3dTranspose:ET,copyRegisteredKernels:R8,cos:jp,cosh:Rb,cosineWindow:ex,cumprod:vf,cumsum:Db,customGrad:va,denseBincount:zy,deprecationWarn:cq,depthToSpace:IT,depthwiseConv2d:uh,device_util:rq,diag:hF,dilation2d:AT,disableDeprecationWarnings:uq,dispose:Yt,disposeVariables:hq,div:Ot,divNoNan:RT,dot:DT,dropout:iN,einsum:Zo,elu:ch,enableDebugMode:lq,enableProdMode:oq,enclosingPowerOfTwo:oN,engine:Lr,ensureShape:dF,env:lt,equal:Cr,erf:Ob,euclideanNorm:_T,exp:vs,expandDims:Kn,expm1:FT,eye:_b,fft:rm,fill:Rl,findBackend:yq,findBackendFactory:bq,floor:dh,floorDiv:$b,fused:eL,gather:fh,gatherND:YF,gather_util:IQ,getBackend:H3,getGradient:sS,getKernel:pf,getKernelsForBackend:Ly,grad:G9,grads:j9,greater:Ts,greaterEqual:fi,ifft:tc,imag:Hp,image:Pr,inTopKAsync:ZF,io:xN,irfft:Xb,isFinite:LT,isInf:MT,isNaN:zT,keep:pn,kernel_impls:PQ,leakyRelu:qp,less:Yu,lessEqual:yo,linalg:cN,linspace:mF,localResponseNormalization:PT,log:Fs,log1p:Kp,logSigmoid:BT,logSoftmax:Lb,logSumExp:Xp,logicalAnd:Gr,logicalNot:Yp,logicalOr:Mb,logicalXor:VT,losses:lL,lowerBound:yF,matMul:Xt,math:bQ,max:er,maxPool:Zp,maxPool3d:UT,maxPoolWithArgmax:bF,maximum:Na,mean:Be,memory:hS,meshgrid:xF,min:Xu,minimum:ao,mirrorPad:WT,mod:GT,moments:Qp,movingAverage:qF,mul:K,multiRNNCell:vF,multinomial:wF,neg:De,nextFrame:CN,norm:hh,notEqual:bl,oneHot:Zu,ones:ms,onesLike:Ls,op:G,outerProduct:SF,pad:pi,pad1d:TF,pad2d:NF,pad3d:CF,pad4d:kF,pool:jT,pow:xa,prelu:tm,print:iT,prod:HT,profile:dq,raggedGather:$F,raggedRange:EF,raggedTensorToTensor:IF,rand:AF,randomGamma:OF,randomNormal:Bb,randomStandardNormal:_F,randomUniform:bo,randomUniformInt:FF,range:xl,ready:mq,real:Qu,reciprocal:YT,registerBackend:eT,registerGradient:D3,registerKernel:Cb,relu:Xr,relu6:Vb,removeBackend:gq,reshape:Z,reverse:nr,reverse1d:LF,reverse2d:MF,reverse3d:zF,reverse4d:PF,rfft:am,round:Ub,rsqrt:Wb,scalar:Lt,scatterND:KF,scatter_util:XX,searchSorted:zb,selu:Gb,separableConv2d:jb,serialization:YZ,setBackend:pq,setPlatform:xq,setdiff1dAsync:BF,sigmoid:Vr,sign:ZT,signal:oL,sin:Hb,sinh:qb,slice:ae,slice1d:em,slice2d:Kb,slice3d:nm,slice4d:Ju,slice_util:CL,softmax:sm,softplus:Dl,spaceToBatchND:Jp,sparse:uL,sparseToDense:XF,spectral:iL,split:gs,sqrt:$n,square:Se,squaredDifference:Yb,squeeze:xo,stack:ws,step:Ol,stridedSlice:QT,string:cL,sub:Et,sum:It,sumOutType:kb,tan:JT,tanh:ro,tensor:Nr,tensor1d:Xn,tensor2d:Uu,tensor3d:tN,tensor4d:VF,tensor5d:UF,tensor6d:WF,tensorScatterUpdate:GF,tensor_util:J8,test_util:lX,tidy:it,tile:Qs,time:fq,topk:nN,train:Xo,transpose:ne,truncatedNormal:Qb,unique:sN,unregisterGradient:A8,unregisterKernel:I8,unsortedSegmentSum:Jb,unstack:sr,upcastType:ys,upperBound:jF,util:B8,valueAndGrad:H9,valueAndGrads:q9,variable:rN,variableGrads:gF,version_core:_Q,where:Ln,whereAsync:aN,zeros:un,zerosLike:ie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QL={kernelName:Mf,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(n,Ol(Tt(e,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VQ={kernelName:fc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const s=Se(Tt(e,"float32")),r=$n(Et(Lt(1),s));return De(Ot(n,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UQ={kernelName:pc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const s=$n(Et(Se(Tt(e,"float32")),1));return Ot(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WQ={kernelName:Al,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=jt(e.shape,s.shape);return{a:()=>{let o=n;const l=hn(e.shape,r);return l.length>0&&(o=It(o,l)),Z(o,e.shape)},b:()=>{let o=n;const l=hn(s.shape,r);return l.length>0&&(o=It(o,l)),Z(o,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GQ={kernelName:zf,saveAllInputs:!0,gradFunc:(n,t)=>{const e={};return t.forEach((s,r)=>{e[r]=()=>n.clone()}),e}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jQ={kernelName:Pf,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ie(e)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HQ={kernelName:Bf,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ie(e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qQ={kernelName:mc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ot(n,$n(Et(Lt(1),Se(Tt(e,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KQ={kernelName:gc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const s=$n(wt(Lt(1),Se(Tt(e,"float32"))));return Ot(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XQ={kernelName:xc,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=jt(e.shape,s.shape);return{a:()=>{const o=wt(Se(e),Se(s));let l=K(n,Ot(s,o));const c=hn(e.shape,r);return c.length>0&&(l=It(l,c)),Z(l,e.shape)},b:()=>{const o=wt(Se(e),Se(s));let l=De(K(n,Ot(e,o)));const c=hn(s.shape,r);return c.length>0&&(l=It(l,c)),Z(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YQ={kernelName:yc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ot(n,wt(Se(Tt(e,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZQ={kernelName:bc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ot(n,Et(Lt(1),Se(Tt(e,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQ(n,t,e,s,r,a){const i=M(n,"dy","avgPool3dGrad"),o=M(t,"input","avgPool3dGrad");let l=i,c=o,d=!1;o.rank===4&&(d=!0,l=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=Z(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),F(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),F(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),us("avgPool3dGrad",r,a);const f={dy:l,input:c},m={filterSize:e,strides:s,pad:r,dimRoundingMode:a},g=U.runKernel(T0,f,m);return d?Z(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const JQ=G({avgPool3dGrad_:QQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tJ={kernelName:Uf,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{filterSize:r,strides:a,pad:i,dimRoundingMode:o}=e;return{x:()=>JQ(n,s,r,a,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eJ(n,t,e,s,r){const a=M(n,"dy","avgPoolGrad"),i=M(t,"input","avgPoolGrad");F(i.rank===a.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${a.rank})`);let o=i,l=a,c=!1;i.rank===3&&(c=!0,o=Z(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),F(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),F(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const d={dy:l,input:o},f={filterSize:e,strides:s,pad:r},m=U.runKernel(S0,d,f);return c?Z(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const nJ=G({avgPoolGrad_:eJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sJ={kernelName:Vf,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{filterSize:r,strides:a,pad:i}=e;return{x:()=>nJ(n,s,r,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rJ={kernelName:Wf,inputsToSave:["a","b"],gradFunc:(n,t,e)=>{const[s,r]=t,{transposeA:a,transposeB:i}=e;return!a&&!i?{a:()=>Xt(n,r,!1,!0),b:()=>Xt(s,n,!0,!1)}:!a&&i?{a:()=>Xt(n,r,!1,!1),b:()=>Xt(n,s,!0,!1)}:a&&!i?{a:()=>Xt(r,n,!1,!0),b:()=>Xt(s,n,!1,!1)}:{a:()=>Xt(r,n,!0,!0),b:()=>Xt(n,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJ={kernelName:Gf,gradFunc:(n,t,e)=>{const{blockShape:s,crops:r}=e;return{x:()=>Jp(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iJ={kernelName:A3,gradFunc:(n,t,e)=>{const s=e,r=s.inputShape,a=s.shape,i=Array.from(a);for(let l=r.length-1;l>=0;l--)if(r[l]===a[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${a}].`);const o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>It(n,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oJ={kernelName:vc,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lJ={kernelName:wc,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uJ={kernelName:Sc,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{clipValueMin:r,clipValueMax:a}=e;return{x:()=>Ln(Gr(fi(s,r),yo(s,a)),n,ie(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cJ={kernelName:Hf,inputsToSave:["x"],gradFunc:QL.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hJ={kernelName:qf,saveAllInputs:!0,gradFunc:(n,t,e)=>{const s=t.map(l=>l.shape),{axis:r}=e,a=Zt(r,t[0].shape)[0],i=s.map(l=>l[a]);return gs(n,i,a).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dJ={kernelName:Kf,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[s,r]=t,{dilations:a,strides:i,pad:o,dataFormat:l}=e;return F(so(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>kT(s.shape,n,r,i,o,l),filter:()=>lN(s,n,r.shape,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fJ={kernelName:Xf,inputsToSave:["dy","filter"],gradFunc:(n,t,e)=>{const[s,r]=t,{strides:a,pad:i,dataFormat:o,dimRoundingMode:l}=e;return{dy:()=>ri(n,r,a,i,o,1,l),filter:()=>lN(n,s,r.shape,a,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pJ(n,t,e,s,r){let a=n;n.rank===4&&(a=Z(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let i=t;i.rank===4&&(i=Z(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),F(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),F(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),F(e.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`),F(a.shape[4]===e[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${e[3]}.`),F(i.shape[4]===e[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${e[4]}).`);const o={x:a,dy:i},l={strides:s,pad:r,filterShape:e};return U.runKernel(E0,o,l)}const mJ=G({conv3DBackpropFilter_:pJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gJ={kernelName:Yf,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:s,strides:r,pad:a}=e;F(so(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,o]=t;return{x:()=>cF(i.shape,n,o,r,a),filter:()=>mJ(i,n,o.shape,r,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yJ={kernelName:Tc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(De(Hb(Tt(e,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bJ={kernelName:Nc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(qb(Tt(e,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xJ={kernelName:Zf,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{axis:r,exclusive:a,reverse:i}=e;return{x:()=>{const o=We([r],s.rank);let l=Db(n,r,a,!i);return o!=null&&(l=ne(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vJ={kernelName:Qf,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:s,strides:r,pad:a,dimRoundingMode:i}=e,o=s??[1,1];F(so(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,c]=t;return F(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),F(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),F(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),F(Pn(r,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${o}'.`),us("depthwiseConv2d",a,i),{x:()=>tL(l.shape,n,c,r,a,o,i),filter:()=>JF(l,n,c.shape,r,a,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wJ={kernelName:Jf,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[s,r]=t,a={x:s,filter:r,dy:n},i={x:s,filter:r,dy:n};return{x:()=>U.runKernel(Oy,a,e),filter:()=>U.runKernel(_y,i,e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SJ={kernelName:kc,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t,s={dy:n,y:e};return{x:()=>U.runKernel(P0,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ={kernelName:$c,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,s=K(vs(De(Se(e))),2/Math.sqrt(Math.PI));return{x:()=>K(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NJ={kernelName:Ec,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(n,e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CJ={kernelName:ep,inputsToSave:["input"],gradFunc:(n,t)=>{const[e]=t;return{input:()=>Z(n,e.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kJ={kernelName:Ic,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(n,vs(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $J={kernelName:Ac,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJ={kernelName:Rc,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=jt(e.shape,s.shape);return{a:()=>{const o=Ot(n,Tt(s,"float32")),l=hn(e.shape,r);return l.length>0?Z(It(o,l),e.shape):o},b:()=>{let o=K(n,Tt(e,"float32"));const l=hn(s.shape,r);l.length>0&&(o=Z(It(o,l),s.shape));const c=Se(s);return De(Ot(o,Tt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IJ={kernelName:np,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,t,e)=>{const{varianceEpsilon:s}=e,[r,a,i,o]=t,l=o??Lt(1),c=hn(a.shape,r.shape),d=[];if(a.rank===1){for(let k=0;k<r.shape.length-1;++k)d.push(r.shape[k]);d.push(1)}const f=Et(r,a),m=K(n,l),g=Wb(wt(i,Lt(s))),b=K(K(K(g,g),g),Lt(-.5));return{x:()=>a.rank===1?Z(K(K(n,Qs(Z(g,[1,1,1,a.shape[0]]),d)),l),r.shape):Z(K(K(n,g),l),r.shape),mean:()=>{let k=K(K(g,Lt(-1)),m);return a.rank===1&&(k=It(k,c)),Z(k,a.shape)},variance:()=>{let k=K(K(b,f),m);return a.rank===1&&(k=It(k,c)),Z(k,a.shape)},scale:()=>{const k=K(f,g);let $=K(n,k);return a.rank===1&&($=It($,c)),Z($,a.shape)},offset:()=>{let k=n;return a.rank===1&&(k=It(k,c)),Z(k,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AJ={kernelName:sp,inputsToSave:["x","indices"],gradFunc:(n,t,e)=>{const[s,r]=t,{axis:a,batchDims:i}=e,o=Zt(a,s.shape)[0],l=(c,d,f)=>()=>{const m=c.shape,g=d.size,b=m.slice(0,o),x=b.length,v=m.slice(a,m.length).slice(1),w=v.length,T=LR(0,x),C=LR(x+1,x+1+w),k=MR([b,[g],v]),$=Z(f,k),I=Z(d,[g]),D=MR([[x],T,C]),_=ne($,D);let O=Jb(_,I,c.shape[o]);const L=go(D);return O=ne(O,L),O};if(i===1){const c=s.shape[0],d=s.split(c,0);return{x:()=>ws(d.map((g,b)=>l(g,r.slice(b,1),n.slice(b,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,n),indices:()=>r}}};function LR(n,t){const e=[];for(let s=n;s<t;++s)e.push(s);return e}function MR(n){const t=[];for(let e=0;e<n.length;++e)for(let s=0;s<n[e].length;++s)t.push(n[e][s]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RJ={kernelName:Dc,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t;return{a:()=>ie(e),b:()=>ie(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DJ={kernelName:Oc,gradFunc:n=>({x:()=>Tt(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OJ={kernelName:_c,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _J={kernelName:Fc,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FJ={kernelName:Lc,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LJ={kernelName:ap,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{alpha:r}=e,a=Ts(s,0);return{x:()=>Ln(a,n,K(n,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MJ={kernelName:zc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ot(n,wt(e,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zJ={kernelName:Mc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ot(n,Tt(e,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PJ={kernelName:R3,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s]=t,{axis:r}=e;return{logits:()=>{const i=vs(s);return Et(n,K(It(n,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BJ(n,t,e,s=5,r=1,a=1,i=.5){const o={x:n,y:t,dy:e},l={depthRadius:s,bias:r,alpha:a,beta:i};return U.runKernel(q0,o,l)}const VJ=G({localResponseNormalizationBackprop_:BJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UJ={kernelName:hp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s,r]=t,{depthRadius:a,bias:i,alpha:o,beta:l}=e;return{x:()=>VJ(s,r,n,a,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JL(n,t,e,s){return t.rank<e.rank&&(t=Z(t,Je(t.shape,s))),n.rank<e.rank&&(n=Z(n,Je(n.shape,s))),{x:()=>K(n,Tt(Cr(e,t),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zR={kernelName:dp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const s=e,{reductionIndices:r}=s,a=t[0],i=t[1],o=Zt(r,a.shape),l=JL(n,i,a,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WJ={kernelName:Pc,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t;return{a:()=>K(n,Tt(fi(e,s),"float32")),b:()=>K(n,Tt(Yu(e,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GJ(n,t,e,s,r,a,i){const o=M(n,"dy","maxPool3dGrad"),l=M(t,"input","maxPool3dGrad"),c=M(e,"output","maxPool3dGrad");let d=o,f=l,m=c,g=!1;l.rank===4&&(g=!0,d=Z(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),f=Z(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),m=Z(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),F(d.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${d.rank}.`),F(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),F(m.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${m.rank}.`),us("maxPool3dGrad",a,i);const b={dy:d,input:f,output:m},x={filterSize:s,strides:r,pad:a,dimRoundingMode:i},v=U.runKernel(X0,b,x);return g?Z(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const jJ=G({maxPool3dGrad_:GJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HJ={kernelName:pp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s,r]=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=e;return{x:()=>jJ(n,s,r,a,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qJ(n,t,e,s,r,a,i){const o=M(n,"dy","maxPoolGrad"),l=M(t,"input","maxPoolGrad"),c=M(e,"output","maxPoolGrad");F(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),F(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),F(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),us("maxPoolGrad",a,i);const d={dy:o,input:l,output:c},f={filterSize:s,strides:r,pad:a,dimRoundingMode:i};return U.runKernel(K0,d,f)}const KJ=G({maxPoolGrad_:qJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XJ={kernelName:fp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s,r]=t,{filterSize:a,strides:i,pad:o}=e;return{x:()=>KJ(n,s,r,a,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YJ={kernelName:mp,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{axis:r}=e,a=Zt(r,s.shape),o=In(s.shape,a)[1],l=ft(o);return{x:()=>{const d=s.shape.slice();a.forEach(g=>{d[g]=1});const f=Z(n,d);return Ot(K(f,ms(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZJ={kernelName:gp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const s=e,{axis:r}=s,[a,i]=t,o=Zt(r,a.shape),l=JL(n,i,a,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QJ={kernelName:Bc,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t;return{a:()=>K(n,Tt(yo(e,s),"float32")),b:()=>K(n,Tt(Ts(e,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JJ={kernelName:yp,inputsToSave:["x"],gradFunc:(n,t,e)=>{const s=t[0],{paddings:r}=e,a=r.map(i=>i[0]);return{x:()=>ae(n,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ttt={kernelName:Vc,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=jt(e.shape,s.shape);return{a:()=>{const o=hn(e.shape,r);return o.length>0?Z(It(n,o),e.shape):n},b:()=>{const o=K(n,De(dh(Ot(e,s)))),l=hn(s.shape,r);return l.length>0?Z(It(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ett={kernelName:Uc,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=jt(e.shape,s.shape);return{a:()=>{const o=K(n,Tt(s,"float32")),l=hn(e.shape,r);return l.length>0?Z(It(o,l),e.shape):o},b:()=>{const o=K(n,Tt(e,"float32")),l=hn(s.shape,r);return l.length>0?Z(It(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ntt={kernelName:bp,gradFunc:n=>({x:()=>De(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const stt={kernelName:wp,inputsToSave:["indices"],gradFunc:(n,t)=>{const e=t[0];return{indices:()=>un(e.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rtt={kernelName:vp,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const att={kernelName:Sp,saveAllInputs:!0,gradFunc:(n,t,e)=>{const{axis:s}=e;return sr(n,s).map(a=>()=>a)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PR={kernelName:Tp,inputsToSave:["x"],gradFunc:(n,t,e)=>{const s=t[0],{paddings:r}=e,a=r.map(i=>i[0]);return{x:()=>ae(n,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const itt={kernelName:Wc,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,t)=>{const[e,s,r]=t,a=e,i=s,o=jt(a.shape,i.shape);return{a:()=>{const d=Tt(i,"float32");let f=K(n,K(d,xa(a,Et(d,Lt(1)))));const m=hn(a.shape,o);return m.length>0&&(f=It(f,m)),Z(f,a.shape)},b:()=>{const d=Ts(a,0),f=Ln(d,Fs(a),ie(a));let m=K(n,K(r,f));const g=hn(i.shape,o);return g.length>0&&(m=It(m,g)),Z(m,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ott={kernelName:Np,inputsToSave:["x","alpha"],gradFunc:(n,t)=>{const[e,s]=t,r=Ts(e,0);return{x:()=>Ln(r,n,K(n,s)),alpha:()=>{let a=Ln(r,ie(n),K(n,e));const i=hn(s.shape,n.shape);return i.length>0&&(a=It(a,i)),Z(a,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ltt(n,t,e){const s=n.shape.slice();s[e]=1;const r=Z(t,s),a=vf(n,e,!0,!1),i=vf(n,e,!0,!0),o=K(a,i);return K(r,o)}function utt(n,t,e){const s=n.shape.length,r=s-e.length,a=We(e,s);let i=n;a!=null&&(i=ne(n,a));const o=i.shape.slice(),c=o.splice(s-e.length,e.length).reduce((m,g)=>m*g,1);o.push(c);const d=i.reshape(o);let f=ltt(d,t,r);if(f=f.reshape(i.shape),a!=null){const m=go(a);f=ne(f,m)}return f}const ctt={kernelName:Cp,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{axis:r}=e;let a=[];return r==null?a=s.shape.map((i,o)=>o):typeof r=="number"?a=[r]:a=r,{x:()=>utt(s,n,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const htt={kernelName:Cc,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=jt(e.shape,s.shape);return{a:()=>{const o=Ot(n,Tt(s,"float32")),l=hn(e.shape,r);return l.length>0?Z(It(o,l),e.shape):o},b:()=>{let o=K(n,Tt(e,"float32"));const l=hn(s.shape,r);l.length>0&&(o=Z(It(o,l),s.shape));const c=Se(s);return De(Ot(o,Tt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dtt={kernelName:Gc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ot(n,De(Se(e)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ftt={kernelName:Hc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,s=K(yo(e,6),Ol(e));return{x:()=>K(n,Tt(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ptt={kernelName:jc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(n,Tt(Ol(e),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mtt={kernelName:kp,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Z(n,e.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gtt={kernelName:Ep,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[s]=t,r={dy:n,images:s};return{images:()=>U.runKernel(ob,r,e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ytt={kernelName:$p,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[s]=t,r={dy:n,images:s};return{images:()=>U.runKernel(ib,r,e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const btt={kernelName:Ip,gradFunc:(n,t,e)=>{const{dims:s}=e,r=Zt(s,n.shape);return{x:()=>nr(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xtt={kernelName:qc,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vtt={kernelName:Kc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>De(Ot(n,K(xa(e,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wtt={kernelName:Ap,inputsToSave:["condition"],gradFunc:(n,t)=>{const[e]=t;return{condition:()=>Tt(ie(e),"float32"),t:()=>K(n,Tt(e,n.dtype)),e:()=>K(n,Tt(Yp(e),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Stt={kernelName:Xc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const s=Ts(e,Lt(0)),r=Lt(fx),a=Lt(px),i=K(n,a),o=K(K(n,r),vs(Tt(e,"float32")));return Ln(s,i,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ttt={kernelName:Jc,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(n,K(e,Et(Lt(1),e)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ntt={kernelName:Qc,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ctt={kernelName:Yc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(jp(Tt(e,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ktt={kernelName:Zc,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(Rb(Tt(e,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $tt={kernelName:Rp,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{begin:r,size:a}=e,i=s.shape,[o,l]=hx(s,r,a),c=[];for(let d=0;d<n.rank;d++)c.push([o[d],i[d]-o[d]-l[d]]);return{x:()=>pi(n,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ett={kernelName:Fp,outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s]=t,{dim:r}=e,a=!0,i=K(n,s);return{logits:()=>Et(i,K(It(i,[r],a),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Itt={kernelName:th,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(n,Vr(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BR={kernelName:Op,gradFunc:(n,t,e)=>{const{blockShape:s,paddings:r}=e;return{x:()=>Gp(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VR={kernelName:_p,gradFunc:(n,t,e)=>{const{axis:s}=e;return{x:()=>Qe(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Att={kernelName:eh,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ot(n,K($n(Tt(e,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rtt={kernelName:gb,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(n,K(Tt(e,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dtt={kernelName:nh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=Lt(2);return{a:()=>K(n,K(r,Et(e,s))),b:()=>K(n,K(r,Et(s,e)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ott={kernelName:oh,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _tt={kernelName:sh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=jt(e.shape,s.shape);return{a:()=>{let o=n;const l=hn(e.shape,r);return l.length>0&&(o=It(o,l)),Z(o,e.shape)},b:()=>{let o=n;const l=hn(s.shape,r);return l.length>0&&(o=It(o,l)),Z(De(o),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ftt={kernelName:Dp,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,r=s.shape.slice(),{axis:a}=e;Zt(a,s.shape).forEach(c=>{r[c]=1});const o=Z(n,r),l=K(o,ms(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ltt={kernelName:rh,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Ot(n,Se(jp(e)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mtt={kernelName:ah,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>K(Et(Lt(1),Se(e)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ztt={kernelName:ih,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{reps:r}=e;return{x:()=>{let i=ie(s);if(s.rank===1)for(let o=0;o<r[0];++o)i=wt(i,ae(n,[o*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)i=wt(i,ae(n,[o*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)i=wt(i,ae(n,[o*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let d=0;d<r[3];++d)i=wt(i,ae(n,[o*s.shape[0],l*s.shape[1],c*s.shape[2],d*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ptt={kernelName:ol,gradFunc:(n,t,e)=>{const s=e,{perm:r}=s,a=go(r);return{x:()=>ne(n,a)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Btt={kernelName:Mp,gradFunc:(n,t,e)=>{const s=e,{axis:r}=s;return{value:()=>ws(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vtt={kernelName:zp,inputsToSave:["segmentIds"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Utt(n,e)}}};function Utt(n,t){const e=Na(t,ie(t)),s=fh(n,e);let r=fi(t,Lt(0,"int32"));const a=s.rank-r.rank;for(let o=0;o<a;++o)r=Kn(r,o+1);r=Gr(r,ms(s.shape,"bool"));const i=ie(s);return Ln(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wtt={kernelName:Pp,gradFunc:n=>({x:()=>ie(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gtt=[QL,VQ,UQ,WQ,GQ,jQ,HQ,qQ,KQ,XQ,YQ,ZQ,tJ,sJ,rJ,aJ,iJ,oJ,lJ,uJ,cJ,hJ,fJ,dJ,gJ,yJ,bJ,xJ,vJ,wJ,htt,SJ,TJ,NJ,CJ,kJ,EJ,$J,IJ,AJ,RJ,DJ,OJ,_J,FJ,LJ,MJ,zJ,PJ,UJ,zR,zR,WJ,HJ,XJ,YJ,ZJ,QJ,JJ,ttt,ett,ntt,stt,rtt,att,PR,PR,itt,ott,ctt,dtt,ftt,ptt,mtt,gtt,ytt,btt,xtt,vtt,wtt,Stt,Ttt,Ntt,Ctt,ktt,$tt,Ett,Itt,BR,BR,VR,VR,Att,Dtt,Rtt,Ott,_tt,Ftt,Ltt,Mtt,ztt,Ptt,Btt,Vtt,Wtt];for(const n of Gtt)D3(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.abs=function(){return this.throwIfDisposed(),ln(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.acos=function(){return this.throwIfDisposed(),oT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.acosh=function(){return this.throwIfDisposed(),lT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.add=function(n){return this.throwIfDisposed(),wt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.all=function(n,t){return this.throwIfDisposed(),Eb(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.any=function(n,t){return this.throwIfDisposed(),yf(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.argMax=function(n){return this.throwIfDisposed(),ml(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.argMin=function(n){return this.throwIfDisposed(),uT(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.asScalar=function(){return this.throwIfDisposed(),F(this.size===1,()=>"The array must have only 1 element."),Z(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.asType=function(n){return this.throwIfDisposed(),Tt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.as1D=function(){return this.throwIfDisposed(),Z(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.as2D=function(n,t){return this.throwIfDisposed(),Z(this,[n,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.as3D=function(n,t,e){return this.throwIfDisposed(),Z(this,[n,t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.as4D=function(n,t,e,s){return this.throwIfDisposed(),Z(this,[n,t,e,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.as5D=function(n,t,e,s,r){return this.throwIfDisposed(),Z(this,[n,t,e,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.asin=function(){return this.throwIfDisposed(),cT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.asinh=function(){return this.throwIfDisposed(),hT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.atan=function(){return this.throwIfDisposed(),dT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.atan2=function(n){return this.throwIfDisposed(),fT(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.atanh=function(){return this.throwIfDisposed(),pT(this)};pt().prototype.avgPool=function(n,t,e,s){return this.throwIfDisposed(),Wp(this,n,t,e,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.batchToSpaceND=function(n,t){return this.throwIfDisposed(),Gp(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.batchNorm=function(n,t,e,s,r){return this.throwIfDisposed(),lh(this,n,t,e,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.broadcastTo=function(n){return this.throwIfDisposed(),ll(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.cast=function(n){return this.throwIfDisposed(),Tt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.ceil=function(){return this.throwIfDisposed(),wT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.clipByValue=function(n,t){return this.throwIfDisposed(),xs(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.concat=function(n,t){return this.throwIfDisposed(),n instanceof ge&&(n=[n]),Qe([this,...n],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.conv1d=function(n,t,e,s,r,a){return this.throwIfDisposed(),Ib(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.conv2dTranspose=function(n,t,e,s,r){return this.throwIfDisposed(),Ab(this,n,t,e,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.conv2d=function(n,t,e,s,r,a){return this.throwIfDisposed(),ri(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.cos=function(){return this.throwIfDisposed(),jp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.cosh=function(){return this.throwIfDisposed(),Rb(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.cumprod=function(n,t,e){return this.throwIfDisposed(),vf(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.cumsum=function(n,t,e){return this.throwIfDisposed(),Db(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.depthToSpace=function(n,t){return this.throwIfDisposed(),IT(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.depthwiseConv2d=function(n,t,e,s,r,a){return this.throwIfDisposed(),uh(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.dilation2d=function(n,t,e,s,r){return this.throwIfDisposed(),AT(this,n,t,e,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.divNoNan=function(n){return this.throwIfDisposed(),RT(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.div=function(n){return this.throwIfDisposed(),Ot(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.dot=function(n){return this.throwIfDisposed(),DT(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.elu=function(){return this.throwIfDisposed(),ch(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.equal=function(n){return this.throwIfDisposed(),Cr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.erf=function(){return this.throwIfDisposed(),Ob(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.euclideanNorm=function(n,t){return this.throwIfDisposed(),_T(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.exp=function(){return this.throwIfDisposed(),vs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.expandDims=function(n){return this.throwIfDisposed(),Kn(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.expm1=function(){return this.throwIfDisposed(),FT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.fft=function(){return this.throwIfDisposed(),rm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.flatten=function(){return this.throwIfDisposed(),Z(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.floor=function(){return this.throwIfDisposed(),dh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.floorDiv=function(n){return this.throwIfDisposed(),$b(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.gather=function(n,t,e){return this.throwIfDisposed(),fh(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.greaterEqual=function(n){return this.throwIfDisposed(),fi(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.greater=function(n){return this.throwIfDisposed(),Ts(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.ifft=function(){return this.throwIfDisposed(),tc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.irfft=function(){return this.throwIfDisposed(),Xb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.isFinite=function(){return this.throwIfDisposed(),LT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.isInf=function(){return this.throwIfDisposed(),MT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.isNaN=function(){return this.throwIfDisposed(),zT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.leakyRelu=function(n){return this.throwIfDisposed(),qp(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.lessEqual=function(n){return this.throwIfDisposed(),yo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.less=function(n){return this.throwIfDisposed(),Yu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.localResponseNormalization=function(n,t,e,s){return this.throwIfDisposed(),PT(this,n,t,e,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.logSigmoid=function(){return this.throwIfDisposed(),BT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.logSoftmax=function(n){return this.throwIfDisposed(),Lb(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.logSumExp=function(n,t){return this.throwIfDisposed(),Xp(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.log=function(){return this.throwIfDisposed(),Fs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.log1p=function(){return this.throwIfDisposed(),Kp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.logicalAnd=function(n){return this.throwIfDisposed(),Gr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.logicalNot=function(){return this.throwIfDisposed(),Yp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.logicalOr=function(n){return this.throwIfDisposed(),Mb(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.logicalXor=function(n){return this.throwIfDisposed(),VT(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.matMul=function(n,t,e){return this.throwIfDisposed(),Xt(this,n,t,e)};pt().prototype.maxPool=function(n,t,e,s){return this.throwIfDisposed(),Zp(this,n,t,e,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.max=function(n,t){return this.throwIfDisposed(),er(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.maximum=function(n){return this.throwIfDisposed(),Na(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.mean=function(n,t){return this.throwIfDisposed(),Be(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.min=function(n,t){return this.throwIfDisposed(),Xu(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.minimum=function(n){return this.throwIfDisposed(),ao(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.mirrorPad=function(n,t){return this.throwIfDisposed(),WT(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.mod=function(n){return this.throwIfDisposed(),GT(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.mul=function(n){return this.throwIfDisposed(),K(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.neg=function(){return this.throwIfDisposed(),De(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.norm=function(n,t,e){return this.throwIfDisposed(),hh(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.notEqual=function(n){return this.throwIfDisposed(),bl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.oneHot=function(n,t=1,e=0){return this.throwIfDisposed(),Zu(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.onesLike=function(){return this.throwIfDisposed(),Ls(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.pad=function(n,t){return this.throwIfDisposed(),pi(this,n,t)};pt().prototype.pool=function(n,t,e,s,r,a){return this.throwIfDisposed(),jT(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.pow=function(n){return this.throwIfDisposed(),xa(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.prelu=function(n){return this.throwIfDisposed(),tm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.prod=function(n,t){return this.throwIfDisposed(),HT(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.reciprocal=function(){return this.throwIfDisposed(),YT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.relu=function(){return this.throwIfDisposed(),Xr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.relu6=function(){return this.throwIfDisposed(),Vb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.reshapeAs=function(n){return this.throwIfDisposed(),Z(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.reshape=function(n){return this.throwIfDisposed(),Z(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.resizeBilinear=function(n,t,e){return this.throwIfDisposed(),rL(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.resizeNearestNeighbor=function(n,t,e){return this.throwIfDisposed(),aL(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.reverse=function(n){return this.throwIfDisposed(),nr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.rfft=function(){return this.throwIfDisposed(),am(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.round=function(){return this.throwIfDisposed(),Ub(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.rsqrt=function(){return this.throwIfDisposed(),Wb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.selu=function(){return this.throwIfDisposed(),Gb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.separableConv2d=function(n,t,e,s,r,a){return this.throwIfDisposed(),jb(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.sigmoid=function(){return this.throwIfDisposed(),Vr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.sign=function(){return this.throwIfDisposed(),ZT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.sin=function(){return this.throwIfDisposed(),Hb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.sinh=function(){return this.throwIfDisposed(),qb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.slice=function(n,t){return this.throwIfDisposed(),ae(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.softmax=function(n){return this.throwIfDisposed(),sm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.softplus=function(){return this.throwIfDisposed(),Dl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.spaceToBatchND=function(n,t){return this.throwIfDisposed(),Jp(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.split=function(n,t){return this.throwIfDisposed(),gs(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.sqrt=function(){return this.throwIfDisposed(),$n(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.square=function(){return this.throwIfDisposed(),Se(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.squaredDifference=function(n){return this.throwIfDisposed(),Yb(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.squeeze=function(n){return this.throwIfDisposed(),xo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.stack=function(n,t){this.throwIfDisposed();const e=n instanceof ge?[this,n]:[this,...n];return ws(e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.step=function(n){return this.throwIfDisposed(),Ol(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.stridedSlice=function(n,t,e,s,r,a,i,o){return this.throwIfDisposed(),QT(this,n,t,e,s,r,a,i,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.sub=function(n){return this.throwIfDisposed(),Et(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.sum=function(n,t){return this.throwIfDisposed(),It(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.tan=function(){return this.throwIfDisposed(),JT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.tanh=function(){return this.throwIfDisposed(),ro(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.tile=function(n){return this.throwIfDisposed(),Qs(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.toBool=function(){return this.throwIfDisposed(),Tt(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.toFloat=function(){return this.throwIfDisposed(),Tt(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.toInt=function(){return this.throwIfDisposed(),Tt(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.topk=function(n,t){return this.throwIfDisposed(),nN(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.transpose=function(n){return this.throwIfDisposed(),ne(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.unique=function(n){return this.throwIfDisposed(),sN(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.unsortedSegmentSum=function(n,t){return this.throwIfDisposed(),Jb(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.unstack=function(n){return this.throwIfDisposed(),sr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.where=function(n,t){return this.throwIfDisposed(),Ln(n,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pt().prototype.zerosLike=function(){return this.throwIfDisposed(),ie(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sa extends Error{constructor(t){super(t),Object.setPrototypeOf(this,sa.prototype)}}class wr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,wr.prototype)}}class J extends Error{constructor(t){super(t),Object.setPrototypeOf(this,J.prototype)}}class qt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,qt.prototype)}}class jN extends Error{constructor(t){super(t),Object.setPrototypeOf(this,jN.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class tM{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wl(n,t){if(Array.isArray(n)){let e=[];for(let s=0;s<t;s++)e=e.concat(n);return e}else{const e=new Array(t);return e.fill(n),e}}function ra(n,t){if(!n)throw new jN(t)}function UR(n,t){let e=0;for(const s of n)s===t&&e++;return e}function fs(n){return n.length===1?n[0]:n}function ye(n){return Array.isArray(n)?n:[n]}function Ga(n){const e=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return e[0]!=="_"?e:"private"+e}function Qo(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}let gr={};function HN(n){if(n==null)return null;const t={};return t.className=n.getClassName(),t.config=n.getConfig(),t}function TS(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(t=>TS(t));else{const t=Object.keys(n);for(const e of t){const s=n[e];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[e]=s.value:TS(s))}}}function um(n,t={},e={},s="object",r=!1){if(typeof n=="string"){const a=n;let i;if(a in e)i=e[a];else if(a in gr)i=gr[a];else if(i=t[a],i==null)throw new J(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const a=n;if(a.className==null||a.config==null)throw new J(`${s}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);const i=a.className;let o,l;if(i in e?[o,l]=e[i]:i in gr?[o,l]=gr.className:i in t&&([o,l]=t[i]),o==null)throw new J(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const g of Object.keys(gr))c[g]=gr[g];for(const g of Object.keys(e))c[g]=e[g];const d=a.config;d.customObjects=c;const f=Object.assign({},gr);for(const g of Object.keys(e))gr[g]=e[g];TS(a.config);const m=l(o,a.config,e,r);return gr=Object.assign({},f),m}else{const c=Object.assign({},gr);for(const f of Object.keys(e))gr[f]=e[f];const d=new o(a.config);return gr=Object.assign({},c),d}}}function jtt(n,t){return n<t?-1:n>t?1:0}function Gg(n,t){return-1*jtt(n,t)}function Ki(n){if(n==null)return n;const t=[];for(const e of n)t.indexOf(e)===-1&&t.push(e);return t}function Htt(n){if(n==null)throw new J(`Invalid value in obj: ${JSON.stringify(n)}`);for(const t in n)if(n.hasOwnProperty(t))return!1;return!0}function Fl(n,t,e){if(e!=null&&n.indexOf(e)<0)throw new J(`${e} is not a valid ${t}.  Valid values are ${n} or null/undefined.`)}function qN(n,t,e=0,s=1/0){return ra(e>=0),ra(s>=e),Array.isArray(n)&&n.length>=e&&n.length<=s&&n.every(r=>typeof r===t)}function Cn(n,t){Array.isArray(n)?(F(n.length>0,()=>`${t} is unexpectedly an empty array.`),n.forEach((e,s)=>Cn(e,`element ${s+1} of ${t}`))):F(Number.isInteger(n)&&n>0,()=>`Expected ${t} to be a positive integer, but got ${eM(n)}.`)}function eM(n){return n===null?"null":Array.isArray(n)?"["+n.map(t=>eM(t)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function qtt(n,t,e){let s=e!=null?e():ns(),r;return(...i)=>{const o=e!=null?e():ns();return o-s<t||(s=o,r=n(...i)),r}}function nM(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Ktt=0;function sM(){return Ktt++}const jg={};function mx(n=""){return n in jg||(jg[n]=0),jg[n]+=1,n+jg[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Xtt=["channelsFirst","channelsLast"],Ytt=["nearest","bilinear"],Ztt=["valid","same","causal"],Qtt=["max","avg"],Jtt=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Eu=new Map;function en(n){Fl(Xtt,"DataFormat",n)}function tet(n){Fl(Ytt,"InterpolationFormat",n)}function rr(n){Fl(Ztt,"PaddingMode",n)}function rM(n){Fl(Qtt,"PoolMode",n)}const Xd=[],WR="/";function ul(n,t){Xd.push(n);try{const e=t();return Xd.pop(),e}catch(e){throw Xd.pop(),e}}function eet(){return Xd.length===0?"":Xd.join(WR)+WR}function aM(n){if(!oM(n))throw new Error("Not a valid tensor name: '"+n+"'");return eet()+n}function iM(n){if(!oM(n))throw new Error("Not a valid tensor name: '"+n+"'");Eu.has(n)||Eu.set(n,0);const t=Eu.get(n);if(Eu.set(n,Eu.get(n)+1),t>0){const e=`${n}_${t}`;return Eu.set(e,1),e}else return n}const net=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function oM(n){return!!n.match(net)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function set(n){return n===parseInt(n.toString(),10)}function Xi(n,t,e){t==null&&(t=0),e==null&&(e=n.length);let s=1;for(let r=t;r<e;++r)s*=n[r];return s}function ec(n){if(n.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let e=0;e<n.length;e++){const s=n[e];s<t&&(t=s)}return t}function io(n){if(n.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let e=0;e<n.length;e++){const s=n[e];s>t&&(t=s)}return t}function jr(n,t){if(t<n)throw new J(`end (${t}) < begin (${n}) is forbidden.`);const e=[];for(let s=n;s<t;++s)e.push(s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let bw;function mn(){return bw==null&&(bw=nT().epsilon()),bw}function Hr(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pa(n,t){return Tt(n,t)}function cm(n,t=-1){const e=n.shape.slice();return t<0&&(t=e.length+t+1),e.splice(t,0,1),Z(n,e)}function ret(n,t){return it(()=>{if(n.shape.length!==2)throw new J(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const e=cm(n,1);return NS(e,[1,t,1])})}function aet(n){const t=[Xi(n.shape)];return Z(n,t)}function iet(n){if(n.rank<=1)throw new J(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const t=[n.shape[0],Xi(n.shape,1)];return Z(n,t)}function cl(n,t,e){return it(()=>{switch(n.rank){case 1:return em(n,t,e);case 2:return Kb(n,[t,0],[e,n.shape[1]]);case 3:return nm(n,[t,0,0],[e,n.shape[1],n.shape[2]]);case 4:return Ju(n,[t,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3]]);case 5:return ae(n,[t,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return ae(n,[t,0,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new J(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function xw(n,t,e){return it(()=>{switch(n.rank){case 1:return em(n,t,e);case 2:return Kb(n,[0,t],[n.shape[0],e]);case 3:return nm(n,[0,0,t],[n.shape[0],n.shape[1],e]);case 4:return Ju(n,[0,0,0,t],[n.shape[0],n.shape[1],n.shape[2],e]);default:throw new J(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Hg(n,t,e,s){return it(()=>{switch(n.rank){case 1:return em(n,t,e);case 2:switch(s){case 1:return cl(n,t,e);case 2:return xw(n,t,e);default:throw new J(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return cl(n,t,e);case 2:return nm(n,[0,t,0],[n.shape[0],e,n.shape[2]]);case 3:return xw(n,t,e);default:throw new J(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return cl(n,t,e);case 2:return Ju(n,[0,t,0,0],[n.shape[0],e,n.shape[2],n.shape[3]]);case 3:return Ju(n,[0,0,t,0],[n.shape[0],n.shape[1],e,n.shape[3]]);case 4:return xw(n,t,e);default:throw new J(`The axis is not within the rank of the tensor ${s}`)}default:throw new J(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function KN(n,t=-1){let e;return t<0&&(e=n[0].rank,e!==0?t=e:t=0),t===n[0].rank&&(t=-1),Qe(n,t)}function GR(n,t){switch(n.rank){case 1:return ST([n,t]);case 2:return TT([n,t],0);case 3:return NT([n,t],0);case 4:return CT([n,t],0);default:throw new J(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function NS(n,t){if(Array.isArray(t)||(t=[t]),n.rank!==t.length)throw new J(`The length of input n (${t.length}) does not match the number of dimensions in input x (${n.rank})`);return Qs(n,t)}function gx(n,t=0,e=1,s,r){return Bb(n,t,e,s,r)}function ma(n,t,e,s){if(n.rank<2||t.rank<2)throw new qt(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${t.shape}`);if(t.rank>=3){const r=n.shape.slice(-1)[0],a=t.shape.slice(-2)[0];if(r!==a)throw new qt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${t.shape}`)}if(n.rank===2&&t.rank===2)return bS({a:n,b:t,transposeA:!1,transposeB:!1,bias:s?CS(n.rank,s,Hr()):null,activation:e});{const r=n.shape.slice(),a=r.pop();n=Z(n,[-1,a]);const i=t.shape.slice(),o=i.pop(),l=i.pop(),c=[...i,o],d=Array.from({length:t.rank},(b,x)=>x===0?t.rank-2:x<=t.rank-2?x-1:x);t=Z(ne(t,d),[l,-1]);const f=[...r,...c];return Z(bS({a:n,b:t,transposeA:!1,transposeB:!1,bias:s?CS(n.rank,s,Hr()):null,activation:e}),f)}}function lM(n,t,e){return it(()=>(Array.isArray(t)?t=Xn(t,"int32"):t=Tt(t,"int32"),fh(n,t,e)))}function hm(n){return K(n,n)}function CS(n,t,e){const s=t.shape;if(t.rank!==1&&t.rank!==n)throw new J(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${n}`);if(n===5){if(e==="channelsFirst")return s.length===1?Z(t,[1,s[0],1,1,1]):Z(t,[1,s[3],s[0],s[1],s[2]]);if(e==="channelsLast")return s.length===1?Z(t,[1,1,1,1,s[0]]):Z(t,[1].concat(s))}else if(n===4){if(e==="channelsFirst")return s.length===1?Z(t,[1,s[0],1,1]):Z(t,[1,s[2],s[0],s[1]]);if(e==="channelsLast")return s.length===1?Z(t,[1,1,1,s[0]]):Z(t,[1].concat(s))}else if(n===3){if(e==="channelsFirst")return s.length===1?Z(t,[1,s[0],1]):Z(t,[1,s[1],s[0]]);if(e==="channelsLast")return s.length===1?Z(t,[1,1,s[0]]):Z(t,[1].concat(s))}else if(n<3)return t;throw new J(`Unsupported input rank by biasAdd: ${t.rank}`)}function Yr(n,t,e){return it(()=>(e==null&&(e=Hr()),en(e),wt(n,CS(n.rank,t,e))))}function oet(n,t=1){if(t!==1)throw new qt(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return ch(n)}function uet(n){return it(()=>Ot(n,wt(ln(n),1)))}function uM(n,t,e,s){return it(()=>iN(n,t,e,s))}function cet(n){return it(()=>{const t=wt(.5,K(.2,n));return xs(t,0,1)})}function dm(n,t,e=!1){return e?n():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const het=["fanIn","fanOut","fanAvg"],det=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fet(n){Fl(het,"FanMode",n)}function pet(n){Fl(det,"Distribution",n)}class $r extends _l{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class cM extends $r{apply(t,e){return un(t,e)}}cM.className="Zeros";St(cM);class XN extends $r{apply(t,e){return ms(t,e)}}XN.className="Ones";St(XN);class hM extends $r{constructor(t){if(super(),typeof t!="object")throw new J(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new J(`config must have value set but got ${t}`);this.value=t.value}apply(t,e){return it(()=>K(Lt(this.value),ms(t,e)))}getConfig(){return{value:this.value}}}hM.className="Constant";St(hM);class dM extends $r{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return bo(t,this.minval,this.maxval,e,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}dM.className="RandomUniform";St(dM);class fM extends $r{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if(e=e||"float32",e!=="float32"&&e!=="int32")throw new qt(`randomNormal does not support dType ${e}.`);return gx(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}fM.className="RandomNormal";St(fM);class pM extends $r{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if(e=e||"float32",e!=="float32"&&e!=="int32")throw new qt(`truncatedNormal does not support dType ${e}.`);return Qb(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}pM.className="TruncatedNormal";St(pM);class mM extends $r{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,e){return it(()=>{if(t.length!==2||t[0]!==t[1])throw new J("Identity matrix initializer can only be used for 2D square matrices.");return K(this.gain,_b(t[0]))})}getConfig(){return{gain:this.gain}}}mM.className="Identity";St(mM);function met(n,t="channelsLast"){let e,s;if(en(t),n.length===2)e=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(t==="channelsFirst"){const r=Xi(n,2);e=n[1]*r,s=n[0]*r}else if(t==="channelsLast"){const r=Xi(n,0,n.length-2);e=n[n.length-2]*r,s=n[n.length-1]*r}}else{const r=Xi(n);e=Math.sqrt(r),s=Math.sqrt(r)}return[e,s]}class Ms extends $r{constructor(t){if(super(),t.scale<0)throw new J(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,fet(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,pet(this.distribution),this.seed=t.seed}apply(t,e){const s=met(t),r=s[0],a=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),this.distribution==="normal"){const o=Math.sqrt(i);if(e=e||"float32",e!=="float32"&&e!=="int32")throw new qt(`${this.getClassName()} does not support dType ${e}.`);return Qb(t,0,o,e,this.seed)}else{const o=Math.sqrt(3*i);return bo(t,-o,o,e,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Ms.className="VarianceScaling";St(Ms);class YN extends Ms{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Ms.className}}YN.className="GlorotUniform";St(YN);class ZN extends Ms{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Ms.className}}ZN.className="GlorotNormal";St(ZN);class QN extends Ms{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Ms.className}}QN.className="HeNormal";St(QN);class JN extends Ms{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Ms.className}}JN.className="HeUniform";St(JN);class tC extends Ms{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Ms.className}}tC.className="LeCunNormal";St(tC);class eC extends Ms{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Ms.className}}eC.className="LeCunUniform";St(eC);class gM extends $r{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,e){return it(()=>{if(t.length<2)throw new qt("Shape must be at least 2D.");if(e!=="int32"&&e!=="float32"&&e!==void 0)throw new TypeError(`Unsupported data type ${e}.`);e=e;const s=ft(t.slice(0,-1)),r=t[t.length-1],a=s*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],o=gx(i,0,1,e,this.seed),l=cN.qr(o,!1);let c=l[0];const f=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=K(c,f.sign()),s<r&&(c=c.transpose()),K(Lt(this.gain),c.reshape(t))})}getConfig(){return{gain:this.gain,seed:this.seed}}}gM.className="Orthogonal";St(gM);const jR={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function HR(n,t={}){return um(n,Zs.getMap().classNameMap,t,"initializer")}function Ve(n){return HN(n)}function Le(n){if(typeof n=="string"){const t=n in jR?jR[n]:n;if(t==="GlorotNormal")return new ZN;if(t==="GlorotUniform")return new YN;if(t==="HeNormal")return new QN;if(t==="HeUniform")return new JN;if(t==="LeCunNormal")return new tC;if(t==="LeCunUniform")return new eC;{const e={};return e.className=t,e.config={},HR(e)}}else return n instanceof $r?n:HR(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kS(n){return Array.isArray(n)&&Array.isArray(n[0])}function By(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function Bt(n){let t;if(Array.isArray(n)){if(n.length!==1)throw new J(`Expected Tensor length to be 1; got ${n.length}`);t=n[0]}else t=n;return t}function he(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new J(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vy(n){let t=0;for(const e of n)e.shape.length===0?t+=1:t+=e.shape.reduce((s,r)=>s*r);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const qR="Variable";class get{constructor(t,e="float32",s=qR,r=!0,a=null){this.dtype=e??"float32",this.shape=t.shape,this.id=sM(),s=s??qR,this.originalName=aM(s),this.name=iM(this.originalName),this.trainable_=r,this.constraint=a,this.val=rN(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),yet(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function yet(n,t){if(n.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(t.shape))}function $S(n){return n.map(t=>t.read())}function nC(n){n.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gn{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class wa{constructor(t,e,s,r,a,i,o){this.dtype=t,this.shape=e,this.sourceLayer=s,this.inputs=r,this.callArgs=a,this.outputTensorIndex=o,this.id=sM(),i!=null&&(this.originalName=aM(i),this.name=iM(this.originalName)),this.rank=e.length}}let bet=0;class yx{constructor(t,e){this.callArgs=e,this.id=bet++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const s of t.inboundLayers)s!=null&&s.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)e!=null?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let xet=0;class Qt extends _l{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=xet++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const s=this.getClassName();e=Ga(s)+"_"+mx(s)}if(this.name=e,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let s;if(t.batchInputShape!=null)s=t.batchInputShape;else if(t.inputShape!=null){let a=null;t.batchSize!=null&&(a=t.batchSize),s=[a].concat(t.inputShape)}this.batchInputShape=s;let r=t.dtype;r==null&&(r=t.inputDType),r==null&&(r="float32"),this.dtype=r}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(this.inboundNodes.length===0)throw new wr(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new J(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return fs(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return fs(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new sa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new sa(`Layer ${this.name} is not connected, no input to return.`);return fs(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new sa(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new sa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return fs(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const e=ye(t);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=ye(this.inputSpec);if(e.length!==s.length)throw new J(`Layer ${this.name} expects ${s.length} inputs, but it received ${e.length} input tensors. Input received: ${t}`);for(let r=0;r<e.length;r++){const a=e[r],i=s[r];if(i==null)continue;const o=a.rank;if(i.ndim!=null&&o!==i.ndim)throw new J(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(i.maxNDim!=null&&o>i.maxNDim)throw new J(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(i.minNDim!=null&&o<i.minNDim)throw new J(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(i.dtype!=null&&a.dtype!==i.dtype)throw new J(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${a.dtype}.`);if(i.axes){const l=a.shape;for(const c in i.axes){const d=Number(c),f=i.axes[c],m=d>=0?l[d]:l[l.length+d];if(f!=null&&[f,null].indexOf(m)===-1)throw new J(`Input ${r} is incompatible with layer ${this.name}: expected axis ${d} of input shape to have value ${f} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const c=i.shape[l],d=a.shape[l];if(c!=null&&d!=null&&c!==d)throw new J(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${a.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){this._callHook!=null&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const s=ye(t),r=Tet(t),a=Net(t);if(r===a)throw new J("Arguments to apply() must be all SymbolicTensors or all Tensors");return ul(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const i=[];for(const o of ye(t))i.push(o.shape);this.build(fs(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(t),a){let i=this.call(t,e);this.supportsMasking&&this.setMaskMetadata(t,i);const o=ye(i),l=[];for(let c of o)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=fs(l),this.activityRegularizer!=null)throw new qt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=vet(t),o=this.computeOutputShape(i);let l;const c=wet(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?i[0]:i),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((d,f)=>new wa(c,d,this,ye(t),e,this.name,f)):l=new wa(c,o,this,ye(t),e,this.name),this.addInboundNode(t,l,null,null,i,o,e),this._refCount++,this.activityRegularizer!=null)throw new qt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&t[r]!=null&&t[r]!==s&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new sa(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const s=JSON.stringify(e.outputShapes);t.indexOf(s)===-1&&t.push(s)}if(t.length===1){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&e.length===1?e[0]:e}else throw new sa(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new wr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Vy(this.weights)}build(t){this.built=!0}getWeights(t=!1){return $S(t?this.trainableWeights:this.weights)}setWeights(t){it(()=>{const e=this.weights;if(e.length!==t.length)throw new J(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(e.length===0)return;const s=[],r=$S(e);for(let a=0;a<r.length;++a){const i=r[a],o=e[a],l=t[a];if(!te(i.shape,l.shape))throw new J(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([o,l])}nC(s)})}addWeight(t,e,s,r,a,i,o,l){if(this._addedWeightNames.indexOf(t)!==-1)throw new J(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():Le("zeros"));const c=r.apply(e,s),d=new get(c,s,t,i,o);return c.dispose(),a!=null&&this.addLoss(()=>a.apply(d.read())),i==null&&(i=!0),i?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=ye(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(e!=null)if(Array.isArray(e))e.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return e}setMaskMetadata(t,e,s){if(!this.supportsMasking)return;const r=this.computeMask(t,s),a=ye(e),i=ye(r);if(a.length!==i.length)throw new Error(`${this.name} outputs ${a.length} tensors but ${a.length} masks for those tensors`);for(let o=0;o<a.length;o++)a[o].kerasMask=i[o]}addInboundNode(t,e,s,r,a,i,o=null){const l=ye(t);e=ye(e),s=ye(s),r=ye(r),a=By(a),i=By(i);const c=[],d=[],f=[];for(const m of l)c.push(m.sourceLayer),d.push(m.nodeIndex),f.push(m.tensorIndex);new yx({outboundLayer:this,inboundLayers:c,nodeIndices:d,tensorIndices:f,inputTensors:l,outputTensors:e,inputMasks:s,outputMasks:r,inputShapes:a,outputShapes:i},o);for(let m=0;m<e.length;m++)e[m].sourceLayer=this,e[m].nodeIndex=this.inboundNodes.length-1,e[m].tensorIndex=m}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function vet(n){n=ye(n);const t=[];for(const e of n)t.push(e.shape);return fs(t)}function wet(n){return"float32"}function yM(n,t,e){if((t==null||e!=null&&e>0)&&(t=n.sourceLayer,e=n.nodeIndex),t.inboundNodes.length===0)return[n];{const s=t.inboundNodes[e];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let a=0;a<s.inboundLayers.length;a++){const i=s.inputTensors[a],o=s.inboundLayers[a],l=s.nodeIndices[a],c=yM(i,o,l);for(const d of c)r.indexOf(d)===-1&&r.push(d)}return r}}}function Tet(n){let t=!0;for(const e of ye(n))if(!(e instanceof wa)){t=!1;break}return t}function Net(n){let t=!0;for(const e of ye(n))if(e instanceof wa){t=!1;break}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fm extends Qt{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:mx("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new J("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(e==null){if(t.inputShape==null)throw new J("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new J("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=t.dtype||"float32";this.batchInputShape=e,this.dtype=s,this.inputSpec=[{shape:e}];const r=new wa(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new yx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new J(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}fm.className="InputLayer";St(fm);function Cet(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new J("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=n.batchShape;n.shape!=null&&t==null&&(t=[null].concat(n.shape));let e=n.dtype;return e==null&&(e="float32"),new fm({batchInputShape:t,name:n.name,dtype:e,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ket(n,t){if(n.dtype==null||n.dtype===t.dtype)return t;try{return Tt(t,n.dtype)}catch{throw new J(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class ji{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof ji)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(t==null)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,s){if(this.id2Value[t.id]==null)this.id2Value[t.id]=ket(t,e),this.name2Id[t.name]=t.id,s!=null&&(this.id2Mask[t.id]=s);else throw new J(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof wa){if(this.id2Value[t.id]==null)throw new J(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const e=this.name2Id[t];if(e==null)throw new J(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof wa){if(this.id2Value[t.id]==null)throw new J(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const e=this.name2Id[t];if(e==null)throw new J(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){this.id2Mask!=null&&Yt(this.id2Mask)}}const Uy=new tM,Wy=new tM;function $et(n){Uy!=null&&Uy.setMaxEntries(n),Wy!=null&&Wy.setMaxEntries(n)}function Fd(n,t,e,s){const r=e==null?!1:e.training,a=Array.isArray(n),i=a?n:[n],o=i.map(b=>b.name),l=[],c=t.names();for(const b of o)c.indexOf(b)!==-1?l.push(t.getValue(b)):l.push(null);const d=o.join(",")+"|"+t.names().sort().join(",");let f=Uy.get(d),m;if(f==null){const b=Eet(i,t);f=b.sorted,m=b.recipientCounts,Uy.put(d,f),Wy.put(d,m)}m={},r||Object.assign(m,Wy.get(d));const g=new ji(t);for(let b=0;b<f.length;++b){const x=f[b],v=x.sourceLayer;if(v instanceof fm)continue;const w=[],T=[],C=[];let k=!1;for(const O of x.inputs){const L=g.getValue(O),R=g.getMask(O);w.push(L),T.push(R),R!=null&&(k=!0),r||(m[O.name]--,m[O.name]===0&&!t.hasKey(O)&&o.indexOf(O.name)===-1&&!L.isDisposed&&O.sourceLayer.stateful!==!0&&C.push(L))}k&&(e=e||{},e.mask=T[0]);const $=ye(v.apply(w,e));let I=null;v.supportsMasking&&(I=v.computeMask(w,T));const D=Aet(x),_=Array.isArray(D)?D:[D];for(let O=0;O<_.length;++O){g.hasKey(_[O])||g.add(_[O],$[O],Array.isArray(I)?I[0]:I);const L=o.indexOf(_[O].name);L!==-1&&(l[L]=$[O])}r||Yt(C)}return g.disposeMasks(),a?l:l[0]}function Eet(n,t){F(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let e=[],s={};if(n.length===1){const r=KR(n[0],t);e=r.sorted,s=r.recipientMap}else{const r=new Set;for(const a of n){const{sorted:i,recipientMap:o}=KR(a,t);for(const l of i)r.has(l.name)||(e.push(l),r.add(l.name));for(const l in o)s[l]==null&&(s[l]=new Set),o[l].forEach(c=>s[l].add(c))}}return{sorted:e,recipientCounts:Iet(s)}}function Iet(n){const t={};for(const e in n)t[e]=n[e].size;return t}function KR(n,t){const e=new Set,s=[],r={};for(const o of t.names())e.add(o);const a=[],i=[];for(a.push(n);a.length>0;){const o=a[a.length-1];if(e.has(o.name)){a.pop();continue}const l=i[i.length-1]===a.length-1;if(o.inputs.length===0||l)a.pop(),s.push(o),e.add(o.name),l&&i.pop();else{i.push(a.length-1);for(const c of o.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(o.name),!e.has(c.name)&&a.push(c)}}return{sorted:s,recipientMap:r}}function Aet(n){let t;if(n.sourceLayer.inboundNodes.length===1)t=n.sourceLayer.output;else{let e=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const r of n.sourceLayer.inboundNodes[s].outputTensors)if(r.id===n.id){e=s;break}t=n.sourceLayer.getOutputAt(e)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ret=lt();Ret.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,$et);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sC(n,t){return it(()=>$n(It(K(n,n),t,!0)))}class pm extends _l{getConfig(){return{}}}class bM extends pm{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return it(()=>{const e=sC(t,this.axis),s=xs(e,0,this.maxValue);return K(t,Ot(s,wt(mn(),e)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}bM.className="MaxNorm";St(bM);class xM extends pm{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return it(()=>Ot(t,wt(mn(),sC(t,this.axis))))}getConfig(){return{axis:this.axis}}}xM.className="UnitNorm";St(xM);class vM extends pm{apply(t){return Xr(t)}}vM.className="NonNeg";St(vM);class wM extends pm{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return it(()=>{const e=sC(t,this.axis),s=wt(K(this.rate,xs(e,this.minValue,this.maxValue)),K(1-this.rate,e));return K(t,Ot(s,wt(mn(),e)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}wM.className="MinMaxNorm";St(wM);const XR={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function yn(n){return HN(n)}function YR(n,t={}){return um(n,Zs.getMap().classNameMap,t,"constraint")}function bn(n){if(n==null)return null;if(typeof n=="string"){const e={className:n in XR?XR[n]:n,config:{}};return YR(e)}else return n instanceof pm?n:YR(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Go(n){if(n==null)return;const t=[],e=[],s=[];for(const r in n){const a=n[r];if(typeof a!="number"){const i=a;t.push(i.data()),e.push(r),s.push(i)}}if(t.length>0){const r=await Promise.all(t);for(let a=0;a<r.length;++a)n[e[a]]=r[a][0];Yt(s)}}function SM(n){if(n!=null)for(const t in n){const e=n[t];typeof e!="number"&&e.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var ZR;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(ZR||(ZR={}));const Det=125;class wf{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class Oet{constructor(t,e=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){e==null&&(e={});for(const s of this.callbacks)await s.onEpochBegin(t,e)}async onEpochEnd(t,e){e==null&&(e={});for(const s of this.callbacks)await s.onEpochEnd(t,e)}async onBatchBegin(t,e){e==null&&(e={});for(const s of this.callbacks)await s.onBatchBegin(t,e)}async onBatchEnd(t,e){e==null&&(e={});for(const s of this.callbacks)await s.onBatchEnd(t,e)}async onTrainBegin(t){t==null&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class _et extends wf{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){e==null&&(e={});const s=e.size==null?0:e.size;this.seen+=s;for(const r in e){const a=e[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const o=it(()=>wt(this.totals[r],K(a,s)));this.totals[r]=o,i!=null&&i.dispose()}}}async onEpochEnd(t,e){if(e!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?e[s]=this.totals[s]/this.seen:it(()=>{const r=K(Ot(1,this.seen),this.totals[s]);e[s]=r,this.totals[s].dispose(),pn(e[s])}))}}class Fet extends wf{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){e==null&&(e={}),this.epoch.push(t);for(const s in e)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(e[s])}async syncData(){const t=[],e=[],s=[];for(const a in this.history){const i=this.history[a];for(let o=0;o<i.length;++o)if(typeof i[o]!="number"){const l=i[o];t.push(l.data()),e.push(a),s.push(o)}}const r=await Promise.all(t);for(let a=0;a<r.length;++a)this.history[e[a]][s[a]].dispose(),this.history[e[a]][s[a]]=r[a][0]}}class Let extends wf{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||CN,this.yieldEvery=e||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Det),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Ry(this.yieldEvery)&&(this.maybeWait=qtt(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,s){const r=[];this.yield!=null&&(await Go(s),r.push(this.yield(t,e,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,this.epochBegin!=null&&(await Go(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const s=[];this.epochEnd!=null&&(await Go(e),s.push(this.epochEnd(t,e))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(t,e){this.batchBegin!=null&&(await Go(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const s=[];this.batchEnd!=null&&(await Go(e),s.push(this.batchEnd(t,e))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Ry(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(s)}async onTrainBegin(t){this.trainBegin!=null&&(await Go(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await Go(t),await this.trainEnd(t))}}function TM(n,t){return n==null&&(n={}),n instanceof wf?[n]:Array.isArray(n)&&n[0]instanceof wf?n:ye(n).map(s=>new Let(s,t))}class xr{constructor(){}static registerCallbackConstructor(t,e){F(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),xr.checkForDuplicate(e),xr.constructors[t]==null&&(xr.constructors[t]=[]),xr.constructors[t].push(e)}static checkForDuplicate(t){for(const e in xr.constructors)xr.constructors[+e].forEach(r=>{if(r===t)throw new J("Duplicate callback constructor.")})}static clear(){xr.constructors={}}static createCallbacks(t){const e=[];for(const s in xr.constructors){const r=+s;t>=r&&e.push(...xr.constructors[r])}return e.map(s=>new s)}}xr.constructors={};function NM(n,t,e,s,r,a,i,o,l){const c=new Fet,d=[new _et,...xr.createCallbacks(t)];n!=null&&d.push(...n),d.push(c);const f=new Oet(d);return f.setParams({epochs:e,initialEpoch:s,samples:r,steps:a,batchSize:i,verbose:t,doValidation:o,metrics:l}),{callbackList:f,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Za(n,t={},e=!1){return um(n,Zs.getMap().classNameMap,t,"layer",e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gy(n,t){return it(()=>{n.dtype!=="float32"&&(n=Tt(n,"float32"));const e=It(hm(n),t,!0),s=Rl(e.shape,mn()),r=$n(Na(e,s));return Ot(n,r)})}function bx(n,t){return it(()=>Be(hm(Et(t,n)),-1))}function rC(n,t){return it(()=>Be(ln(Et(t,n)),-1))}function aC(n,t){return it(()=>{const e=Et(n,t),s=xs(ln(n),mn(),Number.MAX_VALUE),r=ln(Ot(e,s));return K(100,Be(r,-1))})}function Met(n,t){return it(()=>{const e=xs(t,mn(),Number.MAX_VALUE),s=Fs(wt(1,e)),r=xs(n,mn(),Number.MAX_VALUE),a=Fs(wt(1,r));return Be(hm(Et(s,a)),-1)})}function zet(n,t){return it(()=>{const e=Na(0,Et(1,K(n,t)));return Be(hm(e),-1)})}function Pet(n,t){return it(()=>{const e=Na(0,Et(1,K(n,t)));return Be(e,-1)})}function Bet(n,t){return it(()=>{const e=It(K(n,t),-1),s=er(K(Et(1,n),t),-1);return Na(0,wt(1,Et(s,e)))})}function Vet(n,t){return it(()=>{const e=Math.log(2),s=Et(t,n),r=Et(wt(s,Dl(K(-2,s))),e);return Be(r,-1)})}function Sf(n,t,e=!1){return it(()=>{if(e)t=sm(t);else{const s=It(t,t.shape.length-1,!0);t=Ot(t,s)}return t=xs(t,mn(),1-mn()),De(It(K(Tt(n,"float32"),Fs(t)),t.shape.length-1))})}function jy(n,t,e=!1){return it(()=>{const s=Tt(dh(aet(n)),"int32");t=xs(t,mn(),1-mn());const r=t.shape,a=Z(Zu(s,r[r.length-1]),r);return Sf(a,t,e)})}function Uet(n,t){if(!te(n.shape,t.shape))throw new J(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(t.shape)}`);return it(()=>{const e=Xr(t),s=De(ln(t));return wt(Et(e,K(t,n)),Kp(vs(s)))})}function xx(n,t){return it(()=>{let e;return e=xs(t,mn(),1-mn()),e=Fs(Ot(e,Et(1,e))),Be(Uet(n,e),-1)})}function Wet(n,t){return it(()=>{const e=xs(n,mn(),1),s=xs(t,mn(),1);return It(K(n,Fs(Ot(e,s))),-1)})}function Get(n,t){return it(()=>{const e=Fs(wt(mn(),t));return Be(Et(t,K(n,e)),-1)})}function CM(n,t){return it(()=>{const e=Gy(n,-1),s=Gy(t,-1),r=K(e,s);return De(It(r,-1))})}const Hy={meanSquaredError:bx,meanAbsoluteError:rC,meanAbsolutePercentageError:aC,meanSquaredLogarithmicError:Met,squaredHinge:zet,hinge:Pet,categoricalHinge:Bet,logcosh:Vet,categoricalCrossentropy:Sf,sparseCategoricalCrossentropy:jy,binaryCrossentropy:xx,kullbackLeiblerDivergence:Wet,poisson:Get,cosineProximity:CM};function vw(n){if(typeof n=="string"){if(n in Hy)return Hy[n];let t=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new J(t)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kM(n,t){return it(()=>{const e=K(.5,Ls(t)),s=pa(Ts(t,e),n.dtype);return Be(Cr(n,s),-1)})}function $M(n,t){return it(()=>pa(Cr(ml(n,-1),ml(t,-1)),"float32"))}function jet(n,t){return it(()=>Tt(It(Gr(Cr(n,1),Cr(t,1))),"float32"))}function Het(n,t){return it(()=>Tt(It(Gr(Cr(n,0),Cr(t,1))),"float32"))}function qet(n,t){return it(()=>{const e=jet(n,t),s=Het(n,t),r=wt(e,s);return Tt(Ln(Ts(r,0),Ot(e,r),0),"float32")})}function Ket(n,t){return xx(n,t)}function Xet(n,t){return n.rank===t.rank&&(n=xo(n,[n.rank-1])),t=ml(t,-1),t.dtype!==n.dtype&&(t=Tt(t,n.dtype)),Tt(Cr(n,t),"float32")}const Yet=bx,Zet=bx,Qet=rC,Jet=rC,tnt=aC,ent=aC,EM=Sf,nnt=CM,IM=jy,qy={binaryAccuracy:kM,categoricalAccuracy:$M,precision:qet,categoricalCrossentropy:EM,sparseCategoricalCrossentropy:IM,mse:Yet,MSE:Zet,mae:Qet,MAE:Jet,mape:tnt,MAPE:ent,cosine:nnt};function snt(n){if(typeof n=="string"&&n in qy)return qy[n];if(typeof n!="string"&&n!=null)return n;throw new J(`Unknown metric ${n}`)}function qg(n){if(ra(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let t;for(const e of Object.keys(Hy))if(Hy[e]===n){t=e;break}if(t!==void 0)return t;for(const e of Object.keys(qy))if(qy[e]===n){t=e;break}return t!==void 0?t:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rnt(n){const t={Adagrad:()=>Xo.adagrad(.01),Adadelta:()=>Xo.adadelta(1,.95,mn()),Adam:()=>Xo.adam(.001,.9,.999,mn()),Adamax:()=>Xo.adamax(.002,.9,.999,mn(),0),RMSProp:()=>Xo.rmsprop(.001,.9,0,mn()),SGD:()=>Xo.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,n in t)return t[n]();throw new J(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const QR=1*1024*1024;function JR(n,t,e=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!ES(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){const s=JSON.stringify(n);s.length>QR&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${QR}.`)}}function ES(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const t=Object.keys(n);for(const e of t)if(typeof e!="string"||!ES(n[e]))return!1;return!0}else if(Array.isArray(n)){for(const t of n)if(!ES(t))return!1;return!0}else return!1;else{const t=typeof n;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ant(n,t,e,s=console.log){const r=ont(n),a=["Layer (type)","Input Shape","Output shape","Param #"];r?(t=t||90,e=e||[.32,.61,.89,1]):(t=t||115,e=e||[.24,.48,.7,.8,1]),e[e.length-1]<=1&&(e=e.map(d=>Math.floor(t*d)));let i;if(!r){a.push("Receives inputs"),i=[];for(const d in n.nodesByDepth)i.push(...n.nodesByDepth[d])}s("_".repeat(t)),Ky(a,e,s),s("=".repeat(t));const o=n.layers;for(let d=0;d<o.length;++d)r?lnt(o[d],e,s):unt(o[d],e,i,s),s((d===o.length-1?"=":"_").repeat(t));n.checkTrainableWeightsConsistency();const l=int(n),c=Vy(n.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(t))}function int(n){let t;return n.collectedTrainableWeights!=null?t=Vy(n.collectedTrainableWeights):t=Vy(n.trainableWeights),t}function ont(n){let t=!0;const e=[],s=[];for(const r in n.nodesByDepth)e.push(n.nodesByDepth[r]);for(const r of e){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){t=!1;break}s.push(...r)}if(t)for(const r of n.layers){let a=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(a){t=!1;break}else a=!0;if(!t)break}return t}function Ky(n,t,e=console.log){let s="";for(let r=0;r<n.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=n[r],s=s.slice(0,t[r]),s+=" ".repeat(t[r]-s.length);e(s)}function lnt(n,t,e){let s,r;try{r=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const a=n.name,i=n.getClassName(),o=[`${a} (${i})`,r,s,n.countParams().toString()];Ky(o,t,e)}function unt(n,t,e,s){let r,a;try{a=n.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{a="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const i=[];for(const f of n.inboundNodes)if(!(e!=null&&e.length>0&&e.indexOf(f)===-1))for(let m=0;m<f.inboundLayers.length;++m){const g=f.inboundLayers[m].name,b=f.nodeIndices[m],x=f.tensorIndices[m];i.push(`${g}[${b}][${x}]`)}const o=n.name,l=n.getClassName(),c=i.length===0?"":i[0],d=[`${o} (${l})`,a,r,n.countParams().toString(),c];Ky(d,t,s);for(let f=1;f<i.length;++f)Ky(["","","","",i[f]],t,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function AM(n,t,e){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&t===0&&typeof e=="string"}function IS(n,t){if(n===null)return null;if(typeof n=="string")return Qo(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const e=[],s=n.length;for(let r=0;r<s;++r){const a=n[r];AM(t,r,a)?e.push(a):e.push(IS(a,t))}return e}else{const e={};for(const s of Object.keys(n)){const r=n[s];if(s==="name"&&typeof r=="string")e[s]=r;else{const a=Qo(s);e[a]=IS(r,a)}}return e}}function AS(n,t){if(n==null)return null;if(typeof n=="string")return Ga(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const e=[],s=n.length;for(let r=0;r<s;++r){const a=n[r];AM(t,r,a)?e.push(a):e.push(AS(a,t))}return e}else{const e={};for(const s of Object.keys(n)){const r=n[s],a=Ga(s);(s==="name"||s==="className")&&typeof r=="string"?e[a]=r:e[a]=AS(r,s)}return e}}/** @license See the LICENSE file. */const RM="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cnt=n=>{const t=Object.keys(n);if(t.length===0)return!1;const e=t[0].split("/");return!isNaN(parseInt(e[e.length-1],10))};class Fr extends Qt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const T=this.getClassName().toLowerCase();this.name=mx(T)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],Ki(this.inputs).length!==this.inputs.length)throw new J(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(T=>T.name)}`);Ki(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(T=>T.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const T of this.outputs){const C=T.sourceLayer,k=T.nodeIndex,$=T.tensorIndex;this.outputLayers.push(C),this.outputLayersNodeIndices.push(k),this.outputLayersTensorIndices.push($)}for(const T of this.inputs){const C=T.sourceLayer,k=T.nodeIndex,$=T.tensorIndex;ra(k===0,"input layer has >1 nodes"),ra($===0,"input layer has >1 tensors"),this.inputLayers.push(C),this.inputLayersNodeIndices.push(k),this.inputLayersTensorIndices.push($)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let T=0;T<this.inputLayers.length;T++){const C=this.inputLayers[T];if(!(C instanceof fm))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${T} (0-based) originates from layer type ${C.getClassName()}.`);this.inputNames.push(C.name),this.feedInputShapes.push(C.batchInputShape),this.feedInputNames.push(C.name)}for(const T of this.outputLayers)this.outputNames.push(T.name);this.internalInputShapes=this.inputs.map(T=>T.shape),this.internalOutputShapes=this.outputs.map(T=>T.shape);const e={},s={},r={},a={},i={},o=[],l=(T,C,k,$,I,D)=>{($==null||I==null||D==null)&&($=T.sourceLayer,I=T.nodeIndex,D=T.tensorIndex);const _=$.inboundNodes[I];if(k.indexOf(_)!==-1)throw new wr(`The tensor ${T.name} at layer "${$.name}" is part of a cycle.`);if(C.indexOf(_)!==-1)return;this.containerNodes.add(Fr.nodeKey($,I)),$.id in i||(i[$.id]=Object.keys(i).length),k.indexOf(_)===-1&&k.push(_);const O=_.inboundLayers.length;for(let L=0;L<O;L++){const R=_.inputTensors[L],V=_.inboundLayers[L],Y=_.nodeIndices[L],Q=_.tensorIndices[L];l(R,C,k,V,Y,Q)}for(C.push(_);k.indexOf(_)>=0;)k.splice(k.indexOf(_),1);o.push(_)},c=[],d=[];for(const T of this.outputs)l(T,c,d);const f=o.slice().reverse();for(const T of f){s[T.id]=T,T.id in e||(e[T.id]=0);let C=e[T.id];const k=r[T.outboundLayer.id]==null?0:r[T.outboundLayer.id];C=Math.max(C,k),r[T.outboundLayer.id]=C,a[T.outboundLayer.id]=T.outboundLayer,e[T.id]=C;for(let $=0;$<T.inboundLayers.length;$++){const I=T.inboundLayers[$],D=T.nodeIndices[$],_=I.inboundNodes[D],O=e[_.id]==null?0:e[_.id];e[_.id]=Math.max(C+1,O),s[_.id]=_}}const m={};for(const T in e){const C=e[T];C in m||(m[C]=[]),m[C].push(s[T])}const g={};for(const T in r){const C=r[T];C in g||(g[C]=[]),g[C].push(a[T])}let b=Object.keys(g).map(T=>parseInt(T,10)).sort(Gg);this.layers=[];for(const T of b){const C=g[T];C.sort((k,$)=>{const I=i[k.id],D=i[$.id];return I<D?-1:I>D?1:0});for(const k of C)k instanceof Fr&&this.internalContainerRefs.push(k),this.layers.push(k)}this.layersByDepth=g,b=Object.keys(m).map(T=>parseInt(T,10)).sort(Gg);const x=this.inputs.slice(),v=[];for(const T of b)for(const C of m[T]){const k=C.outboundLayer;if(k!=null){for(const $ of C.inputTensors)if(x.indexOf($)===-1)throw new wr(`Graph disconnected: cannot obtain value for tensor ${$} at layer "${k.name}". The following previous layers were accessed without issue: ${v}`);for(const $ of C.outputTensors)x.push($);v.push(k.name)}}this.nodesByDepth=m;const w=this.layers.map(T=>T.name);for(const T of w){const C=w.filter(k=>k===T).length;if(C!==1)throw new wr(`The name "${T}" is used ${C} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new yx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(T=>null),outputMasks:this.outputs.map(T=>null),inputShapes:this.inputs.map(T=>T.shape),outputShapes:this.outputs.map(T=>T.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(s=>s.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new J("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const s of this.layers)e.push(...s.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const s={};let r=0;const a=cnt(t);a&&this.parseWeights(t);for(const o of this.layers)for(const[l,c]of o.weights.entries()){const d=a?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[d]!=null)throw new J(`Duplicate weight name: ${d}`);s[d]=c,r++}const i=[];for(const o in t){let l=o;if(s[o]==null){const c=o.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],t[o]]);else if(e)throw new J(`Provided weight data has no target variable: ${o}`);delete s[l]}if(e){const o=[];for(const l in s)o.push(l);if(o.length>0)throw new J(`${o.length} of ${r} weights are not set: ${o}`)}nC(i)}parseWeights(t){for(const e in Object.keys(t)){const s=e.split("/"),r=["vars","layer_checkpoint_dependencies"],a=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");a!==e&&(t[a]=t[e],delete t[e])}}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion=`tfjs-layers ${RM}`,e.backend="TensorFlow.js",e}toJSON(t,e=!0){const s=AS(this.updatedConfig());return e?JSON.stringify(s):s}call(t,e){return it(()=>{t=ye(t);const s=new ji;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],t[r]);return Fd(this.outputs,s,e)})}computeMask(t,e){return it(()=>{t=ye(t);let s;return e==null?s=wl(null,t.length):s=ye(e),this.runInternalGraph(t,s)[1]})}computeOutputShape(t){const e=By(t);if(e.length!==this.inputLayers.length)throw new J(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let o=0;o<e.length;o++){const l=this.inputLayers[o],c=e[o],d=l.name+"_0_0";s[d]=c}const r=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(Gg);if(r.length>1)for(const o of r){const l=this.nodesByDepth[o];for(const c of l){const d=c.outboundLayer;if(this.inputLayers.map(x=>x.id).indexOf(d.id)!==-1)continue;const f=[];for(let x=0;x<c.inboundLayers.length;x++){const v=c.inboundLayers[x],w=c.nodeIndices[x],T=c.tensorIndices[x],C=`${v.name}_${w}_${T}`,k=s[C];f.push(k)}const m=d.computeOutputShape(fs(f)),g=By(m),b=d.inboundNodes.indexOf(c);for(let x=0;x<g.length;x++){const v=`${d.name}_${b}_${x}`;s[v]=g[x]}}}const a=[],i=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],d=this.outputLayersTensorIndices[o],f=`${l.name}_${c}_${d}`;i.push(f)}for(let o=0;o<i.length;o++){const l=i[o];ra(l in s),a.push(s[l])}return fs(a)}runInternalGraph(t,e){e==null&&(e=wl(null,t.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],d=t[l],f=e[l];s[c.id]=[d,f]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Gg);for(const l of r){const c=this.nodesByDepth[l];for(const d of c){const f=d.outboundLayer,m=d.inputTensors,g=d.outputTensors,b=new Array;for(const x of m)x.id in s&&b.push(s[x.id]);if(b.length===m.length){let x={},v,w,T,C;if(d.callArgs!=null&&(x=d.callArgs),b.length===1){const[k,$]=b[0];x.mask==null&&(x.mask=$),T=ye(f.call(k,x)),C=ye(f.computeMask(k,$)),v=[k],w=[$]}else v=b.map(k=>k[0]),w=b.map(k=>k[1]),x.mask==null&&(x.mask=w),T=ye(f.call(v,x)),C=ye(f.computeMask(v,w));if(f.activityRegularizer)throw new qt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let k=0;k<g.length;++k){const $=g[k],I=T[k],D=C[k];s[$.id]=[I,D]}}}}const a=[],i=[],o=[];for(const l of this.outputs){ra(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,d]=s[l.id];o.push(c.shape),a.push(c),i.push(d)}return[a,i,o]}buildNodeConversionMap(t){const e={};let s;for(const r of this.layers){s=r instanceof Fr?1:0;for(let a=0;a<r.inboundNodes.length;a++){const i=Fr.nodeKey(r,a);this.containerNodes.has(i)&&(e[i]=s,s+=1)}}return e}getLayer(t,e){if(e!=null)return this.findLayer(e);if(t==null)throw new J("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(const s of this.layers)if(s.name===t)return s;throw new J(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new J(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return it(()=>{const t=[];for(const e of this.layers)for(let s=0;s<e.inboundNodes.length;++s){const r=Fr.nodeKey(e,s);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const o=i.getClassName(),l=i.getConfig(),c=[];for(let f=0;f<i.inboundNodes.length;f++){const m=i.inboundNodes[f],g=Fr.nodeKey(i,f);let b={};if(this.containerNodes.has(g)){if(m.callArgs)try{JSON.stringify(m.callArgs),b=m.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${m.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),b={}}if(m.inboundLayers.length>0){const x=[];for(let v=0;v<m.inboundLayers.length;v++){const w=m.inboundLayers[v],T=m.nodeIndices[v],C=m.tensorIndices[v],k=Fr.nodeKey(w,T);let $=e[k];$==null&&($=0),x.push([w.name,$,C,b])}c.push(x)}}}const d={};d.name=i.name,d.className=o,d.config=l,d.inboundNodes=c,s.push(d)}t.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const o=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=Fr.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let d=e[c];d==null&&(d=0);const f=this.inputLayersTensorIndices[i];r.push([o.name,d,f])}t.inputLayers=r;const a=[];for(let i=0;i<this.outputLayers.length;i++){const o=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=Fr.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let d=e[c];d==null&&(d=0);const f=this.outputLayersTensorIndices[i];a.push([o.name,d,f])}return t.outputLayers=a,t}static fromConfig(t,e,s={},r=!1){const a={},i={};function o(v,w){v.name in i?i[v.name].push(w):i[v.name]=[w]}function l(v,w){const T=[];let C;for(const k of w){const $=k[0],I=k[1],D=k[2];if(C=k[3]==null?{}:k[3],!($ in a)){o(v,w);return}const _=a[$];if(_.inboundNodes.length<=I){o(v,w);return}const O=_.inboundNodes[I];T.push(O.outputTensors[D])}T.length>0&&v.apply(fs(T),C)}function c(v){const w=v.name,T=Za(v,e.customObjects!=null?e.customObjects:{});T.setFastWeightInitDuringBuild(r),a[w]=T,v.inboundNodes.forEach(k=>{if(!(k instanceof Array))throw new J(`Corrupted configuration, expected array for nodeData: ${k}`);o(T,k)})}const d=e.name,f=e.layers;for(const v of f)c(v);for(;!Htt(i);)for(const v of f){const w=a[v.name];if(w.name in i){const T=i[w.name];delete i[w.name];for(const C of T)l(w,C)}}const m=[],g=[],b=e.inputLayers;for(const v of b){const w=v[0],T=v[1],C=v[2];ra(w in a);const $=a[w].inboundNodes[T].outputTensors;m.push($[C])}const x=e.outputLayers;for(const v of x){const w=v[0],T=v[1],C=v[2];ra(w in a);const $=a[w].inboundNodes[T].outputTensors;g.push($[C])}return new t({inputs:m,outputs:g,name:d})}get stateful(){if(this._stateful)throw new J("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){it(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hnt(n,t,e){const s=t.length;if(n==null||Array.isArray(n)&&n.length===0)return t.map(r=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&t[0]in n?[n[t[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${e} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const r=[];return t.forEach(a=>{a in n?r.push(n[a]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${e} must be either an array with ${s} elements or an object with ${t} keys. Provided ${e} not understood: ${JSON.stringify(n)}`)}function DM(n,t){return hnt(n,t,"classWeight")}async function OM(n,t,e,s){if(e!=null){const r=it(()=>{if(n.shape.length===1)return da(n);if(n.shape.length===2){if(n.shape[1]>1)return ml(n,1);if(n.shape[1]===1)return Z(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await r.data());Yt(r);const i=[];return a.forEach(o=>{if(e[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);i.push(e[o])}),Xn(i,"float32")}else return null}function dnt(n,t){return K(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const fnt=32;function _M(n,t){let e,s;const r=t;e=r.xs,s=r.ys,F(e!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const a=tD("input",n.inputNames,e),i=tD("output",n.outputNames,s),o=a[0].shape[0];F(a.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),F(i.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<a.length;l++)F(a[l].shape[0]===o,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);for(let l=0;l<i.length;l++)F(i[l].shape[0]===o,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);return{xs:a,ys:i}}function tD(n,t,e){if(e instanceof ge)return[e];if(Array.isArray(e))return F(e.length===t.length,()=>`Received an array of ${e.length} Tensors, but expected ${t.length} to match the ${n} keys ${t}.`),e;{const s=[];for(const r of t){if(e[r]==null)throw new J(`The feature data generated by the dataset lacks the required ${n} key '${r}'.`);s.push(e[r])}return s}}function pnt(n){if(n.length===3)throw new qt("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function mnt(n,t,e){const s=e.batchesPerEpoch!=null;if(F(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),F(e!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),F(e.epochs!=null&&e.epochs>0&&Number.isInteger(e.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${e.epochs}`),F(!s||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${e.batchesPerEpoch}`),F(e.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const r=e.validationData!=null;let a,i;if(r)if(eD(e.validationData))F(e.validationBatches==null||e.validationBatches>0&&Number.isInteger(e.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${e.validationBatches}`);else{const v=pnt(e.validationData);a=v.xs,i=v.ys}const o=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(v=>"val_"+v)):c=l.slice();const d=TM(e.callbacks,e.yieldEvery),f=e.verbose==null?1:e.verbose,{callbackList:m,history:g}=NM(d,f,e.epochs,null,null,gnt(t,e),null,r,c);m.setModel(n),n.history=g,await m.onTrainBegin(),n.stopTraining_=!1;let b=e.initialEpoch==null?0:e.initialEpoch,x=await t.iterator();for(;b<e.epochs;){const v={};await m.onEpochBegin(b);let w=0,T=0;for(s||(x=await t.iterator());!s||w<e.batchesPerEpoch;){const C=await x.next();if(s&&C.done){console.warn(`You provided \`batchesPerEpoch\` as ${e.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${e.batchesPerEpoch*e.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(C.value!=null){const{xs:k,ys:$}=_M(n,C.value),I={};I.batch=T,I.size=k[0].shape[0],await m.onBatchBegin(T,I);const D=[];if(e.classWeight!=null){const L=DM(e.classWeight,n.outputNames);for(let R=0;R<L.length;++R)D.push(await OM($[R],null,L[R]))}const _=k.concat($).concat(D),O=o(_);Yt(_);for(let L=0;L<l.length;++L){const R=l[L],V=O[L];I[R]=V,pn(V)}await m.onBatchEnd(T,I),SM(I),T++,w++}if(s?w>=e.batchesPerEpoch:C.done){if(r){let k;eD(e.validationData)?k=ye(await n.evaluateDataset(e.validationData,{batches:e.validationBatches})):k=ye(n.evaluate(a,i,{batchSize:e.validationBatchSize==null?fnt:e.validationBatchSize,verbose:0}));for(let $=0;$<n.metricsNames.length;++$)v[`val_${n.metricsNames[$]}`]=k[$]}break}if(n.stopTraining_)break}if(await m.onEpochEnd(b,v),b++,n.stopTraining_)break}return await m.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function gnt(n,t){let e=null;return t.batchesPerEpoch!=null?e=t.batchesPerEpoch:Number.isFinite(n.size)&&(e=n.size),e}function eD(n){return typeof n.iterator=="function"}function ynt(n){return typeof n.next=="function"}async function bnt(n,t,e){e=e||{};const s=e.batches!=null,r=n.testFunction;let a=[];if(e.verbose>0)throw new qt("Verbose mode is not implemented yet.");F(!s||e.batches>0&&Number.isInteger(e.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(e.batches)}`);const i=ynt(t)?t:await t.iterator();let o=0,l=0;for(;!s||l<e.batches;){const c=await i.next();if(a=it(()=>{if(c.value){const{xs:d,ys:f}=_M(n,c.value),m=d.concat(f),g=it(()=>r(m));if(Yt(m),l===0)for(let x=0;x<g.length;++x)a.push(Lt(0));const b=m[0].shape[0];for(let x=0;x<g.length;++x){const v=g[x],w=a[x];a[x]=it(()=>wt(a[x],K(b,v))),l>0&&Yt(w)}Yt(g),o+=b,++l}return a}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${e.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<a.length;++c){const d=a[c];a[c]=Ot(a[c],o),Yt(d)}return fs(a)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ww(n){F(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function Ed(n,t,e){return n==null?[null]:Array.isArray(n)?n.map(s=>cl(s,t,e-t)):cl(n,t,e-t)}function RS(n,t){return it(()=>n==null?null:Array.isArray(n)?n.map(e=>RS(e,t)):lM(n,t.dtype==="int32"?t:Tt(t,"int32")))}function Sw(n,t){const e=[];let s=0,r=null;for(;s<n;)r=s+t,r>=n&&(r=n),e.push([s,r]),s=r;return e}function FM(n){const t=[];n instanceof ge&&(n=[n]);for(let e=0;e<n.length;++e){const s=n[e];if(s.rank===1)t.push(cm(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(s)}}return t}function Or(n,t){if(n==null)return;const e=[];if(t instanceof ge)e.push(t.id);else if(Array.isArray(t))t.forEach(r=>e.push(r.id));else if(t!=null)for(const r in t){const a=t[r];e.push(a.id)}const s=[];if(n instanceof ge)e.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(r=>{e.indexOf(r.id)===-1&&s.push(r)});else if(n!=null)for(const r in n){const a=n[r];e.indexOf(a.id)===-1&&s.push(a)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xnt(n){return n instanceof ge}function DS(n){return Array.isArray(n)}function nD(n){return!xnt(n)&&!DS(n)}function sD(n,t,e,s=!0,r=""){if(t==null||t.length===0){if(n!=null){let i=!1;if(DS(n)&&n.length>0)i=!0;else if(nD(n)){for(const o in n)if(n.hasOwnProperty(o)){i=!0;break}}else i=!0;if(i)throw new J(`Error when checking model ${r} expected no data, but got ${n}`)}return[]}if(n==null)return t.map(i=>null);let a;if(nD(n)){n=n,a=[];for(const i of t){if(n[i]==null)throw new J(`No data provided for "${i}". Need data for each key in: ${t}`);a.push(n[i])}}else if(DS(n)){if(n=n,n.length!==t.length)throw new J(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);a=n}else{if(n=n,t.length>1)throw new J(`The model ${r} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);a=[n]}if(a=FM(a),e!=null)for(let i=0;i<t.length;++i){if(e[i]==null)continue;const o=a[i];if(o.shape.length!==e[i].length)throw new J(`Error when checking ${r}: expected ${t[i]} to have ${e[i].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<e[i].length;++l){if(l===0&&!s)continue;const c=o.shape[l],d=e[i][l];if(d!=null&&d>=0&&c!==d)throw new J(`${r} expected a batch of elements where each example has shape [${e[i].slice(1,e[i].length)}] (i.e.,tensor shape [*,${e[i].slice(1,e[i].length)}]) but the ${r} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return a}function vnt(n,t,e){const s=Ki(n.map(a=>a.shape[0]));s.sort();const r=Ki(t.map(a=>a.shape[0]));if(r.sort(),s.length>1)throw new J(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(a=>a.shape))}`);if(r.length>1)throw new J(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(a=>a.shape))}`);if(s.length>0&&r.length>0&&!te(s,r))throw new J(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function wnt(n,t,e){const s=[bx,xx,Sf];for(let r=0;r<n.length;++r){const a=n[r],i=t[r],o=e[r];if(i!=null){if(i===Sf&&a.shape[a.shape.length-1]===1)throw new J(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=a.shape.slice(1),c=o.slice(1);for(let d=0;d<l.length;++d){const f=l[d],m=c[d];if(m!=null&&f!==m)throw new J(`A target Tensor with shape ${a.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function rD(n,t,e,s=!0,r=""){let a;if(Array.isArray(n)){if(n.length!==t.length)throw new J(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${n.length} Tensors(s).`);a=n}else{if(t.length>1)throw new J(`The model expects ${t.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);a=[n]}if(e!=null)for(let i=0;i<t.length;++i){if(e[i]==null)continue;const o=a[i];if(o.shape.length!==e[i].length)throw new J(`Error when checking ${r}: expected ${t[i]} to have ${e[i].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<e[i].length;++l){if(l===0&&!s)continue;const c=o.shape[l],d=e[i][l];if(d!=null&&d!==c)throw new J(`Error when checking ${r}: expected ${t[i]} to have shape ${JSON.stringify(e[i])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function Snt(n,t){if(n==null||Array.isArray(n)&&n.length===0)return t.map(s=>[]);let e;if(typeof n=="string"||typeof n=="function")e=[n];else if(Array.isArray(n)||typeof n=="object")e=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(e))return t.map(s=>e);{const s=[];for(const r of t){let a=e.hasOwnProperty(r)?e[r]:[];Array.isArray(a)||(a=[a]),s.push(a)}return s}}const Tnt="layers-model";class Wu extends Fr{constructor(t){super(t),this.isTraining=!1}summary(t,e,s=console.log){if(!this.built)throw new J("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");ant(this,t,e,s)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=rnt(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof gi))throw new J("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const i in t.loss)if(this.outputNames.indexOf(i)===-1)throw new J(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)t.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),e.push(vw(t.loss[i]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new J(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);e=t.loss.map(o=>vw(o))}else{const i=vw(t.loss);this.outputs.forEach(o=>{e.push(i)})}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const o=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],ul("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([o,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=Snt(t.metrics,this.outputNames),a=(i,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[i]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,i])};ul("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=r[i];(c=>{const d="";let f,m,g;for(const b of c){if(typeof b=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(b)!==-1){const v=this.internalOutputShapes[i];v[v.length-1]===1||this.lossFunctions[i]===xx?["accuracy","acc"].indexOf(b)!==-1?m=kM:["crossentropy","ce"].indexOf(b)!==-1&&(m=Ket):this.lossFunctions[i]===jy?["accuracy","acc"].indexOf(b)!==-1?m=Xet:["crossentropy","ce"].indexOf(b)!==-1&&(m=IM):["accuracy","acc"].indexOf(b)!==-1?m=$M:["crossentropy","ce"].indexOf(b)!==-1&&(m=EM);let w;["accuracy","acc"].indexOf(b)!==-1?w="acc":["crossentropy","ce"].indexOf(b)!==-1&&(w="ce"),g=m,f=d+w}else g=snt(b),f=d+qg(b);let x;ul(f,()=>{x=g}),a(i,f,x)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,s={}){const r=s.batchSize==null?32:s.batchSize;ww(r);const i=this.standardizeUserDataXY(t,e,!0,r);try{const o=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,o,r,s.verbose,s.steps);return fs(c)}finally{Or(i[0],t),Or(i[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),bnt(this,t,e)}checkNumSamples(t,e,s,r="steps"){let a;if(s!=null){if(a=null,e!=null)throw new J(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${e}`)}else if(t!=null)Array.isArray(t)?a=t[0].shape[0]:a=t.shape[0];else throw new J(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return a}execute(t,e){if(Array.isArray(e)&&e.length===0)throw new J("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(e),r=s?e:[e],a=this.retrieveSymbolicTensors(r),i=new ji;if(t instanceof ge&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new J(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],t[l])}else for(const l of this.inputs){const c=t[l.name];if(c==null)throw new J(`No value is provided for the model's input ${l.name}`);i.add(l,c)}const o=Fd(a,i);return s?o:o[0]}retrieveSymbolicTensors(t){const e=wl(null,t.length);let s=t.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],i=a.map(o=>o.name);for(let o=0;o<t.length;++o){const l=i.indexOf(t[o]);if(l!==-1&&(e[o]=a[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw e.forEach((a,i)=>{a==null&&r.push(t[i])}),new J(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return e}predictLoop(t,e=32,s=!1){return it(()=>{const r=this.checkNumSamples(t);if(s)throw new qt("Verbose predictLoop() is not implemented yet.");const a=Sw(r,e),i=this.outputs.map(o=>[]);for(let o=0;o<a.length;++o)it(()=>{const c=a[o][0],d=a[o][1],f=Ed(t,c,d),m=[];if(Array.isArray(f))for(let b=0;b<f.length;++b)m.push({key:this.inputs[b],value:f[b]});else m.push({key:this.inputs[0],value:f});const g=new ji(m);return Fd(this.outputs,g)}).forEach((c,d)=>i[d].push(c));return fs(i.map(o=>Qe(o,0)))})}predict(t,e={}){const s=FM(t);rD(s,this.inputNames,this.feedInputShapes,!1);try{const r=e.batchSize==null?32:e.batchSize;return ww(r),this.predictLoop(s,r)}finally{Or(s,t)}}predictOnBatch(t){rD(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,s=!0,r){if(this.optimizer_==null)throw new wr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let i=0;i<this.feedOutputShapes.length;++i){const o=this.feedOutputShapes[i];this.feedLossFns[i]===jy?a.push(o.slice(0,o.length-1).concat([1])):a.push(o)}if(t=sD(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=sD(e,this.feedOutputNames,a,!1,"target"),vnt(t,e),wnt(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&t[0].shape[0]%r!==0)throw new J(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,s,r,a=!0,i){const[o,l]=this.standardizeUserDataXY(t,e,a,i);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const d=DM(r,this.outputNames);c=[];for(let f=0;f<d.length;++f)c.push(await OM(l[f],null,d[f]))}return[o,l,c]}testLoop(t,e,s,r=0,a){return it(()=>{const i=this.checkNumSamples(e,s,a,"steps"),o=[];if(r>0)throw new qt("Verbose mode is not implemented yet.");if(a!=null)throw new qt("steps mode in testLoop() is not implemented yet");{const l=Sw(i,s),c=Xn(jr(0,i));for(let d=0;d<l.length;++d){const f=l[d][0],m=l[d][1],g=cl(c,f,m-f),b=RS(e,g),x=t(b);if(d===0)for(let v=0;v<x.length;++v)o.push(Lt(0));for(let v=0;v<x.length;++v){const w=x[v];o[v]=wt(o[v],K(m-f,w))}}for(let d=0;d<o.length;++d)o[d]=Ot(o[d],i)}return o})}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let s=0;s<t.length;++s){const r=t[s];let a=r;if(UR(t,r)>1){const i=UR(t.slice(0,s),r);a+=`_${i}`}e.push(a)}return e}makeTrainFunction(){return t=>{const e=[],s=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],o=()=>{const f=[];for(let x=0;x<this.inputs.length;++x)f.push({key:this.inputs[x],value:s[x]});const m=new ji(f),g=Fd(this.outputs,m,{training:!0});let b;for(let x=0;x<this.lossFunctions.length;++x){const v=this.lossFunctions[x];let w=v(r[x],g[x]);a[x]!=null&&(w=dnt(w,a[x]));const T=Be(w);e.push(T),x===0?b=w:b=wt(b,w)}for(let x=0;x<this.metricsTensors.length;++x){let v;if(this.outputs.length>1&&x<this.outputs.length)v=e[x];else{const w=this.metricsTensors[x][0],T=this.metricsTensors[x][1];v=Be(w(r[T],g[T]))}pn(v),i.push(v)}return b=Be(b),this.calculateLosses().forEach(x=>{b=wt(b,x)}),b},l=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(o,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=t=>it(()=>{const e=[];let s;const r=t.slice(0,this.inputs.length),a=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let c=0;c<this.inputs.length;++c)i.push({key:this.inputs[c],value:r[c]});const o=new ji(i),l=Fd(this.outputs,o);for(let c=0;c<this.lossFunctions.length;++c){const d=this.lossFunctions[c],f=Be(d(a[c],l[c]));c===0?s=f:s=wt(s,f),e.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const d=this.metricsTensors[c][0],f=this.metricsTensors[c][1],m=Be(d(a[f],l[f]));e.push(m)}return e})}async fit(t,e,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,i,o,l,c,d,f,m;try{const g=s.batchSize==null?32:s.batchSize;ww(g);const x=await this.standardizeUserData(t,e,s.sampleWeight,s.classWeight,!1,g);r=x[0],a=x[1],m=x[2];let v=!1,w;if(s.validationData!=null&&s.validationData.length>0){if(v=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new qt("validationData including sample weights is not supported yet."):new J(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const L=await this.standardizeUserData(l,c,null,null,!0,g);d=L[0],f=L[1],w=d.concat(f)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){v=!0;const O=Math.floor(r[0].shape[0]*(1-s.validationSplit)),L=r[0].shape[0];d=Ed(r,O,L),i=r,r=Ed(r,0,O),f=Ed(a,O,L),o=a,a=Ed(a,0,O),w=d.concat(f)}else s.validationSteps!=null&&(v=!0);const T=r.concat(a).concat(m);this.checkTrainableWeightsConsistency();const C=this.makeTrainFunction(),k=this.getDedupedMetricsNames();let $,I;v?(this.makeTestFunction(),$=this.testFunction,I=k.slice().concat(k.map(O=>"val_"+O))):($=null,w=[],I=k.slice());const D=TM(s.callbacks,s.yieldEvery);return await this.fitLoop(C,T,k,g,s.epochs,s.verbose,D,$,w,s.shuffle,I,s.initialEpoch,null,null)}finally{this.isTraining=!1,Or(r,t),Or(a,e),Or(i,t),Or(o,e),Or(d,l),Or(f,c),m!=null&&Yt(m)}}async fitLoop(t,e,s,r,a,i,o,l,c,d,f,m,g,b){r==null&&(r=32),a==null&&(a=1),d==null&&(d=!0),m==null&&(m=0);let x=!1;if(l!=null&&c!=null&&(x=!0),b!=null&&(x=!0,g==null))throw new J("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(e,r,g,"steps_per_epoch");let w;v!=null&&(w=jr(0,v)),i==null&&(i=1);const{callbackList:T,history:C}=NM(o,i,a,m,v,g,r,x,f);T.setModel(this),this.history=C,await T.onTrainBegin(),this.stopTraining_=!1;for(let k=m;k<a;++k){await T.onEpochBegin(k);const $={};if(g!=null)throw new qt("stepsPerEpoch mode is not implemented yet.");{if(d==="batch")throw new qt("batch shuffling is not implemneted yet");d&&G2(w);const I=Xn(w),D=Sw(v,r);for(let _=0;_<D.length;++_){const O={};if(await T.onBatchBegin(_,O),it(()=>{const L=D[_][0],R=D[_][1],V=cl(I,L,R-L);O.batch=_,O.size=R-L;const Y=RS(e,V),Q=t(Y);for(let tt=0;tt<s.length;++tt){const B=s[tt],W=Q[tt];O[B]=W,pn(W)}if(_===D.length-1&&x){const tt=this.testLoop(l,c,r);for(let B=0;B<s.length;++B){const W=s[B],X=tt[B];pn(X),$["val_"+W]=X}}}),await T.onBatchEnd(_,O),SM(O),this.stopTraining_)break}I.dispose()}if(await T.onEpochEnd(k,$),this.stopTraining_)break}return await T.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,e){return mnt(this,t,e)}async trainOnBatch(t,e){const s=await this.standardizeUserData(t,e),r=s[0],a=s[1],o=this.makeTrainFunction()(r.concat(a)),l=[];for(const c of o){const d=await c.data();l.push(d[0])}return Yt(o),Or(s[0],t),Or(s[1],e),fs(l)}getNamedWeights(t){const e=[],s=t!=null&&t.trainableOnly,r=s?this.trainableWeights:this.weights,a=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||e.push({name:r[i].originalName,tensor:a[i]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const e=hS().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-hS().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=Ga(this.loss);else if(Array.isArray(this.loss)){for(const e of this.loss)if(typeof e!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(e=>Ga(e))}else{const e=Object.keys(this.loss);t={};const s=this.loss;for(const r of e)if(typeof s[r]=="string")t[r]=Ga(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Ga(qg(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>Ga(qg(t)));{const t={};for(const e in this.metrics)t[e]=Ga(qg(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const e=IS(t.optimizer_config),s=Za(e);let r;if(typeof t.loss=="string")r=Qo(t.loss);else if(Array.isArray(t.loss))r=t.loss.map(i=>Qo(i));else if(t.loss!=null){r={};for(const i in t.loss)r[i]=Qo(t.loss[i])}let a;if(Array.isArray(t.metrics))a=t.metrics.map(i=>Qo(i));else if(t.metrics!=null){a={};for(const i in t.metrics)a[i]=Qo(t.metrics[i])}this.compile({loss:r,metrics:a,optimizer:s})}async save(t,e){if(typeof t=="string"){const c=Q3(t);if(c.length===0)throw new J(`Cannot find any save handlers for URL '${t}'`);if(c.length>1)throw new J(`Found more than one (${c.length}) save handlers for URL '${t}'`);t=c[0]}if(t.save==null)throw new J("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await dS(this.getNamedWeights(e)),o={modelTopology:this.toJSON(null,!1),format:Tnt,generatedBy:`TensorFlow.js tfjs-layers v${RM}`,convertedBy:null};if((e==null?!1:e.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:d,specs:f}=await dS(await this.optimizer.getWeights(),c);s.specs.push(...f),s.data=Y3([s.data,d])}return this.userDefinedMetadata!=null&&(JR(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=s.data,o.weightSpecs=s.specs,t.save(o)}setUserDefinedMetadata(t){JR(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}Wu.className="Model";St(Wu);class LM extends Wu{}LM.className="Functional";St(LM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Tf extends Wu{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:mx("sequential_"),t.layers!=null)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new J(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const e=t instanceof Tf||t instanceof Wu;let s;if(e){if(s=t,s.outputs.length!==1)throw new J("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new J("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new J("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=Cet({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(r)}if(e)this.outputs=s.outputs,this.inputs=s.inputs;else{if(t.inboundNodes.length!==1)throw new J(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new J("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=yM(this.outputs[0])}this.inboundNodes=[],new yx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:wl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=t.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return this.model==null&&this.build(),this.model.call(t,e)}build(t){if(he(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Wu({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,s=console.log){this.built||this.build(),super.summary(t,e,s)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,e,s={}){if(!this.built)throw new wr("The model needs to be compiled before being used.");return this.model.evaluate(t,e,s)}async evaluateDataset(t,e){if(!this.built)throw new wr("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return this.model==null&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,s={}){if(!this.built)throw new wr("The model needs to be compiled before being used.");return this.model.fit(t,e,s)}async fitDataset(t,e){if(!this.built)throw new wr("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,s={},r=!1){let a,i={};if(e instanceof Array){if(e[0].className==null||e[0].className==="Merge")throw new J("Legacy serialization format not supported yet.");a=e}else F(e.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=e.layers,delete e.layers,i=e;const o=new t(i);if(!(o instanceof Tf))throw new qt(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of a){const d=Za(l,void 0,r);r&&d.setFastWeightInitDuringBuild(!0),o.add(d)}return o}set stopTraining(t){if(this.model==null)throw new J("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new J("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const s={};s.className=e.getClassName(),s.config=e.getConfig(),t.push(s)}return{name:this.name,layers:t}}}Tf.className="Sequential";St(Tf);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Yn=class extends _l{getConfig(){return{}}};class MM extends Yn{apply(t,e=1){return oet(t,e)}}MM.className="elu";St(MM);class zM extends Yn{apply(t){return Gb(t)}}zM.className="selu";St(zM);class PM extends Yn{apply(t){return Xr(t)}}PM.className="relu";St(PM);class BM extends Yn{apply(t){return it(()=>ao(6,Xr(t)))}}BM.className="relu6";St(BM);class VM extends Yn{apply(t){return t}}VM.className="linear";St(VM);class UM extends Yn{apply(t){return Vr(t)}}UM.className="sigmoid";St(UM);class WM extends Yn{apply(t){return cet(t)}}WM.className="hardSigmoid";St(WM);class GM extends Yn{apply(t){return Dl(t)}}GM.className="softplus";St(GM);class jM extends Yn{apply(t){return uet(t)}}jM.className="softsign";St(jM);class HM extends Yn{apply(t){return ro(t)}}HM.className="tanh";St(HM);let iC=class extends Yn{apply(t,e=-1){return sm(t,e)}};iC.className="softmax";St(iC);class qM extends Yn{apply(t,e=-1){return Lb(t,e)}}qM.className="logSoftmax";St(qM);class KM extends Yn{apply(t){return it(()=>it(()=>{const e=Math.sqrt(2),s=K(.5,wt(1,Ob(Ot(t,e))));return K(t,s)}))}}KM.className="gelu";St(KM);class XM extends Yn{apply(t){return it(()=>K(.5,K(t,wt(1,ro(K($n(Ot(2,Math.PI)),wt(t,K(.044715,xa(t,3)))))))))}}XM.className="gelu_new";St(XM);class YM extends Yn{apply(t){return it(()=>K(t,ro(Dl(t))))}}YM.className="mish";St(YM);class ZM extends Yn{apply(t,e=1){return it(()=>K(Vr(K(t,e)),t))}}ZM.className="swish";St(ZM);function oo(n){return n.getClassName()}function Tw(n,t={}){return um(n,Zs.getMap().classNameMap,t,"activation")}function lo(n){if(n==null){const t={};return t.className="linear",t.config={},Tw(t)}if(typeof n=="string"){const t={};return t.className=n,t.config={},Tw(t)}else return n instanceof Yn?n:Tw(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nnt(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class QM extends _l{}class JM extends QM{constructor(t){super(),Nnt(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return it(()=>{let e=un([1]);return this.hasL1&&(e=wt(e,It(K(this.l1,ln(t))))),this.hasL2&&(e=wt(e,It(K(this.l2,hm(t))))),Z(e,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}JM.className="L1L2";St(JM);const aD={l1l2:"L1L2"};function $e(n){return HN(n)}function iD(n,t={}){return um(n,Zs.getMap().classNameMap,t,"regularizer")}function Me(n){if(n==null)return null;if(typeof n=="string"){const e={className:n in aD?aD[n]:n,config:{}};return iD(e)}else return n instanceof QM?n:iD(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class t4 extends Qt{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,e){t=Bt(t);let s=Xr(t);return this.maxValue!=null&&(s=xs(s,0,this.maxValue)),s}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}t4.className="ReLU";St(t4);class e4 extends Qt{constructor(t){super(t??{}),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,e){const s=Bt(t);return qp(s,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}e4.className="LeakyReLU";St(e4);class n4 extends Qt{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=Le(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Me(t.alphaRegularizer),this.alphaConstraint=bn(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new J(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=he(t);const e=t.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)e[r-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<t.length;++r)s[r]=t[r];this.inputSpec=[new gn({ndim:t.length,axes:s})],this.built=!0}call(t,e){return t=Bt(t),tm(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Ve(this.alphaInitializer),alphaRegularizer:$e(this.alphaRegularizer),alphaConstraint:yn(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}n4.className="PReLU";St(n4);let s4=class extends Qt{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new qt(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,e){const s=Bt(t);return ch(s)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}};s4.className="ELU";St(s4);class r4 extends Qt{constructor(t){super(t??{}),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,e){const s=Bt(t);return K(s,Tt(Ts(s,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}r4.className="ThresholdedReLU";St(r4);class a4 extends Qt{constructor(t){super(t??{}),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new iC().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,e){return it(()=>{let s=Bt(t);const r=e.mask;if(r!=null){const a=K(Et(ms(s.shape),Tt(r,s.dtype)),Lt(-1e9));s=wt(s,a)}return this.axis instanceof Array?this.axis.length>1?vs(Et(s,Xp(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}a4.className="Softmax";St(a4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gu(n,t,e){if(typeof n=="number")return wl(n,t);if(n.length!==t)throw new J(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${n.length} elements.`);for(let s=0;s<t;++s){const r=n[s];if(!set(r))throw new J(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(n)} including a non-integer number ${r}`)}return n}function Ur(n,t,e,s,r=1){if(n==null)return n;const a=t+(t-1)*(r-1);let i;return e==="same"?i=n:i=n-a+1,Math.floor((i+s-1)/s)}function aa(n,t,e,s){if(n==null)return null;if(s==="valid")n=n*t+io([e-t,0]);else if(s==="same")n=n*t;else throw new J(`Unsupport padding mode: ${s}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oC(n,t){return it(()=>(en(t),t==="channelsFirst"?ne(n,[0,2,3,1]):n))}function i4(n,t){return it(()=>(en(t),t==="channelsFirst"?ne(n,[0,2,3,4,1]):n))}function Cnt(n,t,e,s=1,r="valid",a,i=1){return it(()=>{if(a==null&&(a=Hr()),en(a),n.shape.length!==3)throw new J(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(t.shape.length!==3)throw new J(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(e!=null&&e.shape.length!==1)throw new J(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(a==="channelsFirst"&&(n=ne(n,[0,2,1])),r==="causal")throw new qt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=Ib(n,t,s,r==="same"?"same":"valid","NWC",i);return e!=null&&(o=Yr(o,e)),o})}function oD(n,t,e,s=[1,1],r="valid",a,i,o=null){return it(()=>{if(a==null&&(a=Hr()),en(a),n.rank!==3&&n.rank!==4)throw new J(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(t.rank!==3&&t.rank!==4)throw new J(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=oC(n,a);if(r==="causal")throw new qt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=QF({x:l,filter:t,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:e,activation:o}),a==="channelsFirst"&&(l=ne(l,[0,3,1,2])),l})}function knt(n,t,e,s=[1,1,1],r="valid",a,i){return it(()=>{if(a==null&&(a=Hr()),en(a),n.rank!==4&&n.rank!==5)throw new J(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(t.rank!==4&&t.rank!==5)throw new J(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let o=i4(n,a);if(r==="causal")throw new qt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=$T(o,t,s,r==="same"?"same":"valid","NDHWC",i),e!=null&&(o=Yr(o,e)),a==="channelsFirst"&&(o=ne(o,[0,4,1,2,3])),o})}class vx extends Qt{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",vx.verifyArgs(e),this.rank=t,Cn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new qt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Gu(e.kernelSize,t,"kernelSize"),this.strides=Gu(e.strides==null?1:e.strides,t,"strides"),this.padding=e.padding==null?"valid":e.padding,rr(this.padding),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,en(this.dataFormat),this.activation=lo(e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.biasInitializer=Le(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=bn(e.biasConstraint),this.biasRegularizer=Me(e.biasRegularizer),this.activityRegularizer=Me(e.activityRegularizer),this.dilationRate=Gu(e.dilationRate==null?1:e.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new J(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new J(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new J(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(ra("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!qN(t.kernelSize,"number",1,3))throw new J(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:oo(this.activation),useBias:this.useBias,biasInitializer:Ve(this.biasInitializer),biasRegularizer:$e(this.biasRegularizer),activityRegularizer:$e(this.activityRegularizer),biasConstraint:yn(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class mh extends vx{constructor(t,e){super(t,e),this.kernel=null,mh.verifyArgs(e),this.filters=e.filters,Cn(this.filters,"filters"),this.kernelInitializer=Le(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=bn(e.kernelConstraint),this.kernelRegularizer=Me(e.kernelRegularizer)}build(t){t=he(t);const e=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[e]==null)throw new J(`The channel dimension of the input should be defined. Found ${t[e]}`);const s=t[e],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:s}}],this.built=!0}call(t,e){return it(()=>{t=Bt(t);let s;const r=this.bias==null?null:this.bias.read(),a=nM(this.activation.getClassName());if(a!=null&&this.rank===2)s=oD(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)s=Cnt(t,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=oD(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=knt(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new qt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(t){t=he(t);const e=[],s=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let a=0;a<s.length;++a){const i=Ur(s[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);e.push(i)}let r=[t[0]];return this.dataFormat==="channelsLast"?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:Ve(this.kernelInitializer),kernelRegularizer:$e(this.kernelRegularizer),kernelConstraint:yn(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new J(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class mm extends mh{constructor(t){super(2,t),mm.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!qN(t.kernelSize,"number",1,2))throw new J(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}mm.className="Conv2D";St(mm);class gm extends mh{constructor(t){super(3,t),gm.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new J(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}gm.className="Conv3D";St(gm);class o4 extends mm{constructor(t){if(super(t),this.inputSpec=[new gn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new J(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=he(t),t.length!==4)throw new J("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[e]==null)throw new J("The channel dimension of the inputs should be defined. Found `None`.");const s=t[e],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new gn({ndim:4,axes:{[e]:s}})],this.built=!0}call(t,e){return it(()=>{let s=Bt(t);if(s.shape.length!==4)throw new J(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,o;this.dataFormat==="channelsFirst"?(i=2,o=3):(i=1,o=2);const l=r[i],c=r[o],d=this.kernelSize[0],f=this.kernelSize[1],m=this.strides[0],g=this.strides[1],b=aa(l,m,d,this.padding),x=aa(c,g,f,this.padding),v=[a,b,x,this.filters];this.dataFormat!=="channelsLast"&&(s=ne(s,[0,2,3,1]));let w=Ab(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=ne(w,[0,3,1,2])),this.bias!=null&&(w=Yr(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(t){t=he(t);const e=t.slice();let s,r,a;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3):(s=3,r=1,a=2);const i=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return e[s]=this.filters,e[r]=aa(e[r],l,i,this.padding),e[a]=aa(e[a],c,o,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}o4.className="Conv2DTranspose";St(o4);class l4 extends gm{constructor(t){if(super(t),this.inputSpec=[new gn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new J(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=he(t),t.length!==5)throw new J("Input should have rank 5; Received input shape: "+JSON.stringify(t));const e=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[e]==null)throw new J("The channel dimension of the inputs should be defined. Found `None`.");const s=t[e],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new gn({ndim:5,axes:{[e]:s}})],this.built=!0}call(t,e){return it(()=>{let s=Bt(t);if(s.shape.length!==5)throw new J(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,o,l;this.dataFormat==="channelsFirst"?(l=2,i=3,o=4):(l=1,i=2,o=3);const c=r[l],d=r[i],f=r[o],m=this.kernelSize[0],g=this.kernelSize[1],b=this.kernelSize[2],x=this.strides[0],v=this.strides[1],w=this.strides[2],T=aa(c,x,m,this.padding),C=aa(d,v,g,this.padding),k=aa(f,w,b,this.padding),$=[a,T,C,k,this.filters];this.dataFormat!=="channelsLast"&&(s=ne(s,[0,2,3,4,1]));let I=ET(s,this.kernel.read(),$,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(I=ne(I,[0,4,1,2,3])),this.bias!==null&&(I=Yr(I,this.bias.read(),this.dataFormat)),this.activation!==null&&(I=this.activation.apply(I)),I})}computeOutputShape(t){t=he(t);const e=t.slice();let s,r,a,i;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3,i=4):(s=4,r=1,a=2,i=3);const o=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],d=this.strides[0],f=this.strides[1],m=this.strides[2];return e[s]=this.filters,e[r]=aa(e[r],d,o,this.padding),e[a]=aa(e[a],f,l,this.padding),e[i]=aa(e[i],m,c,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}l4.className="Conv3DTranspose";St(l4);class u4 extends mh{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,e.filters==null)throw new J("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(e.kernelInitializer!=null||e.kernelRegularizer!=null||e.kernelConstraint!=null)throw new J("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(e.padding!=null&&e.padding!=="same"&&e.padding!=="valid")throw new J(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(e.padding)}`);this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Le(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Me(e.depthwiseRegularizer),this.depthwiseConstraint=bn(e.depthwiseConstraint),this.pointwiseInitializer=Le(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Me(e.pointwiseRegularizer),this.pointwiseConstraint=bn(e.pointwiseConstraint)}build(t){if(t=he(t),t.length<this.rank+2)throw new J(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const e=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[e]==null||t[e]<0)throw new J(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[e])}`);const s=t[e],r=this.kernelSize.concat([s,this.depthMultiplier]),a=[];for(let o=0;o<this.rank;++o)a.push(1);a.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new gn({ndim:this.rank+2,axes:{[e]:s}})],this.built=!0}call(t,e){return it(()=>{t=Bt(t);let s;if(this.rank===1)throw new qt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=ne(t,[0,2,3,1])),s=jb(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Yr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=ne(s,[0,3,1,2])),s})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Ve(this.depthwiseInitializer),t.pointwiseInitializer=Ve(this.pointwiseInitializer),t.depthwiseRegularizer=$e(this.depthwiseRegularizer),t.pointwiseRegularizer=$e(this.pointwiseRegularizer),t.depthwiseConstraint=yn(this.depthwiseConstraint),t.pointwiseConstraint=yn(this.pointwiseConstraint),t}}u4.className="SeparableConv";class c4 extends u4{constructor(t){super(2,t)}}c4.className="SeparableConv2D";St(c4);class wx extends mh{constructor(t){super(1,t),wx.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!qN(t.kernelSize,"number",1,1))throw new J(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}wx.className="Conv1D";St(wx);class h4 extends Qt{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return it(()=>{if(t=Bt(t),this.dataFormat==="channelsLast"){const s=Hg(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Hg(s,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Hg(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Hg(s,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}h4.className="Cropping2D";St(h4);class d4 extends Qt{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,en(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,tet(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const e=t[2]==null?null:this.size[0]*t[2],s=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],e,s]}else{const e=t[1]==null?null:this.size[0]*t[1],s=t[2]==null?null:this.size[1]*t[2];return[t[0],e,s,t[3]]}}call(t,e){return it(()=>{let s=Bt(t);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=ne(s,[0,2,3,1]);const a=this.size[0]*r[2],i=this.size[1]*r[3],o=this.interpolation==="nearest"?Pr.resizeNearestNeighbor(s,[a,i]):Pr.resizeBilinear(s,[a,i]);return ne(o,[0,3,1,2])}else{const a=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?Pr.resizeNearestNeighbor(s,[a,i]):Pr.resizeBilinear(s,[a,i])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}}d4.className="UpSampling2D";St(d4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $nt(n,t,e=[1,1],s="valid",r,a){return it(()=>{r==null&&(r=Hr()),en(r);let i=oC(n,r);if(n.rank!==4)throw new J(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(t.rank!==4)throw new J(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return i=uh(i,t,e,s==="same"?"same":"valid","NHWC",a),r==="channelsFirst"&&(i=ne(i,[0,3,1,2])),i})}class f4 extends vx{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Le(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=bn(t.depthwiseConstraint),this.depthwiseRegularizer=Me(t.depthwiseRegularizer)}build(t){if(t=he(t),t.length<4)throw new J(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const e=this.dataFormat==="channelsFirst"?1:3;if(t[e]==null||t[e]<0)throw new J(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[e]}).`);const s=t[e],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return it(()=>{t=Bt(t);let s=$nt(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Yr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(t){t=he(t);const e=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],r=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,a=Ur(e,this.kernelSize[0],this.padding,this.strides[0]),i=Ur(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],r,a,i]:[t[0],a,i,r]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Ve(this.depthwiseInitializer),t.depthwiseRegularizer=$e(this.depthwiseRegularizer),t.depthwiseConstraint=yn(this.depthwiseRegularizer),t}}f4.className="DepthwiseConv2D";St(f4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function p4(n,t,e,s){if(Array.isArray(n)){if(t!=null||e!=null)throw new J("When inputs is an array, neither initialState or constants should be provided");s!=null&&(e=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(t=n.slice(1,n.length)),n=n[0]}function r(a){return a==null||Array.isArray(a)?a:[a]}return t=r(t),e=r(e),{inputs:n,initialState:t,constants:e}}function m4(n,t,e,s=!1,r,a,i=!1,o=!1){return it(()=>{const l=t.shape.length;if(l<3)throw new J(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(jr(2,l));t=ne(t,c),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Tt(Tt(r,"bool"),"float32"),r.rank===l-1&&(r=Kn(r,-1)),r=ne(r,c)),s&&(t=nr(t,0),r!=null&&(r=nr(r,0)));const d=[];let f,m=e;const g=t.shape[0],b=sr(t);let x;r!=null&&(x=sr(r));for(let w=0;w<g;++w){const T=b[w],C=it(()=>n(T,m));if(r==null)f=C[0],m=C[1];else{const k=it(()=>{const $=x[w],I=Et(Ls($),$),D=wt(K(C[0],$),K(m[0],I)),_=m.map((O,L)=>wt(K(C[1][L],$),K(O,I)));return{output:D,newStates:_}});f=k.output,m=k.newStates}o&&d.push(f)}let v;return o&&(v=ws(d,1)),[f,v,m]})}class wo extends Qt{constructor(t){super(t);let e;if(t.cell==null)throw new J("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?e=new cC({cells:t.cell}):e=t.cell,e.stateSize==null)throw new J("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new gn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return jr(0,t).map(e=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){kS(t)&&(t=t[0]),t=t;let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const s=e[0];let r;if(this.returnSequences?r=[t[0],t[1],s]:r=[t[0],s],this.returnState){const a=[];for(const i of e)a.push([t[0],i]);return[r].concat(a)}else return r}computeMask(t,e){return it(()=>{Array.isArray(e)&&(e=e[0]);const s=this.returnSequences?e:null;if(this.returnState){const r=this.states.map(a=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let s=0;s<t;++s)e.push(null);return e}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new qt("Constants support is not implemented in RNN yet.");kS(t)&&(t=t[0]),t=t;const e=this.stateful?t[0]:null,s=t.slice(2);this.inputSpec[0]=new gn({shape:[e,null,...s]});const r=[t[0]].concat(t.slice(2));this.cell.build(r);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!te(this.stateSpec.map(i=>i.shape[i.shape.length-1]),a))throw new J(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(i=>new gn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(t,e=!1){it(()=>{if(!this.stateful)throw new sa("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new J("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>un([s,r])):this.states_=[un([s,this.cell.stateSize])];else if(t==null)Yt(this.states_),this.keptStates!=null&&(Yt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>un([s,r])):this.states_[0]=un([s,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new J(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);e===!0?this.keptStates.push(this.states_.slice()):Yt(this.states_);for(let r=0;r<this.states_.length;++r){const a=t[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,o=[s,i];if(!te(a.shape,o))throw new J(`State ${r} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${a.shape}`);this.states_[r]=a}}this.states_=this.states_.map(r=>pn(r.clone()))})}apply(t,e){let s=e==null?null:e.initialState,r=e==null?null:e.constants;e==null&&(e={});const a=p4(t,s,r,this.numConstants);t=a.inputs,s=a.initialState,r=a.constants;let i=[],o=[];if(s!=null){e.initialState=s,i=i.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new gn({shape:c.shape}));o=o.concat(this.stateSpec)}if(r!=null&&(e.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof wa){const c=[t].concat(i),d=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=d;const m=super.apply(c,e);return this.inputSpec=f,m}else return super.apply(t,e)}call(t,e){return it(()=>{const s=e==null?null:e.mask,r=e==null?null:e.training;let a=e==null?null:e.initialState;t=Bt(t),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(t));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new J(`RNN Layer has ${i} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},c=m4((b,x)=>{const v=this.cell.call([b].concat(x),o);return[v[0],v.slice(1)]},t,a,this.goBackwards,s,null,this.unroll,this.returnSequences),d=c[0],f=c[1],m=c[2];this.stateful&&this.resetStates(m,r);const g=this.returnSequences?f:d;return this.returnState?[g].concat(m):g})}getInitialState(t){return it(()=>{let e=un(t.shape);return e=It(e,[1,2]),e=cm(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?NS(e,[1,s]):e):this.cell.stateSize>1?[NS(e,[1,this.cell.stateSize])]:[e]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(e.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===wo.className&&(e.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),t),e)}static fromConfig(t,e,s={}){const r=e.cell,a=Za(r,s);return new t(Object.assign(e,{cell:a}))}}wo.className="RNN";St(wo);class Sx extends Qt{}class lC extends Sx{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Cn(this.units,"units"),this.activation=lo(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Le(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Le(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Le(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Me(t.kernelRegularizer),this.recurrentRegularizer=Me(t.recurrentRegularizer),this.biasRegularizer=Me(t.biasRegularizer),this.kernelConstraint=bn(t.kernelConstraint),this.recurrentConstraint=bn(t.recurrentConstraint),this.biasConstraint=bn(t.biasConstraint),this.dropout=ec([1,io([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=ec([1,io([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=he(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return it(()=>{if(t=t,t.length!==2)throw new J(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let s=t[1];t=t[0];const r=e.training==null?!1:e.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=uo({ones:()=>Ls(t),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=uo({ones:()=>Ls(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a;const i=this.dropoutMask,o=this.recurrentDropoutMask;i!=null?a=ma(K(t,i),this.kernel.read()):a=ma(t,this.kernel.read()),this.bias!=null&&(a=Yr(a,this.bias.read())),o!=null&&(s=K(s,o));let l=wt(a,ma(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:oo(this.activation),useBias:this.useBias,kernelInitializer:Ve(this.kernelInitializer),recurrentInitializer:Ve(this.recurrentInitializer),biasInitializer:Ve(this.biasInitializer),kernelRegularizer:$e(this.kernelRegularizer),recurrentRegularizer:$e(this.recurrentRegularizer),biasRegularizer:$e(this.biasRegularizer),activityRegularizer:$e(this.activityRegularizer),kernelConstraint:yn(this.kernelConstraint),recurrentConstraint:yn(this.recurrentConstraint),biasConstraint:yn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),e)}}lC.className="SimpleRNNCell";St(lC);class g4 extends wo{constructor(t){t.cell=new lC(t),super(t)}call(t,e){return it(()=>{this.cell.dropoutMask!=null&&(Yt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Yt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=e==null?null:e.mask,r=e==null?null:e.training,a=e==null?null:e.initialState;return super.call(t,{mask:s,training:r,initialState:a})})}static fromConfig(t,e){return new t(e)}}g4.className="SimpleRNN";St(g4);class uC extends Sx{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new J("GRUCell does not support reset_after parameter set to true.");this.units=t.units,Cn(this.units,"units"),this.activation=lo(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=lo(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Le(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Le(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Le(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Me(t.kernelRegularizer),this.recurrentRegularizer=Me(t.recurrentRegularizer),this.biasRegularizer=Me(t.biasRegularizer),this.kernelConstraint=bn(t.kernelConstraint),this.recurrentConstraint=bn(t.recurrentConstraint),this.biasConstraint=bn(t.biasConstraint),this.dropout=ec([1,io([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=ec([1,io([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=he(t);const e=t[t.length-1];this.kernel=this.addWeight("kernel",[e,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return it(()=>{if(t=t,t.length!==2)throw new J(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const s=e.training==null?!1:e.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=uo({ones:()=>Ls(t),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=uo({ones:()=>Ls(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let o,l,c;0<this.dropout&&this.dropout<1&&(t=K(t,a[0]));let d=ma(t,this.kernel.read());this.useBias&&(d=Yr(d,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=K(r,i[0]));const f=this.recurrentKernel.read(),[m,g]=gs(f,[2*this.units,this.units],f.rank-1),b=ma(r,m),[x,v,w]=gs(d,3,d.rank-1),[T,C]=gs(b,2,b.rank-1);o=this.recurrentActivation.apply(wt(x,T)),l=this.recurrentActivation.apply(wt(v,C));const k=ma(K(l,r),g);c=this.activation.apply(wt(w,k));const $=wt(K(o,r),K(wt(1,De(o)),c));return[$,$]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:oo(this.activation),recurrentActivation:oo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ve(this.kernelInitializer),recurrentInitializer:Ve(this.recurrentInitializer),biasInitializer:Ve(this.biasInitializer),kernelRegularizer:$e(this.kernelRegularizer),recurrentRegularizer:$e(this.recurrentRegularizer),biasRegularizer:$e(this.biasRegularizer),activityRegularizer:$e(this.activityRegularizer),kernelConstraint:yn(this.kernelConstraint),recurrentConstraint:yn(this.recurrentConstraint),biasConstraint:yn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),e)}}uC.className="GRUCell";St(uC);class y4 extends wo{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new uC(t),super(t)}call(t,e){return it(()=>{this.cell.dropoutMask!=null&&(Yt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Yt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=e==null?null:e.mask,r=e==null?null:e.training,a=e==null?null:e.initialState;return super.call(t,{mask:s,training:r,initialState:a})})}static fromConfig(t,e){return e.implmentation===0&&(e.implementation=1),new t(e)}}y4.className="GRU";St(y4);class Tx extends Sx{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Cn(this.units,"units"),this.activation=lo(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=lo(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Le(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Le(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Le(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Me(t.kernelRegularizer),this.recurrentRegularizer=Me(t.recurrentRegularizer),this.biasRegularizer=Me(t.biasRegularizer),this.kernelConstraint=bn(t.kernelConstraint),this.recurrentConstraint=bn(t.recurrentConstraint),this.biasConstraint=bn(t.biasConstraint),this.dropout=ec([1,io([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=ec([1,io([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;t=he(t);const s=t[t.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const a=this.biasInitializer,i=this.units;r=new(e=class extends $r{apply(l,c){const d=a.apply([i]),f=new XN().apply([i]),m=a.apply([i*2]);return GR(GR(d,f),m)}},e.className="CustomInit",e)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return it(()=>{const s=e.training==null?!1:e.training;if(t=t,t.length!==3)throw new J(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let r=t[1];const a=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=uo({ones:()=>Ls(t),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=uo({ones:()=>Ls(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let l,c,d,f;0<this.dropout&&this.dropout<1&&(t=K(t,i[0]));let m=ma(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=K(r,o[0])),m=wt(m,ma(r,this.recurrentKernel.read())),this.useBias&&(m=Yr(m,this.bias.read()));const[g,b,x,v]=gs(m,4,m.rank-1);l=this.recurrentActivation.apply(g),c=this.recurrentActivation.apply(b),d=wt(K(c,a),K(l,this.activation.apply(x))),f=this.recurrentActivation.apply(v);const w=K(f,this.activation.apply(d));return[w,w,d]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:oo(this.activation),recurrentActivation:oo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ve(this.kernelInitializer),recurrentInitializer:Ve(this.recurrentInitializer),biasInitializer:Ve(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:$e(this.kernelRegularizer),recurrentRegularizer:$e(this.recurrentRegularizer),biasRegularizer:$e(this.biasRegularizer),activityRegularizer:$e(this.activityRegularizer),kernelConstraint:yn(this.kernelConstraint),recurrentConstraint:yn(this.recurrentConstraint),biasConstraint:yn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),e)}}Tx.className="LSTMCell";St(Tx);class b4 extends wo{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new Tx(t),super(t)}call(t,e){return it(()=>{this.cell.dropoutMask!=null&&(Yt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Yt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=e==null?null:e.mask,r=e==null?null:e.training,a=e==null?null:e.initialState;return super.call(t,{mask:s,training:r,initialState:a})})}static fromConfig(t,e){return e.implmentation===0&&(e.implementation=1),new t(e)}}b4.className="LSTM";St(b4);class cC extends Sx{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return it(()=>{t=t;let s=t.slice(1);const r=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?r.push(s.splice(0,o.stateSize.length)):r.push(s.splice(0,1));r.reverse();const a=[];let i;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];s=r[o],o===0?i=[t[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,e),a.push(i.slice(1))}s=[];for(const o of a.slice().reverse())s.push(...o);return[i[0]].concat(s)})}build(t){kS(t)&&(t=t[0]),t=t;let e;this.cells.forEach((s,r)=>{ul(`RNNCell_${r}`,()=>{s.build(t),Array.isArray(s.stateSize)?e=s.stateSize[0]:e=s.stateSize,t=[t[0],e]})}),this.built=!0}getConfig(){const t=super.getConfig(),e=a=>({className:a.getClassName(),config:a.getConfig()}),r={cells:this.cells.map(e)};return Object.assign(Object.assign({},t),r)}static fromConfig(t,e,s={}){const r=[];for(const a of e.cells)r.push(Za(a,s));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const s of this.cells)e.push(...s.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return $S(t)}setWeights(t){const e=[];for(const s of this.cells){const r=s.weights.length,a=t.splice(r);for(let i=0;i<s.weights.length;++i)e.push([s.weights[i],a[i]])}nC(e)}}cC.className="StackedRNNCells";St(cC);function uo(n){const{ones:t,rate:e,training:s=!1,count:r=1,dropoutFunc:a}=n,i=()=>a!=null?a(t(),e):uM(t(),e),o=()=>dm(i,t,s);return!r||r<=1?pn(o().clone()):Array(r).fill(void 0).map(o).map(c=>pn(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Ent=function(n,t){var e={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.indexOf(s)<0&&(e[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(e[s[r]]=n[s[r]]);return e};class x4 extends wo{constructor(t){if(t.unroll)throw new qt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new qt("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new gn({ndim:5})]}call(t,e){return it(()=>{if(this.cell.dropoutMask!=null&&(Yt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Yt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e.constants)throw new J("ConvRNN2D cell does not support constants");const s=e==null?null:e.mask,r=e==null?null:e.training,a=e==null?null:e.initialState;return super.call(t,{mask:s,training:r,initialState:a})})}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return it(()=>{const{stateSize:e}=this.cell,s=t.shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)],i=un(a);return Array.isArray(e)?Array(e.length).fill(i):[i]})}resetStates(t,e=!1){it(()=>{if(!this.stateful)throw new sa("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)];if(s[0]==null)throw new J("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>un(a)):this.states_=[un(a)];else if(t==null)Yt(this.states_),this.keptStates!=null&&(Yt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>un(a)):this.states_[0]=un(a);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new J(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);e?this.keptStates.push(this.states_.slice()):Yt(this.states_);for(let o=0;o<this.states_.length;++o){const l=t[o],c=a;if(!te(l.shape,c))throw new J(`State ${o} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>pn(o.clone()))})}computeSingleOutputShape(t){const{dataFormat:e,filters:s,kernelSize:r,padding:a,strides:i,dilationRate:o}=this.cell,l=e==="channelsFirst",c=t[l?3:2],d=t[l?4:3],f=Ur(c,r[0],a,i[0],o[0]),m=Ur(d,r[1],a,i[1],o[1]);return[...t.slice(0,2),...l?[s,f,m]:[f,m,s]]}}x4.className="ConvRNN2D";class hC extends Tx{constructor(t){const{filters:e,kernelSize:s,strides:r,padding:a,dataFormat:i,dilationRate:o}=t;super(Object.assign(Object.assign({},t),{units:e})),this.filters=e,Cn(this.filters,"filters"),this.kernelSize=Gu(s,2,"kernelSize"),this.kernelSize.forEach(l=>Cn(l,"kernelSize")),this.strides=Gu(r||1,2,"strides"),this.strides.forEach(l=>Cn(l,"strides")),this.padding=a||"valid",rr(this.padding),this.dataFormat=i||"channelsLast",en(this.dataFormat),this.dilationRate=Gu(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>Cn(l,"dilationRate"))}build(t){var e;t=he(t);const s=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[s]==null)throw new J(`The channel dimension of the input should be defined. Found ${t[s]}`);const r=t[s],a=4,i=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,d=this.filters;l=new(e=class extends $r{apply(m,g){const b=c.apply([d]),x=ms([d]),v=c.apply([d*2]);return KN([b,x,v])}},e.className="CustomInit",e)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return it(()=>{if(t.length!==3)throw new J(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const s=e.training||!1,r=t[0],a=t[1],i=t[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=uo({ones:()=>Ls(r),rate:this.dropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(P,j,rt)=>!j||!j[rt]?P:K(j[rt],P);let d=c(r,l,0),f=c(r,l,1),m=c(r,l,2),g=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=uo({ones:()=>Ls(a),rate:this.recurrentDropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const b=this.recurrentDropoutMask;let x=c(a,b,0),v=c(a,b,1),w=c(a,b,2),T=c(a,b,3);const C=3,[k,$,I,D]=gs(this.kernel.read(),o,C),[_,O,L,R]=this.useBias?gs(this.bias.read(),o):[null,null,null,null];d=this.inputConv(d,k,_,this.padding),f=this.inputConv(f,$,O,this.padding),m=this.inputConv(m,I,L,this.padding),g=this.inputConv(g,D,R,this.padding);const[V,Y,Q,tt]=gs(this.recurrentKernel.read(),o,C);x=this.recurrentConv(x,V),v=this.recurrentConv(v,Y),w=this.recurrentConv(w,Q),T=this.recurrentConv(T,tt);const B=this.recurrentActivation.apply(wt(d,x)),W=this.recurrentActivation.apply(wt(f,v)),X=wt(K(W,i),K(B,this.activation.apply(wt(m,w)))),ot=K(this.recurrentActivation.apply(wt(g,T)),this.activation.apply(X));return[ot,ot,X]})}getConfig(){const t=super.getConfig(),{units:e}=t,s=Ent(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(t,e,s,r){const a=ri(t,e,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Yr(a,s,this.dataFormat):a}recurrentConv(t,e){return ri(t,e,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}hC.className="ConvLSTM2DCell";St(hC);class v4 extends x4{constructor(t){const e=new hC(t);super(Object.assign(Object.assign({},t),{cell:e}))}static fromConfig(t,e){return new t(e)}}v4.className="ConvLSTM2D";St(v4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dC extends Qt{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const e=t.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?e[r]:this.noiseShape[r]);return s}call(t,e){return it(()=>{this.invokeCallHook(t,e);const s=Bt(t);if(0<this.rate&&this.rate<1){const r=e.training==null?!1:e.training,a=this.getNoiseShape(s);return dm(()=>uM(s,this.rate,a,this.seed),()=>s,r)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}dC.className="Dropout";St(dC);class w4 extends dC{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}w4.className="SpatialDropout1D";St(w4);class S4 extends Qt{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let e=null;t.batchSize!=null&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,Cn(this.units,"units"),this.activation=lo(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=Le(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Le(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=bn(t.kernelConstraint),this.biasConstraint=bn(t.biasConstraint),this.kernelRegularizer=Me(t.kernelRegularizer),this.biasRegularizer=Me(t.biasRegularizer),this.activityRegularizer=Me(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=he(t);const e=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){t=he(t);const e=t.slice();return e[e.length-1]=this.units,e}call(t,e){return it(()=>{this.invokeCallHook(t,e);const s=Bt(t),r=nM(this.activation.getClassName());let a;return r!=null?a=ma(s,this.kernel.read(),r,this.bias?this.bias.read():null):(a=ma(s,this.kernel.read()),this.bias!=null&&(a=Yr(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){const t={units:this.units,activation:oo(this.activation),useBias:this.useBias,kernelInitializer:Ve(this.kernelInitializer),biasInitializer:Ve(this.biasInitializer),kernelRegularizer:$e(this.kernelRegularizer),biasRegularizer:$e(this.biasRegularizer),activityRegularizer:$e(this.activityRegularizer),kernelConstraint:yn(this.kernelConstraint),biasConstraint:yn(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}S4.className="Dense";St(S4);class T4 extends Qt{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=he(t);for(const e of t.slice(1))if(e==null)throw new J(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],Xi(t,1)]}call(t,e){return it(()=>{this.invokeCallHook(t,e);let s=Bt(t);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let a=2;a<s.rank;++a)r.push(a);r.push(1),s=ne(s,r)}return iet(s)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}T4.className="Flatten";St(T4);class N4 extends Qt{constructor(t){super(t),this.supportsMasking=!0,this.activation=lo(t.activation)}call(t,e){return it(()=>{this.invokeCallHook(t,e);const s=Bt(t);return this.activation.apply(s)})}getConfig(){const t={activation:oo(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}N4.className="Activation";St(N4);class C4 extends Qt{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return it(()=>(t=Bt(t),ret(t,this.n)))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}C4.className="RepeatVector";St(C4);class k4 extends Qt{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,e){const s="Total size of new array must be unchanged.",r=e.slice();let a=1,i=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(i===null)i=l;else throw new J("Can only specifiy one unknown dimension.");else a*=c}const o=Xi(t);if(i!==null){if(a===0||o%a!==0)throw new J(s);r[i]=o/a}else if(o!==a)throw new J(s);return r}computeOutputShape(t){let e=!1;for(let s=0;s<t.length;++s)if(this.isUnknown(t[s])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return it(()=>{this.invokeCallHook(t,e);const s=Bt(t),r=s.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return Z(s,a)})}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}k4.className="Reshape";St(k4);class $4 extends Qt{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const e=jr(1,t.dims.length+1);if(!te(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new gn({ndim:this.dims.length+1})]}computeOutputShape(t){t=he(t);const e=t.slice();return this.dims.forEach((s,r)=>{e[r+1]=t[s]}),e}call(t,e){return ne(Bt(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}$4.className="Permute";St($4);class E4 extends Qt{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const s=Bt(t);return yf(bl(s,this.maskValue),-1)}call(t,e){return it(()=>{this.invokeCallHook(t,e);const s=Bt(t),i=yf(bl(s,this.maskValue),-1,!0);return K(s,Tt(i,s.dtype))})}}E4.className="Masking";St(E4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class I4 extends Qt{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let e=null;t.batchSize!=null&&(e=t.batchSize),t.inputLength==null?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(ye(t.inputLength))}this.inputDim=t.inputDim,Cn(this.inputDim,"inputDim"),this.outputDim=t.outputDim,Cn(this.outputDim,"outputDim"),this.embeddingsInitializer=Le(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Me(t.embeddingsRegularizer),this.activityRegularizer=Me(t.activityRegularizer),this.embeddingsConstraint=bn(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return it(()=>this.maskZero?(t=Bt(t),bl(t,ie(t))):null)}computeOutputShape(t){if(t=he(t),this.inputLength==null)return[...t,this.outputDim];const e=ye(this.inputLength);if(e.length!==t.length-1)throw new J(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let s=0;for(let r=0;r<e.length;++r){const a=e[r],i=t[r+1];if(a!=null&&i!=null&&a!==i)throw new J(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);a==null&&(e[s]=i),s++}}return[t[0],...e,this.outputDim]}call(t,e){return it(()=>{this.invokeCallHook(t,e);let s=Bt(t);s.dtype!=="int32"&&(s=pa(s,"int32"));const r=lM(this.embeddings.read(),Z(s,[s.size]));return Z(r,he(this.computeOutputShape(s.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Ve(this.embeddingsInitializer),embeddingsRegularizer:$e(this.embeddingsRegularizer),activityRegularizer:$e(this.activityRegularizer),embeddingsConstraint:yn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}I4.className="Embedding";St(I4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ll extends Qt{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new qt}computeElementwiseOpOutputShape(t,e){if(t==null||e==null)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(e.length===0)return t;const s=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const a=t[t.length-e.length+r],i=e[r];if(a==null||i==null||a<0||i<0)s.push(null);else if(a===1)s.push(i);else if(i===1)s.push(a);else{if(a!==i)throw new J("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));s.push(a)}}return s}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[he(t)]),t=t,t.length<2)throw new J(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const a of t)a!=null&&a[0]!==null&&e.push(a[0]);if(e=Ki(e),e.length>1)throw new J(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let s=t[0]==null?null:t[0].slice(1);for(let a=1;a<t.length;++a){const i=t[a]==null?null:t[a].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=t.map(a=>a.length);t.indexOf(null)===-1&&Ki(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return it(()=>{if(t=t,this.reshapeRequired){const s=[],r=t.map(a=>a.rank);if(r.indexOf(null)===-1){const a=io(r);for(let i of t){const o=i.rank;for(let l=0;l<a-o;++l)i=cm(i,1);s.push(i)}return this.mergeFunction(s)}else{let a=!1;for(const l of t){const c=l.rank;if(c==null){const d=l.shape,f=d[0],m=d.slice(1).concat([f]);let g=Z(l,[f].concat(Xi(d.slice(1))));g=ne(g,[1,0]),g=Z(g,m),s.push(g),a=!0}else if(c>1){const d=jr(1,c).concat([0]);s.push(ne(l,d)),a=!0}else s.push(l)}let i=this.mergeFunction(s);const o=i.rank;if(a){if(o==null){const l=i.shape,c=l.length,d=l[c-1],f=[d].concat(l.slice(0,l.length-1));i=Z(ne(Z(i,[-1,d]),[1,0]),f)}else if(o>1){const l=[o-1].concat(jr(0,o-1));i=ne(i,l)}}return i}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let e;t[0]==null?e=null:e=t[0].slice(1);for(let r=1;r<t.length;++r){const a=t[r]==null?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,a)}let s=[];for(const r of t)r!=null&&r[0]!==null&&s.push(r[0]);return s=Ki(s),s.length===1?e=s.concat(e):e=[null].concat(e),e}computeMask(t,e){return it(()=>{if(e==null)return null;if(!Array.isArray(e))throw new J("`mask` should be an Array");if(!Array.isArray(t))throw new J("`inputs` should be an Array");if(e.length!==t.length)throw new J(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(r=>r==null))return null;e=e.map(r=>r==null?r:Kn(r,0));let s=e[0];for(let r=1;r<e.length-1;++r)s=Gr(s,e[r]);return s})}}class A4 extends Ll{constructor(t){super(t)}mergeFunction(t){return it(()=>{let e=t[0].clone();for(let s=1;s<t.length;++s)e=wt(e,t[s]);return e})}}A4.className="Add";St(A4);class R4 extends Ll{constructor(t){super(t)}mergeFunction(t){return it(()=>{let e=t[0].clone();for(let s=1;s<t.length;++s)e=K(e,t[s]);return e})}}R4.className="Multiply";St(R4);class D4 extends Ll{constructor(t){super(t)}mergeFunction(t){return it(()=>{let e=t[0].clone();for(let s=1;s<t.length;++s)e=wt(e,t[s]);return K(1/t.length,e)})}}D4.className="Average";St(D4);class O4 extends Ll{constructor(t){super(t)}mergeFunction(t){return it(()=>{let e=t[0];for(let s=1;s<t.length;++s)e=Na(e,t[s]);return e})}}O4.className="Maximum";St(O4);class _4 extends Ll{constructor(t){super(t)}mergeFunction(t){return it(()=>{let e=t[0];for(let s=1;s<t.length;++s)e=ao(e,t[s]);return e})}}_4.className="Minimum";St(_4);class F4 extends Ll{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new J("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let e=!0;for(const r of t)if(r!=null){e=!1;break}if(e)return;const s=[];for(let r=0;r<t.length;++r){const a=t[r].slice();a.splice(this.axis,1);let i=!1;for(const o of s)if(te(o,a)){i=!0;break}i||s.push(a)}if(s.length>1)throw new J("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return it(()=>KN(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new J("A `Concatenate` layer should be called on a list of inputs.");const e=t,s=e[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const a of e.slice(1)){if(s[r]==null||a[r]==null){s[r]=null;break}s[r]+=a[r]}return s}computeMask(t,e){if(e==null)return null;if(!Array.isArray(e))throw new J("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new J("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new J(`Mismatch in the length of mask (${e.length}) and the legnth of inputs (${t.length})`);return it(()=>{let s=!0;if(e.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<t.length;++i)e[i]==null?r.push(Tt(Ls(t[i]),"bool")):e[i].rank<t[i].rank?r.push(Kn(e[i],-1)):r.push(e[i]);const a=Qe(r,this.axis);return Eb(a,-1,!1)})}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}F4.className="Concatenate";St(F4);function Id(n,t){for(;n<0;)n+=t;return n}function Int(n,t,e){if(n.shape.length>3||t.shape.length>3)throw new qt("batchDot is not implemented for tensors of 4D or higher rank yet");if(F(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),F(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof e=="number"&&(e=[e,e]),n.dtype==="complex64"||t.dtype==="complex64")throw new qt("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,r=t.shape.length;e==null&&(e=[s-1,r-2]);const a=e;return it(()=>{let i;if(s>r){i=s-r;const l=[];for(let c=0;c<i;++c)l.push(1);t=Z(t,t.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let c=0;c<i;++c)l.push(1);n=Z(n,n.shape.concat(l))}else i=0;let o;if(n.shape.length===2&&t.shape.length===2)a[0]===a[1]?o=It(K(n,t),a[0]):o=It(K(ne(n,[1,0]),t),a[1]);else{const l=a[0]!==n.shape.length-1,c=a[1]===t.shape.length-1;o=Xt(n,t,l,c)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let d=l;d<l+i;++d)c.push(d);o=xo(o,c)}return o.shape.length===1&&(o=Kn(o,1)),o})}class L4 extends Ll{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){F(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0],s=t[1];if(e.length>3||s.length>3)throw new qt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,s);if(e[r[0]]!==s[r[1]])throw new J(`Dimension incompatibility: ${e[r[0]]} !== ${s[r[1]]}`)}mergeFunction(t){if(t.length!==2)throw new J(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let e=t[0],s=t[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,i)=>Id(a,t[i].shape.length)):r=[Id(this.axes,e.shape.length),Id(this.axes,s.shape.length)],this.normalize&&(e=Gy(e,r[0]),s=Gy(s,r[1])),Int(e,s,r)}interpretAxes(t,e){let s;return Array.isArray(this.axes)?s=this.axes:s=[Id(this.axes,t.length),Id(this.axes,e.length)],s}computeOutputShape(t){F(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0].slice(),s=t[1].slice();if(e.length>3||s.length>3)throw new qt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,s);e.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const a=e.concat(s);return a.length===1&&a.push(1),a}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}L4.className="Dot";St(L4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class M4 extends Qt{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return it(()=>{this.invokeCallHook(t,e);const s=Bt(t);return dm(()=>wt(gx(s.shape,0,this.stddev),s),()=>s,e.training||!1)})}}M4.className="GaussianNoise";St(M4);class z4 extends Qt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return it(()=>{this.invokeCallHook(t,e);const s=Bt(t);return this.rate>0&&this.rate<1?dm(()=>{const a=Math.sqrt(this.rate/(1-this.rate));return K(s,gx(s.shape,1,a))},()=>s,e.training||!1):s})}}z4.className="GaussianDropout";St(z4);class P4 extends Qt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||Bt(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return it(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(t);return dm(()=>{const a=Bt(t),o=-1.6732632423543772*1.0507009873554805;let l=fi(bo(s),this.rate);l=pa(l,"float32");const c=((1-this.rate)*(1+this.rate*o**2))**-.5,d=-c*o*this.rate,f=wt(K(a,l),K(wt(l,-1),o));return wt(K(f,c),d)},()=>Bt(t),e.training||!1)}return t})}}P4.className="AlphaDropout";St(P4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nf(n,t,e,s,r,a=.001){let i;if(n.rank===2)i=yT(n,t,e,s,r,a);else if(n.rank===3)i=bT(n,t,e,s,r,a);else if(n.rank===4)i=xT(n,t,e,s,r,a);else throw new qt(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return i}function Ant(n,t,e,s,r=.001){return it(()=>{const a=Qp(n,s),i=a.mean,o=a.variance;return[Nf(n,i,o,e,t,r),i,o]})}function Rnt(n,t,e,s,r=.001){return it(()=>{const a=Qp(n,s),i=a.mean,o=a.variance,l=[];for(const b of jr(0,n.rank))s.indexOf(b)!==-1?l.push(1):l.push(n.shape[b]);const c=Z(i,l),d=Z(o,l),f=t==null?null:Z(t,l),m=e==null?null:Z(e,l);return[Nf(n,c,d,m,f,r),i,o]})}function Dnt(n,t,e,s,r=.001){return te(s.slice().sort(),jr(0,n.rank-1))?Ant(n,t,e,s,r):Rnt(n,t,e,s,r)}class B4 extends Qt{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=Le(t.betaInitializer||"zeros"),this.gammaInitializer=Le(t.gammaInitializer||"ones"),this.movingMeanInitializer=Le(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Le(t.movingVarianceInitializer||"ones"),this.betaConstraint=bn(t.betaConstraint),this.gammaConstraint=bn(t.gammaConstraint),this.betaRegularizer=Me(t.betaRegularizer),this.gammaRegularizer=Me(t.gammaRegularizer)}build(t){t=he(t);const e=this.axis>=0?this.axis:this.axis+t.length,s=t[e];if(s==null)throw new J(`Axis ${e} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new gn({ndim:t.length,axes:{[e]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return it(()=>{const s=e.training==null?!1:e.training,r=Bt(t),a=r.shape,i=a.length,o=jr(0,i),l=this.axis>=0?this.axis:this.axis+i;o.splice(l,1);const c=wl(1,i);c[l]=a[l];const d=o.slice();d.sort();const f=!te(d,jr(0,i).slice(0,i-1)),m=()=>{if(f){const T=Z(this.movingMean.read(),c),C=Z(this.movingVariance.read(),c),k=this.center?Z(this.beta.read(),c):null,$=this.scale?Z(this.gamma.read(),c):null;return Nf(r,T,C,k,$,this.epsilon)}else return Nf(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return m();const[g,b,x]=Dnt(r,this.gamma.read(),this.beta.read(),o,this.epsilon),v=(T,C,k)=>{it(()=>{const $=1-k,I=T.read(),D=K(Et(I,C),$);T.write(Et(I,D))})};return(()=>{v(this.movingMean,b,this.momentum),v(this.movingVariance,x,this.momentum)})(),g})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ve(this.betaInitializer),gammaInitializer:Ve(this.gammaInitializer),movingMeanInitializer:Ve(this.movingMeanInitializer),movingVarianceInitializer:Ve(this.movingVarianceInitializer),betaRegularizer:$e(this.betaRegularizer),gammaRegularizer:$e(this.gammaRegularizer),betaConstraint:yn(this.betaConstraint),gammaConstraint:yn(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}B4.className="BatchNormalization";St(B4);class V4 extends Qt{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const e of this.axis)if(!Number.isInteger(e))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=Le(t.betaInitializer||"zeros"),this.gammaInitializer=Le(t.gammaInitializer||"ones"),this.betaRegularizer=Me(t.betaRegularizer),this.gammaRegularizer=Me(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=he(t);const e=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=e);for(const a of this.axis)if(a<0||a>=e)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==Ki(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(a=>t[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(t,e){const s=Bt(t),r=s.shape,a=r.length;return it(()=>{let{mean:o,variance:l}=Qp(s,this.axis,!0);const c=wl(1,a);for(const x of this.axis)c[x]=r[x];const d=x=>x!=null&&x.shape.length!==a?Z(x,c):x;let f=this.scale?d(this.gamma.read()):null,m=this.center?d(this.beta.read()):null;const g=[],b=[];for(let x=0;x<a;++x)this.axis.indexOf(x)!==-1?(g.push(r[x]),b.push(1)):(g.push(1),b.push(r[x]));return o=Qs(o,g),l=Qs(l,g),f!=null&&(f=Qs(f,b)),m!=null&&(m=Qs(m,b)),Nf(s,o,l,m,f,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ve(this.betaInitializer),gammaInitializer:Ve(this.gammaInitializer),betaRegularizer:$e(this.betaRegularizer),gammaRegularizer:$e(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}V4.className="LayerNormalization";St(V4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ont(n,t,e){return it(()=>{if(n.rank!==4)throw new J(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new J("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(e==null&&(e=Hr()),e!=="channelsLast"&&e!=="channelsFirst")throw new J(`Unknown data format: ${e}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return e==="channelsFirst"?s=[[0,0],[0,0],t[0],t[1]]:s=[[0,0],t[0],t[1],[0,0]],pi(n,s)})}class U4 extends Qt{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?Hr():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new J(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let e,s;if(typeof t.padding[0]=="number")e=[t.padding[0],t.padding[0]],s=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new J(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],t.padding[1].length!==2)throw new J(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);s=t.padding[1]}this.padding=[e,s]}this.inputSpec=[new gn({ndim:4})]}computeOutputShape(t){t=he(t);let e,s;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?e=t[2]+this.padding[0][0]+this.padding[0][1]:e=null,t[3]!=null&&t[3]>=0?s=t[3]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],t[1],e,s]):(t[1]!=null&&t[1]>=0?e=t[1]+this.padding[0][0]+this.padding[0][1]:e=null,t[2]!=null&&t[2]>=0?s=t[2]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],e,s,t[3]])}call(t,e){return it(()=>Ont(Bt(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}U4.className="ZeroPadding2D";St(U4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nx(n,t,e,s,r,a){return it(()=>{en(r),rM(a),rr(s),e==null&&(e=[1,1]),s==null&&(s="valid"),r==null&&(r=Hr()),a==null&&(a="max"),n=oC(n,r);let i;const o=s==="same"?"same":"valid";return a==="max"?i=Zp(n,t,e,o):i=Wp(n,t,e,o),r==="channelsFirst"&&(i=ne(i,[0,3,1,2])),i})}function W4(n,t,e,s,r,a){return it(()=>{en(r),rM(a),rr(s),e==null&&(e=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Hr()),a==null&&(a="max"),n=i4(n,r);let i;const o=s==="same"?"same":"valid";return a==="max"?i=UT(n,t,e,o):i=gT(n,t,e,o),r==="channelsFirst"&&(i=ne(i,[0,4,1,2,3])),i})}class G4 extends Qt{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new J(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(Cn(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new J(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);Cn(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,rr(this.padding),this.inputSpec=[new gn({ndim:3})]}computeOutputShape(t){t=he(t);const e=Ur(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return it(()=>{this.invokeCallHook(t,e),t=cm(Bt(t),2);const s=this.poolingFunction(Bt(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return xo(s,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class j4 extends G4{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return en(a),rr(r),Nx(t,e,s,r,a,"max")}}j4.className="MaxPooling1D";St(j4);class H4 extends G4{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return en(a),rr(r),Nx(t,e,s,r,a,"avg")}}H4.className="AveragePooling1D";St(H4);class q4 extends Qt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new J(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];Cn(this.poolSize,"poolSize"),Cn(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,en(this.dataFormat),rr(this.padding),this.inputSpec=[new gn({ndim:4})]}computeOutputShape(t){t=he(t);let e=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2];return e=Ur(e,this.poolSize[0],this.padding,this.strides[0]),s=Ur(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],e,s]:[t[0],e,s,t[3]]}call(t,e){return it(()=>(this.invokeCallHook(t,e),this.poolingFunction(Bt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class K4 extends q4{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return en(a),rr(r),Nx(t,e,s,r,a,"max")}}K4.className="MaxPooling2D";St(K4);class X4 extends q4{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return en(a),rr(r),Nx(t,e,s,r,a,"avg")}}X4.className="AveragePooling2D";St(X4);class Y4 extends Qt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new J(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Cn(this.poolSize,"poolSize"),Cn(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,en(this.dataFormat),rr(this.padding),this.inputSpec=[new gn({ndim:5})]}computeOutputShape(t){t=he(t);let e=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],r=this.dataFormat==="channelsFirst"?t[4]:t[3];return e=Ur(e,this.poolSize[0],this.padding,this.strides[0]),s=Ur(s,this.poolSize[1],this.padding,this.strides[1]),r=Ur(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],e,s,r]:[t[0],e,s,r,t[4]]}call(t,e){return it(()=>(this.invokeCallHook(t,e),this.poolingFunction(Bt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Z4 extends Y4{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return en(a),rr(r),W4(t,e,s,r,a,"max")}}Z4.className="MaxPooling3D";St(Z4);class Q4 extends Y4{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return en(a),rr(r),W4(t,e,s,r,a,"avg")}}Q4.className="AveragePooling3D";St(Q4);class J4 extends Qt{constructor(t){super(t),this.inputSpec=[new gn({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new qt}}class tz extends J4{constructor(t){super(t||{})}call(t,e){return it(()=>{const s=Bt(t);return Be(s,1)})}}tz.className="GlobalAveragePooling1D";St(tz);class ez extends J4{constructor(t){super(t||{})}call(t,e){return it(()=>{const s=Bt(t);return er(s,1)})}}ez.className="GlobalMaxPooling1D";St(ez);class nz extends Qt{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,en(this.dataFormat),this.inputSpec=[new gn({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new qt}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class sz extends nz{call(t,e){return it(()=>{const s=Bt(t);return this.dataFormat==="channelsLast"?Be(s,[1,2]):Be(s,[2,3])})}}sz.className="GlobalAveragePooling2D";St(sz);class rz extends nz{call(t,e){return it(()=>{const s=Bt(t);return this.dataFormat==="channelsLast"?er(s,[1,2]):er(s,[2,3])})}}rz.className="GlobalMaxPooling2D";St(rz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class az extends Qt{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,s={}){const r=e.layer,a=Za(r,s);delete e.layer;const i={layer:a};return Object.assign(i,e),new t(i)}}class iz extends az{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=he(t),t.length<3)throw new J(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=he(t);const e=[t[0]].concat(t.slice(2)),s=this.layer.computeOutputShape(e),r=t[1];return[s[0],r].concat(s.slice(1))}call(t,e){return it(()=>(t=Bt(t),m4((i,o)=>[Bt(this.layer.call(i,e)),[]],t,[],!1,null,null,!1,!0)[1]))}}iz.className="TimeDistributed";St(iz);function _nt(n){Fl(Jtt,"BidirectionalMergeMode",n)}const Fnt="concat";class oz extends az{constructor(t){super(t);const e=t.layer.getConfig(),s={};s.className=t.layer.getClassName(),s.config=e,this.forwardLayer=Za(s),e.goBackwards=e.goBackwards!==!0;const r={};if(r.className=t.layer.getClassName(),r.config=e,this.backwardLayer=Za(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?Fnt:t.mergeMode,_nt(this.mergeMode),t.weights)throw new qt("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,s=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,s)),this.backwardLayer.setWeights(t.slice(s))}computeOutputShape(t){let e=this.forwardLayer.computeOutputShape(t);Array.isArray(e)&&Array.isArray(e[0])||(e=[e]),e=e;let s,r,a;return this.returnState&&(a=e.slice(1)),s=e[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[s].concat(a).concat(a.slice()):fs(r)}apply(t,e){let s=e==null?null:e.initialState,r=e==null?null:e.constants;e==null&&(e={});const a=p4(t,s,r,this.numConstants);if(t=a.inputs,s=a.initialState,r=a.constants,Array.isArray(t)&&(s=t.slice(1),t=t[0]),(s==null||s.length===0)&&r==null)return super.apply(t,e);const i=[],o=[];if(s!=null){const c=s.length;if(c%2>0)throw new J("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=s,i.push(...s);const d=s.map(f=>new gn({shape:f.shape}));this.forwardLayer.stateSpec=d.slice(0,c/2),this.backwardLayer.stateSpec=d.slice(c/2),o.push(...d)}if(r!=null)throw new qt("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof wa;for(const c of i)if(c instanceof wa!==l)throw new J("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[t].concat(i),d=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=d;const m=super.apply(c,e);return this.inputSpec=f,m}else return super.apply(t,e)}call(t,e){return it(()=>{const s=e.initialState;let r,a;if(s==null)r=this.forwardLayer.call(t,e),a=this.backwardLayer.call(t,e);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:l})),a=this.backwardLayer.call(t,Object.assign(e,{initialState:c}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=nr(a,1));let o;return this.mergeMode==="concat"?o=KN([r,a]):this.mergeMode==="sum"?o=wt(r,a):this.mergeMode==="ave"?o=K(.5,wt(r,a)):this.mergeMode==="mul"?o=K(r,a):this.mergeMode==null&&(o=[r,a]),this.returnState?this.mergeMode==null?o.concat(i):[o].concat(i):o})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){ul(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),ul(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,e){Array.isArray(e)&&(e=e[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[e,e]:s=e:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const a=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(a).concat(a):[s].concat(a).concat(a)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const s=Za(e.layer);if(delete e.layer,e.numConstants!=null)throw new qt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r.layer=s,new t(r)}}oz.className="Bidirectional";St(oz);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lz extends Qt{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return it(()=>(t=Bt(t),t.dtype!=="float32"&&(t=pa(t,"float32")),wt(K(t,this.scale),this.offset)))}}lz.className="Rescaling";St(lz);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Lnt,cropAndResize:Mnt}=Pr;class uz extends Qt{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,e,s,r,a,i,o,l){return it(()=>{let c,d=!1;const f=e/i,m=s/o,g=(r+e)/i,b=(a+s)/o,x=[f,m,g,b],v=[];t.rank===3?(d=!0,c=ws([t])):c=t;for(let $=0;$<c.shape[0];$++)v.push(x);const w=Nr(v,[v.length,4]),T=xl(0,v.length,1,"int32"),k=Mnt(c,w,T,[r,a],"nearest");return pa(d?Bt(sr(k)):k,l)})}upsize(t,e,s,r){return it(()=>{const a=Lnt(t,[e,s]);return pa(a,r)})}call(t,e){return it(()=>{const s=Bt(t),r=s.dtype,a=s.shape,i=a[a.length-3],o=a[a.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let c=0;return o!==this.width&&(c=Math.floor((o-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,i,o,r):this.upsize(t,this.height,this.width,r)})}getConfig(){const t={height:this.height,width:this.width},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){t=he(t);const e=t.length-3,s=t.length-2;return t[e]=this.height,t[s]=this.width,t}}uz.className="CenterCrop";St(uz);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function znt(n,t,e,s){let r=Bt(n);if(r.dtype!=="int32"&&(r=pa(r,"int32")),t==="int")return r;const a=r.shape;if(r.rank===0&&(r=Kn(r,-1)),t==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=Kn(r,-1)),r.rank>2)throw new J(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${a} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(t),o=r;let l;if(typeof s<"u"&&t==="count"?l=zy(o,s,e,i):l=zy(o,[],e,i),t!=="tfIdf")return l;if(s)return K(l,s);throw new J("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cz extends Qt{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){return t=he(t),t==null?[this.numTokens]:this.outputMode==="oneHot"&&t[t.length-1]!==1?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,e){return it(()=>{t=Bt(t),t.dtype!=="int32"&&(t=pa(t,"int32"));let s;if(typeof e.countWeights<"u"){if(this.outputMode!=="count")throw new J(`countWeights is not used when outputMode !== count.
              Received countWeights=${e.countWeights}`);s=Bt(e.countWeights)}const r=er(t),a=Xu(t),i=Ts(this.numTokens,r).bufferSync().get(0),o=fi(a,0).bufferSync().get(0);if(!(i&&o))throw new J(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return znt(t,this.outputMode,this.numTokens,s)})}}cz.className="CategoryEncoding";St(cz);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Pnt=["bilinear","nearest"],lD=new Set(Pnt);class hz extends Qt{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation)if(lD.has(t.interpolation))this.interpolation=t.interpolation;else throw new J(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!t.cropToAspectRatio}computeOutputShape(t){t=he(t);const e=t[2];return[this.height,this.width,e]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return it(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Pr.resizeBilinear(t,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Pr.resizeNearestNeighbor(t,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...lD]} are supported`)})}}hz.className="Resizing";St(hz);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dz{constructor(t){this.seed=t}next(){if(this.seed!==void 0)return this.seed++}}dz.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fz extends Qt{constructor(t){super(t),this.randomGenerator=new dz(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},e=super.getConfig();return Object.assign(t,e),t}}fz.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Bnt=["bilinear","nearest"],uD=new Set(Bnt);class pz extends fz{constructor(t){super(t);const{factor:e,interpolation:s="bilinear"}=t;if(this.factor=e,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new J(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new J(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new J(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(uD.has(s))this.interpolation=s;else throw new J(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){t=he(t);const e=t[2];return[this.imgHeight,-1,e]}call(t,e){return it(()=>{const s=Bt(t);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=bo([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);const i=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return Pr.resizeBilinear(t,i);case"nearest":return Pr.resizeNearestNeighbor(t,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...uD]} are supported`)}})}}pz.className="RandomWidth";St(pz);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vnt=lt();Vnt.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Rs;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(Rs||(Rs={}));var cD;(function(n){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(cD||(cD={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fC={};function Unt(n,t){const e={tfOpName:n,category:"custom",inputs:[],attrs:[],customExecutor:t};fC[n]=e}function mz(n){return fC[n]}function Wnt(n){delete fC[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E(n,t,e,s,r){const a=t.inputParams[n];if(a&&a.inputIndexStart!==void 0){const o=a.inputIndexStart,l=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?o+1:a.inputIndexEnd,c=o<0?t.inputNames.length+o:o;if(a.type==="tensor")return _n(t.inputNames[c],e,s,r);if(a.type==="tensors"){const m=t.inputs.slice(o,l);return t.inputNames.slice(o,l).filter((b,x)=>{var v;return((v=m[x])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(b=>_n(b,e,s,r))}const d=_n(t.inputNames[c],e,s,r),f=d.dataSync();return a.type==="number"?f[0]:tr(d.shape,f)}const i=t.attrParams[n];return i&&i.value}function _n(n,t,e,s){const[r,a]=Ds(n,e);if(s!=null){const o=s.getHashTableHandleByName(r);if(o!=null)return o}const i=e.currentContextIds.find(o=>!!t[Xy(r,o)]);return i!==void 0?t[Xy(r,i)][a]:void 0}function hD(n,t,e){return t[Xy(n,e.currentContextId)]}function ja(n,t){const[e,s,r]=Ds(n,t);return[Xy(e,t&&t.currentContextId),s,r]}function Xy(n,t){return t?`${n}-${t}`:n}function Ds(n,t){if(n==="")return["",0,void 0];const e=t!=null&&t.parseNodeNameCache!=null;if(e){const a=t.parseNodeNameCache.get(n);if(a!=null)return a}const s=n.split(":");let r;if(s.length===1)r=[n,0,void 0];else{const a=s[0],i=s.length===3?s[1]:void 0,o=Number(s[s.length-1]);r=[a,o,i]}return e&&t.parseNodeNameCache.set(n,r),r}function vy(n,t,e){let s=E("pad",n,t,e);if(s==="explicit"){s=E("explicitPaddings",n,t,e);const r=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)r[a][0]=s[a*2],r[a][1]=s[a*2+1];return r}return s}function Ha(n){return n.kept?n:da(n)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gnt=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],jnt=Object.freeze(Object.defineProperty({__proto__:null,json:Gnt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hnt=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],qnt=Object.freeze(Object.defineProperty({__proto__:null,json:Hnt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Knt=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Xnt=Object.freeze(Object.defineProperty({__proto__:null,json:Knt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ynt=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Znt=Object.freeze(Object.defineProperty({__proto__:null,json:Ynt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qnt=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Jnt=Object.freeze(Object.defineProperty({__proto__:null,json:Qnt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tst=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],est=Object.freeze(Object.defineProperty({__proto__:null,json:tst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nst=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],sst=Object.freeze(Object.defineProperty({__proto__:null,json:nst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rst=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],ast=Object.freeze(Object.defineProperty({__proto__:null,json:rst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ist=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],ost=Object.freeze(Object.defineProperty({__proto__:null,json:ist},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lst=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],ust=Object.freeze(Object.defineProperty({__proto__:null,json:lst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cst=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],hst=Object.freeze(Object.defineProperty({__proto__:null,json:cst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dst=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],fst=Object.freeze(Object.defineProperty({__proto__:null,json:dst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pst=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],mst=Object.freeze(Object.defineProperty({__proto__:null,json:pst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gst=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],yst=Object.freeze(Object.defineProperty({__proto__:null,json:gst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bst=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],xst=Object.freeze(Object.defineProperty({__proto__:null,json:bst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vst=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],wst=Object.freeze(Object.defineProperty({__proto__:null,json:vst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sst=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Tst=Object.freeze(Object.defineProperty({__proto__:null,json:Sst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nst=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Cst=Object.freeze(Object.defineProperty({__proto__:null,json:Nst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kst=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],$st=Object.freeze(Object.defineProperty({__proto__:null,json:kst},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dD{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[jnt,qnt,Xnt,Znt,Jnt,est,sst,ast,ost,ust,hst,fst,mst,yst,xst,wst,Tst,Cst,$st],e=[].concat(...t.map(s=>s.json));this.opMappers=e.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(t,e={}){const s=t.node,r=[],a=[],i=[],o=s.reduce((x,v)=>(x[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?r.push(x[v.name]):v.op==="Const"?a.push(x[v.name]):(v.input==null||v.input.length===0)&&i.push(x[v.name]),x),{});let l=[];const c=[];let d={},f={};e!=null&&(d=this.mapSignatureEntries(e.inputs),f=this.mapSignatureEntries(e.outputs));const m=Object.keys(o);m.forEach(x=>{const v=o[x];v.inputNames.forEach((w,T)=>{const[C,,k]=ja(w),$=o[C];if($.outputs!=null){const I=$.outputs.indexOf(k);if(I!==-1){const D=`${C}:${I}`;v.inputNames[T]=D}}v.inputs.push($),$.children.push(v)})}),Object.keys(f).length===0?m.forEach(x=>{const v=o[x];v.children.length===0&&c.push(v)}):Object.keys(f).forEach(x=>{const[v]=ja(x),w=o[v];w!=null&&(w.signatureKey=f[x],c.push(w))}),Object.keys(d).length>0?Object.keys(d).forEach(x=>{const[v]=ja(x),w=o[v];w&&(w.signatureKey=d[x],l.push(w))}):l=r;let g={};t.library!=null&&t.library.function!=null&&(g=t.library.function.reduce((x,v)=>(x[v.signature.name]=this.mapFunction(v),x),{}));const b={nodes:o,inputs:l,outputs:c,weights:a,placeholders:r,signature:e,functions:g};return i.length>0&&(b.initNodes=i),b}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,s)=>(e[t[s].name]=s,e),{})}mapNode(t){const e=mz(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});const s={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return e.inputs!=null&&(s.inputParams=e.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),e.attrs!=null&&(s.attrParams=e.attrs.reduce((r,a)=>{const i=a.type;let o;switch(a.type){case"string":o=OS(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=OS(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":o=BS(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=BS(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":o=FS(t.attr,a.tfName,a.defaultValue||0),o===void 0&&a.tfDeprecatedName&&(o=FS(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":o=PS(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=PS(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":o=_S(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=_S(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":o=US(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=US(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":o=zS(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=zS(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":o=VS(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=VS(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":o=LS(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=LS(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":o=MS(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=MS(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":o=fD(t.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=fD(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${t.op}`)}return r[a.name]={value:o,type:i},r},{})),s}mapFunction(t){const e=t.nodeDef,s=[],r=[];let a={};e!=null&&(a=e.reduce((f,m)=>(f[m.name]=this.mapNode(m),m.op==="Const"&&r.push(f[m.name]),f),{}));const i=[],o=[];t.signature.inputArg.forEach(f=>{const[m]=ja(f.name),g={name:m,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:pC(f.type),type:"dtype"}},children:[]};g.signatureKey=f.name,i.push(g),a[m]=g}),Object.keys(a).forEach(f=>{const m=a[f];m.inputNames.forEach((g,b)=>{const[x,,v]=ja(g),w=a[x];if(w.outputs!=null){const T=w.outputs.indexOf(v);if(T!==-1){const C=`${x}:${T}`;m.inputNames[b]=C}}m.inputs.push(w),w.children.push(m)})});const c=t.ret;t.signature.outputArg.forEach(f=>{const[m,g]=ja(c[f.name]),b=a[m];b!=null&&(b.defaultOutput=g,o.push(b))});const d=this.mapArgsToSignature(t);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:s,signature:d}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((e,s)=>(e[s.name]=this.mapArgToTensorInfo(s),e),{}),outputs:t.signature.outputArg.reduce((e,s)=>(e[s.name]=this.mapArgToTensorInfo(s,t.ret),e),{})}}mapArgToTensorInfo(t,e){let s=t.name;return e!=null&&(s=e[s]),{name:s,dtype:t.type}}}function Est(n){const t=lt().global;if(typeof t.atob<"u")return t.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function gz(n,t){const e=Array.isArray(n)?String.fromCharCode.apply(null,n):Est(n);return t?e:e.toLowerCase()}function OS(n,t,e,s=!1){const r=n[t];return r!=null?gz(r.s,s):e}function _S(n,t,e){const s=n[t];return s?s.b:e}function FS(n,t,e){const s=n[t]||{},r=s.i!=null?s.i:s.f!=null?s.f:e;return typeof r=="number"?r:parseInt(r,10)}function pC(n){switch(typeof n=="string"&&(n=Rs[n]),n){case Rs.DT_FLOAT:case Rs.DT_HALF:return"float32";case Rs.DT_INT32:case Rs.DT_INT64:case Rs.DT_INT8:case Rs.DT_UINT8:return"int32";case Rs.DT_BOOL:return"bool";case Rs.DT_DOUBLE:return"float32";case Rs.DT_STRING:return"string";case Rs.DT_COMPLEX64:case Rs.DT_COMPLEX128:return"complex64";default:return null}}function fD(n,t,e){const s=n[t];return s&&s.func?s.func.name:e}function LS(n,t,e){const s=n[t];return s&&s.type?pC(s.type):e}function MS(n,t,e){const s=n[t];return s&&s.list&&s.list.type?s.list.type.map(r=>pC(r)):e}function yz(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function zS(n,t,e){const s=n[t];return s&&s.shape?yz(s.shape):e}function PS(n,t,e){const s=n[t];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):e}function BS(n,t,e,s=!1){const r=n[t];return r&&r.list&&r.list.s?r.list.s.map(a=>gz(a,s)):e}function VS(n,t,e){const s=n[t];return s&&s.list&&s.list.shape?s.list.shape.map(r=>yz(r)):e}function US(n,t,e){const s=n[t];return s&&s.list&&s.list.b?s.list.b:e}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ist{constructor(t,e,s){this.node=t,this.tensorMap=e,this.context=s,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(r=>this.getInput(r)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(t){return _n(t,this.tensorMap,this.context)}getAttr(t,e){const s=this.node.rawAttrs[t];if(s.tensor!=null)return _n(t,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return FS(this.node.rawAttrs,t,e);if(s.s!=null)return OS(this.node.rawAttrs,t,e);if(s.b!=null)return _S(this.node.rawAttrs,t,e);if(s.shape!=null)return zS(this.node.rawAttrs,t,e);if(s.type!=null)return LS(this.node.rawAttrs,t,e);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return PS(this.node.rawAttrs,t,e);if(s.list.s!=null)return BS(this.node.rawAttrs,t,e);if(s.list.shape!=null)return VS(this.node.rawAttrs,t,e);if(s.list.b!=null)return US(this.node.rawAttrs,t,e);if(s.list.type!=null)return MS(this.node.rawAttrs,t,e)}return e}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:tT,abs:ln,acos:oT,acosh:lT,add:wt,addN:iF,all:Eb,any:yf,argMax:ml,argMin:uT,asin:cT,asinh:hT,atan:dT,atan2:fT,atanh:pT,avgPool:Wp,avgPool3d:gT,basicLSTMCell:oF,batchNorm:lh,batchNorm2d:yT,batchNorm3d:bT,batchNorm4d:xT,batchToSpaceND:Gp,bincount:vT,bitwiseAnd:lF,booleanMaskAsync:HF,broadcastArgs:uF,broadcastTo:ll,buffer:Ht,cast:Tt,ceil:wT,clipByValue:xs,clone:da,complex:si,concat:Qe,concat1d:ST,concat2d:TT,concat3d:NT,concat4d:CT,conv1d:Ib,conv2d:ri,conv2dTranspose:Ab,conv3d:$T,conv3dTranspose:ET,cos:jp,cosh:Rb,cosineWindow:ex,cumprod:vf,cumsum:Db,denseBincount:zy,depthToSpace:IT,depthwiseConv2d:uh,diag:hF,dilation2d:AT,div:Ot,divNoNan:RT,dot:DT,dropout:iN,einsum:Zo,elu:ch,enclosingPowerOfTwo:oN,ensureShape:dF,equal:Cr,erf:Ob,euclideanNorm:_T,exp:vs,expandDims:Kn,expm1:FT,eye:_b,fft:rm,fill:Rl,floor:dh,floorDiv:$b,fused:eL,gather:fh,gatherND:YF,greater:Ts,greaterEqual:fi,ifft:tc,imag:Hp,image:Pr,inTopKAsync:ZF,irfft:Xb,isFinite:LT,isInf:MT,isNaN:zT,leakyRelu:qp,less:Yu,lessEqual:yo,linalg:cN,linspace:mF,localResponseNormalization:PT,log:Fs,log1p:Kp,logSigmoid:BT,logSoftmax:Lb,logSumExp:Xp,logicalAnd:Gr,logicalNot:Yp,logicalOr:Mb,logicalXor:VT,losses:lL,lowerBound:yF,matMul:Xt,max:er,maxPool:Zp,maxPool3d:UT,maxPoolWithArgmax:bF,maximum:Na,mean:Be,meshgrid:xF,min:Xu,minimum:ao,mirrorPad:WT,mod:GT,moments:Qp,movingAverage:qF,mul:K,multiRNNCell:vF,multinomial:wF,neg:De,norm:hh,notEqual:bl,oneHot:Zu,ones:ms,onesLike:Ls,op:G,outerProduct:SF,pad:pi,pad1d:TF,pad2d:NF,pad3d:CF,pad4d:kF,pool:jT,pow:xa,prelu:tm,print:iT,prod:HT,raggedGather:$F,raggedRange:EF,raggedTensorToTensor:IF,rand:AF,randomGamma:OF,randomNormal:Bb,randomStandardNormal:_F,randomUniform:bo,randomUniformInt:FF,range:xl,real:Qu,reciprocal:YT,relu:Xr,relu6:Vb,reshape:Z,reverse:nr,reverse1d:LF,reverse2d:MF,reverse3d:zF,reverse4d:PF,rfft:am,round:Ub,rsqrt:Wb,scalar:Lt,scatterND:KF,searchSorted:zb,selu:Gb,separableConv2d:jb,setdiff1dAsync:BF,sigmoid:Vr,sign:ZT,signal:oL,sin:Hb,sinh:qb,slice:ae,slice1d:em,slice2d:Kb,slice3d:nm,slice4d:Ju,softmax:sm,softplus:Dl,spaceToBatchND:Jp,sparse:uL,sparseToDense:XF,spectral:iL,split:gs,sqrt:$n,square:Se,squaredDifference:Yb,squeeze:xo,stack:ws,step:Ol,stridedSlice:QT,string:cL,sub:Et,sum:It,tan:JT,tanh:ro,tensor:Nr,tensor1d:Xn,tensor2d:Uu,tensor3d:tN,tensor4d:VF,tensor5d:UF,tensor6d:WF,tensorScatterUpdate:GF,tile:Qs,topk:nN,transpose:ne,truncatedNormal:Qb,unique:sN,unsortedSegmentSum:Jb,unstack:sr,upperBound:jF,variable:rN,where:Ln,whereAsync:aN,zeros:un,zerosLike:ie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ast=(n,t,e,s=Vn)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(E("a",n,t,e),E("b",n,t,e))];case"AddN":return[s.addN(E("tensors",n,t,e))];case"FloorMod":case"Mod":return[s.mod(E("a",n,t,e),E("b",n,t,e))];case"Mul":return[s.mul(E("a",n,t,e),E("b",n,t,e))];case"RealDiv":case"Div":return[s.div(E("a",n,t,e),E("b",n,t,e))];case"DivNoNan":return[s.divNoNan(E("a",n,t,e),E("b",n,t,e))];case"FloorDiv":return[s.floorDiv(E("a",n,t,e),E("b",n,t,e))];case"Sub":return[s.sub(E("a",n,t,e),E("b",n,t,e))];case"Minimum":return[s.minimum(E("a",n,t,e),E("b",n,t,e))];case"Maximum":return[s.maximum(E("a",n,t,e),E("b",n,t,e))];case"Pow":return[s.pow(E("a",n,t,e),E("b",n,t,e))];case"SquaredDifference":return[s.squaredDifference(E("a",n,t,e),E("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rst=(n,t,e,s=Vn)=>{switch(n.op){case"Abs":case"ComplexAbs":return[s.abs(E("x",n,t,e))];case"Acos":return[s.acos(E("x",n,t,e))];case"Acosh":return[s.acosh(E("x",n,t,e))];case"Asin":return[s.asin(E("x",n,t,e))];case"Asinh":return[s.asinh(E("x",n,t,e))];case"Atan":return[s.atan(E("x",n,t,e))];case"Atan2":return[s.atan2(E("x",n,t,e),E("y",n,t,e))];case"Atanh":return[s.atanh(E("x",n,t,e))];case"Ceil":return[s.ceil(E("x",n,t,e))];case"Complex":return[s.complex(E("real",n,t,e),E("imag",n,t,e))];case"Cos":return[s.cos(E("x",n,t,e))];case"Cosh":return[s.cosh(E("x",n,t,e))];case"Elu":return[s.elu(E("x",n,t,e))];case"Erf":return[s.erf(E("x",n,t,e))];case"Exp":return[s.exp(E("x",n,t,e))];case"Expm1":return[s.expm1(E("x",n,t,e))];case"Floor":return[s.floor(E("x",n,t,e))];case"Log":return[s.log(E("x",n,t,e))];case"Log1p":return[s.log1p(E("x",n,t,e))];case"Imag":return[s.imag(E("x",n,t,e))];case"Neg":return[s.neg(E("x",n,t,e))];case"Reciprocal":return[s.reciprocal(E("x",n,t,e))];case"Real":return[s.real(E("x",n,t,e))];case"Relu":return[s.relu(E("x",n,t,e))];case"Round":return[s.round(E("x",n,t,e))];case"Selu":return[s.selu(E("x",n,t,e))];case"Sigmoid":return[s.sigmoid(E("x",n,t,e))];case"Sin":return[s.sin(E("x",n,t,e))];case"Sign":return[s.sign(E("x",n,t,e))];case"Sinh":return[s.sinh(E("x",n,t,e))];case"Softplus":return[s.softplus(E("x",n,t,e))];case"Sqrt":return[s.sqrt(E("x",n,t,e))];case"Square":return[s.square(E("x",n,t,e))];case"Tanh":return[s.tanh(E("x",n,t,e))];case"Tan":return[s.tan(E("x",n,t,e))];case"ClipByValue":return[s.clipByValue(E("x",n,t,e),E("clipValueMin",n,t,e),E("clipValueMax",n,t,e))];case"Relu6":return[s.relu6(E("x",n,t,e))];case"Rsqrt":return[s.rsqrt(_n(n.inputNames[0],t,e))];case"LeakyRelu":return[s.leakyRelu(E("x",n,t,e),E("alpha",n,t,e))];case"Prelu":return[s.prelu(E("x",n,t,e),E("alpha",n,t,e))];case"IsNan":return[s.isNaN(_n(n.inputNames[0],t,e))];case"IsInf":return[s.isInf(_n(n.inputNames[0],t,e))];case"IsFinite":return[s.isFinite(_n(n.inputNames[0],t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vr(n,t,e=""){if(!(typeof n=="number"||typeof t=="number")){F(n.length===t.length,()=>e+` Shapes ${n} and ${t} must match`);for(let s=0;s<n.length;s++){const r=n[s],a=t[s];F(r<0||a<0||r===a,()=>e+` Shapes ${n} and ${t} must match`)}}}function pD(n){return!(typeof n=="number"||n.some(t=>t<0))}function Ad(n,t,e){let s=WS(n,e);const r=!pD(s);if(r&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&t.forEach(a=>{s=WS(a.shape,s)}),!pD(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function WS(n,t){if(typeof n=="number")return t;if(typeof t=="number")return n;if(n.length!==t.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${t}`);const e=[];for(let s=0;s<n.length;++s){const r=n[s],a=t[s];if(r>=0&&a>=0&&r!==a)throw new Error(`Incompatible shape during merge: ${n} vs. ${t}`);e[s]=r>=0?r:a}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dst{constructor(t,e,s,r,a,i,o){this.name=t,this.dtype=e,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Lt(0),pn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(e=>{(t==null||!t.has(e.tensor.id))&&e.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(e=>this.read(e))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=e.shape),vr(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);s.tensor=e,pn(e),s.written=!0,this.tensors[t]=s}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((s,r)=>this.write(s,e[r]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let r=0;r<this.size();r++)t.push(r)}if(t.length===0)return Nr([],[0].concat(this.elementShape));const s=this.readMany(t);return vr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),ws(s,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return Nr([],[0].concat(this.elementShape));const e=[];for(let r=0;r<this.size();r++)e.push(r);const s=this.readMany(e);return vr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Qe(s,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const s=Math.max(...t);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(t,sr(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let s=0;const r=t.map(l=>(s+=l,s));if(s!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const a=s===0?0:e.size/s,i=[];it(()=>{e=Z(e,[1,s,a]);for(let l=0;l<t.length;++l){const d=[0,l===0?0:r[l-1],0],f=[1,t[l],a];i[l]=Z(ae(e,d,f),this.elementShape)}return i});const o=[];for(let l=0;l<t.length;l++)o[l]=l;this.writeMany(o,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sl{get id(){return this.idTensor.id}constructor(t,e,s,r=-1){this.tensors=t,this.elementShape=e,this.elementDtype=s,t!=null&&t.forEach(a=>{if(s!==a.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${a.dtype}`);vr(e,a.shape,"TensorList shape mismatch: "),pn(a)}),this.idTensor=Lt(0),this.maxNumElements=r,pn(this.idTensor)}copy(){return new Sl([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(e=>{(t==null||!t.has(e.id))&&e.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e,s=-1){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);vr(t,this.elementShape,"TensorList shape mismatch: ");const r=Ad(this.elementShape,this.tensors,t);return it(()=>{const a=this.tensors.map(i=>Z(i,r));return ws(a,0)})}popBack(t,e){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Ad(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,vr(r.shape,t,"TensorList shape mismatch: "),Z(r,s)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(vr(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");pn(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);const e=new Sl([],this.elementShape,this.elementDtype,this.maxNumElements);e.tensors.length=t;for(let s=0;s<Math.min(this.tensors.length,t);++s)e.tensors[s]=this.tensors[s];return e}getItem(t,e,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);vr(this.tensors[t].shape,e,"TensorList shape mismatch: ");const r=Ad(this.elementShape,this.tensors,e);return Z(this.tensors[t],r)}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);vr(this.elementShape,e.shape,"TensorList shape mismatch: "),pn(e),this.tensors[t]!=null&&(this.tensors[t].kept=!1),this.tensors[t]=e}gather(t,e,s){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);vr(this.elementShape,s,"TensorList shape mismatch: "),t=t.slice(0,this.size());const r=Ad(this.elementShape,this.tensors,s);return t.length===0?Nr([],[0].concat(r)):it(()=>{const a=t.map(i=>Z(this.tensors[i],r));return ws(a,0)})}concat(t,e){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);vr(this.elementShape,e,"TensorList shape mismatch: ");const s=Ad(this.elementShape,this.tensors,e);return this.size()===0?Nr([],[0].concat(s)):it(()=>{const r=this.tensors.map(a=>Z(a,s));return Qe(r,0)})}}function Ost(n,t,e){const s=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==e)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${e}`);const r=n.shape.slice(1);vr(r,t,"TensorList shape mismatch: ");const a=sr(n);return new Sl(a,t,s)}function _st(n,t,e,s){return new Sl([],n,t,s)}function Fst(n,t,e,s){if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const r=Math.max(...t);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const a=new Sl([],e,n.dtype,s),i=sr(n,0);return t.forEach((o,l)=>{a.setItem(o,i[l])}),a}function Lst(n,t,e){let s=0;const r=t.map(d=>(s+=d,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);const a=n.shape.slice(1),i=WS(a,e),o=s===0?0:n.size/s,l=it(()=>{const d=[];n=Z(n,[1,s,o]);for(let f=0;f<t.length;++f){const g=[0,f===0?0:r[f-1],0],b=[1,t[f],o];d[f]=Z(ae(n,g,b),i)}return n.dispose(),d}),c=new Sl([],e,n.dtype,t.length);for(let d=0;d<l.length;d++)c.setItem(d,l[d]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mst=async(n,t,e)=>{switch(n.op){case"If":case"StatelessIf":{const s=E("thenBranch",n,t,e),r=E("elseBranch",n,t,e),a=E("cond",n,t,e),i=E("args",n,t,e);return(await a.data())[0]?e.functionMap[s].executeFunctionAsync(i,e.tensorArrayMap,e.tensorListMap):e.functionMap[r].executeFunctionAsync(i,e.tensorArrayMap,e.tensorListMap)}case"While":case"StatelessWhile":{const s=E("body",n,t,e),r=E("cond",n,t,e),a=E("args",n,t,e),i=await e.functionMap[r].executeFunctionAsync(a,e.tensorArrayMap,e.tensorListMap),o=a.map(d=>d.id);let l=await i[0].data();i.forEach(d=>{!d.kept&&o.indexOf(d.id)===-1&&d.dispose()});let c=a;for(;l[0];){const d=c;c=await e.functionMap[s].executeFunctionAsync(c,e.tensorArrayMap,e.tensorListMap);const f=c.map(g=>g.id);d.forEach(g=>{!g.kept&&o.indexOf(g.id)===-1&&f.indexOf(g.id)===-1&&g.dispose()});const m=await e.functionMap[r].executeFunctionAsync(c,e.tensorArrayMap,e.tensorListMap);l=await m[0].data(),m.forEach(g=>{!g.kept&&o.indexOf(g.id)===-1&&f.indexOf(g.id)===-1&&g.dispose()})}return c}case"LoopCond":{const s=E("pred",n,t,e);return[Ha(s)]}case"Switch":{const s=E("pred",n,t,e);let r=E("data",n,t,e);return r.kept||(r=Ha(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=n.inputNames.find(r=>_n(r,t,e)!==void 0);if(s){const r=_n(s,t,e);return[Ha(r)]}return}case"Enter":{const s=E("frameName",n,t,e),r=E("tensor",n,t,e);return e.enterFrame(s),[Ha(r)]}case"Exit":{const s=E("tensor",n,t,e);return e.exitFrame(),[Ha(s)]}case"NextIteration":{const s=E("tensor",n,t,e);return e.nextIteration(),[Ha(s)]}case"TensorArrayV3":{const s=E("size",n,t,e),r=E("dtype",n,t,e),a=E("elementShape",n,t,e),i=E("dynamicSize",n,t,e),o=E("clearAfterRead",n,t,e),l=E("identicalElementShapes",n,t,e),c=E("name",n,t,e),d=new Dst(c,r,s,a,l,i,o);return e.addTensorArray(d),[d.idTensor,Lt(1)]}case"TensorArrayWriteV3":{const s=E("tensorArrayId",n,t,e),r=E("index",n,t,e),a=E("tensor",n,t,e),i=e.getTensorArray(s.id);return i.write(r,a),[i.idTensor]}case"TensorArrayReadV3":{const s=E("tensorArrayId",n,t,e),r=E("index",n,t,e);return[e.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=E("tensorArrayId",n,t,e),r=E("indices",n,t,e),a=E("dtype",n,t,e);return[e.getTensorArray(s.id).gather(r,a)]}case"TensorArrayScatterV3":{const s=E("tensorArrayId",n,t,e),r=E("indices",n,t,e),a=E("tensor",n,t,e),i=e.getTensorArray(s.id);return i.scatter(r,a),[i.idTensor]}case"TensorArrayConcatV3":{const s=E("tensorArrayId",n,t,e),r=e.getTensorArray(s.id),a=E("dtype",n,t,e);return[r.concat(a)]}case"TensorArraySplitV3":{const s=E("tensorArrayId",n,t,e),r=E("tensor",n,t,e),a=E("lengths",n,t,e),i=e.getTensorArray(s.id);return i.split(a,r),[i.idTensor]}case"TensorArraySizeV3":{const s=E("tensorArrayId",n,t,e),r=e.getTensorArray(s.id);return[Lt(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=E("tensorArrayId",n,t,e),r=e.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=E("tensorListId",n,t,e),r=E("index",n,t,e),a=E("tensor",n,t,e),i=e.getTensorList(s.id);return i.setItem(r,a),[i.idTensor]}case"TensorListGetItem":{const s=E("tensorListId",n,t,e),r=E("index",n,t,e),a=E("elementShape",n,t,e),i=E("elementDType",n,t,e);return[e.getTensorList(s.id).getItem(r,a,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=E("indices",n,t,e),r=E("tensor",n,t,e),a=E("elementShape",n,t,e),i=E("numElements",n,t,e),o=Fst(r,s,a,i);return e.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=E("elementShape",n,t,e),r=E("elementDType",n,t,e);let a;n.op==="TensorListReserve"?a="numElements":a="maxNumElements";const i=E(a,n,t,e),o=n.op==="TensorListReserve"?-1:i,l=_st(s,r,i,o);return e.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=E("tensorListId",n,t,e),r=E("indices",n,t,e),a=E("elementShape",n,t,e),i=E("elementDType",n,t,e);return[e.getTensorList(s.id).gather(r,i,a)]}case"TensorListStack":{const s=E("tensorListId",n,t,e),r=E("elementShape",n,t,e),a=E("elementDType",n,t,e),i=E("numElements",n,t,e);return[e.getTensorList(s.id).stack(r,a,i)]}case"TensorListFromTensor":{const s=E("tensor",n,t,e),r=E("elementShape",n,t,e),a=E("elementDType",n,t,e),i=Ost(s,r,a);return e.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=E("tensorListId",n,t,e),r=e.getTensorList(s.id),a=E("dtype",n,t,e),i=E("elementShape",n,t,e);return[r.concat(a,i)]}case"TensorListPushBack":{const s=E("tensorListId",n,t,e),r=E("tensor",n,t,e),a=e.getTensorList(s.id);return a.pushBack(r),[a.idTensor]}case"TensorListPopBack":{const s=E("tensorListId",n,t,e),r=E("elementShape",n,t,e),a=E("elementDType",n,t,e);return[e.getTensorList(s.id).popBack(r,a)]}case"TensorListSplit":{const s=E("tensor",n,t,e),r=E("elementShape",n,t,e),a=E("lengths",n,t,e),i=Lst(s,a,r);return e.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=E("tensorListId",n,t,e),r=e.getTensorList(s.id);return[Lt(r.size(),"int32")]}case"TensorListResize":{const s=E("tensorListId",n,t,e),r=E("size",n,t,e),i=e.getTensorList(s.id).resize(r);return e.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mD(n,t,e){const[s,r]=E("fusedOps",n,t,e),a=s==="biasadd",i=!a,o=r==="prelu",l=s==="fusedbatchnorm",c=E("numArgs",n,t,e);if(a){if(o&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&a&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const d=E("strides",n,t,e),f=vy(n,t,e),m=E("dataFormat",n,t,e).toUpperCase(),g=E("dilations",n,t,e);let[b,x]=E("args",n,t,e);i&&(x=b,b=void 0);const v=E("leakyreluAlpha",n,t,e);return{stride:d,pad:f,dataFormat:m,dilations:g,biasArg:b,preluArg:x,activationFunc:r,leakyreluAlpha:v}}const zst=(n,t,e,s=Vn)=>{switch(n.op){case"Conv1D":{const r=E("stride",n,t,e),a=E("pad",n,t,e),i=E("dataFormat",n,t,e).toUpperCase(),o=E("dilation",n,t,e);return[s.conv1d(E("x",n,t,e),E("filter",n,t,e),r,a,i,o)]}case"Conv2D":{const r=E("strides",n,t,e),a=vy(n,t,e),i=E("dataFormat",n,t,e).toUpperCase(),o=E("dilations",n,t,e);return[s.conv2d(E("x",n,t,e),E("filter",n,t,e),[r[1],r[2]],a,i,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:r,pad:a,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:d,leakyreluAlpha:f}=mD(n,t,e);return[s.fused.conv2d({x:E("x",n,t,e),filter:E("filter",n,t,e),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:d,preluActivationWeights:c,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:a,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:d,leakyreluAlpha:f}=mD(n,t,e);return[s.fused.depthwiseConv2d({x:E("x",n,t,e),filter:E("filter",n,t,e),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:d,preluActivationWeights:c,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=E("outputShape",n,t,e),a=E("strides",n,t,e),i=vy(n,t,e);return[s.conv2dTranspose(E("x",n,t,e),E("filter",n,t,e),r,[a[1],a[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=E("strides",n,t,e),a=vy(n,t,e),i=E("dilations",n,t,e),o=E("dataFormat",n,t,e).toUpperCase();return[s.depthwiseConv2d(E("input",n,t,e),E("filter",n,t,e),[r[1],r[2]],a,o,[i[1],i[2]])]}case"Conv3D":{const r=E("strides",n,t,e),a=E("pad",n,t,e),i=E("dataFormat",n,t,e).toUpperCase(),o=E("dilations",n,t,e);return[s.conv3d(E("x",n,t,e),E("filter",n,t,e),[r[1],r[2],r[3]],a,i,[o[1],o[2],o[3]])]}case"AvgPool":{const r=E("strides",n,t,e),a=E("pad",n,t,e),i=E("kernelSize",n,t,e);return[s.avgPool(E("x",n,t,e),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPool":{const r=E("strides",n,t,e),a=E("pad",n,t,e),i=E("kernelSize",n,t,e);return[s.maxPool(E("x",n,t,e),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPoolWithArgmax":{const r=E("strides",n,t,e),a=E("pad",n,t,e),i=E("kernelSize",n,t,e),o=E("includeBatchInIndex",n,t,e),{result:l,indexes:c}=s.maxPoolWithArgmax(E("x",n,t,e),[i[1],i[2]],[r[1],r[2]],a,o);return[l,c]}case"AvgPool3D":{const r=E("strides",n,t,e),a=E("pad",n,t,e),i=E("kernelSize",n,t,e);return[s.avgPool3d(E("x",n,t,e),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"MaxPool3D":{const r=E("strides",n,t,e),a=E("pad",n,t,e),i=E("kernelSize",n,t,e);return[s.maxPool3d(E("x",n,t,e),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"Dilation2D":{const r=E("strides",n,t,e),a=E("pad",n,t,e),i=E("dilations",n,t,e),o=r[1],l=r[2],c=i[1],d=i[2];return[s.dilation2d(E("x",n,t,e),E("filter",n,t,e),[o,l],a,[c,d],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pst=(n,t,e,s=Vn)=>{switch(n.op){case"Fill":{const r=E("shape",n,t,e),a=E("dtype",n,t,e),i=E("value",n,t,e);return[s.fill(r,i,a)]}case"LinSpace":{const r=E("start",n,t,e),a=E("stop",n,t,e),i=E("num",n,t,e);return[s.linspace(r,a,i)]}case"Multinomial":{const r=E("logits",n,t,e),a=E("numSamples",n,t,e),i=E("seed",n,t,e);return[s.multinomial(r,a,i)]}case"OneHot":{const r=E("indices",n,t,e),a=E("depth",n,t,e),i=E("onValue",n,t,e),o=E("offValue",n,t,e),l=E("dtype",n,t,e);return[s.oneHot(r,a,i,o,l)]}case"Ones":return[s.ones(E("shape",n,t,e),E("dtype",n,t,e))];case"OnesLike":return[s.onesLike(E("x",n,t,e))];case"RandomStandardNormal":return[s.randomStandardNormal(E("shape",n,t,e),E("dtype",n,t,e),E("seed",n,t,e))];case"RandomUniform":return[s.randomUniform(E("shape",n,t,e),E("minval",n,t,e),E("maxval",n,t,e),E("dtype",n,t,e))];case"RandomUniformInt":return[s.randomUniformInt(E("shape",n,t,e),E("minval",n,t,e),E("maxval",n,t,e),E("seed",n,t,e))];case"Range":{const r=E("start",n,t,e),a=E("stop",n,t,e),i=E("step",n,t,e);return[s.range(r,a,i,E("dtype",n,t,e))]}case"TruncatedNormal":{const r=E("shape",n,t,e),a=E("mean",n,t,e),i=E("stdDev",n,t,e),o=E("seed",n,t,e);return[s.truncatedNormal(r,a,i,E("dtype",n,t,e),o)]}case"Zeros":return[s.zeros(E("shape",n,t,e),E("dtype",n,t,e))];case"ZerosLike":return[s.zerosLike(E("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nw(n,t,e){const s=E("boxes",n,t,e),r=E("scores",n,t,e),a=E("maxOutputSize",n,t,e),i=E("iouThreshold",n,t,e),o=E("scoreThreshold",n,t,e),l=E("softNmsSigma",n,t,e);return{boxes:s,scores:r,maxOutputSize:a,iouThreshold:i,scoreThreshold:o,softNmsSigma:l}}const Bst=async(n,t,e,s,r=Vn)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:d}=Nw(n,t,e),f=await r.image.nonMaxSuppressionWithScoreAsync(a,i,o,l,c,d);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=Nw(n,t,e),d=E("padToMaxOutputSize",n,t,e),f=await r.image.nonMaxSuppressionPaddedAsync(a,i,o,l,c,d);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=Nw(n,t,e);return[await r.image.nonMaxSuppressionAsync(a,i,o,l,c)]}case"Where":{const a=r.cast(E("condition",n,t,e),"bool"),i=[await r.whereAsync(a)];return a.dispose(),i}case"ListDiff":return r.setdiff1dAsync(E("x",n,t,e),E("y",n,t,e));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vst=(n,t,e,s=Vn)=>{switch(n.op){case"LowerBound":{const r=E("sortedSequence",n,t,e),a=E("values",n,t,e);return[s.lowerBound(r,a)]}case"TopKV2":{const r=E("x",n,t,e),a=E("k",n,t,e),i=E("sorted",n,t,e),o=s.topk(r,a,i);return[o.values,o.indices]}case"UpperBound":{const r=E("sortedSequence",n,t,e),a=E("values",n,t,e);return[s.upperBound(r,a)]}case"Unique":{const r=E("x",n,t,e),a=s.unique(r);return[a.values,a.indices]}case"UniqueV2":{const r=E("x",n,t,e),a=E("axis",n,t,e),i=s.unique(r,a);return[i.values,i.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ust=(n,t,e,s=Vn)=>{switch(n.op){case"Const":return t[n.name];case"PlaceholderWithDefault":const r=E("default",n,t,e);return[_n(n.name,t,e)||r];case"Placeholder":return[_n(n.name,t,e)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const d=E("x",n,t,e);return[Ha(d)]}case"IdentityN":return E("x",n,t,e).map(d=>Ha(d));case"Snapshot":const a=E("x",n,t,e);return[Ha(a)];case"Shape":return[s.tensor1d(E("x",n,t,e).shape,"int32")];case"ShapeN":return E("x",n,t,e).map(d=>s.tensor1d(d.shape));case"Size":return[s.scalar(E("x",n,t,e).size,"int32")];case"Rank":return[s.scalar(E("x",n,t,e).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=E("x",n,t,e),o=E("data",n,t,e),l=E("message",n,t,e),c=E("summarize",n,t,e);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let d=0;d<o.length;d++)console.log(Array.prototype.slice.call(o[d].dataSync()).slice(0,c));return[i];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wst{get id(){return this.handle.id}constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=Lt(0),this.tensorMap=new Map,pn(this.handle)}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Lt(this.size(),"int32")}async import(t,e){this.checkKeyAndValueTensor(t,e);const s=await t.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),it(()=>{const r=sr(e),a=s.length,i=r.length;F(a===i,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${i} elements.`);for(let o=0;o<a;o++){const l=s[o],c=r[o];pn(c),this.tensorMap.set(l,c)}return this.handle})}async find(t,e){this.checkKeyAndValueTensor(t,e);const s=await t.data();return it(()=>{const r=[];for(let a=0;a<s.length;a++){const i=s[a],o=this.findWithDefault(i,e);r.push(o)}return ws(r)})}findWithDefault(t,e){const s=this.tensorMap.get(t);return s??e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(e.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${e.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gst=async(n,t,e,s)=>{switch(n.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(n.name);if(r!=null)return[r];{const a=E("keyDType",n,t,e),i=E("valueDType",n,t,e),o=new Wst(a,i);return s.addHashTable(n.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=E("tableHandle",n,t,e,s),a=E("keys",n,t,e),i=E("values",n,t,e);return[await s.getHashTableById(r.id).import(a,i)]}case"LookupTableFind":case"LookupTableFindV2":{const r=E("tableHandle",n,t,e,s),a=E("keys",n,t,e),i=E("defaultValue",n,t,e);return[await s.getHashTableById(r.id).find(a,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=E("tableHandle",n,t,e,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jst=(n,t,e,s=Vn)=>{switch(n.op){case"ResizeBilinear":{const r=E("images",n,t,e),a=E("size",n,t,e),i=E("alignCorners",n,t,e),o=E("halfPixelCenters",n,t,e);return[s.image.resizeBilinear(r,[a[0],a[1]],i,o)]}case"ResizeNearestNeighbor":{const r=E("images",n,t,e),a=E("size",n,t,e),i=E("alignCorners",n,t,e),o=E("halfPixelCenters",n,t,e);return[s.image.resizeNearestNeighbor(r,[a[0],a[1]],i,o)]}case"CropAndResize":{const r=E("image",n,t,e),a=E("boxes",n,t,e),i=E("boxInd",n,t,e),o=E("cropSize",n,t,e),l=E("method",n,t,e),c=E("extrapolationValue",n,t,e);return[s.image.cropAndResize(r,a,i,o,l,c)]}case"ImageProjectiveTransformV3":{const r=E("images",n,t,e),a=E("transforms",n,t,e),i=E("outputShape",n,t,e),o=E("fillValue",n,t,e),l=E("interpolation",n,t,e),c=E("fillMode",n,t,e);return[s.image.transform(r,a,l.toLowerCase(),c.toLowerCase(),o,i)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hst=(n,t,e,s=Vn)=>{switch(n.op){case"Equal":return[s.equal(E("a",n,t,e),E("b",n,t,e))];case"NotEqual":return[s.notEqual(E("a",n,t,e),E("b",n,t,e))];case"Greater":return[s.greater(E("a",n,t,e),E("b",n,t,e))];case"GreaterEqual":return[s.greaterEqual(E("a",n,t,e),E("b",n,t,e))];case"Less":return[s.less(E("a",n,t,e),E("b",n,t,e))];case"LessEqual":return[s.lessEqual(E("a",n,t,e),E("b",n,t,e))];case"LogicalAnd":return[s.logicalAnd(E("a",n,t,e),E("b",n,t,e))];case"LogicalNot":return[s.logicalNot(E("a",n,t,e))];case"LogicalOr":return[s.logicalOr(E("a",n,t,e),E("b",n,t,e))];case"Select":case"SelectV2":return[s.where(E("condition",n,t,e),E("a",n,t,e),E("b",n,t,e))];case"BitwiseAnd":return[s.bitwiseAnd(E("a",n,t,e),E("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qst=(n,t,e,s=Vn)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(E("a",n,t,e),E("b",n,t,e),E("transposeA",n,t,e),E("transposeB",n,t,e))];case"Einsum":return[s.einsum(E("equation",n,t,e),...E("tensors",n,t,e))];case"Transpose":return[s.transpose(E("x",n,t,e),E("perm",n,t,e))];case"_FusedMatMul":const[r,a]=E("fusedOps",n,t,e),i=r==="biasadd",o=a==="prelu",l=E("numArgs",n,t,e),c=E("leakyreluAlpha",n,t,e);if(i){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[d,f]=E("args",n,t,e);return[s.fused.matMul({a:E("a",n,t,e),b:E("b",n,t,e),transposeA:E("transposeA",n,t,e),transposeB:E("transposeB",n,t,e),bias:d,activation:a,preluActivationWeights:f,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(E("a",n,t,e),E("numLower",n,t,e),E("numUpper",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kst=(n,t,e,s=Vn)=>{switch(n.op){case"EuclideanNorm":return[s.euclideanNorm(E("x",n,t,e),E("axis",n,t,e),E("keepDims",n,t,e))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(E("x",n,t,e),E("mean",n,t,e),E("variance",n,t,e),E("offset",n,t,e),E("scale",n,t,e),E("epsilon",n,t,e))];case"FusedBatchNormV3":return[s.batchNorm(E("x",n,t,e),E("mean",n,t,e),E("variance",n,t,e),E("offset",n,t,e),E("scale",n,t,e),E("epsilon",n,t,e))];case"LRN":return[s.localResponseNormalization(E("x",n,t,e),E("radius",n,t,e),E("bias",n,t,e),E("alpha",n,t,e),E("beta",n,t,e))];case"Softmax":return[s.softmax(E("x",n,t,e))];case"LogSoftmax":return[s.logSoftmax(E("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xst=(n,t,e,s=Vn)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:a}=s.raggedGather(E("paramsNestedSplits",n,t,e),E("paramsDenseValues",n,t,e),E("indices",n,t,e),E("outputRaggedRank",n,t,e));return r.concat(a)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:a}=s.raggedRange(E("starts",n,t,e),E("limits",n,t,e),E("splits",n,t,e));return[r,a]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(E("shape",n,t,e),E("values",n,t,e),E("defaultValue",n,t,e),E("rowPartitionTensors",n,t,e),E("rowPartitionTypes",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yst=(n,t,e,s=Vn)=>{switch(n.op){case"Max":{const o=E("axis",n,t,e),l=E("keepDims",n,t,e);return[s.max(E("x",n,t,e),o,l)]}case"Mean":{const o=E("axis",n,t,e),l=E("keepDims",n,t,e);return[s.mean(E("x",n,t,e),o,l)]}case"Min":{const o=E("axis",n,t,e),l=E("keepDims",n,t,e);return[s.min(E("x",n,t,e),o,l)]}case"Sum":{const o=E("axis",n,t,e),l=E("keepDims",n,t,e);return[s.sum(E("x",n,t,e),o,l)]}case"All":{const o=E("axis",n,t,e),l=E("keepDims",n,t,e);return[s.all(E("x",n,t,e),o,l)]}case"Any":{const o=E("axis",n,t,e),l=E("keepDims",n,t,e);return[s.any(E("x",n,t,e),o,l)]}case"ArgMax":{const o=E("axis",n,t,e);return[s.argMax(E("x",n,t,e),o)]}case"ArgMin":{const o=E("axis",n,t,e);return[s.argMin(E("x",n,t,e),o)]}case"Prod":{const o=E("axis",n,t,e),l=E("keepDims",n,t,e);return[s.prod(E("x",n,t,e),o,l)]}case"Cumprod":{const o=E("axis",n,t,e),l=E("exclusive",n,t,e),c=E("reverse",n,t,e);return[s.cumprod(E("x",n,t,e),o,l,c)]}case"Cumsum":{const o=E("axis",n,t,e),l=E("exclusive",n,t,e),c=E("reverse",n,t,e);return[s.cumsum(E("x",n,t,e),o,l,c)]}case"Bincount":const r=E("x",n,t,e),a=E("weights",n,t,e),i=E("size",n,t,e);return[s.bincount(r,a,i)];case"DenseBincount":{const o=E("x",n,t,e),l=E("weights",n,t,e),c=E("size",n,t,e),d=E("binaryOutput",n,t,e);return[s.denseBincount(o,l,c,d)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zst=(n,t,e,s=Vn)=>{switch(n.op){case"ConcatV2":case"Concat":{const r=E("n",n,t,e),a=E("axis",n,t,e);let i=E("tensors",n,t,e);return i=i.slice(0,r),[s.concat(i,a)]}case"Gather":{const r=E("x",n,t,e),a=E("indices",n,t,e);return[s.gather(r,s.cast(a,"int32"),0)]}case"GatherV2":{const r=E("axis",n,t,e),a=E("batchDims",n,t,e),i=E("x",n,t,e),o=E("indices",n,t,e);return[s.gather(i,s.cast(o,"int32"),r,a)]}case"Reverse":{const r=E("dims",n,t,e),a=[];for(let o=0;o<r.length;o++)r[o]&&a.push(o);const i=E("x",n,t,e);return[s.reverse(i,a)]}case"ReverseV2":{const r=E("axis",n,t,e),a=E("x",n,t,e);return[s.reverse(a,r)]}case"Slice":{const r=E("begin",n,t,e),a=E("size",n,t,e);return[s.slice(E("x",n,t,e),r,a)]}case"StridedSlice":{const r=E("begin",n,t,e),a=E("end",n,t,e),i=E("strides",n,t,e),o=E("beginMask",n,t,e),l=E("endMask",n,t,e),c=E("ellipsisMask",n,t,e),d=E("newAxisMask",n,t,e),f=E("shrinkAxisMask",n,t,e),m=E("x",n,t,e);return[s.stridedSlice(m,r,a,i,o,l,c,d,f)]}case"Pack":return it(()=>{const r=E("axis",n,t,e),a=E("tensors",n,t,e),i=a[0].shape,o=s.squeeze(a[0]).shape,l=a.map(c=>{const d=te(c.shape,i);if(!d&&!te(s.squeeze(c).shape,o))throw new Error("the input tensors shape does not match");return d?c:s.reshape(c,i)});return[s.stack(l,r)]});case"Unpack":{const r=E("axis",n,t,e),a=E("tensor",n,t,e);return s.unstack(a,r)}case"Tile":{const r=E("reps",n,t,e);return[s.tile(E("x",n,t,e),r)]}case"Split":case"SplitV":{const r=E("axis",n,t,e),a=E("numOrSizeSplits",n,t,e),i=E("x",n,t,e);return s.split(i,a,r)}case"ScatterNd":{const r=E("indices",n,t,e),a=E("values",n,t,e),i=E("shape",n,t,e);return[s.scatterND(r,a,i)]}case"GatherNd":{const r=E("x",n,t,e),a=E("indices",n,t,e);return[s.gatherND(r,a)]}case"SparseToDense":{const r=E("sparseIndices",n,t,e),a=E("outputShape",n,t,e),i=E("sparseValues",n,t,e),o=E("defaultValue",n,t,e);return[s.sparseToDense(r,i,a,i.dtype===o.dtype?o:s.cast(o,i.dtype))]}case"TensorScatterUpdate":{const r=E("indices",n,t,e),a=E("values",n,t,e),i=E("tensor",n,t,e);return[s.tensorScatterUpdate(i,r,a)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qst=(n,t,e,s=Vn)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:a,emptyRowIndicator:i,reverseIndexMap:o}=s.sparse.sparseFillEmptyRows(E("indices",n,t,e),E("values",n,t,e),E("denseShape",n,t,e),E("defaultValue",n,t,e));return[r,a,i,o]}case"SparseReshape":{const{outputIndices:r,outputShape:a}=s.sparse.sparseReshape(E("inputIndices",n,t,e),E("inputShape",n,t,e),E("newShape",n,t,e));return[r,a]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(E("data",n,t,e),E("indices",n,t,e),E("segmentIds",n,t,e))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(E("data",n,t,e),E("indices",n,t,e),E("segmentIds",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jst=(n,t,e,s=Vn)=>{switch(n.op){case"FFT":return[s.fft(E("x",n,t,e))];case"IFFT":return[s.ifft(E("x",n,t,e))];case"RFFT":return[s.rfft(E("x",n,t,e))];case"IRFFT":return[s.irfft(E("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const trt=(n,t,e,s=Vn)=>{switch(n.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(E("input",n,t,e),E("pattern",n,t,e),E("rewrite",n,t,e),E("replaceGlobal",n,t,e))];case"StringNGrams":{const{nGrams:r,nGramsSplits:a}=s.string.stringNGrams(E("data",n,t,e),E("dataSplits",n,t,e),E("separator",n,t,e),E("nGramWidths",n,t,e),E("leftPad",n,t,e),E("rightPad",n,t,e),E("padWidth",n,t,e),E("preserveShortSequences",n,t,e));return[r,a]}case"StringSplit":{const{indices:r,values:a,shape:i}=s.string.stringSplit(E("input",n,t,e),E("delimiter",n,t,e),E("skipEmpty",n,t,e));return[r,a,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(E("input",n,t,e),E("numBuckets",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ert=(n,t,e,s=Vn)=>{switch(n.op){case"Cast":return[s.cast(E("x",n,t,e),E("dtype",n,t,e))];case"ExpandDims":{const r=E("axis",n,t,e);return[s.expandDims(E("x",n,t,e),r)]}case"Squeeze":{const r=E("axis",n,t,e);return[s.squeeze(E("x",n,t,e),r)]}case"Reshape":return[s.reshape(E("x",n,t,e),E("shape",n,t,e))];case"EnsureShape":return[s.ensureShape(E("x",n,t,e),E("shape",n,t,e))];case"MirrorPad":return[s.mirrorPad(E("x",n,t,e),E("padding",n,t,e),E("mode",n,t,e))];case"PadV2":case"Pad":return[s.pad(E("x",n,t,e),E("padding",n,t,e),E("constantValue",n,t,e))];case"SpaceToBatchND":{const r=E("blockShape",n,t,e),a=E("paddings",n,t,e);return[s.spaceToBatchND(E("x",n,t,e),r,a)]}case"BatchToSpaceND":{const r=E("blockShape",n,t,e),a=E("crops",n,t,e);return[s.batchToSpaceND(E("x",n,t,e),r,a)]}case"DepthToSpace":{const r=E("blockSize",n,t,e),a=E("dataFormat",n,t,e).toUpperCase();return[s.depthToSpace(E("x",n,t,e),r,a)]}case"BroadcastTo":return[s.broadcastTo(E("x",n,t,e),E("shape",n,t,e))];case"BroadcastArgs":return[s.broadcastArgs(E("s0",n,t,e),E("s1",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gD(n,t,e,s,r=it){const a=((i,o,l)=>{switch(i.category){case"arithmetic":return r(()=>Ast(i,o,l));case"basic_math":return r(()=>Rst(i,o,l));case"control":return Mst(i,o,l);case"convolution":return r(()=>zst(i,o,l));case"creation":return r(()=>Pst(i,o,l));case"dynamic":return Bst(i,o,l);case"evaluation":return r(()=>Vst(i,o,l));case"image":return r(()=>jst(i,o,l));case"graph":return r(()=>Ust(i,o,l));case"logical":return r(()=>Hst(i,o,l));case"matrices":return r(()=>qst(i,o,l));case"normalization":return r(()=>Kst(i,o,l));case"ragged":return r(()=>Xst(i,o,l));case"reduction":return r(()=>Yst(i,o,l));case"slice_join":return r(()=>Zst(i,o,l));case"sparse":return r(()=>Qst(i,o,l));case"spectral":return r(()=>Jst(i,o,l));case"string":return r(()=>trt(i,o,l));case"transformation":return r(()=>ert(i,o,l));case"hash_table":return Gst(i,o,l,s);case"custom":const c=mz(i.op);if(c&&c.customExecutor)return c.customExecutor(new Ist(i,o,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,t,e);return eo(a)?a.then(i=>[].concat(i)):[].concat(a)}class yD{constructor(t={},e={},s={},r={},a){this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const s=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(s))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(e=>e.id===0&&e.iterationId===0?"":`${e.frameName}-${e.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bD(n,t,e,s){const r=new Set,a=[];let i=null,o=null;const l=new Set,c=new Set(Object.keys(n).map(m=>Ds(m)[0]));s=s||[];const d=new Set(s.map(m=>Ds(m.name)[0])),f=[...t];for(;f.length>0;){const m=f.pop();if((Jo(m)||urt(m)||crt(m))&&i==null&&(i=m,o=i.children.map(g=>g.name).filter(g=>r.has(g))),r.add(m.name),e[m.name]==null&&!c.has(m.name)&&!d.has(m.name)){if(m.inputs.length===0){a.push(m.name);continue}m.inputs.forEach(g=>{l.has(g.name)||(l.add(g.name),f.push(g))})}}return{inputs:n,outputs:t,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:o}}function nrt(n,t){const{usedNodes:e,inputs:s}=t,r=Object.keys(s).map(v=>Ds(v)[0]).map(v=>n.nodes[v]),a=n.initNodes||[],i=v=>e.has(typeof v=="string"?v:v.name);function o(v){return[...new Map(v.map(w=>[w.name,w])).values()]}const l=o([...r,...n.weights,...a]).filter(i),c=o([...l,...Object.values(n.nodes)]).filter(i),d=new Map(c.map(v=>[v.name,v])),f={};for(const v of c){f[v.name]=f[v.name]||0;for(const w of v.children)i(w)||(f[w.name]=Number.POSITIVE_INFINITY),f[w.name]=(f[w.name]||0)+1}const m=Object.entries(f).filter(([,v])=>v===0).map(([v])=>v),g=[...m];for(;m.length>0;){const v=m.pop(),w=d.get(v);for(const T of w.children.filter(i))--f[T.name]===0&&(g.push(T.name),m.push(T.name))}const b=g.map(v=>d.get(v)),x=srt(b,l);return rrt(x,l),x}function srt(n,t){const e=new Map(n.map(i=>[i.name,i])),s=t.map(i=>i.name),r=new Set(s);for(;s.length>0;){const i=s.pop(),o=e.get(i);for(const l of o.children)!e.has(l.name)||r.has(l.name)||(r.add(l.name),s.push(l.name))}return n.filter(i=>r.has(i.name))}class Kg extends Error{constructor(t){super(`NodesExecutionOrderError: ${t}`)}}function rrt(n,t){const e=new Map(n.map((o,l)=>[o.name,l])),s=new Set(t.map(o=>o.name)),r=o=>s.has(typeof o=="string"?o:o.name),a=new Set(n.map(o=>o.name)),i=o=>a.has(typeof o=="string"?o:o.name);for(const o of n){for(const l of o.children.filter(i)){if(!e.has(l.name))throw new Kg(`Child ${l.name} of node ${o.name} is unreachable.`);if(e.get(o.name)>e.get(l.name))throw new Kg(`Node ${o.name} is scheduled to run after its child ${l.name}.`)}if(!r(o))for(const l of o.inputs){if(!e.has(l.name))throw new Kg(`Input ${l.name} of node ${o.name} is unreachable.`);if(e.get(l.name)>e.get(o.name))throw new Kg(`Node ${o.name} is scheduled to run before its input ${l.name}.`)}}}function art(n){const t=new Map(n.map((o,l)=>[o.name,l])),e=Number.MAX_SAFE_INTEGER,s=n.map((o,l)=>Jo(o)?e:l),r=o=>{const l=s[t.get(o.name)];return l??-1},a=n.map((o,l)=>o.children.map(r).reduce((c,d)=>Math.max(c,d),s[l])),i=new Map;for(let o=0;o<n.length;++o){const l=a[o];if(l===e)continue;const c=n[o],d=n[l];i.has(d.name)||i.set(d.name,[]),i.get(d.name).push(c)}return i}const irt=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),ort=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),lrt=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Jo(n){return irt.has(n.op)}function urt(n){return ort.has(n.op)}function crt(n){return lrt.has(n.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yy{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map(s=>t[s].map(r=>r.id));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const e=t.signatureKey||t.name;return t.defaultOutput?`${e}:${t.defaultOutput}`:e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(s=>{this._functionExecutorMap[s]=new Yy(t.functions[s],this)})}getCompilationKey(t,e){const s=t.map(a=>a.name).sort(),r=e.map(a=>a.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(t,e){const s=bD(t,e,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=s;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const c=e.map(f=>f.name),d=Object.keys(t);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${d}]. Missing the following inputs: [${r}]`)}const o=nrt(this.graph,s),l=art(o);return{orderedNodes:o,nodeLiveUntilMap:l}}cloneAndKeepTensor(t){if(t==null)return null;const e=t.clone();return pn(e),e}cloneTensorList(t){return t?t.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([e,s])=>[e,this.cloneTensorList(s)]))}execute(t,e){this.disposeIntermediateTensors(),t=this.mapInputs(t);const s=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const r=s.map(m=>this.graph.nodes[Ds(m)[0]]),a=e.map(m=>Ds(m)[0]),i=new Set(a);let o=a.map(m=>this.graph.nodes[m]);o.length===0&&(o=this._outputs);const l=this.getCompilationKey(r,o);let c=this.compiledMap.get(l);c==null&&(c=this.compile(t,o),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=lt().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(m){this.keepIntermediateTensors=!1,console.warn(m.message)}const d={},f={};return it(()=>{const m=new yD(this.weightMap,d,f,this.functionExecutorMap,this.parseNodeNameCache),g=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(w=>{const[T,C]=Ds(w,m),k=[];k[C]=t[w],g[T]=k,this.keepIntermediateTensors&&(this.clonedTensorsMap[T]=this.cloneTensorList(k))});const b=this.getFrozenTensorIds(g),{orderedNodes:x,nodeLiveUntilMap:v}=c;for(const w of x){if(g[w.name])continue;const T=gD(w,g,m,this._resourceManager);if(eo(T))throw new Error(`The execution of the op '${w.op}' returned a promise. Please use model.executeAsync() instead.`);g[w.name]=T,this.keepIntermediateTensors&&(this.clonedTensorsMap[w.name]=this.cloneTensorList(T)),this.checkTensorForDisposalWithNodeLiveUntilInfo(w,g,m,b,i,v.get(w.name))}return this.parent==null&&m.dispose(b),e.map(w=>_n(w,g,m))})}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map(s=>t[s]).map(s=>s.map(r=>r.id)));return new Set(e)}checkTensorForDisposal(t,e,s,r,a,i,o){if(!(Jo(e)||i.has(t))){for(const l of s[t])l!=null&&(o[l.id]=(o[l.id]||0)+e.children.length);for(const l of e.inputs){if(Jo(l))continue;const c=hD(l.name,s,r);if(c!=null)for(const d of c){if(!d||d.kept||a.has(d.id))continue;const f=o[d.id];f===1?(d.dispose(),delete o[d.id]):f!=null&&o[d.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,e,s,r,a,i){function o(l){return Jo(l)||a.has(l.name)}if(!(Jo(t)||i==null))for(const l of i){if(o(l))continue;const c=hD(l.name,e,s);for(const d of c)!d||d.kept||r.has(d.id)||d.dispose()}}async executeAsync(t,e){return this._executeAsync(t,e)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(t=>{for(const e of t)e&&!e.isDisposed&&e.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,e,s=!1,r={},a={}){this.disposeIntermediateTensors(),s||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));try{this.keepIntermediateTensors=lt().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(m){this.keepIntermediateTensors=!1,console.warn(m.message)}const i=new yD(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const o=await this.executeWithControlFlow(t,i,e,s),l=e.map(m=>_n(m,o,i)),c=l.map(m=>m.id),d=Object.keys(t).map(m=>t[m].id),f=new Set([...c,...d,...this.weightIds]);return Object.values(o).forEach(m=>{m.forEach(g=>{g&&!g.isDisposed&&!f.has(g.id)&&g.dispose()})}),this.parent==null&&i.dispose(f),l}async executeFunctionAsync(t,e,s){const r=t.reduce((a,i,o)=>(a[this.inputs[o].name]=i,a),{});return this._executeAsync(r,this.outputNodes,!0,e,s)}async executeWithControlFlow(t,e,s,r){const a=Object.keys(t),i=a.map(k=>this.graph.nodes[Ds(k)[0]]),o=s.map(k=>Ds(k)[0]),l=new Set(o);let c=o.map(k=>this.graph.nodes[k]);c.length===0&&(c=this._outputs);const{usedNodes:d,missingInputs:f,dynamicNode:m,syncInputs:g}=bD(t,c,this.weightMap,this._initNodes),b=[...i,...this.graph.weights,...this._initNodes||[]].map(k=>({node:k,contexts:e.currentContext})),x=Object.assign({},this.weightMap);Object.keys(t).forEach(k=>{const[$,I]=Ds(k),D=[];D[I]=t[k],x[$]=D});const v={},w=this.getFrozenTensorIds(x),T={};for(;b.length>0;){const k=this.processStack(i,b,e,x,T,w,l,v,d);await Promise.all(k)}m==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const C=c.filter(k=>!Jo(k)&&!_n(k.name,x,e)).map(k=>k.name);if(C.length>0){let k="";throw m!=null&&(k=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${g}]`),new Error(`Cannot compute the outputs [${C}] from the provided inputs [${a}]. Consider providing the following inputs: [${f}]. ${k}`)}return x}processStack(t,e,s,r,a,i,o,l,c){const d=[];for(;e.length>0;){const f=e.pop();s.currentContext=f.contexts;let m="";if(f.node.op==="Enter"&&E("isConstant",f.node,r,s)&&([m]=ja(f.node.name,s)),r[f.node.name]==null){const g=gD(f.node,r,s,this._resourceManager);m||([m]=ja(f.node.name,s));const b=s.currentContext;eo(g)?d.push(g.then(x=>(r[m]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[m]=this.cloneTensorList(x)),s.currentContext=b,this.checkTensorForDisposal(m,f.node,r,s,i,o,l),this.processChildNodes(f.node,e,s,r,a,c),x))):(r[m]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[m]=this.cloneTensorList(g)),this.checkTensorForDisposal(m,f.node,r,s,i,o,l),this.processChildNodes(f.node,e,s,r,a,c))}else this.processChildNodes(f.node,e,s,r,a,c)}return d}processChildNodes(t,e,s,r,a,i){t.children.forEach(o=>{const[l]=ja(o.name,s);a[l]||!i.has(o.name)||(o.op==="Merge"?o.inputNames.some(c=>!!_n(c,r,s))&&(a[l]=!0,e.push({contexts:s.currentContext,node:o})):o.inputNames.every(c=>!!_n(c,r,s))&&(a[l]=!0,e.push({contexts:s.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(e=>e.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{const s=t[e],[r]=Ds(e),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const i=a.attrParams.shape.value,o=i.length===s.shape.length&&s.shape.every((l,c)=>i[c]===-1||i[c]===l);F(o,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&F(s.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(t){var e,s;const r={};for(const a in t){const i=(s=(e=this._signature)===null||e===void 0?void 0:e.inputs)===null||s===void 0?void 0:s[a];i!=null?r[i.name]=t[a]:r[a]=t[a]}return r}checkInputs(t){const e=Object.keys(t).filter(s=>{const[r]=Ds(s);return this.graph.nodes[r]==null});if(e.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${e}] that are not part of graph`)}mapOutputs(t){return t.map(e=>{var s,r;const a=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[e];return a!=null?a.name:e},{})}checkOutputs(t){t.forEach(e=>{const[s]=Ds(e);if(!this.graph.nodes[s])throw new Error(`The output '${e}' is not found in the graph`)})}}class hrt{constructor(t={},e={}){this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const drt="?tfjs-format=file",frt="model.json";class mC{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t,e={},s=xN){this.modelUrl=t,this.loadOptions=e,this.version="n/a",this.io=s,e==null&&(this.loadOptions={}),this.resourceManager=new hrt}findIOHandler(){const t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const e=this.io.getLoadHandlers(t,this.loadOptions);if(e.length===0)e.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error(`Found more than one (${e.length}) load handlers for URL '${[t]}'`);this.handler=e[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return eo(t)?t.then(e=>e.getWeightStream==null?this.loadSync(e):this.loadStreaming(e)):this.loadSync(t)}loadSync(t){const e=this.io.decodeWeights(t.weightData,t.weightSpecs);return this.loadWithWeightMap(t,e)}async loadStreaming(t){if(t.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const e=await X3(t.getWeightStream(),t.weightSpecs);return this.loadWithWeightMap(t,e)}loadWithWeightMap(t,e){this.artifacts=t;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const a=this.artifacts.userDefinedMetadata;a.signature!=null&&(r=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new Yy(dD.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(e),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){const a=dD.Instance.transformGraph(t.modelInitializer);this.initializer=new Yy(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0}async save(t,e){if(typeof t=="string"){const s=this.io.getSaveHandlers(t);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${t}'`);t=s[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}addStructuredOutputNames(t){if(this.structuredOutputKeys){const e=t instanceof ge?[t]:t,s={};return e.forEach((r,a)=>s[this.structuredOutputKeys[a]]=r),s}return t}predict(t,e){const s=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(t,e){const s=await this.executeAsync(t,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(t){var e;if(!(t instanceof ge)&&!Array.isArray(t)){const a=(e=this.signature)===null||e===void 0?void 0:e.inputs;if(a!=null)for(const i in a){const o=a[i];o.resourceId!=null&&(t[i]=this.resourceIdToCapturedInput[o.resourceId])}return t}t=Array.isArray(t)?t:[t];const s=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${t.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((a,i)=>{var o,l,c;const d=(c=(l=(o=this.signature)===null||o===void 0?void 0:o.inputs)===null||l===void 0?void 0:l[i])===null||c===void 0?void 0:c.resourceId;return d!=null?a[i]=this.resourceIdToCapturedInput[d]:a[i]=t[r++],a},{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(t){if(this.resourceIdToCapturedInput={},this.initializerSignature){const e=this.initializerSignature.outputs,s=Object.keys(e);for(let r=0;r<s.length;r++){const a=s[r],i=e[a];this.resourceIdToCapturedInput[i.resourceId]=t[r]}}}execute(t,e){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const s=this.executor.execute(t,e);return s.length>1?s:s[0]}async executeAsync(t,e){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const s=await this.executor.executeAsync(t,e);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,s)=>(e[s]=[t[s]],e),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Yt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function prt(n,t={},e=xN){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof n=="string"&&(n=grt(n));const s=new mC(n,t,e);return await s.load(),s}function mrt(n){if(n==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(n instanceof Array){const[s,r]=n;if(!s)throw new Error("modelJSON must be the first element of the array");if(!r||!(r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const a=My(s.weightsManifest),i=rT(s,a,r);t=Py(i)}else if("load"in n)t=n;else if("modelTopology"in n&&"weightSpecs"in n&&"weightData"in n)t=Py(n);else throw new Error("Unknown model format");const e=new mC(t);return e.load(),e}function grt(n){return n.endsWith("/")||(n=n+"/"),`${n}${frt}${drt}`}/** @license See the LICENSE file. */const yrt="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const brt=Object.freeze(Object.defineProperty({__proto__:null,GraphModel:mC,deregisterOp:Wnt,loadGraphModel:prt,loadGraphModelSync:mrt,registerOp:Unt,version_converter:yrt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var xD;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(xD||(xD={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function At(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{e!=null&&F(e.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xrt=tx;class Cx extends y0{nextDataId(){return Cx.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new W2(this,Lr())}write(t,e,s){this.firstUse&&(this.firstUse=!1,lt().get("IS_NODE")&&Ys(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:s,refCount:1}),r}makeTensorInfo(t,e,s){let r;if(e==="string"&&s!=null&&s.length>0&&ia(s[0])){const a=s.map(i=>ha(i));r=this.write(a,t,e)}else r=this.write(s,t,e);return{dataId:r,shape:t,dtype:e}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const e=this.data.get(t);e.refCount++}decRef(t){if(this.data.has(t)){const e=this.data.get(t);e.refCount--}}move(t,e,s,r,a){this.data.set(t,{values:e,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:s}=this.data.get(t);if(e==="complex64"){const r=this.readSync(s.real.dataId),a=this.readSync(s.imag.dataId);return ai(r,a)}return $3(this.data.get(t).values,e)}bufferSync(t){const e=this.readSync(t.dataId);if(t.dtype==="string")try{const s=e.map(r=>ni(r));return Ht(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ht(t.shape,t.dtype,e)}makeOutput(t,e,s){return Lr().makeTensorFromTensorInfo(this.makeTensorInfo(e,s,t),this)}disposeData(t,e=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(t);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const e=ns();return t(),{kernelMs:ns()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){At([t],"where");const e=this.readSync(t.dataId);return xrt(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Cx.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bz(n){const t=new Float32Array(n.length);for(let e=0;e<n.length;++e)t[e]=Math.abs(n[e]);return t}const vrt=n=>{const{x:t}=n.inputs,e=n.backend;At(t,"abs");let s=new Float32Array(ft(t.shape));const r=e.data.get(t.dataId).values;return s=bz(r),e.makeOutput(s,t.shape,t.dtype)},wrt={kernelName:Mf,backendName:"cpu",kernelFunc:vrt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(n){return(t,e,s,r,a)=>{const i=jt(t,e),o=i.length,l=Ft(i),c=ft(i),d=kn(a,c),f=t.length,m=e.length,g=Ft(t),b=Ft(e),x=yl(t,i),v=yl(e,i);if(x.length+v.length===0)for(let w=0;w<d.length;++w)d[w]=n(s[w%s.length],r[w%r.length]);else for(let w=0;w<d.length;++w){const T=Il(w,o,l),C=T.slice(-f);x.forEach(D=>C[D]=0);const k=Br(C,f,g),$=T.slice(-m);v.forEach(D=>$[D]=0);const I=Br($,m,b);d[w]=n(s[k],r[I])}return[d,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Os(n){const{inputs:t,backend:e}=n,{real:s,imag:r}=t,a=e.data.get(s.dataId).values,i=e.data.get(r.dataId).values,o=e.makeTensorInfo(s.shape,"complex64"),l=e.data.get(o.dataId);return l.complexTensorInfos={real:e.makeTensorInfo(s.shape,"float32",a),imag:e.makeTensorInfo(r.shape,"float32",i)},o}const Srt={kernelName:k0,backendName:"cpu",kernelFunc:Os};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zy(n,t,e="float32"){if(e==="complex64"){const r=Zy(n,t,"float32"),a=Zy(n,t,"float32");return Os({inputs:{real:r,imag:a},backend:n})}const s=Mn(ft(t),e);return n.makeTensorInfo(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sa(n){const{inputs:t,backend:e}=n,{x:s}=t;return e.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Trt={kernelName:Oc,backendName:"cpu",kernelFunc:Sa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tl(n){const{inputs:t,backend:e}=n,{input:s}=t,r=e.data.get(s.dataId).complexTensorInfos.real,a=e.data.get(r.dataId).values;return e.makeTensorInfo(r.shape,r.dtype,a)}const Nrt={kernelName:ab,backendName:"cpu",kernelFunc:Tl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(n,t,e,s){if(s==="int32"){const r=Int32Array.from(n);return[t,"int32",r]}if(s==="bool"){const r=fo([0],e),[a,i]=nn((o,l)=>o!==l?1:0)(t,[],n,r,"bool");return[i,"bool",a]}throw new Error(`Error in Cast: failed to cast ${e} to ${s}`)}function co(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return Sa({inputs:{x:r},backend:e});const d=Zy(e,r.shape,r.dtype),f=co({inputs:{x:r},backend:e,attrs:{dtype:"float32"}}),m=Os({inputs:{real:f,imag:d},backend:e});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),m}if(r.dtype==="complex64"){const d=Tl({inputs:{input:r},backend:e}),f=co({inputs:{x:d},backend:e,attrs:{dtype:a}});return e.disposeIntermediateTensorInfo(d),f}if(!H2(r.dtype,a)){const d=Sa({inputs:{x:r},backend:e});return{dataId:d.dataId,shape:d.shape,dtype:a}}const i=e.data.get(r.dataId).values,[o,l,c]=xz(i,r.shape,r.dtype,a);return e.makeTensorInfo(o,l,c)}const Crt={kernelName:vc,backendName:"cpu",kernelFunc:co};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xn(n,t,e,s){return e==null?({inputs:r,backend:a})=>{const{a:i,b:o}=r,l=a;At([i,o],n);const c=l.data.get(i.dataId).values,d=l.data.get(o.dataId).values,f=i.dtype==="string"?ii(c):c,m=i.dtype==="string"?ii(d):d,g=s||i.dtype,[b,x]=t(i.shape,o.shape,f,m,g);return l.makeTensorInfo(x,g,b)}:({inputs:r,backend:a})=>{const{a:i,b:o}=r,l=a;if(i.dtype==="complex64"||o.dtype==="complex64"){const c=co({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),d=l.data.get(c.dataId),f=d.complexTensorInfos.real,m=d.complexTensorInfos.imag,g=l.data.get(f.dataId).values,b=l.data.get(m.dataId).values,x=co({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),v=l.data.get(x.dataId),w=v.complexTensorInfos.real,T=v.complexTensorInfos.imag,C=l.data.get(w.dataId).values,k=l.data.get(T.dataId).values,[$,I,D]=e(i.shape,o.shape,g,b,C,k),_=l.makeTensorInfo(D,"float32",$),O=l.makeTensorInfo(D,"float32",I),L=Os({inputs:{real:_,imag:O},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(x),l.disposeIntermediateTensorInfo(_),l.disposeIntermediateTensorInfo(O),L}else{const c=l.data.get(i.dataId).values,d=l.data.get(o.dataId).values,f=s||i.dtype,[m,g]=t(i.shape,o.shape,c,d,f);return l.makeTensorInfo(g,f,m)}}}function gC(n){return(t,e,s,r,a,i)=>{const o=jt(t,e),l=ft(o),c=o.length,d=Ft(o),f=kn("float32",l),m=kn("float32",l),g=yl(t,o),b=yl(e,o),x=ai(s,r),v=ai(a,i),w=t.length,T=Ft(t),C=e.length,k=Ft(e);if(g.length+b.length===0)for(let $=0;$<f.length;$++){const I=$%x.length,D=$%v.length,_=n(x[I*2],x[I*2+1],v[D*2],v[D*2+1]);f[$]=_.real,m[$]=_.imag}else for(let $=0;$<f.length;$++){const I=Il($,c,d),D=I.slice(-w);g.forEach(V=>D[V]=0);const _=Br(D,w,T),O=I.slice(-C);b.forEach(V=>O[V]=0);const L=Br(O,C,k),R=n(x[_*2],x[_*2+1],v[L*2],v[L*2+1]);f[$]=R.real,m[$]=R.imag}return[f,m,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vz=nn((n,t)=>n+t),krt=gC((n,t,e,s)=>({real:n+e,imag:t+s})),nc=xn(Al,vz,krt),$rt={kernelName:Al,backendName:"cpu",kernelFunc:nc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yC(n,t,e,s,r){const a=ft(s),i=Mn(r,e);for(let o=0;o<n.length;o++){const l=n[o];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(a>0?i[l]+=t[o]:i[l]+=1)}return i}function wz(n,t,e,s=!1){const r=n.shape[0],a=n.shape[1],i=Ht([r,e],t.dtype);for(let o=0;o<r;o++)for(let l=0;l<a;l++){const c=n.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=e||(s?i.set(1,o,c):t.size>0?i.set(i.get(o,c)+t.get(o,l),o,c):i.set(i.get(o,c)+1,o,c))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sz=nn((n,t)=>n&t),Ert=xn(jf,Sz),Irt={kernelName:jf,backendName:"cpu",kernelFunc:Ert};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(n){return(t,e,s)=>{const r=He(e,t.length);for(let a=0;a<t.length;++a)r[a]=n(t[a],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function be(n,t,e){const s=Ca(t);return So(n,s,e)}function So(n,t,e){return({inputs:s,attrs:r,backend:a})=>{const{x:i}=s;At(i,n);const o=a,l=o.data.get(i.dataId).values;let c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=ii(l)}else c=l;const d=e||i.dtype,f=t(c,d,r);return o.makeTensorInfo(i.shape,d,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tz=Ca(n=>Math.ceil(n)),Art=So(wc,Tz),Rrt={kernelName:wc,backendName:"cpu",kernelFunc:Art};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nz(n,t,e,s){const r=He(e,ft(t));if(s&&e!=="string"){let a=0;n.forEach(i=>{const o=ft(i.shape);r.set(i.vals,a),a+=o})}else{let a=0;n.forEach(i=>{const o=e==="string"?ii(i.vals):i.vals;let l=0;for(let c=0;c<i.shape[0];++c){const d=c*t[1]+a;for(let f=0;f<i.shape[1];++f)r[d+f]=o[l++]}a+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cz=nn((n,t)=>n===t?1:0),kz=xn(tp,Cz,null,"bool"),Drt={kernelName:tp,backendName:"cpu",kernelFunc:kz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $z=Ca(n=>Math.exp(n)),Ez=So(Ec,$z,"float32"),Ort={kernelName:Ec,backendName:"cpu",kernelFunc:Ez};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iz=Ca(n=>Math.expm1(n)),_rt=So(Ic,Iz),Frt={kernelName:Ic,backendName:"cpu",kernelFunc:_rt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Az=Ca(n=>Math.floor(n)),Lrt=So(Ac,Az),Mrt={kernelName:Ac,backendName:"cpu",kernelFunc:Lrt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rz=nn((n,t)=>Math.floor(n/t)),zrt=xn(Rc,Rz,null,"int32"),Prt={kernelName:Rc,backendName:"cpu",kernelFunc:zrt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dz(n,t,e,s,r,a,i,o,l){const c=Ht([s,a],e);for(let d=0;d<s;d++){const f=[];let m=0;for(let g=0;g<r;g++){const b=n[d*r+g];m+=b*i[g],f.push(b)}if(m<0||m>=l/a)throw new Error(`Invalid indices: ${f} does not index into ${o}`);for(let g=0;g<a;g++)c.values[d*a+g]=t.get(...t.indexToLoc(m*a+g))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oz(n,t,e){const s=Ht(e,n.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),o=i[0],l=i[2],c=t.locToIndex([o,l]);i[2]=t.values[c];const d=n.locToIndex(i);0<=d&&d<n.values.length&&(s.values[r]=n.values[d])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _z=nn((n,t)=>n>t?1:0),Brt=xn(rp,_z,null,"bool"),Vrt={kernelName:rp,backendName:"cpu",kernelFunc:Brt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fz=nn((n,t)=>n>=t?1:0),Urt=xn(Dc,Fz,null,"bool"),Wrt={kernelName:Dc,backendName:"cpu",kernelFunc:Urt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lz=nn((n,t)=>n<t?1:0),Grt=xn(ip,Lz,null,"bool"),jrt={kernelName:ip,backendName:"cpu",kernelFunc:Grt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mz=nn((n,t)=>n<=t?1:0),Hrt=xn(op,Mz,null,"bool"),qrt={kernelName:op,backendName:"cpu",kernelFunc:Hrt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zz(n,t,e){const s=(t-n)/(e-1),r=Mn(e,"float32");r[0]=n;for(let a=1;a<r.length;a++)r[a]=r[a-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pz=Ca(n=>Math.log(n)),Krt=So(Mc,Pz),Xrt={kernelName:Mc,backendName:"cpu",kernelFunc:Krt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(n,t,e,s){const r=kn(s,ft(e));for(let a=0;a<r.length;++a){const i=a*t;let o=n[i];for(let l=0;l<t;++l){const c=n[i+l];(Number.isNaN(c)||c>o)&&(o=c)}r[a]=o}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vz=nn((n,t)=>Math.max(n,t)),Yrt=xn(Pc,Vz),Zrt={kernelName:Pc,backendName:"cpu",kernelFunc:Yrt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uz=nn((n,t)=>Math.min(n,t)),Qrt=xn(Bc,Uz),Jrt={kernelName:Bc,backendName:"cpu",kernelFunc:Qrt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bC=nn((n,t)=>n*t),tat=gC((n,t,e,s)=>({real:n*e-t*s,imag:n*s+t*e})),kx=xn(Uc,bC,tat),eat={kernelName:Uc,backendName:"cpu",kernelFunc:kx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wz(n,t,e){const s=ci(-1,e);return bC([],t,s,n,e)}function nat(n){const{inputs:t,backend:e}=n,{x:s}=t;At(s,"neg");const r=e.data.get(s.dataId).values,[a,i]=Wz(r,s.shape,s.dtype);return e.makeTensorInfo(i,s.dtype,a)}const sat={kernelName:bp,backendName:"cpu",kernelFunc:nat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gz=nn((n,t)=>n!==t?1:0),rat=xn(xp,Gz,null,"bool"),aat={kernelName:xp,backendName:"cpu",kernelFunc:rat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xC(n,t,e,s,r){const a=t.length,i=ft(t),o=Ft(t),l=Ft(r),c=kn(e,ft(r));for(let d=0;d<i;++d){const f=Il(d,a,o),m=new Array(f.length);for(let b=0;b<m.length;b++)m[b]=f[s[b]];const g=Br(m,a,l);c[g]=n[d]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ss(n){const{inputs:t,attrs:e,backend:s}=n,{x:r}=t,{perm:a}=e;At(r,"transpose");const i=r.shape.length,o=new Array(i);for(let f=0;f<o.length;f++)o[f]=r.shape[a[f]];const l=s.data.get(r.dataId).values,c=xC(l,r.shape,r.dtype,a,o);return{dataId:s.write(c,o,r.dtype),shape:o,dtype:r.dtype}}const iat={kernelName:ol,backendName:"cpu",kernelFunc:Ss};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jz(n,t,e,s){const[r,a]=In(n,s),i=ys(t,"int32"),o=Mn(ft(r),i),l=ft(a);for(let c=0;c<o.length;++c){const d=c*l;let f=1;for(let m=0;m<l;++m)f*=e[d+m];o[c]=f}return{outVals:o,outShape:r,outDtype:i}}function oat(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;At(r,"prod");const o=r.shape.length,l=Zt(a,r.shape),c=We(l,o);let d=l,f=r;const m=[];c!=null&&(f=Ss({inputs:{x:r},backend:e,attrs:{perm:c}}),m.push(f),d=tn(d.length,o));const g=e.data.get(f.dataId).values,{outVals:b,outShape:x,outDtype:v}=jz(f.shape,f.dtype,g,d);let w=x;return i&&(w=Je(x,l)),m.forEach(T=>e.disposeIntermediateTensorInfo(T)),e.makeTensorInfo(w,v,b)}const lat={kernelName:Cp,backendName:"cpu",kernelFunc:oat};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uat(n,t,e){n.forEach((s,r)=>{if(s<0||s>=e){const a=Il(r,t.length,Ft(t)).join(",");throw new Error(`indices[${a}] = ${s} is not in [0, ${e})`)}})}function cat(n,t){for(let e=0;e<n.length;++e){const s=n[e],r=e===n.length-1?t:n[e+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let a=1;a<s.length;++a)if(s[a-1]>s[a])throw new Error("Ragged splits must be sorted in ascending order")}}function hat(n,t,e,s){const r=[];let a=0;const i=t.length-1+e.length,o=new Array(i).fill(null).map(()=>[0]);cat(e,s);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];const d=t[c+1];for(let f=1;f<l+1;++f)o[c].push(f*d)}for(let c=0;c<n.length;++c){let d=n[c],f=n[c]+1;for(let m=0;m<e.length;++m){const g=e[m],b=m+t.length-1;if(b>=0){const x=o[b],v=x[x.length-1]-g[d];for(let w=d;w<f;++w)o[b].push(g[w+1]+v)}d=g[d],f=g[f]}f!==d&&(r.push([d,f]),a+=f-d)}return{outSplits:o,valueSlices:r,numValues:a}}function dat(n){const t=[];for(let e=0;e<n.length;++e){const s=n[e].length,r=He("int32",s);t.push(r),n[e].forEach((a,i)=>r[i]=a)}return t}function vD(n,t){const e=n.slice(0,t);for(;e.length<t;)e.push(1);for(let s=t;s<n.length;s++)e[t-1]*=n[s];return e}function fat(n,t,e,s,r,a){const i=vD(t,2)[1],o=vD(a,2)[1];let l=0;for(const c of e)for(let d=c[0];d<c[1];++d){for(let f=0;f<s;++f)r[l*o+f]=n[d*i+f];++l}}function pat(n,t,e,s,r){const a=t.slice();a[0]=r;const i=He(e,ft(a)),o=n.length,l=o===0?0:o/t[0];return fat(n,t,s,l,i,a),[i,a]}function Hz(n,t,e,s,r,a,i,o){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const l=t[0][0]-1;if(uat(a,i,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:d,valueSlices:f,numValues:m}=hat(a,i,n,c),g=dat(d),b=pat(e,s,r,f,m);return[g,b[0],b[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wD=2147483647;function qz(n,t,e,s,r,a,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const o=t.length===0,l=r.length===0,c=i.length===0,d=[];o||d.push(t[0]),l||d.push(r[0]),c||d.push(i[0]);for(let v=1;v<d.length;++v)if(d[v]!==d[v-1])throw new Error("starts, limits, and deltas must have the same shape");const f=d.length===0?1:d[0],m=He("int32",f+1);m[0]=0;for(let v=0;v<f;++v){const w=o?n[0]:n[v],T=l?s[0]:s[v],C=c?a[0]:a[v];if(C===0)throw new Error("Requires delta != 0");let k;if(C>0&&T<w||C<0&&T>w)k=0;else if(k=Math.ceil(Math.abs((T-w)/C)),k>wD)throw new Error(`Requires ((limit - start) / delta) <= ${wD}`);m[v+1]=m[v]+k}const g=m[f],b=He(e,g);let x=0;for(let v=0;v<f;++v){const w=m[v+1]-m[v];let T=o?n[0]:n[v];const C=c?a[0]:a[v];for(let k=0;k<w;++k)b[x++]=T,T+=C}return[m,b]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var yr=zr;class Qy{constructor(t,e,s,r,a,i,o,l,c,d){this.shape=t,this.shapeShape=e,this.values=s,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=EL(d),this.raggedRank=IL(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===yr.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===yr.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case yr.VALUE_ROWIDS:return Qy.getMaxWidthValueRowID(e);case yr.ROW_SPLITS:return Qy.getMaxWidthRowSplit(e);default:throw new Error(`Cannot handle partition type ${yr[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const e=t.length;if(e===0||e===1)return 0;let s=0;for(let r=0;r<e-1;++r){const a=t[r+1]-t[r];a>s&&(s=a)}return s}static getMaxWidthValueRowID(t){const e=t.length;if(e===0)return 0;let s=0,r=t[0],a=0;for(let i=1;i<e;++i){const o=t[i];o!==r&&(r=o,a=Math.max(i-s,a),s=i)}return Math.max(e-s,a)}tensorShapeFromTensor(t,e,s=!0){if(e.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return TD(t,s)}calculateOutputSize(t){const e=this.valuesShape,s=this.defaultValueShape;AL(s,e);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=$L(this.raggedRank,r,e);i[0]<0&&(i[0]=t);for(let o=1;o<=this.raggedRank;++o)i[o]<0&&(i[o]=this.getMaxWidth(o));return i}calculateFirstParentOutputIndex(t,e,s){const r=Math.min(t,s),a=[];let i=0;for(let o=0;o<r;++o,i+=e)a.push(i);for(let o=r;o<t;++o)a.push(-1);return F(a.length===t,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(t,e,s,r){const a=t.length,i=[];for(let o=0;o<a-1;++o){const l=t[o+1]-t[o];let c=Math.min(r,l),d=e[o];d===-1&&(c=0);for(let f=0;f<c;++f)i.push(d),d+=s;for(let f=0;f<l-c;++f)i.push(-1)}if(a>0&&i.length!==t[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(t,e,s,r){const a=t.length,i=[];if(a===0)return[];let o=0,l=t[0];if(l>=e.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${e.length}`);let c=e[l];i.push(c);for(let d=1;d<a;++d){const f=t[d];if(f===l)c>=0&&(++o,o<r?c+=s:c=-1);else{if(o=0,l=f,f>=e.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${e.length}`);c=e[f]}i.push(c)}if(i.length!==t.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(t,e,s,r){const a=this.getRowPartitionTensor(t),i=this.getRowPartitionTypeByDimension(t);switch(i){case yr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,e,s,r);case yr.ROW_SPLITS:if(a.length-1>e.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${e.length}`);return this.calculateOutputIndexRowSplit(a,e,s,r);default:throw new Error(`Unsupported partition type: ${yr[i]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case yr.FIRST_DIM_SIZE:return t[0];case yr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case yr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${yr[e]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),s=this.calculateOutputSize(e),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const a=TD(s,!1),i=He(this.valuesDType,ft(a));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(e,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,i,a)}return[a,i]}setOutput(t,e,s,r){if(s.length===0)return;const a=this.values,i=s;let o=r.slice();o=o.slice(t+1);const l=ft(o),c=e.length;let d=this.defaultValue;if(d.length!==l&&d.length!==1){const b=this.defaultValueShape;it(()=>{const x=Z(d,b);d=ll(x,o).dataSync()})}let f=0,m=0,g=0;for(let b=0;b<=c;++b){let x=b<c?e[b]:-1;if(x===g){++g;continue}if(m<g){const v=a.subarray(f*l),w=i.subarray(m*l),T=(g-m)*l;SD(w,v,T)}if(b>=c){const v=s.length;x=Math.floor(v/l)}if(x>g)if(this.defaultValue.length===1)i.subarray(g*l,x*l).fill(this.defaultValue[0]),g=x;else for(;x>g;){const v=i.slice(g*l);SD(v,d,l),++g}x<0?(f=b+1,m=g):(f=b,m=g,g=m+1)}}}function SD(n,t,e){for(let s=0;s<e;s++)n[s]=t[s]}function TD(n,t){const e=[];for(let s of n){if(s<0){if(!t)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}e.push(s)}return e}function Kz(n,t,e,s,r,a,i,o,l,c){return new Qy(n,t,e,s,r,a,i,o,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(n,t,e,s){const r=n===t,a=n<t&&e<0,i=t<n&&e>1;if(r||a||i)return Mn(0,s);const o=Math.abs(Math.ceil((t-n)/e)),l=Mn(o,s);t<n&&e===1&&(e=-1),l[0]=n;for(let c=1;c<l.length;c++)l[c]=l[c-1]+e;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yz=Ca(n=>1/Math.sqrt(n)),mat=So(Kc,Yz),gat={kernelName:Kc,backendName:"cpu",kernelFunc:mat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rl(n,t,e,s,r,a,i,o,l,c){const d=[s/r,r],f=n.values,m=t.values;if(s===0)return Ht(e,t.dtype);const g=l instanceof cn?l:Ht(d,t.dtype);typeof l=="string"||typeof l=="number"?g.values.fill(l):typeof l=="boolean"&&g.values.fill(+l);for(let b=0;b<a;b++){const x=[];let v=0;for(let w=0;w<i;w++){const T=f[b*i+w];x.push(T),v+=T*o[w]}if(v<0||v>=s/r)throw new Error(`Invalid indices: ${x} does not index into ${e}`);for(let w=0;w<r;w++)c?g.values[v*r+w]+=m[b*r+w]:g.values[v*r+w]=t.rank===0?m[0]:m[b*r+w]}return g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yat=Ca(n=>1/(1+Math.exp(-n))),Zz=be(Jc,n=>1/(1+Math.exp(-n))),bat={kernelName:Jc,backendName:"cpu",kernelFunc:Zz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(n,t,e,s,r){const a=SN(s,t,e),i=ft(e),o=Ft(s);if(a){const f=TN(t,o);return r==="string"?n.slice(f,f+i):n.subarray(f,f+i)}const l=r==="string"?ii(n):n,c=Ht(s,r,l),d=Ht(e,r);for(let f=0;f<d.size;++f){const m=d.indexToLoc(f),g=m.map((b,x)=>b+t[x]);d.set(c.get(...g),...m)}return r==="string"?YL(d.values):d.values}function Nl(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{begin:a,size:i}=s;At(r,"slice");const[o,l]=hx(r,a,i);vN(r,o,l);const c=e.data.get(r.dataId).values,d=Qz(c,o,l,r.shape,r.dtype);return e.makeTensorInfo(l,r.dtype,d)}const xat={kernelName:Rp,backendName:"cpu",kernelFunc:Nl};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz(n,t,e,s,r,a,i){const o=t[0],l=a[0],c=new Array(l),d=new Array(o),f=t[1];if(l===0){if(o!==0)throw new Error(ML(o));const v=He(e,0),w=He(r,0);return[v,[0,f],w,c,d]}let m=!0,g=0;const b=new Array(l).fill(0);for(let v=0;v<o;++v){const w=n[v*f];if(w<0)throw new Error(zL(v,w));if(w>=l)throw new Error(PL(v,w,l));++b[w],m=m&&w>=g,g=w}let x=!0;for(let v=0;v<l;++v){const w=b[v]===0;c[v]=w,x=x&&!w,b[v]=Math.max(b[v],1),v>0&&(b[v]+=b[v-1])}if(x&&m){const v=n,w=s;for(let T=0;T<o;++T)d[T]=T;return[v,[o,f],w,c,d]}else{const v=b[l-1],w=He(e,v*f),T=He(r,v),C=new Array(l).fill(0);for(let k=0;k<o;++k){const $=n[k*f],I=C[$],D=($===0?0:b[$-1])+I;C[$]++;for(let _=0;_<f;++_)w[D*f+_]=n[k*f+_];T[D]=s[k],d[k]=D}for(let k=0;k<l;++k)if(C[k]===0){const I=k===0?0:b[k-1];w[I*f+0]=k;for(let D=1;D<f;++D)w[I*f+D]=0;T[I]=i}return[w,[v,f],T,c,d]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tP(n,t,e,s,r){const a=ft(s),i=t[0],o=r.length,l=[];let c=1,d=-1;for(let v=0;v<o;++v){const w=r[v];if(w===-1){if(d!==-1)throw new Error(BL(d,v));d=v,l.push(1)}else{if(w<0)throw new Error(VL(v,w));c*=w,l.push(w)}}if(d!==-1){if(c<=0)throw new Error(UL());const v=Math.trunc(a/c);if(c*v!==a)throw new Error(WL(s,l));l[d]=v}if(ft(l)!==a)throw new Error(GL(s,l));const m=s.length,g=[];if(m>0){g[m-1]=1;for(let v=m-2;v>=0;--v)g[v]=g[v+1]*s[v+1]}const b=[];if(o>0){b[o-1]=1;for(let v=o-2;v>=0;--v)b[v]=b[v+1]*l[v+1]}const x=He(e,i*o);for(let v=0;v<i;++v){let w=0;for(let T=0;T<m;++T)w+=n[v*m+T]*g[T];for(let T=0;T<o;++T)x[v*o+T]=Math.trunc(w/b[T]),w%=b[T]}return[x,[i,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vC(n,t,e,s,r,a=!1,i=0){const o=s.length,l=[t[0],n.length/t[0]],c=l[1],f=o>0?r[o-1]+1:0;if(f<0)throw new Error(SS());const m=t.slice();m[0]=f;const g=m.reduce((C,k)=>C*k,1),b=He(e,g);if(o===0)return f>0&&b.fill(i),[b,m];if(f<=0)throw new Error(SS());let x=0,v=1,w=0,T=r[x];for(;;){let C=0;if(v<o){if(C=r[v],T===C){++v;continue}if(T>=C)throw new Error(jL())}if(T<0||T>=f)throw new Error(HL(T,f));T>w&&b.fill(i,w*c,T*c);for(let k=x;k<v;++k){const $=s[k];if($<0||$>=l[0])throw new Error(qL(k,s[k],l[0]));for(let I=0;I<c;I++)b[T*c+I]+=n[$*c+I]}if(a)for(let k=0;k<c;k++)b[T*c+k]/=v-x;if(x=v,++v,w=T+1,T=C,v>o)break}return w<f&&b.fill(i,w*c,f*c),[b,m]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vat=Ca(n=>Math.sqrt(n)),wat=be(eh,n=>Math.sqrt(n)),Sat={kernelName:eh,backendName:"cpu",kernelFunc:wat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eP=nn((n,t)=>{const e=n-t;return e*e}),Tat=xn(nh,eP),Nat={kernelName:nh,backendName:"cpu",kernelFunc:Tat};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nP=Ca((n,t)=>{const{pattern:e,replaceGlobal:s,rewrite:r}=t;return n.replace(new RegExp(e,s?"g":""),r)}),Cat=So(Lp,nP),kat={kernelName:Lp,backendName:"cpu",kernelFunc:Cat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sP(n,t,e,s){const r=Ht(n,t.dtype);for(let a=0;a<r.size;a++){const i=r.indexToLoc(a),o=new Array(i.length);for(let l=0;l<o.length;l++)o[l]=i[l]*e[l]+s[l];r.set(t.get(...o),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $at{constructor(t,e,s,r,a,i){this.separator=ha(t),this.nGramWidths=e,this.leftPad=ha(s),this.rightPad=ha(r),this.padWidth=a,this.preserveShort=i}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const s=this.getPadWidth(e);return Math.max(0,t+2*s-e+1)}createNGrams(t,e,s,r,a,i){for(let o=0;o<a;++o){const l=this.getPadWidth(i),c=Math.max(0,l-o),d=Math.max(0,l-(a-(o+1))),f=i-(c+d),m=e+(c>0?0:o-l);let g=0;g+=c*this.leftPad.length;for(let T=0;T<f;++T)g+=t[m+T].length;g+=d*this.rightPad.length;const b=c+d+f-1;g+=b*this.separator.length,s[r+o]=new Uint8Array(g);const x=s[r+o];let v=0;const w=T=>T.forEach(C=>x[v++]=C);for(let T=0;T<c;++T)w(this.leftPad),w(this.separator);for(let T=0;T<f-1;++T)w(t[m+T]),w(this.separator);if(f>0){w(t[m+f-1]);for(let T=0;T<d;++T)w(this.separator),w(this.rightPad)}else{for(let T=0;T<d-1;++T)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(t,e){const s=t.length,r=e.length;if(r>0){let l=e[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let d=e[c]>=l;if(d=d&&e[c]<=s,!d)throw new Error(`Invalid split value ${e[c]}, must be in [${l}, ${s}]`);l=e[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const a=r-1,i=He("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=a;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=a;++l){const c=e[l]-e[l-1];let d=0;this.nGramWidths.forEach(f=>{d+=this.getNumNGrams(c,f)}),this.preserveShort&&c>0&&d===0&&(d=1),i[l]=i[l-1]+d}const o=new Array(i[a]);for(let l=0;l<a;++l){const c=e[l];let d=i[l];if(this.nGramWidths.forEach(f=>{const m=e[l+1]-e[l],g=this.getNumNGrams(m,f);this.createNGrams(t,c,o,d,g,f),d+=g}),this.preserveShort&&d===i[l]){const f=e[l+1]-e[l];if(f===0)continue;const m=f+2*this.padWidth;this.createNGrams(t,c,o,d,1,m)}}return[o,i]}}function rP(n,t,e,s,r,a,i,o){return new $at(e,s,r,a,i,o).compute(n,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eat(n,t,e,s){if(!n.length)return;if(t.length===0){for(let a=0;a<n.length;++a)s.push(n.subarray(a,a+1));return}if(t.length===1){const a=t[0];let i=n.indexOf(a);for(;i!==-1;){const o=n.subarray(0,i);(!e||o.length!==0)&&s.push(o),n=n.subarray(i+1),i=n.indexOf(a)}(!e||n.length!==0)&&s.push(n);return}let r=0;for(let a=0;a<n.length+1;a++)if(a===n.length||t.indexOf(n[a])!==-1){const i=n.subarray(r,a);(!e||i.length!==0)&&s.push(i),r=a+1}}function aP(n,t,e){const s=n.length,r=[];let a=0,i=0;const o=new Array(s);for(let m=0;m<s;++m){const g=r.length;Eat(n[m],t,e,r);const b=r.length-g;o[m]=b,a+=b,i=Math.max(i,b)}const l=He("int32",a*2),c=new Array(a),d=[s,i];let f=0;for(let m=0;m<s;++m)for(let g=0;g<o[m];++g)l[f*2]=m,l[f*2+1]=g,c[f]=r[f],++f;return[l,c,d]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iP(n,t){const e=He("int32",n.length);for(let s=0;s<n.length;++s)e[s]=z3(n[s]).modulo(t).getLowBitsUnsigned();return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oP=nn((n,t)=>n-t),Iat=gC((n,t,e,s)=>({real:n-e,imag:t-s})),wC=xn(sh,oP,Iat),Aat={kernelName:sh,backendName:"cpu",kernelFunc:wC};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lP(n,t){const e=new Array(n.rank);for(let r=0;r<e.length;r++)e[r]=n.shape[r]*t[r];const s=Ht(e,n.dtype);for(let r=0;r<s.values.length;++r){const a=s.indexToLoc(r),i=new Array(n.rank);for(let l=0;l<i.length;l++)i[l]=a[l]%n.shape[l];const o=n.locToIndex(i);s.values[r]=n.values[o]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ld=(n,t)=>{const e=t.value-n.value;return e===0?n.index-t.index:e};function uP(n,t,e=0,s=n.length-1){for(;s>e;){if(s-e>600){const o=s-e+1,l=t-e+1,c=Math.log(o),d=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*d*(o-d)/o)*Math.sign(l-o/2),m=Math.max(e,Math.floor(t-l*d/o+f)),g=Math.min(s,Math.floor(t+(o-l)*d/o+f));uP(n,t,m,g)}const r=n[t];let a=e,i=s;for(Ka(n,e,t),Ld(n[s],r)>0&&Ka(n,e,s);a<i;){for(Ka(n,a,i),a++,i--;Ld(n[a],r)<0;)a=a+1;for(;Ld(n[i],r)>0;)i=i-1}Ld(n[e],r)===0?Ka(n,e,i):(i=i+1,Ka(n,i,s)),i<=t&&(e=i+1),t<=i&&(s=i-1)}}function cP(n,t,e,s,r){const a=t[t.length-1],[i,o]=[n.length/a,a],l=kn(e,i*s),c=kn("int32",i*s);for(let f=0;f<i;f++){const m=f*o,g=n.subarray(m,m+o);let b=new Array(g.length);g.forEach((T,C)=>b[C]={value:T,index:C}),s<b.length&&(uP(b,s),b=b.slice(0,s)),r&&b.sort(Ld);const x=f*s,v=l.subarray(x,x+s),w=c.subarray(x,x+s);for(let T=0;T<s;T++)v[T]=b[T].value,w[T]=b[T].index}const d=t.slice();return d[d.length-1]=s,[Ht(d,e,l),Ht(d,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hP(n,t,e,s){const r=Zt(t,e)[0],a=[1,e[0],1];for(let b=0;b<r;b++)a[0]*=e[b];a[1]=e[r];for(let b=r+1;b<e.length;b++)a[2]*=e[b];const i=new Map,o=new Int32Array(e[r]),l=new cn(a,s,n),c=[],d=a[0]===1&&a[2]===1;for(let b=0;b<e[r];b++){let x;if(d)x=n[b].toString();else{const w=[];for(let T=0;T<a[0];T++)for(let C=0;C<a[2];C++)w.push(l.get(T,b,C));x=w.join(",")}const v=i.get(x);if(v!=null)o[b]=v;else{const w=i.size;i.set(x,w),o[b]=w,c.push(b)}}const f=a.slice();f[1]=i.size;const m=new cn(f,s);c.forEach((b,x)=>{for(let v=0;v<a[0];v++)for(let w=0;w<a[2];w++)m.set(l.get(v,b,w),v,x,w)});const g=e.slice();return g[r]=f[1],{outputValues:m.values,outputShape:g,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rat=Object.freeze(Object.defineProperty({__proto__:null,addImpl:vz,bincountImpl:yC,bincountReduceImpl:wz,bitwiseAndImpl:Sz,castImpl:xz,ceilImpl:Tz,concatImpl:Nz,equalImpl:Cz,expImpl:$z,expm1Impl:Iz,floorDivImpl:Rz,floorImpl:Az,gatherNdImpl:Dz,gatherV2Impl:Oz,greaterEqualImpl:Fz,greaterImpl:_z,lessEqualImpl:Mz,lessImpl:Lz,linSpaceImpl:zz,logImpl:Pz,maxImpl:Bz,maximumImpl:Vz,minimumImpl:Uz,multiplyImpl:bC,negImpl:Wz,notEqualImpl:Gz,prodImpl:jz,raggedGatherImpl:Hz,raggedRangeImpl:qz,raggedTensorToTensorImpl:Kz,rangeImpl:Xz,rsqrtImpl:Yz,scatterImpl:rl,sigmoidImpl:yat,simpleAbsImpl:bz,sliceImpl:Qz,sparseFillEmptyRowsImpl:Jz,sparseReshapeImpl:tP,sparseSegmentReductionImpl:vC,sqrtImpl:vat,squaredDifferenceImpl:eP,staticRegexReplaceImpl:nP,stridedSliceImpl:sP,stringNGramsImpl:rP,stringSplitImpl:aP,stringToHashBucketFastImpl:iP,subImpl:oP,tileImpl:lP,topKImpl:cP,transposeImpl:xC,uniqueImpl:hP},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */eT("cpu",()=>new Cx,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dP=be(kc,n=>n>=0?n:Math.exp(n)-1),Dat={kernelName:kc,backendName:"cpu",kernelFunc:dP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fP(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{alpha:a}=s;At([r],"leakyRelu");const i=ft(r.shape),o=e.data.get(r.dataId).values,l=kn("float32",i);for(let c=0;c<o.length;c++)l[c]=o[c]<0?a*o[c]:o[c];return e.makeTensorInfo(r.shape,"float32",l)}const Oat={kernelName:ap,backendName:"cpu",kernelFunc:fP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _at=nn((n,t)=>n<0?t*n:n);function pP(n){const{inputs:t,backend:e}=n,{x:s,alpha:r}=t;At([s,r],"prelu");const a=e.data.get(s.dataId).values,i=e.data.get(r.dataId).values,[o,l]=_at(s.shape,r.shape,a,i,"float32");return e.makeTensorInfo(l,"float32",o)}const Fat={kernelName:Np,backendName:"cpu",kernelFunc:pP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mP=be(jc,n=>Math.max(0,n)),Lat={kernelName:jc,backendName:"cpu",kernelFunc:mP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gP=be(Hc,n=>Math.min(Math.max(0,n),6)),Mat={kernelName:Hc,backendName:"cpu",kernelFunc:gP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jy(n,t,e,s,r){if(e==="linear")return Sa({inputs:{x:t},backend:n});if(e==="relu")return mP({inputs:{x:t},backend:n});if(e==="elu")return dP({inputs:{x:t},backend:n});if(e==="relu6")return gP({inputs:{x:t},backend:n});if(e==="prelu")return pP({inputs:{x:t,alpha:s},backend:n});if(e==="leakyrelu")return fP({inputs:{x:t},backend:n,attrs:{alpha:r}});if(e==="sigmoid")return Zz({inputs:{x:t},backend:n});throw new Error(`Activation ${e} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oe(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{shape:a}=s,i=ft(r.shape),o=j2(a,i),l=ft(o);F(i===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),e.incRef(r.dataId);const c=e.data.get(r.dataId);if(c.complexTensorInfos!=null){const d=c.complexTensorInfos.real,f=c.complexTensorInfos.imag;d.shape=o,f.shape=o}return{dataId:r.dataId,shape:o,dtype:r.dtype}}const zat={kernelName:kp,backendName:"cpu",kernelFunc:Oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yP(n){const{inputs:t,backend:e,attrs:s}=n,{a:r,b:a}=t,{transposeA:i,transposeB:o}=s;At([r,a],"matMul");const l=r.shape.length,c=a.shape.length,d=i?r.shape[l-2]:r.shape[l-1],f=o?a.shape[c-1]:a.shape[c-2],m=i?r.shape[l-1]:r.shape[l-2],g=o?a.shape[c-2]:a.shape[c-1],b=r.shape.slice(0,-2),x=a.shape.slice(0,-2),v=ft(b),w=ft(x),C=jt(r.shape.slice(0,-2),a.shape.slice(0,-2)).concat([m,g]);F(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${r.shape} and ${a.shape} and transposeA=${i} and transposeB=${o} must match.`);const k=i?[v,d,m]:[v,m,d],$=o?[w,g,f]:[w,f,g],I=Oe({inputs:{x:r},backend:e,attrs:{shape:k}}),D=Oe({inputs:{x:a},backend:e,attrs:{shape:$}}),_=i?I.shape[1]:I.shape[2],O=i?I.shape[2]:I.shape[1],L=o?D.shape[1]:D.shape[2],R=Math.max(v,w),V=e.data.get(I.dataId).values,Y=e.data.get(D.dataId).values,Q=Ft(I.shape),tt=Ft(D.shape),[B,W,X]=i?[Q[0],1,Q[1]]:[Q[0],Q[1],1],[ot,P,j]=o?[1,tt[1],tt[0]]:[tt[1],1,tt[0]],rt=O*L,st=Ht([R,O,L],I.dtype),mt=st.values,gt=e.blockSize;for(let bt=0;bt<R;bt++){const $t=bt%v,Ct=bt%w;for(let _t=0;_t<O;_t+=gt){const Wt=Math.min(_t+gt,O);for(let Gt=0;Gt<L;Gt+=gt){const ue=Math.min(Gt+gt,L);for(let fe=0;fe<_;fe+=gt){const Ee=Math.min(fe+gt,_);for(let xe=_t;xe<Wt;xe++)for(let pe=Gt;pe<ue;pe++){let oe=0;for(let Ie=fe;Ie<Ee;Ie++){const ar=V[$t*B+xe*W+Ie*X],sn=Y[Ie*ot+pe*P+Ct*j];oe+=ar*sn}mt[bt*rt+(xe*L+pe)]+=oe}}}}}return e.disposeIntermediateTensorInfo(I),e.disposeIntermediateTensorInfo(D),e.makeTensorInfo(C,st.dtype,st.values)}const Pat={kernelName:Wf,backendName:"cpu",kernelFunc:yP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bat(n){const{inputs:t,backend:e,attrs:s}=n,{a:r,b:a,bias:i,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:d,leakyreluAlpha:f}=s;let m,g,b;const x=[];m=yP({inputs:{a:r,b:a},attrs:{transposeA:l,transposeB:c},backend:e}),i&&(g=nc({inputs:{a:m,b:i},backend:e}),x.push(m),m=g),d&&(b=Jy(e,m,d,o,f),x.push(m),m=b);for(const w of x)e.disposeIntermediateTensorInfo(w);return m}const Vat={kernelName:cf,backendName:"cpu",kernelFunc:Bat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uat=be(fc,n=>Math.acos(n)),Wat={kernelName:fc,backendName:"cpu",kernelFunc:Uat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gat=be(pc,n=>Math.acosh(n)),jat={kernelName:pc,backendName:"cpu",kernelFunc:Gat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hat(n){const{inputs:t,backend:e}=n,s=t;At(t,"addN");const r=s.map(o=>e.data.get(o.dataId).values),a=Ht(s[0].shape,s[0].dtype),i=a.values;for(let o=0;o<s.length;o++){const l=r[o];for(let c=0;c<i.length;c++)i[c]+=l[c]}return e.makeTensorInfo(a.shape,a.dtype,a.values)}const qat={kernelName:zf,backendName:"cpu",kernelFunc:Hat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kat(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;At(r,"all");const o=Zt(a,r.shape);let l=o;const c=We(l,r.shape.length);let d=r;c!=null&&(d=Ss({inputs:{x:r},backend:e,attrs:{perm:c}}),l=tn(l.length,r.shape.length)),Bn("all",l,d.shape.length);const[f,m]=In(d.shape,l),g=ft(m),b=Mn(ft(f),d.dtype),x=e.data.get(d.dataId).values;for(let w=0;w<b.length;++w){const T=w*g;let C=x[T];for(let k=0;k<g;++k){const $=x[T+k];C=C&&$}b[w]=C}c!=null&&e.disposeIntermediateTensorInfo(d);const v=e.makeTensorInfo(f,d.dtype,b);if(i){const w=Je(f,o),T=Oe({inputs:{x:v},backend:e,attrs:{shape:w}});return e.disposeIntermediateTensorInfo(v),T}return v}const Xat={kernelName:v0,backendName:"cpu",kernelFunc:Kat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yat(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;At(r,"any");const o=Zt(a,r.shape);let l=o;const c=We(l,r.shape.length);let d=r;c!=null&&(d=Ss({inputs:{x:r},backend:e,attrs:{perm:c}}),l=tn(l.length,r.shape.length)),Bn("any",l,d.shape.length);const[f,m]=In(d.shape,l),g=ft(m),b=Mn(ft(f),d.dtype),x=e.data.get(d.dataId).values;for(let w=0;w<b.length;++w){const T=w*g;let C=x[T];for(let k=0;k<g;++k){const $=x[T+k];C=C||$}b[w]=C}c!=null&&e.disposeIntermediateTensorInfo(d);const v=e.makeTensorInfo(f,d.dtype,b);if(i){const w=Je(f,o),T=Oe({inputs:{x:v},backend:e,attrs:{shape:w}});return e.disposeIntermediateTensorInfo(v),T}return v}const Zat={kernelName:w0,backendName:"cpu",kernelFunc:Yat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qat(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a}=s;At(r,"argMax");let i=Zt(a,r.shape);const o=We(i,r.shape.length);let l=r;const c=[];o!=null&&(l=Ss({inputs:{x:r},backend:e,attrs:{perm:o}}),c.push(l),i=tn(i.length,l.shape.length)),i=[i[0]],Bn("argMax",i,l.shape.length);const[d,f]=In(l.shape,i),m=ft(d),g=Mn(m,"int32"),b=ft(f),x=e.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const w=v*b;let T=x[w],C=0;for(let k=0;k<b;++k){const $=x[w+k];$>T&&(T=$,C=k)}g[v]=C}return c.forEach(v=>e.disposeIntermediateTensorInfo(v)),e.makeTensorInfo(d,"int32",g)}const Jat={kernelName:Pf,backendName:"cpu",kernelFunc:Qat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tit(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a}=s;At(r,"argMin");let i=Zt(a,r.shape);const o=We(i,r.shape.length);let l=r;const c=[];o!=null&&(l=Ss({inputs:{x:r},backend:e,attrs:{perm:o}}),c.push(l),i=tn(i.length,l.shape.length)),i=[i[0]],Bn("argMin",i,l.shape.length);const[d,f]=In(l.shape,i),m=ft(d),g=Mn(m,"int32"),b=ft(f),x=e.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const w=v*b;let T=x[w],C=0;for(let k=0;k<b;++k){const $=x[w+k];$<T&&(T=$,C=k)}g[v]=C}return c.forEach(v=>e.disposeIntermediateTensorInfo(v)),e.makeTensorInfo(d,"int32",g)}const eit={kernelName:Bf,backendName:"cpu",kernelFunc:tit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nit=be(mc,n=>Math.asin(n)),sit={kernelName:mc,backendName:"cpu",kernelFunc:nit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rit=be(gc,n=>Math.asinh(n)),ait={kernelName:gc,backendName:"cpu",kernelFunc:rit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iit=be(yc,n=>Math.atan(n)),oit={kernelName:yc,backendName:"cpu",kernelFunc:iit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lit=nn((n,t)=>Math.atan2(n,t)),uit=xn(xc,lit),cit={kernelName:xc,backendName:"cpu",kernelFunc:uit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hit=be(bc,n=>Math.atanh(n)),dit={kernelName:bc,backendName:"cpu",kernelFunc:hit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SC(n,t,e,s,r,a){const i=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,m=r.padInfo.top,g=r.padInfo.left,b=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=Ht(r.outShape,e),v=x.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3],T=r.outShape[2]*r.outShape[3],C=r.outShape[3];for(let k=0;k<r.batchSize;++k){const $=k*w,I=k*s[0];for(let D=0;D<r.inChannels;++D)for(let _=0;_<r.outHeight;++_){const O=_*i-m,L=Math.max(0,O),R=Math.min(r.inHeight,d+O),V=$+_*T;for(let Y=0;Y<r.outWidth;++Y){const Q=Y*o-g,tt=Math.max(0,Q),B=Math.min(r.inWidth,f+Q);let W=b,X=0,ot=0;for(let j=L;j<R;j+=l){const rt=I+j*s[1];for(let st=tt;st<B;st+=c){const mt=rt+st*s[2],gt=n[mt+D];a==="max"&&gt>W?W=gt:a==="avg"&&(X+=gt,ot++)}if(isNaN(W))break}const P=V+Y*C+D;v[P]=a==="avg"?X/ot:W}}}return x}function bP(n,t,e,s,r=!1,a=!1){const i=Ht(s.outShape,"int32"),o=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,d=s.dilationWidth,f=s.effectiveFilterHeight,m=s.effectiveFilterWidth,g=s.padInfo.top,b=s.padInfo.left,x=Ht(t,e,n);for(let v=0;v<s.batchSize;++v)for(let w=0;w<s.inChannels;++w)for(let T=0;T<s.outHeight;++T){const C=T*o-g;let k=C;for(;k<0;)k+=c;const $=Math.min(s.inHeight,f+C);for(let I=0;I<s.outWidth;++I){const D=I*l-b;let _=D;for(;_<0;)_+=d;const O=Math.min(s.inWidth,m+D);let L=Number.NEGATIVE_INFINITY,R=-1;for(let V=k;V<$;V+=c){const Y=V-C;for(let Q=_;Q<O;Q+=d){const tt=Q-D,B=x.get(v,V,Q,w);B>L&&(L=B,r?R=a?((v*s.inHeight+V)*s.inWidth+Q)*s.inChannels+w:(V*s.inWidth+Q)*s.inChannels+w:R=Y*m+tt)}}i.set(R,v,T,I,w)}}return i}function xP(n,t,e,s,r,a){const i=r.strideDepth,o=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,d=r.dilationHeight,f=r.dilationWidth,m=r.effectiveFilterDepth,g=r.effectiveFilterHeight,b=r.effectiveFilterWidth,x=r.padInfo.front,v=r.padInfo.top,w=r.padInfo.left,T=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,C=Ht(r.outShape,e),k=C.values,$=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],I=r.outShape[2]*r.outShape[3]*r.outShape[4],D=r.outShape[3]*r.outShape[4],_=r.outShape[4];for(let O=0;O<r.batchSize;++O){const L=O*$,R=O*s[0];for(let V=0;V<r.inChannels;++V)for(let Y=0;Y<r.outDepth;++Y){const Q=Y*i-x;let tt=Q;for(;tt<0;)tt+=c;const B=Math.min(r.inDepth,m+Q),W=L+Y*I;for(let X=0;X<r.outHeight;++X){const ot=X*o-v;let P=ot;for(;P<0;)P+=d;const j=Math.min(r.inHeight,g+ot),rt=W+X*D;for(let st=0;st<r.outWidth;++st){const mt=st*l-w;let gt=mt;for(;gt<0;)gt+=f;const bt=Math.min(r.inWidth,b+mt),$t=rt+st*_;let Ct=T,_t=0,Wt=0;for(let ue=tt;ue<B;ue+=c){const fe=R+ue*s[1];for(let Ee=P;Ee<j;Ee+=d){const xe=fe+Ee*s[2];for(let pe=gt;pe<bt;pe+=f){const oe=xe+pe*s[3],Ie=n[oe+V];if(a==="max"&&Ie>Ct?Ct=Ie:a==="avg"&&(_t+=Ie,Wt++),isNaN(Ct))break}if(isNaN(Ct))break}if(isNaN(Ct))break}const Gt=$t+V;k[Gt]=a==="avg"?_t/Math.max(Wt,1):Ct}}}}return C}function fit(n,t){const e=Ht(t.outShape,"int32"),s=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,b=t.padInfo.left;for(let x=0;x<t.batchSize;++x)for(let v=0;v<t.inChannels;++v)for(let w=0;w<t.outDepth;++w){const T=w*s-m;let C=T;for(;C<0;)C+=i;const k=Math.min(t.inDepth,c+T);for(let $=0;$<t.outHeight;++$){const I=$*r-g;let D=I;for(;D<0;)D+=o;const _=Math.min(t.inHeight,d+I);for(let O=0;O<t.outWidth;++O){const L=O*a-b;let R=L;for(;R<0;)R+=l;const V=Math.min(t.inWidth,f+L);let Y=Number.NEGATIVE_INFINITY,Q=-1;for(let tt=C;tt<k;tt+=i){const B=tt-T;for(let W=D;W<_;W+=o){const X=W-I;for(let ot=R;ot<V;ot+=l){const P=ot-L,j=n.get(x,tt,W,ot,v);j>=Y&&(Y=j,Q=B*d*f+X*d+P)}}}e.set(Q,x,w,$,O,v)}}}return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pit(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;At(r,"avgPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;F(Pn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=kr(r.shape,a,i,c,o,l);let f;if(d.filterWidth===1&&d.filterHeight===1&&te(d.inShape,d.outShape))f=Sa({inputs:{x:r},backend:e});else{const m=e.data.get(r.dataId).values,g=Ft(r.shape),b=SC(m,r.shape,r.dtype,g,d,"avg");f=e.makeTensorInfo(d.outShape,r.dtype,b.values)}return f}const mit={kernelName:Vf,backendName:"cpu",kernelFunc:pit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function git(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=s;At(r,"avgPool3d");const d=hi(r.shape,a,i,1,o,l,c),f=e.data.get(r.dataId).values,m=xP(f,r.shape,r.dtype,Ft(r.shape),d,"avg");return e.makeTensorInfo(m.shape,"float32",m.values)}const yit={kernelName:Uf,backendName:"cpu",kernelFunc:git};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bit(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=s;At([r,a],"avgPool3DGrad");const d=hi(a.shape,i,o,1,l,c),f=d.strideDepth,m=d.strideHeight,g=d.strideWidth,b=d.filterDepth,x=d.filterHeight,v=d.filterWidth,w=d.dilationDepth,T=d.dilationHeight,C=d.dilationWidth,k=d.effectiveFilterDepth,$=d.effectiveFilterHeight,I=d.effectiveFilterWidth,D=k-1-d.padInfo.front,_=I-1-d.padInfo.left,O=$-1-d.padInfo.top,L=Ht(a.shape,"float32"),R=1/(b*x*v),V=e.bufferSync(r);for(let Y=0;Y<d.batchSize;++Y)for(let Q=0;Q<d.inChannels;++Q)for(let tt=0;tt<d.inDepth;++tt)for(let B=0;B<d.inHeight;++B)for(let W=0;W<d.inWidth;++W){const X=tt-D,ot=B-O,P=W-_;let j=0;for(let rt=0;rt<k;rt+=w){const st=(X+rt)/f;if(!(st<0||st>=d.outDepth||Math.floor(st)!==st))for(let mt=0;mt<$;mt+=T){const gt=(ot+mt)/m;if(!(gt<0||gt>=d.outHeight||Math.floor(gt)!==gt))for(let bt=0;bt<I;bt+=C){const $t=(P+bt)/g;if($t<0||$t>=d.outWidth||Math.floor($t)!==$t)continue;const Ct=V.get(Y,st,gt,$t,Q);j+=Ct}}}L.set(j*R,Y,tt,B,W,Q)}return e.makeTensorInfo(L.shape,L.dtype,L.values)}const xit={kernelName:T0,backendName:"cpu",kernelFunc:bit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vit(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,i=a;At([r,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=s,d=kr(i.shape,o,l,1,c),f=d.strideHeight,m=d.strideWidth,g=d.filterHeight,b=d.filterWidth,x=d.dilationHeight,v=d.dilationWidth,w=d.effectiveFilterHeight,T=d.effectiveFilterWidth,C=T-1-d.padInfo.left,k=w-1-d.padInfo.top,$=Ht(i.shape,"float32"),I=1/(g*b),D=e.data.get(r.dataId).values,_=Ht(r.shape,"float32",D);for(let O=0;O<d.batchSize;++O)for(let L=0;L<d.inChannels;++L)for(let R=0;R<d.inHeight;++R)for(let V=0;V<d.inWidth;++V){const Y=R-k,Q=V-C;let tt=0;for(let B=0;B<w;B+=x){const W=(Y+B)/f;if(!(W<0||W>=d.outHeight||Math.floor(W)!==W))for(let X=0;X<T;X+=v){const ot=(Q+X)/m;if(ot<0||ot>=d.outWidth||Math.floor(ot)!==ot)continue;const P=_.get(O,W,ot,L);tt+=P}}$.set(tt*I,O,R,V,L)}return e.makeTensorInfo($.shape,$.dtype,$.values)}const wit={kernelName:S0,backendName:"cpu",kernelFunc:vit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sit(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,scale:a,offset:i,mean:o,variance:l}=t;F(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),At([r,o,l,a,i],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const d=e.data.get(r.dataId).values,f=e.data.get(o.dataId).values,m=e.data.get(l.dataId).values,g=a?e.data.get(a.dataId).values:new Float32Array([1]),b=i?e.data.get(i.dataId).values:new Float32Array([0]),x=new Float32Array(d.length),v=b.length,w=g.length,T=m.length,C=f.length;let k=0,$=0,I=0,D=0;for(let _=0;_<d.length;++_)x[_]=b[k++]+(d[_]-f[$++])*g[I++]/Math.sqrt(m[D++]+c),k>=v&&(k=0),$>=C&&($=0),I>=w&&(I=0),D>=T&&(D=0);return e.makeTensorInfo(r.shape,r.dtype,x)}const Tit={kernelName:np,backendName:"cpu",kernelFunc:Sit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nit(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockShape:a,crops:i}=s;At([r],"batchToSpaceND");const o=a.reduce((w,T)=>w*T),l=im(r.shape,a,o),c=om(l.length,a.length),d=lm(r.shape,a,o),f=IN(i,a.length),m=AN(d,i,a.length),g=Oe({inputs:{x:r},backend:e,attrs:{shape:l}}),b=Ss({inputs:{x:g},backend:e,attrs:{perm:c}}),x=Oe({inputs:{x:b},backend:e,attrs:{shape:d}}),v=Nl({inputs:{x},backend:e,attrs:{begin:f,size:m}});return e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(x),v}const Cit={kernelName:Gf,backendName:"cpu",kernelFunc:Nit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kit(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,weights:a}=t,{size:i}=s,o=e.data.get(r.dataId).values,l=e.data.get(a.dataId).values,c=yC(o,l,a.dtype,a.shape,i);return e.makeTensorInfo([i],a.dtype,c)}const $it={kernelName:N0,backendName:"cpu",kernelFunc:kit};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eit(n){const{inputs:t,backend:e}=n,{s0:s,s1:r}=t,a=e.data.get(s.dataId).values,i=e.data.get(r.dataId).values,o=jt(Array.from(a),Array.from(i));return e.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const Iit={kernelName:C0,backendName:"cpu",kernelFunc:Eit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ait=be(Sc,(n,t)=>{const e=t;return n>e.clipValueMax?e.clipValueMax:n<e.clipValueMin?e.clipValueMin:n}),Rit={kernelName:Sc,backendName:"cpu",kernelFunc:Ait};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dit=n=>{const{x:t}=n.inputs,e=n.backend,s=new Float32Array(ft(t.shape)),r=e.data.get(t.dataId),a=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,o=e.data.get(a.dataId).values,l=e.data.get(i.dataId).values;for(let c=0;c<o.length;c++){const d=o[c],f=l[c];s[c]=Math.hypot(d,f)}return e.makeOutput(s,t.shape,"float32")},Oit={kernelName:Hf,backendName:"cpu",kernelFunc:Dit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sc(n){const{inputs:t,backend:e}=n,{input:s}=t,r=e.data.get(s.dataId).complexTensorInfos.imag,a=e.data.get(r.dataId).values;return e.makeTensorInfo(r.shape,r.dtype,a)}const _it={kernelName:j0,backendName:"cpu",kernelFunc:sc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rc(n){const{inputs:t,backend:e,attrs:s}=n,{axis:r}=s,a=Zt(r,t[0].shape)[0],i=t.map(x=>x.shape);kN(i,a);let o=fa(t.map(x=>x.shape),a);if(ft(o)===0)return e.makeTensorInfo(o,t[0].dtype,[]);const l=t.filter(x=>ft(x.shape)>0);if(l.length===1)return Sa({inputs:{x:l[0]},backend:e});if(l[0].dtype==="complex64"){const x=l.map(k=>Tl({inputs:{input:k},backend:e})),v=l.map(k=>sc({inputs:{input:k},backend:e})),w=rc({inputs:x,backend:e,attrs:{axis:a}}),T=rc({inputs:v,backend:e,attrs:{axis:a}}),C=Os({inputs:{real:w,imag:T},backend:e});return x.forEach(k=>e.disposeIntermediateTensorInfo(k)),v.forEach(k=>e.disposeIntermediateTensorInfo(k)),e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(T),C}const c=l.map(x=>{const w=[-1,ft(x.shape.slice(a))];return Oe({inputs:{x},backend:e,attrs:{shape:w}})}),d=c.map(x=>({vals:e.data.get(x.dataId).values,shape:x.shape}));o=fa(c.map(x=>x.shape),1);const f=c[0].shape[0]===1,m=Nz(d,o,t[0].dtype,f),g=fa(l.map(x=>x.shape),a),b=e.makeTensorInfo(g,t[0].dtype,m);return c.forEach(x=>e.disposeIntermediateTensorInfo(x)),b}const Fit={kernelName:qf,backendName:"cpu",kernelFunc:rc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vP(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:d}=s;At([r,a],"conv2d");const f=di(l),m=En(r.shape,a.shape,i,c,o,d,!1,f),g=m.filterHeight,b=m.filterWidth,x=m.dilationHeight,v=m.dilationWidth,w=m.padInfo.left,T=m.padInfo.top,C=m.dataFormat==="channelsLast",k=new cn(m.outShape,r.dtype),$=Ft(r.shape),I=Ft(a.shape),D=$[0],_=C?$[1]:$[2],O=C?$[2]:1,L=C?1:$[1],R=k.strides[0],V=C?k.strides[1]:k.strides[2],Y=C?k.strides[2]:1,Q=C?1:k.strides[1],tt=e.data.get(r.dataId).values,B=e.data.get(a.dataId).values,W=k.values;for(let X=0;X<m.batchSize;++X){const ot=X*D,P=X*R;for(let j=0;j<m.outHeight;++j){const rt=P+j*V,st=j*m.strideHeight-T;for(let mt=0;mt<g;++mt){const gt=st+mt*x;if(gt<0||gt>=m.inHeight)continue;const bt=mt*I[0],$t=ot+gt*_;for(let Ct=0;Ct<m.outWidth;++Ct){const _t=rt+Ct*Y,Wt=Ct*m.strideWidth-w;for(let Gt=0;Gt<b;++Gt){const ue=Wt+Gt*v;if(ue<0||ue>=m.inWidth)continue;const fe=bt+Gt*I[1],Ee=$t+ue*O;let xe=fe;for(let pe=0;pe<m.inChannels;++pe){const oe=tt[Ee+pe*L];for(let Ie=0;Ie<m.outChannels;++Ie)W[_t+Ie*Q]+=oe*B[xe+Ie];xe+=m.outChannels}}}}}}return e.makeTensorInfo(k.shape,k.dtype,W)}const Lit={kernelName:Kf,backendName:"cpu",kernelFunc:vP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mit(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:d}=s;At([r,a],"conv2dBackpropFilter");const f=di(l),m=En(r.shape,d,i,1,o,c,!1,f),{strideHeight:g,strideWidth:b,filterHeight:x,filterWidth:v}=m,w=m.dataFormat==="channelsLast",T=new cn(m.filterShape,"float32"),C=m.padInfo.left,k=m.padInfo.top,$=e.data.get(r.dataId).values,I=e.data.get(a.dataId).values,D=new cn(r.shape,r.dtype,$),_=new cn(a.shape,a.dtype,I);for(let O=0;O<x;++O){const L=Math.max(0,Math.ceil((k-O)/g)),R=Math.min(m.outHeight,(m.inHeight+k-O)/g);for(let V=0;V<v;++V){const Y=Math.max(0,Math.ceil((C-V)/b)),Q=Math.min(m.outWidth,(m.inWidth+C-V)/b);for(let tt=0;tt<m.inChannels;++tt)for(let B=0;B<m.outChannels;++B){let W=0;for(let X=0;X<m.batchSize;++X)for(let ot=L;ot<R;++ot){const P=O+ot*g-k;for(let j=Y;j<Q;++j){const rt=V+j*b-C;w?W+=D.get(X,P,rt,tt)*_.get(X,ot,j,B):W+=D.get(X,tt,P,rt)*_.get(X,B,ot,j)}}T.set(W,O,V,tt,B)}}}return e.makeTensorInfo(T.shape,T.dtype,T.values)}const zit={kernelName:$0,backendName:"cpu",kernelFunc:Mit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pit(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:d}=s;At([r,a],"conv2dBackpropInput");const f=Ft(a.shape),m=Ft(r.shape);let g=di(c);const b=En(i,a.shape,o,1,l,d,!1,g),x=new cn(b.inShape,"float32"),v=x.values,w=e.data.get(r.dataId).values,T=e.data.get(a.dataId).values,[C,k,$]=f,{batchSize:I,filterHeight:D,filterWidth:_,inChannels:O,inHeight:L,inWidth:R,outChannels:V,outHeight:Y,outWidth:Q,strideHeight:tt,strideWidth:B}=b;g=b.dataFormat;const W=D-1-b.padInfo.top,X=_-1-b.padInfo.left,ot=g==="channelsLast",P=x.strides[0],j=ot?x.strides[1]:x.strides[2],rt=ot?x.strides[2]:1,st=ot?1:x.strides[1],mt=m[0],gt=ot?m[1]:m[2],bt=ot?m[2]:1,$t=ot?1:m[1];for(let Ct=0;Ct<I;++Ct)for(let _t=0;_t<O;++_t)for(let Wt=0;Wt<L;++Wt){const Gt=Wt-W,ue=Math.max(0,Math.ceil(Gt/tt)),fe=Math.min(Y,(D+Gt)/tt);for(let Ee=0;Ee<R;++Ee){const xe=Ee-X,pe=Math.max(0,Math.ceil(xe/B)),oe=Math.min(Q,(_+xe)/B);let Ie=0;for(let sn=ue;sn<fe;++sn){const Vs=sn*tt-Gt;for(let hs=pe;hs<oe;++hs){const Zr=hs*B-xe,Us=mt*Ct+gt*sn+bt*hs,Ir=C*(D-1-Vs)+k*(_-1-Zr)+$*_t;for(let Ns=0;Ns<V;++Ns){const Ke=w[Us+$t*Ns],Wn=T[Ir+Ns];Ie+=Ke*Wn}}}const ar=P*Ct+j*Wt+rt*Ee+st*_t;v[ar]=Ie}}return e.makeTensorInfo(x.shape,x.dtype,x.values)}const Bit={kernelName:Xf,backendName:"cpu",kernelFunc:Pit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vit(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:o,dilations:l}=s;At([r,a],"conv3d");const c=mo(r.shape,a.shape,i,l,o),{filterDepth:d,filterHeight:f,filterWidth:m,dilationDepth:g,dilationHeight:b,dilationWidth:x,padInfo:v}=c,w=v.front,T=v.left,C=v.top,k=new cn(c.outShape,r.dtype),$=e.data.get(r.dataId).values,I=e.data.get(a.dataId).values,D=k.values,_=Ft(r.shape),O=Ft(a.shape);for(let L=0;L<c.batchSize;++L){const R=L*_[0],V=L*k.strides[0];for(let Y=0;Y<c.outDepth;++Y){const Q=V+Y*k.strides[1],tt=Y*c.strideDepth-w;for(let B=0;B<d;++B){const W=tt+B*g;if(W<0||W>=c.inDepth)continue;const X=B*O[0],ot=R+W*_[1];for(let P=0;P<c.outHeight;++P){const j=Q+P*k.strides[2],rt=P*c.strideHeight-C;for(let st=0;st<f;++st){const mt=rt+st*b;if(mt<0||mt>=c.inHeight)continue;const gt=X+st*O[1],bt=ot+mt*_[2];for(let $t=0;$t<c.outWidth;++$t){const Ct=j+$t*c.outChannels,_t=$t*c.strideWidth-T;for(let Wt=0;Wt<m;++Wt){const Gt=_t+Wt*x;if(Gt<0||Gt>=c.inWidth)continue;const ue=gt+Wt*O[2],fe=bt+Gt*c.inChannels;let Ee=ue;for(let xe=0;xe<c.inChannels;++xe){const pe=$[fe+xe];for(let oe=0;oe<c.outChannels;++oe)D[Ct+oe]+=pe*I[Ee+oe];Ee+=c.outChannels}}}}}}}}return e.makeTensorInfo(k.shape,k.dtype,k.values)}const Uit={kernelName:Yf,backendName:"cpu",kernelFunc:Vit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wit(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,pad:o,filterShape:l}=s;At([r,a],"conv3dBackpropFilterV2");const c=Ft(r.shape),d=Ft(a.shape),f=mo(r.shape,l,i,1,o),m=f.strideDepth,g=f.strideHeight,b=f.strideWidth,x=f.filterDepth,v=f.filterHeight,w=f.filterWidth,T=new cn(f.filterShape,"float32"),C=T.values,[k,$,I,D]=T.strides,_=e.data.get(a.dataId).values,[O,L,R,V]=d,Y=e.data.get(r.dataId).values,[Q,tt,B,W]=c,X=f.padInfo.front,ot=f.padInfo.left,P=f.padInfo.top;for(let j=0;j<x;++j){const rt=Math.max(0,Math.ceil((X-j)/m)),st=Math.min(f.outDepth,(f.inDepth+X-j)/m),mt=j*k;for(let gt=0;gt<v;++gt){const bt=Math.max(0,Math.ceil((P-gt)/g)),$t=Math.min(f.outHeight,(f.inHeight+P-gt)/g),Ct=gt*$+mt;for(let _t=0;_t<w;++_t){const Wt=Math.max(0,Math.ceil((ot-_t)/b)),Gt=Math.min(f.outWidth,(f.inWidth+ot-_t)/b),ue=_t*I+Ct;for(let fe=0;fe<f.inChannels;++fe){const Ee=fe*D+ue;for(let xe=0;xe<f.outChannels;++xe){let pe=0;for(let oe=0;oe<f.batchSize;++oe){const Ie=oe*Q,ar=oe*O;for(let sn=rt;sn<st;++sn){const hs=(j+sn*m-X)*tt+Ie,Zr=sn*L+ar;for(let Us=bt;Us<$t;++Us){const Ns=(gt+Us*g-P)*B+hs,Ke=Us*R+Zr;for(let Wn=Wt;Wn<Gt;++Wn){const Nh=(_t+Wn*b-ot)*W+Ns,Ch=Wn*V+Ke;pe+=Y[Nh+fe]*_[Ch+xe]}}}}C[Ee+xe]=pe}}}}}return e.makeTensorInfo(T.shape,T.dtype,T.values)}const Git={kernelName:E0,backendName:"cpu",kernelFunc:Wit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jit(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{pad:i,strides:o,inputShape:l}=s;At([r],"conv3dBackpropInputV2");const c=Ft(r.shape),d=Ft(a.shape),f=mo(l,a.shape,o,1,i),m=new cn(f.inShape,"float32"),g=m.values,[b,x,v,w]=m.strides,T=e.data.get(r.dataId).values,[C,k,$,I]=c,D=e.data.get(a.dataId).values,[_,O,L,R]=d,{batchSize:V,filterDepth:Y,filterHeight:Q,filterWidth:tt,inChannels:B,inDepth:W,inHeight:X,inWidth:ot,outChannels:P,outDepth:j,outHeight:rt,outWidth:st,strideDepth:mt,strideHeight:gt,strideWidth:bt}=f,$t=Y-1-f.padInfo.front,Ct=Q-1-f.padInfo.top,_t=tt-1-f.padInfo.left;for(let Wt=0;Wt<V;++Wt)for(let Gt=0;Gt<B;++Gt)for(let ue=0;ue<W;++ue){const fe=ue-$t,Ee=Math.max(0,Math.ceil(fe/mt)),xe=Math.min(j,(Y+fe)/mt);for(let pe=0;pe<X;++pe){const oe=pe-Ct,Ie=Math.max(0,Math.ceil(oe/gt)),ar=Math.min(rt,(Q+oe)/gt);for(let sn=0;sn<ot;++sn){const Vs=sn-_t,hs=Math.max(0,Math.ceil(Vs/bt)),Zr=Math.min(st,(tt+Vs)/bt);let Us=0;for(let Ir=Ee;Ir<xe;++Ir){const Ns=Ir*mt-fe;for(let Ke=Ie;Ke<ar;++Ke){const Wn=Ke*gt-oe;for(let vn=hs;vn<Zr;++vn){const Nh=vn*bt-Vs,Ch=C*Wt+k*Ir+$*Ke+I*vn,Dx=_*(Y-1-Ns)+O*(Q-1-Wn)+L*(tt-1-Nh)+R*Gt;for(let ka=0;ka<P;++ka){const Vl=T[Ch+ka],$a=D[Dx+ka];Us+=Vl*$a}}}}g[b*Wt+x*ue+v*pe+w*sn+Gt]=Us}}}return e.makeTensorInfo(m.shape,m.dtype,m.values)}const Hit={kernelName:I0,backendName:"cpu",kernelFunc:jit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qit=be(Tc,n=>Math.cos(n)),Kit={kernelName:Tc,backendName:"cpu",kernelFunc:qit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xit=be(Nc,n=>Math.cosh(n)),Yit={kernelName:Nc,backendName:"cpu",kernelFunc:Xit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zit(n){const{inputs:t,backend:e,attrs:s}=n,{image:r,boxes:a,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:c}=s,[d,f,m,g]=r.shape,b=a.shape[0],[x,v]=o,w=Ht([b,x,v,g],"float32"),T=e.data.get(a.dataId).values,C=e.data.get(i.dataId).values,k=e.data.get(r.dataId).values,$=Ft(r.shape),I=Ft(w.shape);for(let D=0;D<b;D++){const _=D*4,O=T[_],L=T[_+1],R=T[_+2],V=T[_+3],Y=C[D];if(Y>=d)continue;const Q=x>1?(R-O)*(f-1)/(x-1):0,tt=v>1?(V-L)*(m-1)/(v-1):0;for(let B=0;B<x;B++){const W=x>1?O*(f-1)+B*Q:.5*(O+R)*(f-1);if(W<0||W>f-1){for(let X=0;X<v;X++)for(let ot=0;ot<g;ot++){const P=ot+X*I[2]+B*I[1]+D*I[0];w.values[P]=c}continue}if(l==="bilinear"){const X=Math.floor(W),ot=Math.ceil(W),P=W-X;for(let j=0;j<v;j++){const rt=v>1?L*(m-1)+j*tt:.5*(L+V)*(m-1);if(rt<0||rt>m-1){for(let bt=0;bt<g;bt++){const $t=bt+j*I[2]+B*I[1]+D*I[0];w.values[$t]=c}continue}const st=Math.floor(rt),mt=Math.ceil(rt),gt=rt-st;for(let bt=0;bt<g;bt++){let $t=bt+st*$[2]+X*$[1]+Y*$[0];const Ct=k[$t];$t=bt+mt*$[2]+X*$[1]+Y*$[0];const _t=k[$t];$t=bt+st*$[2]+ot*$[1]+Y*$[0];const Wt=k[$t];$t=bt+mt*$[2]+ot*$[1]+Y*$[0];const Gt=k[$t],ue=Ct+(_t-Ct)*gt,fe=Wt+(Gt-Wt)*gt;$t=bt+j*I[2]+B*I[1]+D*I[0],w.values[$t]=ue+(fe-ue)*P}}}else for(let X=0;X<v;++X){const ot=v>1?L*(m-1)+X*tt:.5*(L+V)*(m-1);if(ot<0||ot>m-1){for(let rt=0;rt<g;rt++){const st=rt+X*I[2]+B*I[1]+D*I[0];w.values[st]=c}continue}const P=Math.round(ot),j=Math.round(W);for(let rt=0;rt<g;rt++){const st=rt+P*$[2]+j*$[1]+Y*$[0],mt=rt+X*I[2]+B*I[1]+D*I[0];w.values[mt]=k[st]}}}}return e.makeTensorInfo(w.shape,w.dtype,w.values)}const Qit={kernelName:R0,backendName:"cpu",kernelFunc:Zit};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jit(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,exclusive:i,reverse:o}=s;At(r,"cumprod");const l=We([a],r.shape.length);let c=r;l!=null&&(c=Ss({inputs:{x:r},backend:e,attrs:{perm:l}}));const d=tn(1,r.shape.length)[0];if(d!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${d}`);const f=ys(c.dtype,"int32"),m=x0(ft(c.shape),f),g=e.data.get(c.dataId).values,b=c.shape[c.shape.length-1],x=o?(w,T)=>w+b-T-1:(w,T)=>w+T;for(let w=0;w<g.length;w+=b)for(let T=0;T<b;T++){const C=x(w,T);if(T===0)m[C]=i?1:g[C];else{const k=x(w,T-1);m[C]=i?g[k]*m[k]:g[C]*m[k]}}const v=e.makeTensorInfo(c.shape,f,m);if(l!=null){const w=go(l),T=Ss({inputs:{x:v},backend:e,attrs:{perm:w}});return e.disposeIntermediateTensorInfo(v),e.disposeIntermediateTensorInfo(c),T}return v}const tot={kernelName:A0,backendName:"cpu",kernelFunc:Jit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eot(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,exclusive:i,reverse:o}=s;At(r,"cumsum");const l=We([a],r.shape.length);let c=r;l!=null&&(c=Ss({inputs:{x:r},backend:e,attrs:{perm:l}}));const d=tn(1,r.shape.length)[0];if(d!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${d}`);const f=ys(c.dtype,"int32"),m=Mn(ft(c.shape),f),g=e.data.get(c.dataId).values,b=c.shape[c.shape.length-1],x=o?(w,T)=>w+b-T-1:(w,T)=>w+T;for(let w=0;w<g.length;w+=b)for(let T=0;T<b;T++){const C=x(w,T);if(T===0)m[C]=i?0:g[C];else{const k=x(w,T-1);m[C]=i?g[k]+m[k]:g[C]+m[k]}}const v=e.makeTensorInfo(c.shape,f,m);if(l!=null){const w=go(l),T=Ss({inputs:{x:v},backend:e,attrs:{perm:w}});return e.disposeIntermediateTensorInfo(v),e.disposeIntermediateTensorInfo(c),T}return v}const not={kernelName:Zf,backendName:"cpu",kernelFunc:eot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sot(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,weights:a}=t,{size:i,binaryOutput:o}=s;if(r.shape.length===1){const l=e.data.get(r.dataId).values,c=e.data.get(a.dataId).values,d=yC(l,c,a.dtype,a.shape,i);return e.makeTensorInfo([i],a.dtype,d)}else if(r.shape.length===2){const l=e.bufferSync(r),c=e.bufferSync(a),d=wz(l,c,i,o);return e.makeTensorInfo(d.shape,a.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const rot={kernelName:D0,backendName:"cpu",kernelFunc:sot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aot(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockSize:a,dataFormat:i}=s;F(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const o=r.shape[0],l=r.shape[1],c=r.shape[2],d=r.shape[3],f=l*a,m=c*a,g=d/(a*a),b=e.data.get(r.dataId).values,x=new Float32Array(o*f*m*g);let v=0;for(let w=0;w<o;++w)for(let T=0;T<f;++T){const C=Math.floor(T/a),k=T%a;for(let $=0;$<m;++$){const I=Math.floor($/a),D=$%a,_=(k*a+D)*g;for(let O=0;O<g;++O){const R=O+_+d*(I+c*(C+l*w));x[v++]=b[R]}}}return e.makeTensorInfo([o,f,m,g],r.dtype,x)}const iot={kernelName:O0,backendName:"cpu",kernelFunc:aot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wP(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=s;At([r,a],"depthwiseConv2DNative");const d=Ft(r.shape),f=Ft(a.shape);let m=l;m==null&&(m=[1,1]),F(Pn(i,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${m}'`);const g=En(r.shape,a.shape,i,m,o,c,!0),{filterHeight:b,filterWidth:x,dilationHeight:v,dilationWidth:w,padInfo:T}=g,C=T.left,k=T.top,$=g.outChannels/g.inChannels,I=new cn(g.outShape,r.dtype),D=e.data.get(r.dataId).values,_=e.data.get(a.dataId).values,O=I.values;for(let L=0;L<g.batchSize;++L){const R=L*d[0],V=L*I.strides[0];for(let Y=0;Y<g.outHeight;++Y){const Q=V+Y*I.strides[1],tt=Y*g.strideHeight-k;for(let B=0;B<b;++B){const W=tt+B*v;if(W<0||W>=g.inHeight)continue;const X=B*f[0],ot=R+W*d[1];for(let P=0;P<g.outWidth;++P){const j=Q+P*I.strides[2],rt=P*g.strideWidth-C;for(let st=0;st<x;++st){const mt=rt+st*w;if(mt<0||mt>=g.inWidth)continue;const gt=X+st*f[1],bt=ot+mt*g.inChannels;let $t=j,Ct=gt;for(let _t=0;_t<g.inChannels;++_t){const Wt=D[bt+_t];for(let Gt=0;Gt<$;++Gt)O[$t+Gt]+=Wt*_[Ct+Gt];$t+=$,Ct+=$}}}}}}return e.makeTensorInfo(I.shape,I.dtype,I.values)}const oot={kernelName:Qf,backendName:"cpu",kernelFunc:wP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lot(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:d}=s;At([r,a],"depthwiseConv2dNativeBackpropFilter");const f=En(r.shape,d,i,o,l,c,!0),{strideHeight:m,strideWidth:g,filterHeight:b,filterWidth:x}=f,v=new cn(f.filterShape,"float32"),w=f.padInfo.left,T=f.padInfo.top,C=f.outChannels/f.inChannels,k=e.data.get(r.dataId).values,$=new cn(r.shape,r.dtype,k),I=e.data.get(a.dataId).values,D=new cn(a.shape,a.dtype,I);for(let _=0;_<b;++_){const O=Math.max(0,Math.ceil((T-_)/m)),L=Math.min(f.outHeight,(f.inHeight+T-_)/m);for(let R=0;R<x;++R){const V=Math.max(0,Math.ceil((w-R)/g)),Y=Math.min(f.outWidth,(f.inWidth+w-R)/g);for(let Q=0;Q<f.outChannels;++Q){const tt=Math.trunc(Q/C),B=Q%C;let W=0;for(let X=0;X<f.batchSize;++X)for(let ot=O;ot<L;++ot){const P=_+ot*m-T;for(let j=V;j<Y;++j){const rt=R+j*g-w;W+=$.get(X,P,rt,tt)*D.get(X,ot,j,Q)}}v.set(W,_,R,tt,B)}}}return e.makeTensorInfo(v.shape,v.dtype,v.values)}const uot={kernelName:_0,backendName:"cpu",kernelFunc:lot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cot(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:d}=s;At([r,a],"depthwiseConv2DNativeBackpropInput");const f=Ft(r.shape),m=Ft(a.shape),g=En(d,a.shape,i,o,l,c,!0),b=new cn(g.inShape,"float32"),x=b.values,[v,w,T]=b.strides,C=e.data.get(r.dataId).values,[k,$,I]=f,D=e.data.get(a.dataId).values,[_,O,L]=m,{batchSize:R,filterHeight:V,filterWidth:Y,inChannels:Q,inHeight:tt,inWidth:B,outChannels:W,outHeight:X,outWidth:ot,strideHeight:P,strideWidth:j}=g,rt=V-1-g.padInfo.top,st=Y-1-g.padInfo.left,mt=W/Q;for(let gt=0;gt<R;++gt)for(let bt=0;bt<Q;++bt)for(let $t=0;$t<tt;++$t){const Ct=$t-rt,_t=Math.max(0,Math.ceil(Ct/P)),Wt=Math.min(X,(V+Ct)/P);for(let Gt=0;Gt<B;++Gt){const ue=Gt-st,fe=Math.max(0,Math.ceil(ue/j)),Ee=Math.min(ot,(Y+ue)/j);let xe=0;for(let pe=_t;pe<Wt;++pe){const oe=pe*P-Ct;for(let Ie=fe;Ie<Ee;++Ie){const ar=Ie*j-ue,sn=k*gt+$*pe+I*Ie,Vs=_*(V-1-oe)+O*(Y-1-ar)+L*bt;for(let hs=0;hs<mt;++hs){const Zr=bt*mt+hs,Us=C[sn+Zr],Ir=D[Vs+hs];xe+=Us*Ir}}}x[v*gt+w*$t+T*Gt+bt]=xe}}return e.makeTensorInfo(b.shape,b.dtype,b.values)}const hot={kernelName:F0,backendName:"cpu",kernelFunc:cot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dot(n){const{inputs:t,backend:e}=n,{x:s}=t,r=ft(s.shape),a=e.data.get(s.dataId).values,i=Ht([r,r],s.dtype),o=i.values;for(let c=0;c<a.length;c++)o[c*r+c]=a[c];const l=[...s.shape,...s.shape];return e.makeTensorInfo(l,i.dtype,i.values)}const fot={kernelName:L0,backendName:"cpu",kernelFunc:dot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pot={kernelName:Jf,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:s,filter:r}=n,{strides:a,pad:i,dilations:o}=e,l=t,c=l.data.get(s.dataId).values,d=s.shape.length,f=l.data.get(r.dataId).values,m=r.shape.length,{batchSize:g,inHeight:b,inWidth:x,inChannels:v,outHeight:w,outWidth:T,padInfo:C,strideHeight:k,strideWidth:$,filterHeight:I,filterWidth:D,dilationHeight:_,dilationWidth:O,outShape:L}=Up(s.shape,r.shape,a,i,"NHWC",o),R=ft(L),V=L.length,Y=He(s.dtype,R);for(let tt=0;tt<g;++tt)for(let B=0;B<w;++B){const W=B*k-C.top;for(let X=0;X<T;++X){const ot=X*$-C.left;for(let P=0;P<v;++P){let j=Number.MIN_SAFE_INTEGER;for(let st=0;st<I;++st){const mt=W+st*_;if(mt>=0&&mt<b)for(let gt=0;gt<D;++gt){const bt=ot+gt*O;if(bt>=0&&bt<x){const $t=Br([tt,mt,bt,P],d,Ft(s.shape)),Ct=Br([st,gt,P],m,Ft(r.shape)),_t=c[$t]+f[Ct];_t>j&&(j=_t)}}}const rt=Br([tt,B,X,P],V,Ft(L));Y[rt]=j}}}return{dataId:l.write(fo(Y,s.dtype),L,s.dtype),shape:L,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mot={kernelName:_y,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:s,filter:r,dy:a}=n,{strides:i,pad:o,dilations:l}=e,c=t,d=tr(s.shape,c.data.get(s.dataId).values),f=tr(r.shape,c.data.get(r.dataId).values),{batchSize:m,inHeight:g,inWidth:b,inChannels:x,outHeight:v,outWidth:w,padInfo:T,strideHeight:C,strideWidth:k,filterHeight:$,filterWidth:I,dilationHeight:D,dilationWidth:_,outShape:O}=Up(s.shape,r.shape,i,o,"NHWC",l);F(a.rank===O.length,()=>`Error in ${_y}, dy must have the same rank as output ${O.length}, but got ${a.rank}`);const L=tr(O,c.data.get(a.dataId).values),R=q2(r.shape,r.dtype);for(let Y=0;Y<m;++Y)for(let Q=0;Q<v;++Q){const tt=Q*C-T.top;for(let B=0;B<w;++B){const W=B*k-T.left;for(let X=0;X<x;++X){let ot=Number.MIN_SAFE_INTEGER,P=0,j=0;for(let rt=0;rt<$;++rt){const st=tt+rt*D;if(st>=0&&st<g)for(let mt=0;mt<I;++mt){const gt=W+mt*_;if(gt>=0&&gt<b){const bt=d[Y][st][gt][X]+f[rt][mt][X];bt>ot&&(ot=bt,P=rt,j=mt)}}}R[P][j][X]+=L[Y][Q][B][X]}}}return{dataId:c.write(fo(R,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const got={kernelName:Oy,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:s,filter:r,dy:a}=n,{strides:i,pad:o,dilations:l}=e,c=t,d=tr(s.shape,c.data.get(s.dataId).values),f=tr(r.shape,c.data.get(r.dataId).values),{batchSize:m,inHeight:g,inWidth:b,inChannels:x,outHeight:v,outWidth:w,padInfo:T,strideHeight:C,strideWidth:k,filterHeight:$,filterWidth:I,dilationHeight:D,dilationWidth:_,outShape:O}=Up(s.shape,r.shape,i,o,"NHWC",l);F(a.rank===O.length,()=>`Error in ${Oy}, dy must have the same rank as output ${O.length}, but got ${a.rank}`);const L=tr(O,c.data.get(a.dataId).values),R=q2(s.shape,s.dtype);for(let Y=0;Y<m;++Y)for(let Q=0;Q<v;++Q){const tt=Q*C-T.top;for(let B=0;B<w;++B){const W=B*k-T.left;for(let X=0;X<x;++X){let ot=Number.MIN_SAFE_INTEGER,P=tt<0?0:tt,j=W<0?0:W;for(let rt=0;rt<$;++rt){const st=tt+rt*D;if(st>=0&&st<g)for(let mt=0;mt<I;++mt){const gt=W+mt*_;if(gt>=0&&gt<b){const bt=d[Y][st][gt][X]+f[rt][mt][X];bt>ot&&(ot=bt,P=st,j=gt)}}}R[Y][P][j][X]+=L[Y][Q][B][X]}}}return{dataId:c.write(fo(R,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yot(n){const{inputs:t,backend:e,attrs:s}=n,{image:r}=t,{canvas:a,options:i}=s,{contextOptions:o,imageOptions:l}=i||{},c=(l==null?void 0:l.alpha)||1,d=(o==null?void 0:o.contextType)||"2d";if(d!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const f=a.getContext(d,(o==null?void 0:o.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${d} type.`);const[m,g]=r.shape.slice(0,2),b=r.shape.length===2?1:r.shape[2],x=e.data.get(r.dataId).values,v=r.dtype==="float32"?255:1,w=new Uint8ClampedArray(g*m*4);for(let C=0;C<m*g;++C){const k=[0,0,0,255*c];for(let I=0;I<b;I++){const D=x[C*b+I];if(r.dtype==="float32"){if(D<0||D>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${D}.`)}else if(r.dtype==="int32"&&(D<0||D>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${D}.`);b===1?(k[0]=D*v,k[1]=D*v,k[2]=D*v):k[I]=D*v}const $=C*4;w[$+0]=Math.round(k[0]),w[$+1]=Math.round(k[1]),w[$+2]=Math.round(k[2]),w[$+3]=Math.round(k[3])}a.width=g,a.height=m;const T=new ImageData(w,g,m);return f.putImageData(T,0,0),r}const bot={kernelName:M0,backendName:"cpu",kernelFunc:yot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ym(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;At(r,"sum");let o;r.dtype==="bool"?o=co({inputs:{x:r},backend:e,attrs:{dtype:"int32"}}):o=Sa({inputs:{x:r},backend:e});const l=o.shape.length,c=Zt(a,o.shape),d=We(c,l);let f=c,m=o;d!=null&&(m=Ss({inputs:{x:o},backend:e,attrs:{perm:d}}),f=tn(f.length,l)),Bn("sum",f,m.shape.length);const[g,b]=In(m.shape,f),x=ys(m.dtype,"int32");let v=Zy(e,g,x);const w=ft(b),T=e.data.get(v.dataId).values,C=e.data.get(m.dataId).values;for(let k=0;k<T.length;++k){const $=k*w;let I=0;for(let D=0;D<w;++D)I+=C[$+D];T[k]=I}if(i){const k=Je(v.shape,c),$=v;v=Oe({inputs:{x:v},backend:e,attrs:{shape:k}}),e.disposeIntermediateTensorInfo($)}return e.disposeIntermediateTensorInfo(o),d!=null&&e.disposeIntermediateTensorInfo(m),v}const xot={kernelName:Dp,backendName:"cpu",kernelFunc:ym};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vot(n){const{inputs:t,backend:e,attrs:s}=n,{equation:r}=s,a=t,{allDims:i,summedDims:o,idDims:l}=zN(r,a.length);BN(i.length,l,a);const{path:c,steps:d}=VN(o,l),f=d.length;let m=null,g=i.length;const b=[];for(let x=0;x<f;++x){for(const v of d[x]){const{permutationIndices:w,expandDims:T}=PN(g,l[v]);let C;UN(w)?C=a[v]:(C=Ss({inputs:{x:a[v]},backend:e,attrs:{perm:w}}),b.push(C));const k=C.shape.slice();for(let $=0;$<T.length;++$)k.splice(T[$],0,1);te(C.shape,k)||(C=Oe({inputs:{x:C},backend:e,attrs:{shape:k}}),b.push(C)),m===null?m=C:(m=kx({inputs:{a:C,b:m},backend:e}),b.push(m))}x<f-1&&(c[x]>=0&&(m=ym({inputs:{x:m},backend:e,attrs:{axis:c[x]-(i.length-g),keepDims:!1}}),b.push(m)),g--)}for(const x of b)x!==m&&e.disposeIntermediateTensorInfo(x);return m}const wot={kernelName:z0,backendName:"cpu",kernelFunc:vot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sot(n){const{inputs:t,backend:e}=n,{dy:s,y:r}=t;At([s,r],"eluGrad");const a=new Float32Array(ft(r.shape)),i=e.data.get(r.dataId).values,o=e.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const c=i[l];c>=0?a[l]=o[l]:a[l]=o[l]*(c+1)}return e.makeTensorInfo(r.shape,"float32",a)}const Tot={kernelName:P0,backendName:"cpu",kernelFunc:Sot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Not=RN,Cot=DN,kot=ON,$ot=_N,Eot=FN,Iot=LN,Aot=be($c,n=>{const t=Math.sign(n),e=Math.abs(n),s=1/(1+Not*e);return t*(1-((((Iot*s+Eot)*s+$ot)*s+kot)*s+Cot)*s*Math.exp(-e*e))}),Rot={kernelName:$c,backendName:"cpu",kernelFunc:Aot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t0(n){const{inputs:t,backend:e,attrs:s}=n,{input:r}=t,{dim:a}=s,i=r.shape.length,o=r.shape.slice();let l=a;return a<0&&(F(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+a+1),o.splice(l,0,1),Oe({inputs:{x:r},backend:e,attrs:{shape:o}})}const Dot={kernelName:ep,backendName:"cpu",kernelFunc:t0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oot=nn((n,t)=>n/t),TC=xn(Cc,Oot),GS={kernelName:Cc,backendName:"cpu",kernelFunc:TC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SP(n,t,e){const s=n.shape,r=s[0],a=s[1],i=e.data.get(n.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[r,a],d=ft(c),f=kn("float32",d),m=kn("float32",d);for(let v=0;v<r;v++){const w=Nl({inputs:{x:o},backend:e,attrs:{begin:[v,0],size:[1,a]}}),T=Nl({inputs:{x:l},backend:e,attrs:{begin:[v,0],size:[1,a]}}),C=Os({inputs:{real:w,imag:T},backend:e}),{real:k,imag:$}=_ot(C,t,e),I=ai(k,$);for(let D=0;D<a;D++){const _=MN(I,D);f[v*a+D]=_.real,m[v*a+D]=_.imag}e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(C)}const g=e.makeTensorInfo(c,"float32",f),b=e.makeTensorInfo(c,"float32",m),x=Os({inputs:{real:g,imag:b},backend:e});return e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(b),x}function _ot(n,t,e){const s=ft(n.shape),r=e.data.get(n.dataId),a=e.data.get(r.complexTensorInfos.real.dataId).values,i=e.data.get(r.complexTensorInfos.imag.dataId).values;if(Fot(s)){const o=jS(a,i,s,t,e),l=[n.shape[0],n.shape[1]];if(t){const c=e.makeTensorInfo(l,"float32",o.real),d=e.makeTensorInfo(l,"float32",o.imag),f=e.makeTensorInfo([],"float32",ci(s,"float32")),m=Sa({inputs:{x:f},backend:e}),g=GS.kernelFunc({inputs:{a:c,b:f},backend:e}),b=GS.kernelFunc({inputs:{a:d,b:m},backend:e}),x=e.data.get(g.dataId).values,v=e.data.get(b.dataId).values;return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(b),{real:x,imag:v}}return o}else{const o=ai(a,i),l=Lot(o,s,t);return RL(l)}}function Fot(n){return(n&n-1)===0}function jS(n,t,e,s,r){if(e===1)return{real:n,imag:t};const a=ai(n,t),i=e/2,o=DL(a),l=o.real,c=o.imag,d=[l.length],f=r.makeTensorInfo(d,"float32",l),m=r.makeTensorInfo(d,"float32",c),g=Os({inputs:{real:f,imag:m},backend:r}),b=OL(a),x=b.real,v=b.imag,w=[x.length],T=r.makeTensorInfo(w,"float32",x),C=r.makeTensorInfo(w,"float32",v),k=Os({inputs:{real:T,imag:C},backend:r}),$=jS(l,c,i,s,r),I=$.real,D=$.imag,_=[I.length],O=r.makeTensorInfo(_,"float32",I),L=r.makeTensorInfo(_,"float32",D),R=Os({inputs:{real:O,imag:L},backend:r}),V=jS(x,v,i,s,r),Y=V.real,Q=V.imag,tt=[Y.length],B=r.makeTensorInfo(tt,"float32",Y),W=r.makeTensorInfo(tt,"float32",Q),X=Os({inputs:{real:B,imag:W},backend:r}),ot=FL(e,s),P=[ot.real.length],j=r.makeTensorInfo(P,"float32",ot.real),rt=r.makeTensorInfo(P,"float32",ot.imag),st=Os({inputs:{real:j,imag:rt},backend:r}),mt=kx({inputs:{a:st,b:X},backend:r}),gt=nc({inputs:{a:R,b:mt},backend:r}),bt=wC({inputs:{a:R,b:mt},backend:r}),$t=Tl({inputs:{input:gt},backend:r}),Ct=Tl({inputs:{input:bt},backend:r}),_t=sc({inputs:{input:gt},backend:r}),Wt=sc({inputs:{input:bt},backend:r}),Gt=rc({inputs:[$t,Ct],backend:r,attrs:{axis:0}}),ue=rc({inputs:[_t,Wt],backend:r,attrs:{axis:0}}),fe=r.data.get(Gt.dataId).values,Ee=r.data.get(ue.dataId).values;return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo(k),r.disposeIntermediateTensorInfo(O),r.disposeIntermediateTensorInfo(L),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(B),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(X),r.disposeIntermediateTensorInfo(j),r.disposeIntermediateTensorInfo(rt),r.disposeIntermediateTensorInfo(st),r.disposeIntermediateTensorInfo(mt),r.disposeIntermediateTensorInfo(gt),r.disposeIntermediateTensorInfo(bt),r.disposeIntermediateTensorInfo($t),r.disposeIntermediateTensorInfo(_t),r.disposeIntermediateTensorInfo(Ct),r.disposeIntermediateTensorInfo(Wt),r.disposeIntermediateTensorInfo(Gt),r.disposeIntermediateTensorInfo(ue),{real:fe,imag:Ee}}function Lot(n,t,e){const s=new Float32Array(t*2);for(let r=0;r<t;r++){let a=0,i=0;for(let o=0;o<t;o++){const l=LL(r*o,t,e),c=MN(n,o);a+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}e&&(a/=t,i/=t),_L(s,a,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mot(n){const{inputs:t,backend:e}=n,{input:s}=t,r=ft(s.shape),a=s.shape[s.shape.length-1],i=r/a,o=Oe({inputs:{x:s},backend:e,attrs:{shape:[i,a]}}),l=SP(o,!1,e),c=Oe({inputs:{x:l},backend:e,attrs:{shape:s.shape}});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(l),c}const zot={kernelName:B0,backendName:"cpu",kernelFunc:Mot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NC(n){const{backend:t,attrs:e}=n,{shape:s,value:r,dtype:a}=e,i=a||El(r),o=He(i,ft(s));return Bot(o,r,i),t.makeTensorInfo(s,i,o)}const Pot={kernelName:V0,backendName:"cpu",kernelFunc:NC};function Bot(n,t,e){n.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vot={kernelName:U0,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:s}=n,r=e,a=kn(s.dtype,ft(s.shape)),[i,o,l,c]=s.shape,d=r.data.get(s.dataId).values;for(let m=0;m<i;m++){const g=m*l*o*c;for(let b=0;b<o;b++){const x=b*(l*c);for(let v=0;v<l;v++){const w=v*c;for(let T=0;T<c;T++){const C=Math.round(l-v-1),k=g+x+w+T;let $=d[k];if(C>=0&&C<l){const I=C*c,D=g+x+I+T;$=d[D]}a[k]=$}}}}return{dataId:r.write(a,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uot(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:d,dilations:f,dimRoundingMode:m,activation:g,leakyreluAlpha:b}=s;let x=vP({inputs:{x:r,filter:a},backend:e,attrs:{strides:l,pad:c,dataFormat:d,dilations:f,dimRoundingMode:m}});if(i){const v=x;if(d==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const w=Oe({inputs:{x:i},backend:e,attrs:{shape:[i.shape[0],1,1]}});x=nc({inputs:{a:x,b:w},backend:e}),e.disposeIntermediateTensorInfo(w)}else x=nc({inputs:{a:x,b:i},backend:e});e.disposeIntermediateTensorInfo(v)}if(g){const v=x;if(d==="NCHW"&&g==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const w=Oe({inputs:{x:o},backend:e,attrs:{shape:[o.shape[0],1,1]}});x=Jy(e,x,g,w,b),e.disposeIntermediateTensorInfo(w)}else x=Jy(e,x,g,o,b);e.disposeIntermediateTensorInfo(v)}return x}const Wot={kernelName:hf,backendName:"cpu",kernelFunc:Uot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Got(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:d,dilations:f,dimRoundingMode:m,activation:g,leakyreluAlpha:b}=s;let x=wP({inputs:{x:r,filter:a},backend:e,attrs:{strides:l,pad:c,dataFormat:d,dilations:f,dimRoundingMode:m}});if(i){const v=x;x=nc({inputs:{a:x,b:i},backend:e}),e.disposeIntermediateTensorInfo(v)}if(g){const v=x;x=Jy(e,x,g,o,b),e.disposeIntermediateTensorInfo(v)}return x}const jot={kernelName:df,backendName:"cpu",kernelFunc:Got};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hot(n){const{inputs:t,backend:e}=n,{params:s,indices:r}=t,a=ft(s.shape),i=r.shape,o=i[i.length-1],[l,c,d,f]=cx(s,r);if(c===0)return e.makeTensorInfo(l,s.dtype,[]);const m=e.data.get(r.dataId).values,g=e.bufferSync(s),b=Dz(m,g,s.dtype,c,o,d,f,s.shape,a);return e.makeTensorInfo(l,s.dtype,b.values)}const qot={kernelName:W0,backendName:"cpu",kernelFunc:Hot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kot(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,indices:a}=t,{axis:i,batchDims:o}=s;At([r,a],"gatherV2");const l=Zt(i,r.shape)[0],c=e.data.get(a.dataId).values,d=r.shape[l];for(let k=0;k<c.length;++k){const $=c[k];F($<=d-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${d-1}]`)}let f=o;o==null&&(f=0);const m=ft(a.shape),g=GN(r,a,l,f),b=Oe({inputs:{x:r},backend:e,attrs:{shape:[g.batchSize,g.outerSize,g.dimSize,g.sliceSize]}}),x=Oe({inputs:{x:a},backend:e,attrs:{shape:[g.batchSize,m/g.batchSize]}}),v=[g.batchSize,g.outerSize,m/g.batchSize,g.sliceSize],w=e.bufferSync(x),T=e.bufferSync(b),C=Oz(T,w,v);return e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(x),e.makeTensorInfo(g.outputShape,C.dtype,C.values)}const Xot={kernelName:sp,backendName:"cpu",kernelFunc:Kot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yot(n){const{inputs:t,backend:e}=n,{input:s}=t,r=ft(s.shape),a=s.shape[s.shape.length-1],i=r/a,o=Oe({inputs:{x:s},backend:e,attrs:{shape:[i,a]}}),l=SP(o,!0,e),c=Oe({inputs:{x:l},backend:e,attrs:{shape:s.shape}});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(l),c}const Zot={kernelName:G0,backendName:"cpu",kernelFunc:Yot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qot=be(_c,n=>Number.isFinite(n)?1:0,"bool"),Jot={kernelName:_c,backendName:"cpu",kernelFunc:Qot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tlt=be(Fc,n=>Math.abs(n)===1/0?1:0,"bool"),elt={kernelName:Fc,backendName:"cpu",kernelFunc:tlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nlt=be(Lc,n=>Number.isNaN(n)?1:0,"bool"),slt={kernelName:Lc,backendName:"cpu",kernelFunc:nlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rlt(n){const{backend:t,attrs:e}=n,{start:s,stop:r,num:a}=e,i=zz(s,r,a);return t.makeTensorInfo([i.length],"float32",i)}const alt={kernelName:H0,backendName:"cpu",kernelFunc:rlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ilt=be(zc,n=>Math.log1p(n)),olt={kernelName:zc,backendName:"cpu",kernelFunc:ilt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const llt=nn((n,t)=>n&&t),ult=xn(lp,llt,null,"bool"),clt={kernelName:lp,backendName:"cpu",kernelFunc:ult};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hlt=be(up,n=>n?0:1,"bool"),dlt={kernelName:up,backendName:"cpu",kernelFunc:hlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const flt=nn((n,t)=>n||t),plt=xn(cp,flt,null,"bool"),mlt={kernelName:cp,backendName:"cpu",kernelFunc:plt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function glt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{depthRadius:a,bias:i,alpha:o,beta:l}=s;At(r,"LRN");const c=r.shape[3],d=c-1,f=e.data.get(r.dataId).values,m=ft(r.shape),g=new Float32Array(m);function b(x){const v=x%c;let w=x-v+Math.max(0,v-a);const T=x-v+Math.min(v+a,d);let C=0;for(;w<=T;w++){const k=f[w];C+=k*k}return C}for(let x=0;x<m;x++){const v=b(x),w=f[x]*Math.pow(i+o*v,-l);g[x]=w}return e.makeTensorInfo(r.shape,r.dtype,g)}const ylt={kernelName:hp,backendName:"cpu",kernelFunc:glt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function blt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,y:a,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:d}=s;At(i,"LRNGrad");const f=ft(i.shape),m=i.shape[3],g=e.data.get(i.dataId).values,b=e.data.get(r.dataId).values,x=e.data.get(a.dataId).values,v=new Float32Array(f),w=f;for(let T=0;T<w;T++){const C=T%m,k=T-C+Math.max(0,C-o),$=T-C+Math.min(m,C+o+1);let I=0;for(let D=k;D<$;D++)I+=Math.pow(b[D],2);I=c*I+l;for(let D=k;D<$;D++){let _=-2*c*d*b[D]*x[T]/I;T===D&&(_+=Math.pow(I,-d)),_*=g[T],v[D]+=_}}return e.makeTensorInfo(i.shape,r.dtype,v)}const xlt={kernelName:q0,backendName:"cpu",kernelFunc:blt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TP(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{reductionIndices:a,keepDims:i}=s,o=e;let l=r.shape;const c=l.length,d=Zt(a,l);let f=d;const m=We(f,c);let g=o.data.get(r.dataId).values;if(m!=null){const k=new Array(c);for(let $=0;$<k.length;$++)k[$]=l[m[$]];g=xC(g,l,r.dtype,m,k),f=tn(f.length,c),l=k}At(r,"max"),Bn("max",f,c);const[b,x]=In(l,f),v=ft(x),w=Bz(g,v,b,r.dtype),T=o.write(w,b,r.dtype);let C=b;return i&&(C=Je(b,d)),{dataId:T,shape:C,dtype:r.dtype}}const vlt={kernelName:dp,backendName:"cpu",kernelFunc:TP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wlt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;At(r,"maxPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;F(Pn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=kr(r.shape,a,i,c,o,l);let f;if(d.filterWidth===1&&d.filterHeight===1&&te(d.inShape,d.outShape))f=Sa({inputs:{x:r},backend:e});else{const m=e.data.get(r.dataId).values,g=Ft(r.shape),b=SC(m,r.shape,r.dtype,g,d,"max");f=e.makeTensorInfo(d.outShape,r.dtype,b.values)}return f}const Slt={kernelName:fp,backendName:"cpu",kernelFunc:wlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tlt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=s;At(r,"maxPool3d");const d=hi(r.shape,a,i,1,o,l,c),f=e.data.get(r.dataId).values,m=xP(f,r.shape,r.dtype,Ft(r.shape),d,"max");return e.makeTensorInfo(m.shape,"float32",m.values)}const Nlt={kernelName:pp,backendName:"cpu",kernelFunc:Tlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Clt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=s;At([r,a],"maxPool3DGrad");const d=hi(a.shape,i,o,1,l,c),f=e.bufferSync(a),m=fit(f,d),g=d.strideDepth,b=d.strideHeight,x=d.strideWidth,v=d.dilationDepth,w=d.dilationHeight,T=d.dilationWidth,C=d.effectiveFilterDepth,k=d.effectiveFilterHeight,$=d.effectiveFilterWidth,I=C-1-d.padInfo.front,D=$-1-d.padInfo.left,_=k-1-d.padInfo.top,O=Ht(a.shape,"float32"),L=e.bufferSync(r);for(let R=0;R<d.batchSize;++R)for(let V=0;V<d.inChannels;++V)for(let Y=0;Y<d.inDepth;++Y)for(let Q=0;Q<d.inHeight;++Q)for(let tt=0;tt<d.inWidth;++tt){const B=Y-I,W=Q-_,X=tt-D;let ot=0;for(let P=0;P<C;P+=v){const j=(B+P)/g;if(!(j<0||j>=d.outDepth||Math.floor(j)!==j))for(let rt=0;rt<k;rt+=w){const st=(W+rt)/b;if(!(st<0||st>=d.outHeight||Math.floor(st)!==st))for(let mt=0;mt<$;mt+=T){const gt=(X+mt)/x;if(gt<0||gt>=d.outWidth||Math.floor(gt)!==gt)continue;const bt=C*k*$-1-m.get(R,j,st,gt,V),$t=P*k*$+rt*$+mt,Ct=bt===$t?1:0;if(Ct===0)continue;const _t=L.get(R,j,st,gt,V);ot+=_t*Ct}}}O.set(ot,R,Y,Q,tt,V)}return e.makeTensorInfo(O.shape,O.dtype,O.values)}const klt={kernelName:X0,backendName:"cpu",kernelFunc:Clt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $lt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a,output:i}=t,o=a;At([a,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:d,dimRoundingMode:f}=s,m=kr(o.shape,l,c,1,d,f),g=e.data.get(o.dataId).values,b=Ht(m.outShape,o.dtype,bP(g,o.shape,o.dtype,m).values),x=m.strideHeight,v=m.strideWidth,w=m.dilationHeight,T=m.dilationWidth,C=m.effectiveFilterHeight,k=m.effectiveFilterWidth,$=k-1-m.padInfo.left,I=C-1-m.padInfo.top,D=Ht(o.shape,"float32"),_=e.data.get(r.dataId).values,O=Ht(r.shape,"float32",_);for(let L=0;L<m.batchSize;++L)for(let R=0;R<m.inChannels;++R)for(let V=0;V<m.inHeight;++V)for(let Y=0;Y<m.inWidth;++Y){const Q=V-I,tt=Y-$;let B=0;for(let W=0;W<C;W+=w){const X=(Q+W)/x;if(!(X<0||X>=m.outHeight||Math.floor(X)!==X))for(let ot=0;ot<k;ot+=T){const P=(tt+ot)/v;if(P<0||P>=m.outWidth||Math.floor(P)!==P)continue;const j=C*k-1-b.get(L,X,P,R),rt=W*k+ot,st=j===rt?1:0;if(st===0)continue;const mt=O.get(L,X,P,R);B+=mt*st}}D.set(B,L,V,Y,R)}return e.makeTensorInfo(D.shape,D.dtype,D.values)}const Elt={kernelName:K0,backendName:"cpu",kernelFunc:$lt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ilt(n,t,e,s,r){const a=Ft(t),i=SC(n,t,e,a,r,"max"),o=bP(n,t,e,r,!0,s);return[i.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Alt={kernelName:Y0,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:s}=n,{filterSize:r,strides:a,pad:i,includeBatchInIndex:o}=t,l=e;At(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,d=kr(s.shape,r,a,[1,1],i),[f,m]=Ilt(c,s.shape,s.dtype,o,d),g=l.write(f,d.outShape,s.dtype),b=l.write(m,d.outShape,s.dtype);return[{dataId:g,shape:d.outShape,dtype:s.dtype},{dataId:b,shape:d.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rlt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,o=Zt(a,r.shape),c=In(r.shape,o)[1],d=ft(c),f=[],m=e.makeTensorInfo([],"float32",new Float32Array([d]));f.push(m);const g=co({inputs:{x:r},backend:e,attrs:{dtype:"float32"}});f.push(g);const b=TC({inputs:{a:g,b:m},backend:e});f.push(b);const x=ym({inputs:{x:b},backend:e,attrs:{axis:a,keepDims:i}});return f.forEach(v=>e.disposeIntermediateTensorInfo(v)),x}const Dlt={kernelName:mp,backendName:"cpu",kernelFunc:Rlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Olt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;At(r,"min");const o=Zt(a,r.shape);let l=o;const c=We(l,r.shape.length);let d=r;c!=null&&(d=Ss({inputs:{x:r},backend:e,attrs:{perm:c}}),l=tn(l.length,r.shape.length)),Bn("min",l,d.shape.length);const[f,m]=In(d.shape,l),g=ft(m),b=Mn(ft(f),d.dtype),x=e.data.get(d.dataId).values;for(let w=0;w<b.length;++w){const T=w*g;let C=x[T];for(let k=0;k<g;++k){const $=x[T+k];(Number.isNaN($)||$<C)&&(C=$)}b[w]=C}c!=null&&e.disposeIntermediateTensorInfo(d);const v=e.makeTensorInfo(f,d.dtype,b);if(i){const w=Je(f,o),T=Oe({inputs:{x:v},backend:e,attrs:{shape:w}});return e.disposeIntermediateTensorInfo(v),T}return v}const _lt={kernelName:gp,backendName:"cpu",kernelFunc:Olt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Flt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{paddings:a,mode:i}=s;At(r,"mirrorPad");const o=a.map((C,k)=>C[0]+r.shape[k]+C[1]),l=a.map(C=>C[0]),c=a.map((C,k)=>C[0]+r.shape[k]),d=i==="reflect"?0:1,f=e.data.get(r.dataId).values,m=r.shape.length,g=Ft(r.shape),b=ft(o),x=o.length,v=Ft(o),w=kn(r.dtype,b);for(let C=0;C<b;C++){let k=Il(C,x,v);for(let I=0;I<x;I++)k[I]<l[I]?k[I]=l[I]*2-k[I]-d:k[I]>=c[I]&&(k[I]=(c[I]-1)*2-k[I]+d);k=k.map((I,D)=>I-l[D]);const $=Br(k,m,g);w[C]=f[$]}return{dataId:e.write(w,o,r.dtype),shape:o,dtype:r.dtype}}const Llt={kernelName:yp,backendName:"cpu",kernelFunc:Flt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mlt=nn((n,t)=>{const e=n%t;return n<0&&t<0||n>=0&&t>=0?e:(e+t)%t}),zlt=xn(Vc,Mlt),Plt={kernelName:Vc,backendName:"cpu",kernelFunc:zlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NP(n){const{inputs:t,backend:e,attrs:s}=n,{logits:r}=t,{dim:a}=s,i=r.shape.length;let o=a;if(o===-1&&(o=i-1),o!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${o}`);const l=Zt([o],r.shape),c=TP({inputs:{x:r},backend:e,attrs:{reductionIndices:l,keepDims:!1}}),d=Je(c.shape,l),f=Oe({inputs:{x:c},backend:e,attrs:{shape:d}}),m=wC({inputs:{a:r,b:f},backend:e}),g=Ez({inputs:{x:m},backend:e}),b=ym({inputs:{x:g},backend:e,attrs:{axis:l,keepDims:!1}}),x=Oe({inputs:{x:b},backend:e,attrs:{shape:d}}),v=TC({inputs:{a:g,b:x},backend:e});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(x),v}const Blt={kernelName:Fp,backendName:"cpu",kernelFunc:NP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vlt(n){const{inputs:t,backend:e,attrs:s}=n,{logits:r}=t,{numSamples:a,seed:i,normalized:o}=s;At(r,"multinomial");const l=o?r:NP({inputs:{logits:r},backend:e,attrs:{dim:-1}}),c=l.shape[0],d=l.shape[1],f=e.data.get(l.dataId).values,m=[c,a],g=Mn(ft(m),"int32");for(let b=0;b<c;++b){const x=b*d,v=new Float32Array(d-1);v[0]=f[x];for(let C=1;C<v.length;++C)v[C]=v[C-1]+f[x+C];const w=Pb.alea(i.toString()),T=b*a;for(let C=0;C<a;++C){const k=w();g[T+C]=v.length;for(let $=0;$<v.length;$++)if(k<v[$]){g[T+C]=$;break}}}return o||e.disposeIntermediateTensorInfo(l),e.makeTensorInfo(m,"int32",g)}const Ult={kernelName:Z0,backendName:"cpu",kernelFunc:Vlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wlt=ix;function Glt(n){const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s;At(r,"NonMaxSuppression");const c=e.data.get(r.dataId).values,d=e.data.get(a.dataId).values,{selectedIndices:f}=Wlt(c,d,i,o,l);return e.makeTensorInfo([f.length],"int32",new Int32Array(f))}const jlt={kernelName:Q0,backendName:"cpu",kernelFunc:Glt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hlt=ox;function qlt(n){const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=s;At(r,"NonMaxSuppressionPadded");const d=e.data.get(r.dataId).values,f=e.data.get(a.dataId).values,{selectedIndices:m,validOutputs:g}=Hlt(d,f,i,o,l,c);return[e.makeTensorInfo([m.length],"int32",new Int32Array(m)),e.makeTensorInfo([],"int32",new Int32Array([g]))]}const Klt={kernelName:J0,backendName:"cpu",kernelFunc:qlt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xlt=lx;function Ylt(n){const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=s;At(r,"NonMaxSuppressionWithScore");const d=e.data.get(r.dataId).values,f=e.data.get(a.dataId).values,m=i,g=o,b=l,x=c,{selectedIndices:v,selectedScores:w}=Xlt(d,f,m,g,b,x);return[e.makeTensorInfo([v.length],"int32",new Int32Array(v)),e.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const Zlt={kernelName:tb,backendName:"cpu",kernelFunc:Ylt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qlt(n){const{inputs:t,backend:e,attrs:s}=n,{indices:r}=t,{dtype:a,depth:i,onValue:o,offValue:l}=s;At(r,"oneHot");const c=ft(r.shape),d=new Float32Array(c*i);d.fill(l);const f=e.data.get(r.dataId).values;for(let m=0;m<c;++m)f[m]>=0&&f[m]<i&&(d[m*i+f[m]]=o);return e.makeTensorInfo([...r.shape,i],a,d)}const Jlt={kernelName:wp,backendName:"cpu",kernelFunc:Qlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0(n){const{inputs:t,backend:e}=n,{x:s}=t;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Tl({inputs:{input:s},backend:e}),a=e0({inputs:{x:r},backend:e}),i=sc({inputs:{input:s},backend:e}),o=e0({inputs:{x:i},backend:e}),l=Os({inputs:{real:a,imag:o},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(o),l}else return NC({backend:e,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const tut={kernelName:Pp,backendName:"cpu",kernelFunc:e0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CP(n){const{inputs:t,backend:e}=n,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Tl({inputs:{input:s},backend:e}),a=CP({inputs:{x:r},backend:e}),i=sc({inputs:{input:s},backend:e}),o=e0({inputs:{x:i},backend:e}),l=Os({inputs:{real:a,imag:o},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(o),l}else return NC({backend:e,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const eut={kernelName:vp,backendName:"cpu",kernelFunc:CP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kP(n){const{inputs:t,backend:e,attrs:s}=n,{axis:r}=s;if(t.length===1)return t0({inputs:{input:t[0]},backend:e,attrs:{dim:r}});const a=t[0].shape,i=t[0].dtype;t.forEach(d=>{zn(a,d.shape,"All tensors passed to stack must have matching shapes"),F(i===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=t.map(d=>{const f=t0({inputs:{input:d},backend:e,attrs:{dim:r}});return o.push(f),f}),c=rc({inputs:l,backend:e,attrs:{axis:r}});return o.forEach(d=>e.disposeIntermediateTensorInfo(d)),c}const nut={kernelName:Sp,backendName:"cpu",kernelFunc:kP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sut(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{paddings:a,constantValue:i}=s;At(r,"pad");const o=a.map((T,C)=>T[0]+r.shape[C]+T[1]),l=a.map(T=>T[0]),c=e.data.get(r.dataId).values,d=ft(r.shape),f=r.shape.length,m=Ft(r.shape),g=ft(o),b=o.length,x=Ft(o),v=kn(r.dtype,g);i!==0&&v.fill(i);for(let T=0;T<d;T++){const k=Il(T,f,m).map((I,D)=>I+l[D]),$=Br(k,b,x);v[$]=c[T]}return{dataId:e.write(v,o,r.dtype),shape:o,dtype:r.dtype}}const $P={kernelName:Tp,backendName:"cpu",kernelFunc:sut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rut=nn((n,t)=>Math.pow(n,t)),aut=xn(Wc,rut),iut={kernelName:Wc,backendName:"cpu",kernelFunc:aut};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function out(n){const{inputs:t,backend:e,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=t,{outputRaggedRank:o}=s,l=r.map(w=>e.data.get(w.dataId).values),c=r.map(w=>w.shape),d=e.data.get(a.dataId).values,f=e.data.get(i.dataId).values,[m,g,b]=Hz(l,c,d,a.shape,a.dtype,f,i.shape),x=m.map(w=>e.makeTensorInfo([w.length],"int32",w)),v=e.makeTensorInfo(b,a.dtype,g);return x.concat([v])}const lut={kernelName:eb,backendName:"cpu",kernelFunc:out};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uut(n){const{inputs:t,backend:e}=n,{starts:s,limits:r,deltas:a}=t,i=e.data.get(s.dataId).values,o=e.data.get(r.dataId).values,l=e.data.get(a.dataId).values,[c,d]=qz(i,s.shape,s.dtype,o,r.shape,l,a.shape),f=e.makeTensorInfo([c.length],"int32",c),m=e.makeTensorInfo([d.length],s.dtype,d);return[f,m]}const cut={kernelName:nb,backendName:"cpu",kernelFunc:uut};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hut(n){const{inputs:t,backend:e,attrs:s}=n,{shape:r,values:a,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=s,c=e.data.get(r.dataId).values,d=e.data.get(a.dataId).values,f=e.data.get(i.dataId).values,m=o.map(v=>e.data.get(v.dataId).values),g=o.map(v=>v.shape),[b,x]=Kz(c,r.shape,d,a.shape,a.dtype,f,i.shape,m,g,l);return e.makeTensorInfo(b,a.dtype,x)}const dut={kernelName:sb,backendName:"cpu",kernelFunc:hut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fut(n){const{backend:t,attrs:e}=n,{start:s,stop:r,dtype:a,step:i}=e,o=Xz(s,r,i,a);return t.makeTensorInfo([o.length],a,o)}const put={kernelName:rb,backendName:"cpu",kernelFunc:fut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mut=be(Gc,n=>1/n),gut={kernelName:Gc,backendName:"cpu",kernelFunc:mut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yut(n){const{inputs:t,backend:e,attrs:s}=n,{images:r}=t,{alignCorners:a,halfPixelCenters:i,size:o}=s;At(r,"resizeBilinear");const l=Ft(r.shape),[c,d]=o,[f,m,g,b]=r.shape,x=e.data.get(r.dataId).values,v=new Float32Array(ft([f,c,d,b])),w=[a&&c>1?m-1:m,a&&d>1?g-1:g],T=[a&&c>1?c-1:c,a&&d>1?d-1:d];let C=0;const k=w[0]/T[0],$=w[1]/T[1];for(let I=0;I<f;I++)for(let D=0;D<c;D++){let _;i?_=k*(D+.5)-.5:_=k*D;const O=Math.max(0,Math.floor(_)),L=_-O,R=Math.min(m-1,Math.ceil(_)),V=I*l[0]+O*l[1],Y=I*l[0]+R*l[1];for(let Q=0;Q<d;Q++){let tt;i?tt=$*(Q+.5)-.5:tt=$*Q;const B=Math.max(0,Math.floor(tt)),W=tt-B,X=Math.min(g-1,Math.ceil(tt)),ot=V+B*l[2],P=Y+B*l[2],j=V+X*l[2],rt=Y+X*l[2];for(let st=0;st<b;st++){const mt=x[ot+st],gt=x[P+st],bt=x[j+st],$t=x[rt+st],Ct=mt+(bt-mt)*W,_t=gt+($t-gt)*W,Wt=Ct+(_t-Ct)*L;v[C++]=Wt}}}return e.makeTensorInfo([f,c,d,b],"float32",v)}const but={kernelName:Ep,backendName:"cpu",kernelFunc:yut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xut(n){const{inputs:t,backend:e,attrs:s}=n,{images:r,dy:a}=t,{alignCorners:i}=s;At([a,r],"resizeBilinearGrad");const o=Ft(r.shape),[l,c,d,f]=r.shape,[,m,g]=a.shape,b=new Float32Array(l*c*d*f),x=[i&&m>1?c-1:c,i&&g>1?d-1:d],v=[i&&m>1?m-1:m,i&&g>1?g-1:g],w=x[0]/v[0],T=x[1]/v[1],C=e.data.get(a.dataId).values;let k=0;for(let $=0;$<l;$++){const I=$*o[0];for(let D=0;D<m;D++){const _=D*w,O=Math.floor(_),L=Math.min(Math.ceil(_),c-1),R=I+O*o[1],V=I+L*o[1],Y=_-O,Q=1-Y;for(let tt=0;tt<g;tt++){const B=tt*T,W=Math.floor(B),X=Math.min(Math.ceil(B),d-1),ot=B-W,P=1-ot,j=R+W*o[2],rt=R+X*o[2],st=V+W*o[2],mt=V+X*o[2],gt=Q*P,bt=Q*ot,$t=Y*P,Ct=Y*ot;for(let _t=0;_t<f;_t++){const Wt=C[k++];b[j+_t]+=Wt*gt,b[rt+_t]+=Wt*bt,b[st+_t]+=Wt*$t,b[mt+_t]+=Wt*Ct}}}}return e.makeTensorInfo([l,d,c,f],"float32",b)}const vut={kernelName:ob,backendName:"cpu",kernelFunc:xut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wut(n){const{inputs:t,backend:e,attrs:s}=n,{images:r}=t,{alignCorners:a,halfPixelCenters:i,size:o}=s;At(r,"resizeNearestNeighbor");const l=Ft(r.shape),[c,d]=o,[f,m,g,b]=r.shape,x=e.data.get(r.dataId).values,v=new Float32Array(f*c*d*b),w=[a&&c>1?m-1:m,a&&d>1?g-1:g],T=[a&&c>1?c-1:c,a&&d>1?d-1:d],C=w[0]/T[0],k=w[1]/T[1];let $=0;for(let I=0;I<f;I++){const D=I*l[0];for(let _=0;_<c;_++){const O=i?C*(_+.5):C*_;let L=Math.min(m-1,a?Math.round(O):Math.floor(O));i&&(L=Math.max(0,L));const R=D+L*l[1];for(let V=0;V<d;V++){const Y=i?k*(V+.5):k*V;let Q=Math.min(g-1,a?Math.round(Y):Math.floor(Y));i&&(Q=Math.max(0,Q));const tt=R+Q*l[2];for(let B=0;B<b;B++){const W=x[tt+B];v[$++]=W}}}}return e.makeTensorInfo([f,c,d,b],r.dtype,v)}const Sut={kernelName:$p,backendName:"cpu",kernelFunc:wut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tut(n){const{inputs:t,backend:e,attrs:s}=n,{images:r,dy:a}=t,{alignCorners:i}=s;At([a,r],"resizeNearestNeighborGrad");const o=Ft(r.shape),l=Ft(a.shape),[c,d,f,m]=r.shape,[,g,b]=a.shape,x=new Float32Array(c*d*f*m),v=e.data.get(a.dataId).values,w=[i&&g>1?d-1:d,i&&b>1?f-1:f],T=[i&&g>1?g-1:g,i&&b>1?b-1:b],C=w[0]/T[0],k=w[1]/T[1],$=1/C,I=1/k,D=Math.ceil($)*2+2,_=Math.ceil(I)*2+2;for(let O=0;O<c;O++){const L=O*o[0];for(let R=0;R<d;R++){const V=L+R*o[1],Y=Math.floor(R*$),Q=Math.floor(Y-D/2);for(let tt=0;tt<f;tt++){const B=V+tt*o[2],W=Math.floor(tt*I),X=Math.floor(W-_/2);for(let ot=0;ot<m;ot++){let P=0;for(let j=0;j<D;j++){const rt=j+Q;if(rt<0||rt>=g)continue;const st=L+rt*l[1],mt=rt*C,gt=Math.min(d-1,i?Math.round(mt):Math.floor(mt));if(R===gt)for(let bt=0;bt<_;bt++){const $t=bt+X;if($t<0||$t>=b)continue;const Ct=st+$t*l[2],_t=$t*k,Wt=Math.min(f-1,i?Math.round(_t):Math.floor(_t));tt===Wt&&(P+=v[Ct+ot])}}x[B+ot]=P}}}}return e.makeTensorInfo(r.shape,r.dtype,x)}const Nut={kernelName:ib,backendName:"cpu",kernelFunc:Tut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cut(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{dims:a}=s;At(r,"reverse");const i=r.shape.length,o=Zt(a,r.shape);if(i===0)return Sa({inputs:{x:r},backend:e});const l=new cn(r.shape,r.dtype),c=e.bufferSync(r);for(let d=0;d<l.size;d++){const f=l.indexToLoc(d),m=f.slice();o.forEach(g=>m[g]=r.shape[g]-1-m[g]),l.set(c.get(...m),...f)}return e.makeTensorInfo(l.shape,l.dtype,l.values)}const kut={kernelName:Ip,backendName:"cpu",kernelFunc:Cut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ut={kernelName:Nb,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:s}=n,{radians:r,fillValue:a,center:i}=t,o=e,l=kn(s.dtype,ft(s.shape)),[c,d,f,m]=s.shape,[g,b]=EN(i,d,f),x=255,v=Math.sin(r),w=Math.cos(r),T=o.data.get(s.dataId).values;for(let k=0;k<c;k++){const $=k*f*d*m;for(let I=0;I<d;I++){const D=I*(f*m);for(let _=0;_<f;_++){const O=_*m;for(let L=0;L<m;L++){const R=[c,I,_,L],V=R[2],Y=R[1];let Q=(V-g)*w-(Y-b)*v,tt=(V-g)*v+(Y-b)*w;Q=Math.round(Q+g),tt=Math.round(tt+b);let B=a;if(typeof a!="number"&&(L===3?B=x:B=a[L]),Q>=0&&Q<f&&tt>=0&&tt<d){const X=tt*(f*m),ot=Q*m,P=$+X+ot+L;B=T[P]}const W=$+D+O+L;l[W]=B}}}}return{dataId:o.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eut=be(qc,n=>{const t=Math.floor(n);return n-t<.5?Math.floor(n):n-t>.5?Math.ceil(n):t%2===0?t:t+1}),Iut={kernelName:qc,backendName:"cpu",kernelFunc:Eut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aut(n){const{inputs:t,backend:e,attrs:s}=n,{indices:r,updates:a}=t,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:c,strides:d,outputSize:f}=vo(a,r,i),m=!0,g=e.bufferSync(r),b=e.bufferSync(a),x=rl(g,b,i,f,c,l,o,d,0,m);return e.makeTensorInfo(i,x.dtype,x.values)}const Rut={kernelName:lb,backendName:"cpu",kernelFunc:Aut};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dut(n,t){let e=0,s=n.length,r=0;for(;e<s;)r=Math.floor((e+s)/2),n[r]<t?e=r+1:s=r;return s}function Out(n,t){let e=0,s=n.length,r=0;for(;e<s;)r=Math.floor((e+s)/2),n[r]<=t?e=r+1:s=r;return s}function _ut(n,t,e,s,r,a){const i=He("int32",e*r);for(let o=0;o<e;++o){const l=n.slice(o*s,(o+1)*s),c=o*r;for(let d=0;d<r;++d)i[c+d]=a==="left"?Dut(l,t[d+c]):Out(l,t[d+c])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fut(n){const{inputs:t,backend:e,attrs:s}=n,{sortedSequence:r,values:a}=t,{side:i}=s,o=e.data.get(r.dataId).values,l=e.data.get(a.dataId).values,c=_ut(o,l,r.shape[0],r.shape[1],a.shape[1],i);return e.makeTensorInfo(a.shape,"int32",c)}const Lut={kernelName:cb,backendName:"cpu",kernelFunc:Fut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mut(n){const{inputs:t,backend:e}=n,{condition:s,t:r,e:a}=t;At([s,r,a],"select");const i=s.shape.length,o=e.data.get(s.dataId).values,l=e.data.get(r.dataId).values,c=e.data.get(a.dataId).values,d=ys(r.dtype,a.dtype),f=Mn(ft(r.shape),d);let m=0;const g=i===0||i>1||r.shape.length===1?1:ft(r.shape.slice(1));for(let b=0;b<o.length;b++)for(let x=0;x<g;x++)o[b]===1?f[m++]=l[b]:f[m++]=c[b];return e.makeTensorInfo(r.shape,d,f)}const zut={kernelName:Ap,backendName:"cpu",kernelFunc:Mut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Put=fx,But=px,Vut=be(Xc,n=>n>=0?But*n:Put*(Math.exp(n)-1)),Uut={kernelName:Xc,backendName:"cpu",kernelFunc:Vut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wut=be(Qc,n=>n<0?-1:n>0?1:0),Gut={kernelName:Qc,backendName:"cpu",kernelFunc:Wut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jut=be(Yc,n=>Math.sin(n)),Hut={kernelName:Yc,backendName:"cpu",kernelFunc:jut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qut=be(Zc,n=>Math.sinh(n)),Kut={kernelName:Zc,backendName:"cpu",kernelFunc:qut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xut=11920928955078125e-23,ND=Math.log(Xut)+2,Yut=be(th,n=>{const t=n>-ND,e=n<ND,s=Math.exp(n);let r;return e?r=s:t?r=n:r=Math.log(1+s),r}),Zut={kernelName:th,backendName:"cpu",kernelFunc:Yut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qut(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockShape:a,paddings:i}=s;At([r],"spaceToBatchND");const o=ft(a),l=[[0,0]];l.push(...i);for(let I=1+a.length;I<r.shape.length;++I)l.push([0,0]);const c=$P.kernelFunc({inputs:{x:r},backend:e,attrs:{paddings:l,constantValue:0}}),d=im(c.shape,a,o,!1),f=om(d.length,a.length,!1),m=lm(c.shape,a,o,!1),x=Oe({inputs:{x:c},backend:e,attrs:{shape:d}}),T=Ss({inputs:{x},backend:e,attrs:{perm:f}}),$=Oe({inputs:{x:T},backend:e,attrs:{shape:m}});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(T),$}const Jut={kernelName:Op,backendName:"cpu",kernelFunc:Qut};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tct(n){const{inputs:t,backend:e}=n,{indices:s,values:r,denseShape:a,defaultValue:i}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=e.data.get(s.dataId).values,l=e.data.get(r.dataId).values,c=e.data.get(a.dataId).values,d=e.data.get(i.dataId).values[0],[f,m,g,b,x]=Jz(o,s.shape,s.dtype,l,r.dtype,c,d);return[e.makeTensorInfo(m,s.dtype,f),e.makeTensorInfo([m[0]],r.dtype,g),e.makeTensorInfo([b.length],"bool",new Uint8Array(b.map(v=>Number(v)))),e.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const ect={kernelName:hb,backendName:"cpu",kernelFunc:tct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nct(n){const{inputs:t,backend:e}=n,{inputIndices:s,inputShape:r,newShape:a}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(e.data.get(r.dataId).values),o=e.data.get(s.dataId).values,l=Array.from(e.data.get(a.dataId).values),[c,d,f]=tP(o,s.shape,s.dtype,i,l);return[e.makeTensorInfo(d,s.dtype,c),e.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}const sct={kernelName:db,backendName:"cpu",kernelFunc:nct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rct(n){const{inputs:t,backend:e}=n,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=e.data.get(s.dataId).values,o=e.data.get(r.dataId).values,l=e.data.get(a.dataId).values,[c,d]=vC(i,s.shape,s.dtype,o,l,!0);return e.makeTensorInfo(d,s.dtype,c)}const act={kernelName:fb,backendName:"cpu",kernelFunc:rct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ict(n){const{inputs:t,backend:e}=n,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=e.data.get(s.dataId).values,o=e.data.get(r.dataId).values,l=e.data.get(a.dataId).values,[c,d]=vC(i,s.shape,s.dtype,o,l);return e.makeTensorInfo(d,s.dtype,c)}const oct={kernelName:pb,backendName:"cpu",kernelFunc:ict};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lct(n){const{inputs:t,backend:e,attrs:s}=n,{sparseIndices:r,sparseValues:a,defaultValue:i}=t,{outputShape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:d,strides:f,outputSize:m}=vo(a,r,o),g=!1,b=e.bufferSync(r);let x;switch(a.dtype){case"bool":{const v=e.bufferSync(a),w=!!e.data.get(i.dataId).values[0];x=rl(b,v,o,m,d,c,l,f,w,g);break}case"float32":{const v=e.bufferSync(a),w=e.data.get(i.dataId).values[0];x=rl(b,v,o,m,d,c,l,f,w,g);break}case"int32":{const v=e.bufferSync(a),w=e.data.get(i.dataId).values[0];x=rl(b,v,o,m,d,c,l,f,w,g);break}case"string":{const v=e.bufferSync(a),w=ni(e.data.get(i.dataId).values[0]);x=rl(b,v,o,m,d,c,l,f,w,g);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return e.makeTensorInfo(o,x.dtype,x.values)}const uct={kernelName:mb,backendName:"cpu",kernelFunc:lct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cct(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{numOrSizeSplits:a,axis:i}=s,o=Zt(i,r.shape)[0],l=WN(r,a,o),c=new Array(r.shape.length).fill(0),d=r.shape.slice();return l.map(f=>{const m=[...d];m[o]=f;const g=Nl({inputs:{x:r},backend:e,attrs:{begin:c,size:m}});return c[o]+=f,g})}const hct={kernelName:_p,backendName:"cpu",kernelFunc:cct};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dct={kernelName:gb,backendName:"cpu",kernelFunc:({inputs:n,backend:t})=>{const{x:e}=n,s=t;At(e,"square");const r=s.data.get(e.dataId).values,a=new Float32Array(r.length);for(let o=0;o<r.length;++o){const l=r[o];a[o]=l*l}return{dataId:s.write(a,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fct=be(oh,(n,t)=>{const e=t;return isNaN(n)?NaN:n>0?1:e.alpha}),pct={kernelName:oh,backendName:"cpu",kernelFunc:fct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mct(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{begin:a,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:d,newAxisMask:f,shrinkAxisMask:m}=s;At(r,"stridedSlice");const{finalShapeSparse:g,finalShape:b,isIdentity:x,sliceDim0:v,isSimpleSlice:w,begin:T,end:C,strides:k}=NN(r.shape,a,i,o,l,c,d,f,m);let $;if(x)$=Oe({inputs:{x:r},backend:e,attrs:{shape:b}});else if(v||w){F(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const I=wN(T,C,k),D=Nl({inputs:{x:r},backend:e,attrs:{begin:T,size:I}});$=Oe({inputs:{x:D},backend:e,attrs:{shape:b}}),e.disposeIntermediateTensorInfo(D)}else{const I=e.bufferSync(r),D=sP(g,I,k,T);$=e.makeTensorInfo(b,D.dtype,D.values)}return $}const gct={kernelName:yb,backendName:"cpu",kernelFunc:mct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yct(n){const{inputs:t,backend:e,attrs:s}=n,{separator:r,nGramWidths:a,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=s,{data:d,dataSplits:f}=t,m=e.data.get(d.dataId).values,g=e.data.get(f.dataId).values,[b,x]=rP(m,g,r,a,i,o,l,c);return[e.makeTensorInfo([b.length],"string",b),e.makeTensorInfo(f.shape,"int32",x)]}const bct={kernelName:bb,backendName:"cpu",kernelFunc:yct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xct(n){const{inputs:t,backend:e,attrs:s}=n,{skipEmpty:r}=s,{input:a,delimiter:i}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=e.data.get(a.dataId).values,l=e.data.get(i.dataId).values[0],[c,d,f]=aP(o,l,r),m=d.length;return[e.makeTensorInfo([m,2],"int32",c),e.makeTensorInfo([m],"string",d),e.makeTensorInfo([2],"int32",new Int32Array(f))]}const vct={kernelName:xb,backendName:"cpu",kernelFunc:xct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wct(n){const{inputs:t,backend:e,attrs:s}=n,{numBuckets:r}=s,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=e.data.get(a.dataId).values,o=iP(i,r);return e.makeTensorInfo(a.shape,"int32",o)}const Sct={kernelName:vb,backendName:"cpu",kernelFunc:wct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tct=be(rh,n=>Math.tan(n)),Nct={kernelName:rh,backendName:"cpu",kernelFunc:Tct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cct=be(ah,n=>Math.tanh(n)),kct={kernelName:ah,backendName:"cpu",kernelFunc:Cct};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ct(n){const{inputs:t,backend:e}=n,{tensor:s,indices:r,updates:a}=t,{sliceRank:i,numUpdates:o,sliceSize:l,strides:c,outputSize:d}=vo(a,r,s.shape),f=!1,m=e.bufferSync(r),g=e.bufferSync(a),b=e.bufferSync(s),x=rl(m,g,s.shape,d,l,o,i,c,b,f);return e.makeTensorInfo(s.shape,x.dtype,x.values)}const Ect={kernelName:ub,backendName:"cpu",kernelFunc:$ct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ict(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{reps:a}=s;At(r,"tile");const i=lP(e.bufferSync(r),a);return e.makeTensorInfo(i.shape,i.dtype,i.values)}const Act={kernelName:ih,backendName:"cpu",kernelFunc:Ict};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rct(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{k:a,sorted:i}=s;At(r,"topk");const o=e.data.get(r.dataId).values,[l,c]=cP(o,r.shape,r.dtype,a,i);return[e.makeTensorInfo(l.shape,l.dtype,l.values),e.makeTensorInfo(c.shape,c.dtype,c.values)]}const Dct={kernelName:wb,backendName:"cpu",kernelFunc:Rct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oct(n){const{inputs:t,attrs:e,backend:s}=n,{image:r,transforms:a}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=e,[d,f,m,g]=r.shape,[b,x]=c??[f,m],v=[d,b,x,g],w=Ft(r.shape),T=w[0],C=w[1],k=w[2],$=Ft(v),I=$[0],D=$[1],_=$[2],O=kn(r.dtype,ft(v));O.fill(l);const L=s.data.get(r.dataId).values,R=s.data.get(a.dataId).values;for(let Y=0;Y<d;++Y){const Q=a.shape[0]===1?R:R.subarray(Y*8,Y*8+8);for(let tt=0;tt<b;++tt)for(let B=0;B<x;++B)for(let W=0;W<g;++W){let X;const ot=Q[6]*B+Q[7]*tt+1;if(ot===0)continue;const P=(Q[0]*B+Q[1]*tt+Q[2])/ot,j=(Q[3]*B+Q[4]*tt+Q[5])/ot,rt=CD(P,m,o),st=CD(j,f,o);switch(i){case"nearest":X=Pct(L,f,m,T,C,k,Y,st,rt,W,l);break;case"bilinear":X=Bct(L,f,m,T,C,k,Y,st,rt,W,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const mt=Y*I+tt*D+B*_+W;O[mt]=X}return s.makeTensorInfo(v,r.dtype,O)}return{dataId:s.write(O,v,r.dtype),shape:r.shape,dtype:r.dtype}}const _ct={kernelName:Sb,backendName:"cpu",kernelFunc:Oct};function CD(n,t,e){switch(e){case"reflect":return Fct(n,t);case"wrap":return Lct(n,t);case"nearest":return zct(n,t);case"constant":default:return Mct(n)}}function Fct(n,t){let e=n;if(e<0)if(t<=1)e=0;else{const s=2*t;e<s&&(e=s*Math.trunc(-e/s)+e),e=e<-t?e+s:-e-1}else if(e>t-1)if(t<=1)e=0;else{const s=2*t;e-=s*Math.trunc(e/s),e>=t&&(e=s-e-1)}return Ji(0,e,t-1)}function Lct(n,t){let e=n;if(e<0)if(t<=1)e=0;else{const s=t-1;e+=t*(Math.trunc(-e/s)+1)}else if(e>t-1)if(t<=1)e=0;else{const s=t-1;e-=t*Math.trunc(e/s)}return Ji(0,e,t-1)}function Mct(n,t){return n}function zct(n,t){return Ji(0,n,t-1)}function Md(n,t,e,s,r,a,i,o,l,c,d){const f=i*s+o*r+l*a+c;return 0<=o&&o<t&&0<=l&&l<e?n[f]:d}function Pct(n,t,e,s,r,a,i,o,l,c,d){const f=Math.round(o),m=Math.round(l);return Md(n,t,e,s,r,a,i,f,m,c,d)}function Bct(n,t,e,s,r,a,i,o,l,c,d){const f=Math.floor(o),m=Math.floor(l),g=f+1,b=m+1,x=(b-l)*Md(n,t,e,s,r,a,i,f,m,c,d)+(l-m)*Md(n,t,e,s,r,a,i,f,b,c,d),v=(b-l)*Md(n,t,e,s,r,a,i,g,m,c,d)+(l-m)*Md(n,t,e,s,r,a,i,g,b,c,d);return(g-o)*x+(o-f)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vct(n){const{inputs:t,attrs:e,backend:s}=n,{axis:r}=e,{x:a}=t;At(a,"unique");const i=s.data.get(a.dataId).values,{outputValues:o,outputShape:l,indices:c}=hP(i,r,a.shape,a.dtype);return[s.makeTensorInfo(l,a.dtype,o),s.makeTensorInfo([c.length],"int32",c)]}const Uct={kernelName:Tb,backendName:"cpu",kernelFunc:Vct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wct(n){const{inputs:t,backend:e,attrs:s}=n,{value:r}=t;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r.shape.length,o=r.shape[a],l=new Array(i-1);let c=0;for(let g=0;g<i;g++)g!==a&&(l[c++]=r.shape[g]);const d=new Array(i).fill(0),f=r.shape.slice();f[a]=1;const m=new Array(o);for(let g=0;g<m.length;g++){d[a]=g;const b=Nl({inputs:{x:r},backend:e,attrs:{begin:d,size:f}});m[g]=Oe({inputs:{x:b},backend:e,attrs:{shape:l}}),e.disposeIntermediateTensorInfo(b)}return m}const Gct={kernelName:Mp,backendName:"cpu",kernelFunc:Wct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jct(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,segmentIds:a}=t,{numSegments:i}=s;At(r,"unsortedSegmentSum");const o=r.shape.length,l=a.shape.length,c=[],d=[],f=o-l;let m=a;for(let b=0;b<f;++b){const x=t0({inputs:{input:m},backend:e,attrs:{dim:b+1}});m=x,d.push(x)}for(let b=0;b<i;++b){const x=ci(b,"int32"),v=e.makeTensorInfo([],"int32",x),w=kz({inputs:{a:v,b:m},backend:e}),T=co({inputs:{x:w},backend:e,attrs:{dtype:"float32"}}),C=kx({inputs:{a:T,b:r},backend:e}),k=ym({inputs:{x:C},backend:e,attrs:{axis:0,keepDims:!1}});c.push(k),d.push(v),d.push(w),d.push(T),d.push(C),d.push(k)}const g=kP({inputs:c,backend:e,attrs:{axis:0}});return d.forEach(b=>e.disposeIntermediateTensorInfo(b)),g}const Hct={kernelName:zp,backendName:"cpu",kernelFunc:jct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qct=[Vat,wrt,Wat,jat,$rt,qat,Xat,Zat,Jat,eit,sit,ait,oit,cit,dit,mit,yit,xit,wit,Pat,Tit,Cit,$it,Irt,Iit,Crt,Rrt,Rit,Srt,Oit,Fit,Lit,zit,Bit,Uit,Git,Hit,Kit,Yit,Qit,tot,not,rot,iot,oot,uot,hot,fot,pot,mot,got,bot,wot,Dat,Tot,Drt,Rot,Ort,Dot,Frt,zot,Pot,Vot,Mrt,Prt,Wot,jot,qot,Xot,Vrt,Wrt,Trt,Zot,_it,Jot,elt,slt,Oat,jrt,qrt,alt,Xrt,olt,clt,dlt,mlt,ylt,xlt,vlt,Zrt,Slt,Nlt,klt,Elt,Alt,Dlt,_lt,Jrt,Llt,Plt,Ult,eat,sat,jlt,Klt,Zlt,aat,Jlt,eut,nut,$P,iut,Fat,lat,lut,cut,dut,put,Nrt,GS,gut,Lat,Mat,zat,but,vut,Sut,Nut,kut,$ut,Iut,gat,Rut,Lut,zut,Uut,bat,Gut,Hut,Kut,xat,Blt,Zut,Jut,ect,sct,act,oct,uct,hct,Sat,dct,Nat,kat,pct,gct,bct,vct,Sct,Aat,xot,Nct,kct,Ect,Act,Dct,_ct,iat,Uct,Gct,Hct,tut];for(const n of qct)Cb(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tl={},Xg={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Kct(n,t){tl[n]=t}function qr(n,t){if(!(n in tl)||t!=null){const s=Yct(n,t);if(s!==null)tl[n]=s;else return console.log("Could not get context for WebGL version",n),null}const e=tl[n];return e==null||e.isContextLost()?(delete tl[n],qr(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),tl[n])}function Xct(n){if(!lt().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Yct(n,t){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=t??Xct(n);return e.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete tl[n]},!1),lt().getBool("SOFTWARE_WEBGL_ENABLED")&&(Xg.failIfMajorPerformanceCaveat=!1),n===1?e.getContext("webgl",Xg)||e.getContext("experimental-webgl",Xg):e.getContext("webgl2",Xg)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Cf;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(Cf||(Cf={}));var Js;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(Js||(Js={}));var Fn;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Fn||(Fn={}));function bm(n,t){return[t,n]}function Zct(n,t){return n*t}function Yg(n){const t=ft(n),e=Math.ceil(t/4);return Ay(e)}function gh(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function Qct(n,t){const[e,s]=gh(n,t);return e*s*4}function CC(n,t){const e=n;let s,r,a,i,o,l,c,d,f,m;return lt().getNumber("WEBGL_VERSION")===2?(s=e.R32F,r=e.R16F,a=e.RGBA16F,i=e.RGBA32F,o=e.RED,c=4,d=1,f=e.HALF_FLOAT,m=e.FLOAT,l=e.RGBA8):(s=n.RGBA,r=n.RGBA,a=n.RGBA,i=e.RGBA,o=n.RGBA,c=4,d=4,f=t!=null?t.HALF_FLOAT_OES:null,m=n.FLOAT,l=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:d,textureTypeHalfFloat:f,textureTypeFloat:m}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kt(n,t){const e=t();return lt().getBool("DEBUG")&&Jct(n),e}function Jct(n){const t=n.getError();if(t!==n.NO_ERROR)throw new Error("WebGL Error: "+sht(n,t))}const tht=596e-10,eht=65504;function nht(n){return!!(lt().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||tht<Math.abs(n)&&Math.abs(n)<eht)}function sht(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function Zg(n,t){return yi(n,()=>n.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function rht(n,t){const e=yi(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(kt(n,()=>n.shaderSource(e,t)),kt(n,()=>n.compileShader(e)),n.getShaderParameter(e,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(e)),new Error("Failed to compile vertex shader.");return e}function aht(n,t){const e=yi(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(kt(n,()=>n.shaderSource(e,t)),kt(n,()=>n.compileShader(e)),lt().get("ENGINE_COMPILE_ONLY"))return e;if(n.getShaderParameter(e,n.COMPILE_STATUS)===!1)throw EP(t,n.getShaderInfoLog(e)),new Error("Failed to compile fragment shader.");return e}const iht=/ERROR: [0-9]+:([0-9]+):/g;function EP(n,t){const e=iht.exec(t);if(e==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(n);return}const s=+e[1],r=n.split(`
`),a=r.length.toString().length+2,i=r.map((f,m)=>il((m+1).toString(),a)+f);let o=0;for(let f=0;f<i.length;f++)o=Math.max(i[f].length,o);const l=i.slice(0,s-1),c=i.slice(s-1,s),d=i.slice(s);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${il(c[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join(`
`))}function oht(n){return yi(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function lht(n,t){if(kt(n,()=>n.linkProgram(t)),!lt().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(t,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function Cw(n,t){if(kt(n,()=>n.validateProgram(t)),n.getProgramParameter(t,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function uht(n,t){const e=yi(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return kt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),kt(n,()=>n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)),e}function cht(n,t){const e=yi(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return kt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e)),kt(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)),e}function hht(n){return yi(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function dht(n,t){const e=lt().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0){const s=`[${n}x${t}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>e||t>e){const s=`[${n}x${t}]`,r=`[${e}x${e}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function fht(n){return yi(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function kD(n,t,e,s,r,a,i){const o=n.getAttribLocation(t,e);return o===-1?!1:(kt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),kt(n,()=>n.vertexAttribPointer(o,r,n.FLOAT,!1,a,i)),kt(n,()=>n.enableVertexAttribArray(o)),!0)}function pht(n,t,e){xht(n,e),kt(n,()=>n.activeTexture(n.TEXTURE0+e)),kt(n,()=>n.bindTexture(n.TEXTURE_2D,t))}function mht(n,t,e){return yi(n,()=>n.getUniformLocation(t,e),'uniform "'+e+'" not present in program.')}function ght(n,t,e){return n.getUniformLocation(t,e)}function yht(n,t,e,s){kt(n,()=>pht(n,t,s)),kt(n,()=>n.uniform1i(e,s))}function kw(n,t,e){kt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),kt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0))}function $D(n,t){kt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),kt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function Qg(n){const t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+bht(n,t))}function bht(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function yi(n,t,e){const s=kt(n,()=>t());if(s==null)throw new Error(e);return s}function xht(n,t){const e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=t+n.TEXTURE0;if(s<n.TEXTURE0||s>e){const r=`[gl.TEXTURE0, gl.TEXTURE${e}]`;throw new Error(`textureUnit must be in ${r}.`)}}function ac(n,t=2){return ft(n.slice(0,n.length-t))}function ic(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Jg(n){let t=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(t=[ac(n),...ic(n)]),t}function vht(n,t=!1){let e=lt().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=lt().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&lt().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=e/2),t&&(e=e*2,s=s*2,n=n.map((o,l)=>l>=n.length-2?b0(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=ui(n).newShape);let r=ft(n),a=null;n.length<=1&&r<=e?a=[1,r]:n.length===2&&n[0]<=e&&n[1]<=e?a=n:n.length===3&&n[0]*n[1]<=e&&n[2]<=e?a=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=e&&n[1]*n[2]<=e?a=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=e&&n[3]<=e?a=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=e&&n[1]*n[2]*n[3]<=e&&(a=[n[0],n[1]*n[2]*n[3]]);const i=a!=null&&Math.max(...a)>s&&Math.min(...a)<=(t?2:1)&&Math.min(...a)>0;if(a==null||i)if(t){const o=ac(n);let l=2,c=2;n.length&&([l,c]=ic(n)),r=o*(l/2)*(c/2),a=Ay(r).map(d=>d*2)}else a=Ay(r);return a}function ty(n){return n%2===0}function n0(n,t){if(n=n.slice(-2),t=t.slice(-2),te(n,t)||!n.length||!t.length||n[0]===0||n[1]===0||t[0]===0||t[1]===0)return!0;if(n.length!==t.length){const e=n[n.length-1],s=t[t.length-1];if(e===s||ty(e)&&ty(s)&&(n[0]===1||t[0]===1))return!0}return n[1]===t[1]&&ty(n[0])&&ty(t[0])}let $w,Ew;function wht(n){if($w==null){const t=qr(n);$w=t.getParameter(t.MAX_TEXTURE_SIZE)}return $w}function Sht(n){if(Ew==null){const t=qr(n);Ew=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Ew)}function Tht(n){if(n===0)return 0;let t;const e=qr(n);return Sr(e,"EXT_disjoint_timer_query_webgl2")&&n===2?t=2:Sr(e,"EXT_disjoint_timer_query")?t=1:t=0,t}function Sr(n,t){return n.getExtension(t)!=null}function ED(n){try{if(qr(n)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function Nht(n){if(n===0)return!1;const t=qr(n);if(n===1){if(!Sr(t,"OES_texture_float"))return!1}else if(!Sr(t,"EXT_color_buffer_float"))return!1;return HS(t)}function Cht(n){if(n===0)return!1;const t=qr(n);if(n===1){if(!Sr(t,"OES_texture_float")||!Sr(t,"WEBGL_color_buffer_float"))return!1}else{if(Sr(t,"EXT_color_buffer_float"))return HS(t);const s="EXT_color_buffer_half_float";if(Sr(t,s)){const r=t.getExtension(s);return kht(t,r)}return!1}return HS(t)}function HS(n){const t=CC(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);const i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(a),i}function kht(n,t){const e=CC(n,t),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatHalfFloat,1,1,0,e.textureFormatFloat,e.textureTypeHalfFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(i),o}function $ht(n){return n!==2?!1:qr(n).fenceSync!=null}function xm(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{e!=null&&F(e.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dt=lt();Dt.registerFlag("HAS_WEBGL",()=>Dt.getNumber("WEBGL_VERSION")>0);Dt.registerFlag("WEBGL_VERSION",()=>ED(2)?2:ED(1)?1:0);Dt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Dt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Dt.get("WEBGL_VERSION")===2);Dt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Dt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Dt.registerFlag("WEBGL_PACK",()=>Dt.getBool("HAS_WEBGL"));Dt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_PACK_CLIP",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_PACK_REDUCE",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_LAZILY_UNPACK",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_CONV_IM2COL",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Dt.getBool("WEBGL_PACK"));Dt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>wht(Dt.getNumber("WEBGL_VERSION")));Dt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Sht(Dt.getNumber("WEBGL_VERSION")));Dt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Dt.getNumber("WEBGL_VERSION");return n===0?0:Tht(n)});Dt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Dt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Q2());Dt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Nht(Dt.getNumber("WEBGL_VERSION")));Dt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Dt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Dt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Dt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Cht(Dt.getNumber("WEBGL_VERSION")));Dt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>$ht(Dt.getNumber("WEBGL_VERSION")));Dt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Dt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Dt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Dt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Q2()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Dt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Dt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Dt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Dt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Dt.registerFlag("WEBGL_EXP_CONV",()=>!1);Dt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Dt.getBool("IS_TEST"));Dt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Dt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Dt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Dt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(){let n,t,e,s,r,a,i,o,l,c;return lt().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",t="in",e="out",s="in",r="texture",a="outputColor",i="out vec4 outputColor;",o=lt().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",t="attribute",e="varying",s="varying",r="texture2D",a="gl_FragColor",i="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:t,varyingVs:e,varyingFs:s,texture2D:r,output:a,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ml(n,t,e="index"){const s=Ft(t);return s.map((r,a)=>{const i=`int ${n[a]} = ${e} / ${r}`,o=a===s.length-1?`int ${n[a+1]} = ${e} - ${n[a]} * ${r}`:`index -= ${n[a]} * ${r}`;return`${i}; ${o};`}).join("")}function $x(n,t,e="index"){const s=Ft(t);return s.map((r,a)=>{const i=`int ${n[a]} = ${e} / outShapeStrides[${a}]`,o=a===s.length-1?`int ${n[a+1]} = ${e} - ${n[a]} * outShapeStrides[${a}]`:`index -= ${n[a]} * outShapeStrides[${a}]`;return`${i}; ${o};`}).join("")}function Eht(n,t){const e=n.length,s=n.map(a=>`${t}[${a}]`),r=new Array(e-1);r[e-2]=s[e-1];for(let a=e-3;a>=0;--a)r[a]=`(${r[a+1]} * ${s[a+1]})`;return r}function Iht(n,t,e="index"){const s=n.map((a,i)=>i),r=Eht(s,t);return r.map((a,i)=>{const o=`int ${n[i]} = ${e} / ${r[i]}`,l=i===r.length-1?`int ${n[i+1]} = ${e} - ${n[i]} * ${r[i]}`:`index -= ${n[i]} * ${r[i]}`;return`${o}; ${l};`}).join("")}function kC(n){const t=Ft(n).map(e=>e.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function $C(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const IP=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:AP}=ZL;function Aht(n,t,e){const s=[];if(n.forEach(g=>{const b=ft(g.shapeInfo.logicalShape);if(g.shapeInfo.isUniform?s.push(`uniform float ${g.name}${b>1?`[${b}]`:""};`):(s.push(`uniform sampler2D ${g.name};`),s.push(`uniform int offset${g.name};`)),e.enableShapeUniforms){const{uniformShape:x}=EC(e.packedInputs,g.shapeInfo.logicalShape,g.shapeInfo.texShape);switch(x.length){case 1:s.push(`uniform int ${g.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${g.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${g.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${g.name}Shape;`);break}s.push(`uniform ivec2 ${g.name}TexShape;`)}}),e.enableShapeUniforms){switch(t.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}e.customUniforms&&e.customUniforms.forEach(g=>{s.push(`uniform ${g.type} ${g.name}${g.arrayIndex?`[${g.arrayIndex}]`:""};`)});const r=s.join(`
`),a=n.map(g=>Rht(g,t,e.packedInputs,e.enableShapeUniforms)).join(`
`),i=t.texShape,o=cs(),l=_ht(o);let c,d,f=Mht(o);return t.isPacked?(c=Dht(t.logicalShape,i,e.enableShapeUniforms),d=Lht(o)):(c=Oht(t.logicalShape,i,e.enableShapeUniforms),d=Fht(o)),e.packedInputs&&(f+=Vht),[f,l,d,r,c,a,e.userCode].join(`
`)}function yh(n,t=!1){const e=n.shapeInfo.logicalShape;switch(e.length){case 0:return Jht(n,t);case 1:return edt(n,t);case 2:return sdt(n,t);case 3:return adt(n,t);case 4:return odt(n,t);case 5:return ldt(n);case 6:return udt(n);default:throw new Error(`${e.length}-D input sampling is not yet supported`)}}function RP(n,t){switch(n.shapeInfo.logicalShape.length){case 0:return Qht(n);case 1:return tdt(n,t);case 2:return ndt(n,t);case 3:return rdt(n,t);default:return idt(n,t)}}function Rht(n,t,e=!1,s){let r="";e?r+=RP(n,s):r+=yh(n,s);const a=n.shapeInfo.logicalShape,i=t.logicalShape;return a.length<=i.length&&(e?r+=cdt(n,t):r+=hdt(n,t)),r}function Dht(n,t,e){switch(n.length){case 0:return DP();case 1:return Uht(n,t,e);case 2:return Yht(n,t,e);case 3:return Ght(n,t,e);default:return Hht(n,t,e)}}function Oht(n,t,e){switch(n.length){case 0:return DP();case 1:return Wht(n,t,e);case 2:return Zht(n,t,e);case 3:return jht(n,t,e);case 4:return qht(n,t,e);case 5:return Kht(n,t);case 6:return Xht(n,t);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function _ht(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function Fht(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function Lht(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function Mht(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${zht}
    ${Pht}
    ${Bht}
  `}const zht=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Pht=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Bht=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Vht=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function DP(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Uht(n,t,e){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return s[0]===1?e?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?e?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:e?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Wht(n,t,e){return t[0]===1?e?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?e?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:e?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function Ght(n,t,e){if(e)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(n[2]/2),a=r*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function jht(n,t,e){if(e)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${$x(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=Ml(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function Hht(n,t,e){if(e)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(n[n.length-1]/2),a=r*Math.ceil(n[n.length-2]/2);let i=a,o="",l="b, r, c";for(let c=2;c<n.length-1;c++)i*=n[n.length-c-1],o=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+o,l=`b${c}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${o}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${n.length}(${l});
    }
  `}function qht(n,t,e){if(e)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${$x(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Ml(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Kht(n,t){const e=Ml(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${e}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Xht(n,t){const e=Ml(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${e}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Yht(n,t,e){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(te(n,t))return e?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(n[1]/2);return e?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function Zht(n,t,e){return te(n,t)?e?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:n[1]===1?e?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?e?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:e?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function zl(n){return`offset${n}`}function Qht(n){const t=n.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),s=cs();return`
    vec4 ${e}() {
      return ${s.texture2D}(${t}, halfCR);
    }
  `}function Jht(n,t){const e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${e};}`;const[r,a]=n.shapeInfo.texShape;if(r===1&&a===1)return`
      float ${s}() {
        return sampleTexture(${e}, halfCR);
      }
    `;const i=zl(e);if(t)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], ${i});
      return sampleTexture(${e}, uv);
    }
  `;const[o,l]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${i});
      return sampleTexture(${e}, uv);
    }
  `}function tdt(n,t){const e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1),r=n.shapeInfo.texShape,a=cs();if(t)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${e}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${a.texture2D}(${e}, uv);
    }
  `}function edt(n,t){const e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${bh(n)}
      }
    `;const r=n.shapeInfo.texShape,a=r[0],i=r[1];if(i===1&&a===1)return`
      float ${s}(int index) {
        return sampleTexture(${e}, halfCR);
      }
    `;const o=zl(e);return i===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${e}TexShape[0]));
        return sampleTexture(${e}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${a}.0);
        return sampleTexture(${e}, uv);
      }
    `:a===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${e}TexShape[1]), 0.5);
        return sampleTexture(${e}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${e}, uv);
      }
    `:t?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], index + ${o});
      return sampleTexture(${e}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${a}, ${i}, index + ${o});
      return sampleTexture(${e}, uv);
    }
  `}function ndt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape,i=a[0],o=a[1],l=cs();if(a!=null&&te(e,a))return t?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(t)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],d=Math.ceil(e[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${d}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function sdt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape;if(a!=null&&te(e,a)){if(t)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const m=a[0],g=a[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${g}.0, ${m}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:o}=ui(e),l=i;if(l.length<e.length){const m=xh(n,l),g=["row","col"];return`
      ${yh(m,t)}
      float ${r}(int row, int col) {
        return ${r}(${vh(g,o)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));
        ${bh(n)}
      }
    `;const c=a[0],d=a[1],f=zl(s);return d===1?t?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${e[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?t?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${e[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${d}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:t?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${e[1]} + col + ${f};
    vec2 uv = uvFromFlat(${c}, ${d}, index);
    return sampleTexture(${s}, uv);
  }
`}function rdt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(e[0]===1){const m=e.slice(1),g=[1,2],b=xh(n,m),x=["b","row","col"];return`
        ${RP(b,t)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${vh(x,g)});
        }
      `}const o=cs();if(t)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `;const l=i[0],c=i[1],d=Math.ceil(e[2]/2),f=d*Math.ceil(e[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${f}, ${d}, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `}function adt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=e[1]*e[2],i=e[2],{newShape:o,keptDims:l}=ui(e),c=o;if(c.length<e.length){const x=xh(n,c),v=["row","col","depth"];return`
        ${yh(x,t)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${vh(v,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${i}, 1)));
        ${bh(n)}
      }
    `;const d=n.shapeInfo.texShape,f=d[0],m=d[1],g=n.shapeInfo.flatOffset;if(m===a&&g==null)return t?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${m}.0, ${f}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(m===i&&g==null)return t?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${m}.0, ${f}.0);
      return sampleTexture(${s}, uv);
    }
  `;const b=zl(s);return t?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${b};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${i} + depth + ${b};
        vec2 uv = uvFromFlat(${f}, ${m}, index);
        return sampleTexture(${s}, uv);
      }
  `}function idt(n,t){const e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1),r=cs();if(t)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${e}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${e}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${e}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${e}, uv);
    }
  `;const a=n.shapeInfo.logicalShape,i=a.length,o=n.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],d=l[1],f=Math.ceil(a[i-1]/2);let m=f*Math.ceil(a[i-2]/2),g="int b, int row, int col",b=`b * ${m} + (row / 2) * ${f} + (col / 2)`;for(let x=2;x<i-1;x++)g=`int b${x}, `+g,m*=a[i-x-1],b=`b${x} * ${m} + `+b;return`
    vec4 ${s}(${g}) {
      int index = ${b};
      int texR = index / ${d};
      int texC = index - texR * ${d};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}, ${c});
      return ${r.texture2D}(${e}, uv);
    }
  `}function odt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=e[3],i=e[2]*a,o=e[1]*i,{newShape:l,keptDims:c}=ui(e);if(l.length<e.length){const T=xh(n,l),C=["row","col","depth","depth2"];return`
      ${yh(T,t)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${vh(C,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${i}, ${a}, 1)));
        ${bh(n)}
      }
    `;const d=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,m=f[0],g=f[1],b=`int stride2 = ${s}Shape[3];`,x=`int stride1 = ${s}Shape[2] * stride2;`,v=`int stride0 = ${s}Shape[1] * stride1;`;if(g===o&&d==null)return t?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${b}
        ${x}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(g===a&&d==null)return t?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${e[1]*e[2]}, ${e[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;const w=zl(s);return t?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${b}
      ${x}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${w});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${m}, ${g}, index + ${w});
      return sampleTexture(${s}, uv);
    }
  `}function ldt(n){const t=n.shapeInfo.logicalShape,e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t[4],a=t[3]*r,i=t[2]*a,o=t[1]*i,{newShape:l,keptDims:c}=ui(t);if(l.length<t.length){const x=xh(n,l),v=["row","col","depth","depth2","depth3"];return`
      ${yh(x)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${vh(v,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${i}, ${a}, ${r})) +
          depth3;
        ${bh(n)}
      }
    `;const d=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,m=f[0],g=f[1];if(g===o&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${a}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${m}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(g===r&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${m}.0);
        return sampleTexture(${e}, uv);
      }
    `;const b=zl(e);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} + depth * ${a} +
          depth2 * ${r} + depth3 + ${b};
      vec2 uv = uvFromFlat(${m}, ${g}, index);
      return sampleTexture(${e}, uv);
    }
  `}function udt(n){const t=n.shapeInfo.logicalShape,e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1),{newShape:r,keptDims:a}=ui(t);if(r.length<t.length){const v=xh(n,r),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${yh(v)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${vh(w,a)});
      }
    `}const i=t[5],o=t[4]*i,l=t[3]*o,c=t[2]*l,d=t[1]*c;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${d}, ${c}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${bh(n)}
      }
    `;const f=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],b=m[1];if(b===d&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${o}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${b}.0, ${g}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(b===i&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${b}.0, ${g}.0);
        return sampleTexture(${e}, uv);
      }
    `;const x=zl(e);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${d} + col * ${c} + depth * ${l} +
          depth2 * ${o} + depth3 * ${i} + depth4 + ${x};
      vec2 uv = uvFromFlat(${g}, ${b}, index);
      return sampleTexture(${e}, uv);
    }
  `}function bh(n){const t=n.name,e=ft(n.shapeInfo.logicalShape);return e<2?`return ${t};`:`
    for (int i = 0; i < ${e}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function cdt(n,t){const e=n.name,s=e.charAt(0).toUpperCase()+e.slice(1),r="get"+s+"AtOutCoords",a=n.shapeInfo.logicalShape.length,i=t.logicalShape.length,o=AP(n.shapeInfo.logicalShape,t.logicalShape),l=Te(i),c=i-a;let d;const f=["x","y","z","w","u","v"];a===0?d="":i<2&&o.length>=1?d="coords = 0;":d=o.map(T=>`coords.${f[T+c]} = 0;`).join(`
`);let m="";i<2&&a>0?m="coords":m=n.shapeInfo.logicalShape.map((T,C)=>`coords.${f[C+c]}`).join(", ");let g="return outputValue;";const x=ft(n.shapeInfo.logicalShape)===1,w=ft(t.logicalShape)===1;if(a===1&&!x&&!w)g=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(x&&!w)i===1?g=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:g=`
        return vec4(outputValue.x);
      `;else if(o.length){const T=a-2,C=a-1;o.indexOf(T)>-1&&o.indexOf(C)>-1?g="return vec4(outputValue.x);":o.indexOf(T)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(C)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${d}
      vec4 outputValue = get${s}(${m});
      ${g}
    }
  `}function hdt(n,t){const e=n.name,s=e.charAt(0).toUpperCase()+e.slice(1),r="get"+s+"AtOutCoords",a=t.texShape,i=n.shapeInfo.texShape,o=n.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!n.shapeInfo.isUniform&&o===l&&n.shapeInfo.flatOffset==null&&te(i,a))return`
      float ${r}() {
        return sampleTexture(${e}, resultUV);
      }
    `;const c=Te(l),d=AP(n.shapeInfo.logicalShape,t.logicalShape),f=l-o;let m;const g=["x","y","z","w","u","v"];o===0?m="":l<2&&d.length>=1?m="coords = 0;":m=d.map(x=>`coords.${g[x+f]} = 0;`).join(`
`);let b="";return l<2&&o>0?b="coords":b=n.shapeInfo.logicalShape.map((x,v)=>`coords.${g[v+f]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${m}
      return get${s}(${b});
    }
  `}function Te(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function EC(n,t,e){const{newShape:s,keptDims:r}=ui(t),a=t.length,i=n&&a===3&&t[0]===1,o=i?t.slice(1):s,l=!n&&a>1&&!te(t,e)&&s.length<a||i;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:r}}function xh(n,t){const e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function vh(n,t){return t.map(e=>n[e]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ddt(n,t,e,s){const r=e.map((d,f)=>{const m={logicalShape:d.shape,texShape:d.isUniform?null:d.texData.texShape,isUniform:d.isUniform,isPacked:d.isUniform?!1:d.texData.isPacked,flatOffset:null};return d.texData!=null&&d.texData.slice!=null&&d.texData.slice.flatOffset>0&&(m.flatOffset=d.texData.slice.flatOffset),{name:t.variableNames[f],shapeInfo:m}}),a=r.map(d=>d.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},o=Aht(r,i,t),l=aht(n.gl,o),c=n.createProgram(l);return lt().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:a,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(c),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:a,outShapeInfo:i},OP(n,t,c)))}function OP(n,t,e){const s=[],r=[];let a,i,o,l=null,c=null;c=n.getUniformLocation(e,"NAN",!1),lt().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(e,"INFINITY",!1));const d=!1;for(const f of t.variableNames){const m={name:f,uniform:n.getUniformLocation(e,f,d),offset:n.getUniformLocation(e,`offset${f}`,d)};t.enableShapeUniforms&&(m.shape=n.getUniformLocation(e,`${f}Shape`,d),m.texShape=n.getUniformLocation(e,`${f}TexShape`,d)),s.push(m)}if(t.enableShapeUniforms&&(a=n.getUniformLocation(e,"outShape",d),o=n.getUniformLocation(e,"outShapeStrides",d),i=n.getUniformLocation(e,"outTexShape",d)),t.customUniforms)for(const f of t.customUniforms)r.push(n.getUniformLocation(e,f.name,d));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:i}}function ID(n,t){if(n.length!==t.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${t.length} inputs`);n.forEach((e,s)=>{const r=e.logicalShape,a=t[s],i=a.shape;if(!te(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(e.isUniform&&a.isUniform)return;const o=e.texShape,l=a.isUniform?null:a.texData.texShape;if(!te(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function fdt(n,t,e,s,r){t.program.enableShapeUniforms||(ID(t.inShapeInfos,e),ID([t.outShapeInfo],[s]));const a=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(a.texture,i[0],i[1]):n.setOutputMatrixTexture(a.texture,i[0],i[1]),n.setProgram(t.webGLProgram),n.bindVertexArray(t.webGLProgram.vao),lt().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&n.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&n.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<e.length;++l){const c=e[l],{uniform:d,offset:f,shape:m,texShape:g}=t.variablesLocations[l];if(m){const{uniformShape:b}=EC(t.program.packedInputs,c.shape,c.texData.texShape);switch(b.length){case 1:n.gl.uniform1iv(m,new Int32Array(b));break;case 2:n.gl.uniform2iv(m,new Int32Array(b));break;case 3:n.gl.uniform3iv(m,new Int32Array(b));break;case 4:n.gl.uniform4iv(m,new Int32Array(b));break}}if(g&&n.gl.uniform2i(g,c.texData.texShape[0],c.texData.texShape[1]),d!=null){if(c.isUniform){if(ft(c.shape)<2)n.gl.uniform1f(d,c.uniformValues[0]);else{let b=c.uniformValues;b instanceof Float32Array||(b=new Float32Array(b)),n.gl.uniform1fv(d,b)}continue}c.texData.slice!=null&&f!=null&&n.gl.uniform1i(f,c.texData.slice.flatOffset),n.setInputMatrixTexture(c.texData.texture.texture,d,l)}}const o=t.outShapeLocation;if(o)switch(s.shape.length){case 1:n.gl.uniform1iv(o,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(o,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(o,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(o,new Int32Array(s.shape));break}if(t.outShapeStridesLocation){const l=Ft(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&n.gl.uniform2i(t.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),t.program.customUniforms&&r)for(let l=0;l<t.program.customUniforms.length;++l){const c=t.program.customUniforms[l],d=t.customUniformLocations[l],f=r[l];if(c.type==="float")n.gl.uniform1fv(d,f);else if(c.type==="vec2")n.gl.uniform2fv(d,f);else if(c.type==="vec3")n.gl.uniform3fv(d,f);else if(c.type==="vec4")n.gl.uniform4fv(d,f);else if(c.type==="int")n.gl.uniform1iv(d,f);else if(c.type==="ivec2")n.gl.uniform2iv(d,f);else if(c.type==="ivec3")n.gl.uniform3iv(d,f);else if(c.type==="ivec4")n.gl.uniform4iv(d,f);else throw Error(`uniform type ${c.type} is not supported yet.`)}n.executeProgram()}function pdt(n,t,e){let s="";t.concat(e).forEach(i=>{const o=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:c,uniformShape:d,keptDims:f}=EC(n.packedInputs,i.shape,l);let m="",g="",b="";if(d.length===1&&n.packedInputs){const $=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];m=`${$[0]>1}_${$[1]>1}`}else if(d.length===2&&!n.packedInputs)g=`${d[0]>1}_${d[1]>1}`;else if(d.length>2&&!n.packedInputs){const $=Ft(d);b=`${$[0]===l[1]}_${$[$.length-1]===l[1]}`}const x=i.shape.length,v=d.length===2&&te(i.shape,l),w=ft(i.shape)===1,T=yl(i.shape,e.shape),C=!n.packedInputs&&x===e.shape.length&&te(l,e.texData.texShape),k=n.packedInputs||d.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${x}_${C}_${c?f:""}_${d.length}_${w}_${T}_${v}_${m}_${g}_${b}_${k}_${o}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${o}`}});const r=n.userCode;let a=n.constructor.name;return a+="_"+s+"_"+r+`${lt().getNumber("WEBGL_VERSION")}`,a}function Zn(n){return lt().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mdt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Cf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=cs();this.outputShape=t,this.enableShapeUniforms=Zn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?$x(["r","c","d"],t):Ml(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${e.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gdt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Cf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=cs();this.outputShape=t,this.enableShapeUniforms=Zn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?$x(["r","c","d"],t):Ml(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${e.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ydt{constructor(t){this.variableNames=["A"],this.outTexUsage=Js.DOWNLOAD;const e=cs();this.outputShape=t,this.userCode=`
      ${IP}

      void main() {
        float x = getAAtOutCoords();
        ${e.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bdt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Js.DOWNLOAD;const e=cs();this.outputShape=t,this.userCode=`
      ${IP}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${e.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xdt={R:0,G:1,B:2,A:3};class AD{constructor(t,e=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=cs();this.outputShape=t,this.enableShapeUniforms=Zn(this.outputShape.length);let a="result";e&&(a="floor(result * 255. + 0.5)");let i="";for(let o=0;o<s.length;o++){const l=s[o];i+=`
          if(offset == ${o}) {
            result = values[${xdt[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?$C():kC(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vdt{constructor(t,e=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=cs();this.outputShape=t,this.enableShapeUniforms=Zn(this.outputShape.length);let r="",a="result";e&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let o=0;o<=1;o++){const l=i*2+o;r+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?$C():kC(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${a};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wdt(n){const t=cs(),e=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return rht(n,e)}function Sdt(n){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return uht(n,t)}function Tdt(n){const t=new Uint16Array([0,1,2,2,1,3]);return cht(n,t)}function vm(n,t,e,s,r,a){dht(t,e);const i=hht(n),o=n.TEXTURE_2D;return kt(n,()=>n.bindTexture(o,i)),kt(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),kt(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),kt(n,()=>n.texParameteri(o,n.TEXTURE_MIN_FILTER,n.NEAREST)),kt(n,()=>n.texParameteri(o,n.TEXTURE_MAG_FILTER,n.NEAREST)),lt().getNumber("WEBGL_VERSION")===1?kt(n,()=>n.texImage2D(o,0,s,t,e,0,r,a,null)):kt(n,()=>n.texStorage2D(o,1,s,t,e)),kt(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:i,texShape:[e,t]}}function _P(n){return n.internalFormatFloat}function Ndt(n,t,e,s){const[r,a]=bm(t,e);return vm(n,r,a,_P(s),s.textureFormatFloat,n.FLOAT)}function FP(n){return n.internalFormatHalfFloat}function Cdt(n,t,e,s){const[r,a]=bm(t,e);return vm(n,r,a,FP(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function LP(n){return n.downloadTextureFormat}function kdt(n,t,e,s){const[r,a]=bm(t,e);return vm(n,r,a,LP(s),n.RGBA,n.UNSIGNED_BYTE)}function MP(n){return n.internalFormatPackedFloat}function $dt(n,t,e,s){const[r,a]=gh(t,e);return vm(n,r,a,MP(s),n.RGBA,n.FLOAT)}function zP(n){return n.internalFormatPackedHalfFloat}function Edt(n,t,e,s){const[r,a]=gh(t,e);return vm(n,r,a,zP(s),n.RGBA,s.textureTypeHalfFloat)}function Idt(n,t,e){return kt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),kD(n,t,"clipSpacePos",e,3,20,0)&&kD(n,t,"uv",e,2,20,12)}function Adt(n,t,e,s,r,a){kt(n,()=>n.bindTexture(n.TEXTURE_2D,t));let i,o,l;r instanceof Uint8Array?(i=new Uint8Array(e*s*4),o=n.UNSIGNED_BYTE,l=n.RGBA):(i=new Float32Array(e*s*4),o=n.FLOAT,l=a.internalFormatPackedFloat),i.set(r),lt().getNumber("WEBGL_VERSION")===2?kt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,s,n.RGBA,o,i)):kt(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,e,s,0,n.RGBA,o,i)),kt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Rdt(n,t,e){kt(n,()=>n.bindTexture(n.TEXTURE_2D,t)),e.data instanceof Uint8Array?lt().getNumber("WEBGL_VERSION")===2?kt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.width,e.height,n.RGBA,n.UNSIGNED_BYTE,e.data)):kt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,e.data)):lt().getNumber("WEBGL_VERSION")===2?kt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,e)):kt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e)),kt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Ddt(n,t,e,s){const r=n.createBuffer();kt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,r));const o=4*4*t*e;return kt(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,o,n.STREAM_READ)),kt(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,0)),kt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),r}function Odt(n,t,e){const s=n,r=new Float32Array(e);return s.bindBuffer(s.PIXEL_PACK_BUFFER,t),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function _dt(n,t,e,s){const[r,a]=bm(t,e),i=4,o=new Uint8Array(Zct(t*e,i));return kt(n,()=>n.readPixels(0,0,r,a,s.downloadTextureFormat,n.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function Fdt(n,t,e,s,r,a,i,o){const l=n,c=new Float32Array(Qct(a,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Ldt(n,t,e){const s=new Float32Array(t*e*4);return kt(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iw{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const e=lt().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,Kct(e,t)):this.gl=qr(e),t=this.gl,lt().getNumber("WEBGL_VERSION")===2){const a=t;this.createVertexArray=()=>kt(a,()=>a.createVertexArray()),this.bindVertexArray=i=>kt(a,()=>a.bindVertexArray(i)),this.deleteVertexArray=i=>kt(a,()=>a.deleteVertexArray(i)),this.getVertexArray=()=>kt(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(t!=null){const a=t.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>kt(t,()=>a.createVertexArrayOES()),this.bindVertexArray=i=>kt(t,()=>a.bindVertexArrayOES(i)),this.deleteVertexArray=i=>kt(t,()=>a.deleteVertexArrayOES(i)),this.getVertexArray=()=>kt(t,()=>t.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),lt().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Zg(this.gl,a),Sr(this.gl,i))this.textureHalfFloatExtension=Zg(this.gl,i);else if(lt().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Sr(this.gl,r))this.colorBufferHalfFloatExtension=Zg(this.gl,r);else if(lt().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Sr(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Sr(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Sdt(this.gl),this.indexBuffer=Tdt(this.gl),this.framebuffer=fht(this.gl),this.textureConfig=CC(this.gl,this.textureHalfFloatExtension)}get debug(){return lt().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;kt(t,()=>t.finish()),kt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),kt(t,()=>t.deleteFramebuffer(this.framebuffer)),kt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),kt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),kt(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),Ndt(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),Cdt(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),kdt(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),Rdt(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,s,r){this.throwIfDisposed(),Adt(this.gl,t,e,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),Edt(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),$dt(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&($D(this.gl,this.framebuffer),this.outputTexture=null),kt(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,s){return this.downloadMatrixDriver(t,()=>_dt(this.gl,e,s,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,s,r,a,i){return Fdt(this.gl,t,e,s,r,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return Odt(this.gl,t,e)}createBufferFromTexture(t,e,s){this.bindTextureToFrameBuffer(t);const r=Ddt(this.gl,e,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,s;if(lt().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),s=()=>{const i=r.clientWaitSync(a,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},e=a}else lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(e,lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:e,isFencePassed:s}}downloadMatrixFromPackedTexture(t,e,s){return this.downloadMatrixDriver(t,()=>Ldt(this.gl,e,s))}createProgram(t){this.throwIfDisposed();const e=this.gl;this.vertexShader==null&&(this.vertexShader=wdt(e));const s=oht(e);kt(e,()=>e.attachShader(s,this.vertexShader)),kt(e,()=>e.attachShader(s,t)),lht(e,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&Cw(e,r),r}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const e=this.gl;kt(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Idt(e,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(kt(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Cw(this.gl,this.program),kt(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,s=!0){return this.throwIfDisposed(),s?mht(this.gl,t,e):ght(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),kt(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,s){this.throwIfDisposed(),this.throwIfNoProgram(),yht(this.gl,t,e,s)}setOutputMatrixTexture(t,e,s){this.setOutputMatrixTextureDriver(t,s,e)}setOutputPackedMatrixTexture(t,e,s){this.throwIfDisposed();const[r,a]=gh(e,s);this.setOutputMatrixTextureDriver(t,r,a)}setOutputMatrixWriteRegion(t,e,s,r){this.setOutputMatrixWriteRegionDriver(s,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Cw(this.gl,this.program),Qg(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}kt(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),kt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Zg(this.gl,lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,a),a}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const e=this.gl,s=this.getQueryTimerExtensionWebGL2();e.endQuery(s.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await nS(()=>this.disposed||this.isQueryAvailable(t,lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(e===0)return null;if(e===2){const s=this.gl;return s.getQueryParameter(t,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(t,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(e===0)return!0;if(e===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.getQueryParameter(t,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(t,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=Mdt(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:s}=this.itemsToPoll[e];s()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in lt().platform&&(s=lt().platform.setTimeoutCustom.bind(lt().platform)),nS(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),kw(this.gl,t,this.framebuffer),this.debug&&Qg(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(kw(this.gl,this.outputTexture,this.framebuffer),this.debug&&Qg(this.gl)):$D(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const s=e();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(t,e,s){this.throwIfDisposed();const r=this.gl;kw(r,t,this.framebuffer),this.debug&&Qg(r),this.outputTexture=t,kt(r,()=>r.viewport(0,0,e,s)),kt(r,()=>r.scissor(0,0,e,s))}setOutputMatrixWriteRegionDriver(t,e,s,r){this.throwIfDisposed(),kt(this.gl,()=>this.gl.scissor(t,e,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Mdt(n){let t=0;for(;t<n.length&&n[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:zdt,bincountImpl:PP,bincountReduceImpl:Pdt,bitwiseAndImpl:Bdt,castImpl:Vdt,ceilImpl:Udt,concatImpl:Wdt,equalImpl:Gdt,expImpl:jdt,expm1Impl:Hdt,floorImpl:qdt,gatherNdImpl:Kdt,gatherV2Impl:Xdt,greaterImpl:Ydt,greaterEqualImpl:Zdt,lessImpl:Qdt,lessEqualImpl:Jdt,linSpaceImpl:tft,logImpl:eft,maxImpl:nft,maximumImpl:sft,minimumImpl:rft,multiplyImpl:aft,negImpl:ift,notEqualImpl:oft,prodImpl:lft,raggedGatherImpl:uft,raggedRangeImpl:cft,raggedTensorToTensorImpl:hft,rangeImpl:dft,rsqrtImpl:fft,scatterImpl:pft,sigmoidImpl:mft,simpleAbsImpl:BP,sliceImpl:gft,sparseFillEmptyRowsImpl:yft,sparseReshapeImpl:bft,sparseSegmentReductionImpl:VP,sqrtImpl:xft,staticRegexReplaceImpl:vft,stridedSliceImpl:wft,stringNGramsImpl:Sft,stringSplitImpl:Tft,stringToHashBucketFastImpl:Nft,subImpl:Cft,tileImpl:kft,topKImpl:$ft,transposeImpl:IC,uniqueImpl:Eft}=Rat;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UP(n,t){return["x","y","z","w","u","v"].slice(0,t).map(e=>`${n}.${e}`)}function is(n,t){return t===1?[n]:UP(n,t)}function Ift(n,t){if(n===1)return"rc";let e="";for(let s=0;s<n;s++)e+=t[s],s<n-1&&(e+=",");return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aft{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Zn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const e=is("rc",this.rank),s=Te(this.rank),r=this.getOutOfBoundsCondition(e),a=this.getSetup(e),i=this.getOutput(e);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(t){const e=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let a=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)a=`${t[t.length-1-i]},`+a;e.push(a)}return e}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let e="";for(let s=this.rank-2;s<this.rank;s++)e+=`${t[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(e+="||");return e}getSetup(t){if(this.rank===1)return"";const e=t.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${e[0]};
      int c = ${e[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(t){const e=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${e[0]}),
            cEdge ? 0. : getA(${e[1]}),
            rEdge ? 0. : getA(${e[2]}),
            rEdge || cEdge ? 0. : getA(${e[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WP{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Zn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),s+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Rft(e,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?$C():kC(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${s}

        setOutput(result);
      }
    `}}function Rft(n,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?Iht(["r","c","d"],"inputShape"):Ml(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dft{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,e,s){const r=DD(e,s),a=OD(t,r,s);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const i=RD(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[a].pop();return this.usedTextures[a].push(l),l}let o;return r===Fn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===Fn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===Fn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===Fn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===Fn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}releaseTexture(t,e,s,r){if(this.freeTextures==null)return;const a=DD(s,r),i=OD(e,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);const o=RD(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=lt().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(t),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const c=this.usedTextures[i],d=c&&c.indexOf(t);if(d==null||d<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[d]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Oft(n,t){const e=n;if(t===e.R32F)return 4;if(t===e.R16F)return 2;if(t===e.RGBA32F)return 16;if(t===n.RGBA)return 16;if(t===e.RGBA16F)return 8;if(t===e.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function RD(n,t,e,s,r){const a=_ft(t,s);let i;if(r){const[l,c]=gh(n[0],n[1]);i=l*c}else{const[l,c]=bm(n[0],n[1]);i=l*c}const o=Oft(e,a);return i*o}function _ft(n,t){switch(n){case Fn.PACKED_2X2_FLOAT32:return MP(t);case Fn.PACKED_2X2_FLOAT16:return zP(t);case Fn.UNPACKED_FLOAT32:return _P(t);case Fn.UNPACKED_FLOAT16:return FP(t);case Fn.PACKED_4X1_UNSIGNED_BYTE:return LP(t);default:throw new Error(`Unknown physical texture type ${n}`)}}function Fft(n){return lt().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Fn.PACKED_2X2_FLOAT32:Fn.UNPACKED_FLOAT32:n?Fn.PACKED_2X2_FLOAT16:Fn.UNPACKED_FLOAT16}function DD(n,t){if(n===Js.UPLOAD)return Fn.PACKED_2X2_FLOAT32;if(n===Js.RENDER||n==null)return Fft(t);if(n===Js.DOWNLOAD||n===Js.PIXELS)return Fn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function OD(n,t,e){return`${n[0]}_${n[1]}_${t}_${e}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oa{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Zn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${e}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Er="if (isnan(x)) return x;",Lft="return x;",_D="return abs(x);",Mft="return (x >= 0.0) ? x : (exp(x) - 1.0);",zft=Er+`
  return (x < 0.0) ? 0.0 : x;
`,Pft=Er+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Wi="return x;",Bft="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vft="return x;",Uft=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Wft=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Gft=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,jft="return 1.0 / (1.0 + exp(-1.0 * x));";class Hi{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Zn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${e}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hft{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Zn(this.outputShape.length);const e=t.length,s=is("rc",e),r=Te(e),a=Ift(e,s),i=s.slice(-2),o=e<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qft=tx,Kft=1e-7,Xft=1e-4,ey={};function Yft(n){return n in ey||(ey[n]={}),ey[n]}const Zft=lt().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Qft=600;function Jft(){return lt().global.screen==null?1024:lt().global.screen.height*lt().global.screen.width*window.devicePixelRatio*Qft/1024/1024}class Ex extends y0{nextDataId(){return Ex.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!lt().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let e;if(t!=null){if(t instanceof Iw)e=t;else{const s=qr(lt().getNumber("WEBGL_VERSION"),t);e=new Iw(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=qr(lt().getNumber("WEBGL_VERSION"));e=new Iw(s),this.binaryCache=Yft(lt().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=e,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Dft(this.gpgpu),this.numMBBeforeWarning=Jft(),this.texData=new W2(this,Lr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,e,s,r,a,i){const o=this.makeTensorInfo(e,s),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:t,texShape:[r,a]},l.texShape=[r,a];const c=Jg(e),d=new AD(c,!1,i),f=this.runWebGLProgram(d,[o],s,[[r,a]]);return f.shape=e,l.texture=null,this.disposeIntermediateTensorInfo(o),f.dataId}write(t,e,s){if((lt().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||lt().getBool("DEBUG"))&&this.checkNumericalProblems(t),s==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:e,dtype:s,values:t,usage:Js.UPLOAD,refCount:1}),r}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const e=this.texData.get(t);e.refCount++}decRef(t){if(this.texData.has(t)){const e=this.texData.get(t);e.refCount--}}move(t,e,s,r,a){if(lt().getBool("DEBUG")&&this.checkNumericalProblems(e),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:s,dtype:r,values:e,usage:Js.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const e=this.texData.get(t),{values:s,dtype:r,complexTensorInfos:a,slice:i,shape:o,isPacked:l}=e;if(i!=null){let m;l?m=new Hi(o,Wi):m=new oa(o,Wi);const g=this.runWebGLProgram(m,[{dataId:t,shape:o,dtype:r}],r),b=this.readSync(g.dataId);return this.disposeIntermediateTensorInfo(g),b}if(s!=null)return this.convertAndCacheOnCPU(t);if(r==="string")return s;const c=this.activeTimers!=null;let d;c&&(d=ns());let f;if(r==="complex64"){const m=this.readSync(a.real.dataId),g=this.readSync(a.imag.dataId);f=ai(m,g)}else f=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=ns()-d),this.convertAndCacheOnCPU(t,f)}async read(t){if(this.pendingRead.has(t)){const b=this.pendingRead.get(t);return new Promise(x=>b.push(x))}const e=this.texData.get(t),{values:s,shape:r,slice:a,dtype:i,complexTensorInfos:o,isPacked:l}=e;if(a!=null){let b;l?b=new Hi(r,Wi):b=new oa(r,Wi);const x=this.runWebGLProgram(b,[{dataId:t,shape:r,dtype:i}],i),v=this.read(x.dataId);return this.disposeIntermediateTensorInfo(x),v}if(s!=null)return this.convertAndCacheOnCPU(t);if(lt().getBool("DEBUG")&&!lt().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&lt().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,d;if(i!=="complex64"&&lt().get("WEBGL_BUFFER_SUPPORTED")){d=this.decode(t);const b=this.texData.get(d.dataId);c=this.gpgpu.createBufferFromTexture(b.texture.texture,...Yg(r))}this.pendingRead.set(t,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(i==="complex64"){const b=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),x=b[0],v=b[1];f=ai(x,v)}else if(c==null)f=this.getValuesFromTexture(t);else{const b=ft(r);f=this.gpgpu.downloadFloat32MatrixFromBuffer(c,b)}if(d!=null&&this.disposeIntermediateTensorInfo(d),c!=null){const b=this.gpgpu.gl;kt(b,()=>b.deleteBuffer(c))}const m=this.convertAndCacheOnCPU(t,f),g=this.pendingRead.get(t);return this.pendingRead.delete(t),g.forEach(b=>b(m)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Lr().removeDataId(t,this),this.pendingDeletes--),m}readToGPU(t,e={}){const s=this.texData.get(t),{values:r,shape:a,slice:i,dtype:o,isPacked:l,texture:c}=s;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let g;l?g=new Hi(a,Wi):g=new oa(a,Wi);const b=this.runWebGLProgram(g,[{dataId:t,shape:a,dtype:o}],o),x=this.readToGPU(b,e);return this.disposeIntermediateTensorInfo(b),x}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const d=this.decode(t,e.customTexShape),f=Lr().makeTensorFromTensorInfo(d),m=this.texData.get(d.dataId);return Object.assign({tensorRef:f},m.texture)}bufferSync(t){const e=this.readSync(t.dataId);if(t.dtype==="string")try{const s=e.map(r=>ni(r));return Ht(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ht(t.shape,t.dtype,e)}checkNumericalProblems(t){if(t!=null)for(let e=0;e<t.length;e++){const s=t[e];if(!nht(s))throw lt().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:e,dtype:s,isPacked:r}=this.texData.get(t),a=ft(e);if(lt().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const m=this.decode(t),g=this.texData.get(m.dataId),b=this.gpgpu.downloadMatrixFromPackedTexture(g.texture.texture,...Yg(e)).subarray(0,a);return this.disposeIntermediateTensorInfo(m),b}const i=lt().getBool("WEBGL_PACK")&&r===!0,o=i?Jg(e):e,l=i?new bdt(o):new ydt(o),c=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:t}],"float32"),d=this.texData.get(c.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture.texture,d.texShape[0],d.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),f}timerAvailable(){return lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const e=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,t();const a=ya(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=ya(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=e,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(a);o.kernelMs=v3(l),o.getExtraProfileInfo=()=>l.map((c,d)=>({name:i[d],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ns(),endMs:null}}endTimer(t){return lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=ns(),t)}async getQueryTime(t){if(lt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t,e=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:s}=this.texData.get(t);return s!=null&&(this.disposeData(s.real.dataId,e),this.disposeData(s.imag.dataId,e)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:e,dtype:s,texShape:r,usage:a,isPacked:i,slice:o}=this.texData.get(t),l=o&&o.origDataId||t,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),e!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(e,r,a,i)));const d=this.texData.get(t);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,e=Zft){return lt().getBool("WEBGL_CPU_FORWARD")&&t.every(s=>this.texData.get(s.dataId).texture==null&&ft(s.shape)<e)}getGPGPUContext(){return this.gpgpu}where(t){Ys("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return qft(t.shape,e)}packedUnaryOp(t,e,s){const r=new Hi(t.shape,e),a=this.compileAndRun(r,[t],s);return Lr().makeTensorFromTensorInfo(a)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const r=BP(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,r)}if(lt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,_D,t.dtype);const e=new oa(t.shape,_D),s=this.compileAndRun(e,[t]);return Lr().makeTensorFromTensorInfo(s)}makeTensorInfo(t,e,s){let r;if(e==="string"&&s!=null&&s.length>0&&ia(s[0])){const a=s.map(i=>ha(i));r=this.write(a,t,e)}else r=this.write(s,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e,s){return Lr().makeTensorFromTensorInfo(this.makeTensorInfo(t,e,s),this)}unpackTensor(t){const e=new Hft(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new Aft(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const s=[ac(t.shape),...ic(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},a=[ac(e),...ic(e)],i=new WP(a,s),o=!0,l=[s],c=this.runWebGLProgram(i,[r],t.dtype,l,o);return{dataId:c.dataId,shape:e,dtype:c.dtype}}decode(t,e){const s=this.texData.get(t),{isPacked:r,shape:a,dtype:i}=s;if(e!=null){const m=ft(a),g=e[0]*e[1]*4;F(m<=g,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=Jg(a);let l;r?l=new gdt(o):l=new mdt(o);const c=!0,d=[e??Yg(o)],f=this.runWebGLProgram(l,[{shape:o,dtype:i,dataId:t}],i,d,c,e);return{dtype:i,shape:a,dataId:f.dataId}}runWebGLProgram(t,e,s,r,a=!1,i){const o=this.makeTensorInfo(t.outputShape,s),l=this.texData.get(o.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===Cf.DENSE){const w=i??Yg(t.outputShape);l.texShape=w.map(T=>T*2)}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),ft(o.shape)===0)return l.values=kn(o.dtype,0),o;const c=[],d=e.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let T=this.texData.get(w.dataId);if(T.texture==null){if(!t.packedInputs&&ft(w.shape)<=lt().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:T.values};t.packedInputs&&(T.isPacked=!0,T.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!T.isPacked!=!!t.packedInputs)w=T.isPacked?this.unpackTensor(w):this.packTensor(w),c.push(w),T=this.texData.get(w.dataId);else if(T.isPacked&&!n0(T.shape,w.shape)){const C=w,k=w.shape;w.shape=T.shape,w=this.packedReshape(w,k),c.push(w),T=this.texData.get(w.dataId),C.shape=k}return{shape:w.shape,texData:T,isUniform:!1}});this.uploadToGPU(o.dataId);const f={shape:o.shape,texData:l,isUniform:!1},m=pdt(t,d,f),g=this.getAndSaveBinary(m,()=>ddt(this.gpgpu,t,d,f)),b=this.activeTimers!=null;let x;b&&(x=this.startTimer()),lt().get("ENGINE_COMPILE_ONLY")||fdt(this.gpgpu,g,d,f,r),c.forEach(w=>this.disposeIntermediateTensorInfo(w)),b&&(x=this.endTimer(x),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(x)}));const v=lt().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const w=ns();w-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!lt().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){const w=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),w}return o}compileAndRun(t,e,s,r,a=!1){return s=s||e[0].dtype,this.runWebGLProgram(t,e,s,r,a)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(lt().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=it(()=>{if(!lt().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=lt().getBool("DEBUG");lt().set("DEBUG",!1);const e=this.abs(Lt(1e-8)).dataSync()[0];if(lt().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Kft:Xft}uploadToGPU(t){const e=this.texData.get(t),{shape:s,dtype:r,values:a,texture:i,usage:o,isPacked:l}=e;if(i!=null)return;const c=this.activeTimers!=null;let d;c&&(d=ns());let f=e.texShape;if(f==null&&(f=vht(s,l),e.texShape=f),a!=null){const m=Jg(s);let g,b=f[1],x=f[0];const v=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(l||!v)&&([b,x]=gh(f[0],f[1])),l?g=new vdt(m,v):g=new AD(m,v);const w=v?[x,b]:f,T=this.makeTensorInfo(w,r),C=this.texData.get(T.dataId);v?C.usage=Js.PIXELS:C.usage=Js.UPLOAD,C.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(T.dataId),b,x,a);const k=[[x,b]],I=this.runWebGLProgram(g,[T],r,k,!0),D=this.texData.get(I.dataId);e.texShape=D.texShape,e.isPacked=D.isPacked,e.usage=D.usage,lt().get("ENGINE_COMPILE_ONLY")?this.disposeData(I.dataId):(e.texture=D.texture,e.values=null,this.texData.delete(I.dataId)),this.disposeIntermediateTensorInfo(T),c&&(this.uploadWaitMs+=ns()-d)}else{const m=this.acquireTexture(f,o,r,l);e.texture=m}}convertAndCacheOnCPU(t,e){const s=this.texData.get(t),{dtype:r}=s;return e!=null&&(s.values=tpt(e,r)),s.values}acquireTexture(t,e,s,r){if(this.numBytesInGPU+=this.computeBytes(t,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*uf(e)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,e]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(e));return Promise.all(t)}else{for(const[,e]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(e),r(!0)}catch(a){throw a}});t.push(s)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await CN(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(EP(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:e,customUniformLocations:s,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:l}=OP(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=e,t.customUniformLocations=s,t.infLoc=r,t.nanLoc=a,t.outShapeLocation=i,t.outShapeStridesLocation=o,t.outTexShapeLocation=l}}createTensorFromGPUData(t,e,s){t.channels=t.channels||"RGBA";const{texture:r,height:a,width:i,channels:o}=t,l=Lr().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,e,s,a,i,o);return Lr().makeTensorFromDataId(c,e,s,l)}}Ex.nextDataId=0;function tpt(n,t){if(t==="float32"||t==="complex64")return n;if(t==="int32"||t==="bool"){const e=t==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<e.length;++s)e[s]=Math.round(n[s]);return e}else throw new Error(`Unknown dtype ${t}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J2()&&eT("webgl",()=>new Ex,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AC=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Cl{constructor(t,e,s){this.variableNames=["A","B"],this.outputShape=jt(e,s),this.enableShapeUniforms=Zn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class wh{constructor(t,e,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=jt(e,s);const a=this.outputShape.length;this.enableShapeUniforms=Zn(a);let i="";if(r)if(a===0||ft(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${Te(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=is("coords",a);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zs(n){const{inputs:t,backend:e}=n,{x:s}=t;return e.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const ept={kernelName:Oc,backendName:"webgl",kernelFunc:zs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function To(n){const{inputs:t,backend:e}=n,{real:s,imag:r}=t,a=e.makeTensorInfo(s.shape,"complex64"),i=e.texData.get(a.dataId),o=zs({inputs:{x:s},backend:e}),l=zs({inputs:{x:r},backend:e});return i.complexTensorInfos={real:o,imag:l},a}const npt={kernelName:k0,backendName:"webgl",kernelFunc:To};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GP="return (a < 0.) ? b * a : a;",jP=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function spt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{alpha:a}=s,i=e.makeTensorInfo([],"float32",ci(a,"float32")),o=lt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wh(jP,r.shape,i.shape):new Cl(GP,r.shape,i.shape),l=e.runWebGLProgram(o,[r,i],"float32");return e.disposeIntermediateTensorInfo(i),l}const rpt={kernelName:ap,backendName:"webgl",kernelFunc:spt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HP="return (a < 0.) ? b * a : a;",qP=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function apt(n){const{inputs:t,backend:e}=n,{x:s,alpha:r}=t,a=lt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wh(qP,s.shape,r.shape):new Cl(HP,s.shape,r.shape);return e.runWebGLProgram(a,[s,r],"float32")}const ipt={kernelName:Np,backendName:"webgl",kernelFunc:apt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sh="if (isnan(x)) return x;";function le({opSnippet:n,packedOpSnippet:t,cpuKernelImpl:e,dtype:s}){return({inputs:r,backend:a})=>{const{x:i}=r,o=a,l=s||i.dtype;if(o.shouldExecuteOnCPU([i])&&e!=null){const f=o.texData.get(i.dataId),m=e(f.values,l);return o.makeTensorInfo(i.shape,l,m)}const c=lt().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let d;return c?d=new Hi(i.shape,t):d=new oa(i.shape,n),o.runWebGLProgram(d,[i],l)}}function Un({opSnippet:n,packedOpSnippet:t,checkOutOfBounds:e=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:a}){return({inputs:i,backend:o})=>{const{a:l,b:c}=i,d=o;if(s&&l.dtype==="complex64"){const b=d.texData.get(l.dataId),x=d.texData.get(c.dataId),[v,w]=[[b.complexTensorInfos.real,x.complexTensorInfos.real],[b.complexTensorInfos.imag,x.complexTensorInfos.imag]].map(C=>{const[k,$]=C,I={dataId:k.dataId,dtype:k.dtype,shape:l.shape},D={dataId:$.dataId,dtype:$.dtype,shape:c.shape},_=new Cl(n,l.shape,c.shape);return d.runWebGLProgram(_,[I,D],ys(k.dtype,$.dtype))}),T=To({inputs:{real:v,imag:w},backend:d});return d.disposeIntermediateTensorInfo(v),d.disposeIntermediateTensorInfo(w),T}const f=a||ys(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||d.shouldExecuteOnCPU([l,c]))&&r!=null){const b=d.texData.get(l.dataId).values,x=d.texData.get(c.dataId).values,v=l.dtype==="string"?ii(b):b,w=l.dtype==="string"?ii(x):x,[T,C]=r(l.shape,c.shape,v,w,f),k=d.makeTensorInfo(C,f),$=d.texData.get(k.dataId);return $.values=T,k}const m=lt().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let g;return m?g=new wh(t,l.shape,c.shape,e):g=new Cl(n,l.shape,c.shape),d.runWebGLProgram(g,[l,c],f)}}function kf(n,t=!1){if(n==="linear")return t?Vft:Lft;if(n==="relu")return t?Wft:zft;if(n==="elu")return t?Uft:Mft;if(n==="relu6")return t?Gft:Pft;if(n==="prelu")return t?qP:HP;if(n==="leakyrelu")return t?jP:GP;if(n==="sigmoid")return t?jft:Bft;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KP{constructor(t,e,s,r=!1,a=!1,i=!1,o=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Zn(this.outputShape.length);const d=r?t[1]:t[2],f=Math.ceil(d/2),m=r?"i * 2, rc.y":"rc.y, i * 2",g=a?"rc.z, i * 2":"i * 2, rc.z",b=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],x=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",w="";o&&(l?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:c?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:v=`vec4 activation(vec4 x) {
          ${o}
        }`,w="result = activation(result);");const T=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let C="rc.x",k="rc.x";t[0]<e[0]?C=`imod(rc.x, ${t[0]})`:e[0]<t[0]&&(k=`imod(rc.x, ${e[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${C};
        int batchB = ${k};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${m});
          vec4 b = getMatrixB(batchB, ${g});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${b[0]} * ${x[0]});
          result += (${b[1]} * ${x[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${T}

        ${w}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FD={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class LD{constructor(t,e,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=jt(e,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MD="return a * b;";function RC(n){const{inputs:t,backend:e}=n,{a:s,b:r}=t,a=ys(s.dtype,r.dtype);if(s.dtype==="complex64"){const o=e.texData.get(s.dataId),l=e.texData.get(r.dataId),c=new LD(FD.REAL,s.shape,r.shape),d=new LD(FD.IMAG,s.shape,r.shape),f=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:s.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],m=e.runWebGLProgram(c,f,"float32"),g=e.runWebGLProgram(d,f,"float32"),b=To({inputs:{real:m,imag:g},backend:e});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),b}if(e.shouldExecuteOnCPU([s,r])){const o=e.texData.get(s.dataId),l=e.texData.get(r.dataId),[c,d]=aft(s.shape,r.shape,o.values,l.values,a),f=e.makeTensorInfo(d,a),m=e.texData.get(f.dataId);return m.values=c,f}let i;return lt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new wh(MD,s.shape,r.shape):i=new Cl(MD,s.shape,r.shape),e.runWebGLProgram(i,[s,r],a)}const opt={kernelName:Uc,backendName:"webgl",kernelFunc:RC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lpt(n,t,e){const s=[ac(n.shape),...ic(n.shape)],r={dtype:n.dtype,shape:s,dataId:n.dataId},a=[ac(t),...ic(t)],i=new WP(a,s),o=!0,l=[s],c=e.runWebGLProgram(i,[r],n.dtype,l,o);return{dataId:c.dataId,shape:t,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{shape:a}=s,i=e,o=ft(r.shape),l=j2(a,o),c=ft(l);F(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const d=i.texData.get(r.dataId);return d.isPacked&&!n0(r.shape,l)&&!(d.texture!==null&&n0(d.shape,l))?lpt(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const upt={kernelName:kp,backendName:"webgl",kernelFunc:Nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zD{constructor(t,e){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=t;this.outputShape=[r,i];const o=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(e!=null){const f=1/e;c=`sumValue += dot(values * ${hl(f)?f.toPrecision(2):f}, ones);`}let d="";a%s>0&&(d=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cpt{constructor(t,e){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=t;this.outputShape=[r,i];let o="0.0",l="";e==="prod"?o="1.0":e==="min"?(o="1.0 / 1e-20",l="min"):e==="max"&&(o="-1.0 / 1e-20",l="max");let c=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="sum"?c="sumValue":e==="prod"?c="prodValue":e==="all"?c="allValue":e==="any"&&(c="anyValue");const d=Math.floor(s/4)*4,f=s%4;let m=`
      if (${e==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${e==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${e==="min"} || ${e==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,g="vec4";e==="all"?(o="1.0",m=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,g="bvec4"):e==="any"&&(o="0.0",m=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,g="bvec4");let b="";a%s>0&&(b=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${b}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${m}
        }

        int inIdx = inOffset + ${d};
        if (${f===1}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${f===2}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${f===3}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${m}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hpt(n){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const e=t.length?t[t.length-1].outSize:n[1],s=dx(e);t.push({inSize:e,windowSize:s,outSize:Math.ceil(e/s)})}return t}function Bl(n,t,e,s){const r=hpt(n.shape);let a=n;for(let i=0;i<r.length;i++){const{inSize:o,windowSize:l,outSize:c}=r[i];let d,f;e==="mean"?d=i===0?new zD({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c},o):new zD({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c}):d=new cpt({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c},e),f=a,a=s.runWebGLProgram(d,[a],t),f.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(f)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dpt{constructor(t,e){this.variableNames=["A"];const s=new Array(t.length);for(let i=0;i<s.length;i++)s[i]=t[e[i]];this.outputShape=s,this.rank=s.length;const r=Te(this.rank),a=fpt(e);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function fpt(n){const t=n.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(t);for(let r=0;r<n.length;r++)s[n[r]]=e[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ppt{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(t.length);for(let d=0;d<s.length;d++)s[d]=t[e[d]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=Te(this.rank),a=UP("rc",this.rank),i=new Array(this.rank);for(let d=0;d<e.length;d++)i[e[d]]=a[d];const o=`vec2(${i.slice(-2).join()})`,l=`++${a[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${o})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ix(n,t,e){const s=lt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ppt(n.shape,t):new dpt(n.shape,t);return e.runWebGLProgram(s,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mpt(n,t,e,s){const r=t,a=n.shape.length,i=Zt(r,n.shape);let o=i;const l=We(o,a),c=l!=null;let d=n;c&&(d=Ix(n,l,s),o=tn(o.length,a)),Bn("sum",o,a);const[f,m]=In(d.shape,o);let g=f;e&&(g=Je(f,i));const b=ft(m),v=ft(n.shape)/b,w=Nt({inputs:{x:d},attrs:{shape:[v,b]},backend:s}),T=kb(n.dtype),C=Bl(w,T,"sum",s),k=Nt({inputs:{x:C},attrs:{shape:g},backend:s});return s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(C),c&&s.disposeIntermediateTensorInfo(d),k}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ax(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;return mpt(r,a,i,e)}const gpt={kernelName:Dp,backendName:"webgl",kernelFunc:Ax};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ls(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{perm:a}=s,i=e,o=r.shape.length,l=new Array(o);for(let d=0;d<l.length;d++)l[d]=r.shape[a[d]];let c;if(i.shouldExecuteOnCPU([r])){const f=i.texData.get(r.dataId).values,m=IC(f,r.shape,r.dtype,a,l);c=i.makeTensorInfo(l,r.dtype);const g=i.texData.get(c.dataId);g.values=m}else c=Ix(r,a,i);return c}const ypt={kernelName:ol,backendName:"webgl",kernelFunc:ls};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XP=1e3;function s0({a:n,b:t,transposeA:e,transposeB:s,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}){const c=n.shape.length,d=t.shape.length,f=e?n.shape[c-2]:n.shape[c-1],m=s?t.shape[d-1]:t.shape[d-2],g=e?n.shape[c-1]:n.shape[c-2],b=s?t.shape[d-2]:t.shape[d-1],x=n.shape.slice(0,-2),v=t.shape.slice(0,-2),w=ft(x),T=ft(v),k=jt(n.shape.slice(0,-2),t.shape.slice(0,-2)).concat([g,b]);F(f===m,()=>`Error in matMul: inner shapes (${f}) and (${m}) of Tensors with shapes ${n.shape} and ${t.shape} and transposeA=${e} and transposeB=${s} must match.`);const $=e?[w,f,g]:[w,g,f],I=s?[T,b,m]:[T,m,b],D=Nt({inputs:{x:n},backend:r,attrs:{shape:$}}),_=Nt({inputs:{x:t},backend:r,attrs:{shape:I}}),O=[D,_],L=Math.max(w,T),R=e?D.shape[1]:D.shape[2],V=a!=null,Y=i!=null,Q=l==="leakyrelu",tt=l!=null?kf(l,!0):null,B=V||Y||Q||tt!=null;let W;if((g===1||b===1)&&R>XP&&B===!1){let ot=D,P=_;e&&(ot=ls({inputs:{x:D},backend:r,attrs:{perm:[0,2,1]}}),O.push(ot)),s&&(P=ls({inputs:{x:_},backend:r,attrs:{perm:[0,2,1]}}),O.push(P));const j=b!==1,rt=b===1;let st=ot;j&&(st=Nt({inputs:{x:ot},backend:r,attrs:{shape:[L,R,1]}}),O.push(st));const mt=b===1?2:1;let gt=P;rt&&(gt=Nt({inputs:{x:P},backend:r,attrs:{shape:[L,1,R]}}),O.push(gt));const bt=RC({inputs:{a:st,b:gt},backend:r});W=Ax({inputs:{x:bt},backend:r,attrs:{axis:mt,keepDims:!0}}),O.push(bt)}else{const ot=ys(n.dtype,t.dtype),P=new KP($,I,[L,g,b],e,s,V,tt,Y,Q),j=[D,_];if(a!=null&&j.push(a),Y&&j.push(i),Q){const rt=r.makeTensorInfo([],"float32",ci(o,"float32"));j.push(rt),O.push(rt)}W=r.runWebGLProgram(P,j,ot)}const X=Nt({inputs:{x:W},backend:r,attrs:{shape:k}});O.push(W);for(const ot of O)r.disposeIntermediateTensorInfo(ot);return X}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bpt(n){const{inputs:t,backend:e,attrs:s}=n,{a:r,b:a,bias:i,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:d,leakyreluAlpha:f}=s;return s0({a:r,b:a,transposeA:l,transposeB:c,backend:e,bias:i,preluActivationWeights:o,leakyreluAlpha:f,activation:d})}const xpt={kernelName:cf,backendName:"webgl",kernelFunc:bpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PD="return abs(x);";function vpt(n){const{inputs:t,backend:e}=n,{x:s}=t;if(e.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const a=e.texData.get(s.dataId),i=BP(a.values);return e.makeTensorInfo(s.shape,s.dtype,i)}let r;return lt().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Hi(s.shape,PD):r=new oa(s.shape,PD),e.runWebGLProgram(r,[s],s.dtype)}const wpt={kernelName:Mf,backendName:"webgl",kernelFunc:vpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Spt=Er+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Tpt=le({opSnippet:Spt}),Npt={kernelName:fc,backendName:"webgl",kernelFunc:Tpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpt=Er+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,kpt=le({opSnippet:Cpt}),$pt={kernelName:pc,backendName:"webgl",kernelFunc:kpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BD="return a + b;",Ept=Un({opSnippet:BD,packedOpSnippet:BD,supportsComplex:!0,cpuKernelImpl:zdt}),Ipt={kernelName:Al,backendName:"webgl",kernelFunc:Ept};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Apt{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`float v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rpt{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`vec4 v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wy(n){const{inputs:t,backend:e}=n,s=t;if(s.length===1)return zs({inputs:{x:s[0]},backend:e});if(s.length>lt().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=wy({inputs:s.slice(0,l),backend:e}),d=wy({inputs:s.slice(l),backend:e});return wy({inputs:[c,d],backend:e})}const r=s.map(l=>l.dtype).reduce((l,c)=>ys(l,c)),a=s.map(l=>l.shape),o=lt().getBool("WEBGL_PACK")?new Rpt(s[0].shape,a):new Apt(s[0].shape,a);return e.runWebGLProgram(o,s,r)}const Dpt={kernelName:zf,backendName:"webgl",kernelFunc:wy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Opt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,o=r.shape.length,l=Zt(a,r.shape);let c=l;const d=We(c,o);let f=r;d!=null&&(f=ls({inputs:{x:r},backend:e,attrs:{perm:d}}),c=tn(c.length,o)),Bn("all",c,o);const[m,g]=In(f.shape,c),b=ft(g),x=Nt({inputs:{x:f},backend:e,attrs:{shape:[-1,b]}}),v=Bl(x,x.dtype,"all",e);let w;if(i){const T=Je(m,l);w=Nt({inputs:{x:v},backend:e,attrs:{shape:T}})}else w=Nt({inputs:{x:v},backend:e,attrs:{shape:m}});return e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v),d!=null&&e.disposeIntermediateTensorInfo(f),w}const _pt={kernelName:v0,backendName:"webgl",kernelFunc:Opt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,o=r.shape.length,l=Zt(a,r.shape);let c=l;const d=We(c,o);let f=r;d!=null&&(f=ls({inputs:{x:r},backend:e,attrs:{perm:d}}),c=tn(c.length,o)),Bn("any",c,o);const[m,g]=In(f.shape,c),b=ft(g),x=Nt({inputs:{x:f},backend:e,attrs:{shape:[-1,b]}}),v=Bl(x,x.dtype,"any",e);let w;if(i){const T=Je(m,l);w=Nt({inputs:{x:v},backend:e,attrs:{shape:T}})}else w=Nt({inputs:{x:v},backend:e,attrs:{shape:m}});return e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v),d!=null&&e.disposeIntermediateTensorInfo(f),w}const Lpt={kernelName:w0,backendName:"webgl",kernelFunc:Fpt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mpt{constructor(t,e,s){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:i}=t;s||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];const o=e==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zpt{constructor(t,e,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,F(t.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const a=t[t.length-1],i=Math.ceil(a/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,c=Te(l),d=is("coords",l);let f,m;if(i===1){m=l+1;const _=Te(m);f=`
        ${_} sourceLocR = ${_}(${d.join()}, 0);
        ++${d[l-1]};
        ${_} sourceLocG = ${_}(${d.join()}, 0);
        ++${d[l-2]};
        ${_} sourceLocA = ${_}(${d.join()}, 0);
        --${d[l-1]};
        ${_} sourceLocB = ${_}(${d.join()}, 0);
        --${d[l-2]};`}else m=l,f=`
        ${c} sourceLocR = coords;
        ++${d[l-1]};
        ${c} sourceLocG = coords;
        ++${d[l-2]};
        ${c} sourceLocA = coords;
        --${d[l-1]};
        ${c} sourceLocB = coords;
        --${d[l-2]};`;const g=["x","y","z","w","u","v"].slice(0,m),b="."+g[m-1],x=g.map(_=>"int "+_),v=is("sourceLocR",m-1).concat("inIdx.r"),w=is("sourceLocG",m-1).concat("inIdx.g"),T=is("sourceLocB",m-1).concat("inIdx.b"),C=is("sourceLocA",m-1).concat("inIdx.a"),k=s==="max"?"greaterThan":"lessThan",$=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${T.join()}),
                             getBestIndicesAChannel(${C.join()})));`,I=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${T.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${C.join()}) : 0.)`,D=r?"":`
      float getBestIndicesAChannel(${x.join()}) {
        return getChannel(getBestIndicesA(${g.join()}),
                                          vec2(${g.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${x.join()}) {
        return getChannel(getA(${g.join()}),
                               vec2(${g.slice(-2).join()}));
      }
      ${D}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${d[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${d[l-2]} < ${o[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${b}, sourceLocG${b},
          sourceLocB${b}, sourceLocA${b}) * ${e};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${I};

        for (int i = 0; i < ${e}; i++) {
          inIdx = srcIdx;
          ${$}
          vec4 candidate = ${I};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${k}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YP(n,t,e,s=null){let r=t.shape[0],a=t.shape[1];s!=null&&(r=s.shape[0],a=s.shape[1]);const i=dx(a),o={windowSize:i,inSize:a,batchSize:r,outSize:Math.ceil(a/i)},l=new Mpt(o,e,s==null),c=[t];s!=null&&c.push(s);const d=n.runWebGLProgram(l,c,"int32");if(d.shape[1]===1)return d;const f=YP(n,t,e,d);return n.disposeIntermediateTensorInfo(d),f}function ZP(n,t,e,s=null){const r=s!=null?s.shape:t.shape,a=r[r.length-1],i=dx(a),o=new zpt(r,i,e,s==null),l=s==null?[t]:[t,s],c=n.runWebGLProgram(o,l,"int32");if(c.shape.length===t.shape.length){const d=ZP(n,t,e,c);return n.disposeIntermediateTensorInfo(c),d}return c}function QP(n,t,e,s){const r=[e];if(Bn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,t.shape.length),!lt().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const a=[],i=n.texData.get(t.dataId),o=i!==null&&i.isPacked;let l=t;o&&(l=n.unpackTensor(t),a.push(l));const[c,d]=In(l.shape,r),f=ft(d),m=Nt({inputs:{x:l},backend:n,attrs:{shape:[-1,f]}});a.push(m);const g=YP(n,m,s);a.push(g);const b=Nt({inputs:{x:g},backend:n,attrs:{shape:c}});return a.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}return ZP(n,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a}=s;let i=Zt(a,r.shape);const o=We(i,r.shape.length);let l=r;const c=[];o!=null&&(l=ls({inputs:{x:r},backend:e,attrs:{perm:o}}),c.push(l),i=tn(i.length,l.shape.length)),Bn("argMax",[i[0]],l.shape.length);const d=QP(e,l,i[0],"max");return c.forEach(f=>e.disposeIntermediateTensorInfo(f)),d}const Bpt={kernelName:Pf,backendName:"webgl",kernelFunc:Ppt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a}=s;let i=Zt(a,r.shape);const o=We(i,r.shape.length);let l=r;const c=[];o!=null&&(l=ls({inputs:{x:r},backend:e,attrs:{perm:o}}),c.push(l),i=tn(i.length,l.shape.length)),Bn("argMin",[i[0]],l.shape.length);const d=QP(e,l,i[0],"min");return c.forEach(f=>e.disposeIntermediateTensorInfo(f)),d}const Upt={kernelName:Bf,backendName:"webgl",kernelFunc:Vpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wpt=Er+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Gpt=le({opSnippet:Wpt}),jpt={kernelName:mc,backendName:"webgl",kernelFunc:Gpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hpt=Er+"return log(x + sqrt(x * x + 1.0));",qpt=le({opSnippet:Hpt}),Kpt={kernelName:gc,backendName:"webgl",kernelFunc:qpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xpt=Er+`
  return atan(x);
`,Ypt=le({opSnippet:Xpt}),Zpt={kernelName:yc,backendName:"webgl",kernelFunc:Ypt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qpt=AC+`
  return atan(a, b);
`,Jpt=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Pl+`
  return result;
`,tmt=Un({opSnippet:Qpt,packedOpSnippet:Jpt}),emt={kernelName:xc,backendName:"webgl",kernelFunc:tmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nmt=Er+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,smt=le({opSnippet:nmt}),rmt={kernelName:bc,backendName:"webgl",kernelFunc:smt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $f{constructor(t,e,s,r=!1,a=!1){if(this.variableNames=["x"],e==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,o=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,d=t.dilationWidth,f=t.effectiveFilterHeight,m=t.effectiveFilterWidth,g=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;const x=e==="avg",v=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,w=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let T="0.0";if(x||(T="-1.0 / 1e-20"),s){const _=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${g}, ${b});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${m};
                wC += ${d}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${_} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?v:w:`wR * ${m} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let k=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(k="avgValue / max(count, 1.0)");const $=Math.floor(i/4)*4,I=i%4,D=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${g}, ${b});
      const float initializationValue = ${T};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${T});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${$}; wC += 4) {
            int xC = xCCorner + wC * ${d};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              getValue(batch, xR, xC + 3 * ${d}, d)
            );

            ${D}
          }

          int xC = xCCorner + ${$};
          if (${I===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${D}
          } else if (${I===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              initializationValue,
              initializationValue
            );

            ${D}
          } else if (${I===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              initializationValue
            );

            ${D}
          }
        }
        setOutput(${k});
      }
    `}}class DC{constructor(t,e,s,r=!1,a=!1){if(this.variableNames=["x"],e==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,o=t.strideDepth,l=t.strideHeight,c=t.strideWidth,d=t.dilationDepth,f=t.dilationHeight,m=t.dilationWidth,g=t.effectiveFilterDepth,b=t.effectiveFilterHeight,x=t.effectiveFilterWidth,v=t.padInfo.front,w=t.padInfo.top,T=t.padInfo.left;this.outputShape=t.outShape;const C=e==="avg";let k="0.0";if(C||(k="-1.0 / 1e-20"),s){const L=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${c});
        const ivec3 pads = ivec3(${v}, ${w}, ${T});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${g};
              wD += ${d}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${b};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${x};
                  wC += ${m}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${L} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${b} * ${x} +
                      wR * ${x} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let I=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(I="avgValue / max(count, 1.0)");const D=Math.floor(i/4)*4,_=i%4,O=`
      if (${C}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${c});
      const ivec3 pads = ivec3(${v}, ${w}, ${T});
      const float initializationValue = ${k};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${k});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${g};
            wD += ${d}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${b};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${D}; wC += 4) {
              int xC = xCCorner + wC * ${m};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                getValue(batch, xD, xR, xC + 3 * ${m}, ch)
              );

              ${O}
            }

            int xC = xCCorner + ${D};
            if (${_===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${O}
            } else if (${_===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                initializationValue,
                initializationValue
              );

              ${O}
            } else if (${_===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                initializationValue
              );

              ${O}
            }
          }
        }
        setOutput(${I});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function amt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;xm(r,"avgPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;F(Pn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=kr(r.shape,a,i,c,o,l);if(d.filterWidth===1&&d.filterHeight===1&&te(d.inShape,d.outShape))return zs({inputs:{x:r},backend:e});const f=new $f(d,"avg",!1);return e.runWebGLProgram(f,[r],"float32")}const imt={kernelName:Vf,backendName:"webgl",kernelFunc:amt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function omt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=s,d=[1,1,1],f=hi(r.shape,a,i,d,o,l,c),m=new DC(f,"avg",!1);return e.runWebGLProgram(m,[r],"float32")}const lmt={kernelName:Uf,backendName:"webgl",kernelFunc:omt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class umt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,s=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,d=l-1-t.padInfo.top,f=c-1-t.padInfo.left,m=1/(e*s);this.userCode=`
      const ivec2 pads = ivec2(${d}, ${f});
      const float avgMultiplier = float(${m});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class cmt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,s=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,d=t.dilationWidth,f=t.effectiveFilterDepth,m=t.effectiveFilterHeight,g=t.effectiveFilterWidth,b=f-1-t.padInfo.front,x=m-1-t.padInfo.top,v=g-1-t.padInfo.left,w=1/(e*s*r);this.userCode=`
      const ivec3 pads = ivec3(${b}, ${x}, ${v});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${m};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${g};
                wC += ${d}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hmt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,i=a,{filterSize:o,strides:l,pad:c,dimRoundingMode:d}=s,f=[1,1,1],m=hi(i.shape,o,l,f,c,d),g=new cmt(m);return e.runWebGLProgram(g,[r],i.dtype)}const dmt={kernelName:T0,backendName:"webgl",kernelFunc:hmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fmt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,i=a;xm([r,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=s,d=kr(i.shape,o,l,1,c),f=new umt(d);return e.runWebGLProgram(f,[r],i.dtype)}const pmt={kernelName:S0,backendName:"webgl",kernelFunc:fmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mmt(n){const{inputs:t,backend:e,attrs:s}=n,{a:r,b:a}=t,{transposeA:i,transposeB:o}=s;return s0({a:r,b:a,transposeA:i,transposeB:o,backend:e})}const gmt={kernelName:Wf,backendName:"webgl",kernelFunc:mmt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ymt{constructor(t,e,s,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],jt(t,e),jt(t,s);let o="0.0";r!=null&&(jt(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";a!=null&&(jt(t,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bmt{constructor(t,e,s,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],jt(t,e),jt(t,s);let o="vec4(0.0)";r!=null&&(jt(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";a!=null&&(jt(t,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xmt=({inputs:n,backend:t,attrs:e})=>{const{x:s,mean:r,variance:a,offset:i,scale:o}=n;F(r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=e;l==null&&(l=.001);const c=[s,r,a];let d=null;i!=null&&(d=i.shape,c.push(i));let f=null;o!=null&&(f=o.shape,c.push(o));const m=lt().getBool("WEBGL_PACK_NORMALIZATION")?new bmt(s.shape,r.shape,a.shape,d,f,l):new ymt(s.shape,r.shape,a.shape,d,f,l);return t.runWebGLProgram(m,c,c[0].dtype)},vmt={kernelName:np,backendName:"webgl",kernelFunc:xmt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wmt{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=Te(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Smt(this.rank);let r;const a=t.map((i,o)=>`sourceLoc.${qS[o]} = start[${o}] + coords.${qS[o]};`);r=`
        ${e} sourceLoc;
        ${e} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const qS=["x","y","z","w","u","v"];function Smt(n){if(n===1)return"sourceLoc";if(n<=6)return qS.slice(0,n).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tmt{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=Te(this.rank),s=is("coords",this.rank),r=is("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${a})`,o=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${t[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${e}(${t.map((d,f)=>`start[${f}]`).join()});`:t.map((d,f)=>`${r[f]} = ${s[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${e} coords = getOutputCoords();
        ${e} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nmt(n,t,e,s){const r=s.texData.get(n.dataId),a=s.makeTensorInfo(e,n.dtype),i=s.texData.get(a.dataId);Object.assign(i,r),i.refCount=1,i.shape=e,i.dtype=n.dtype;let o=TN(t,Ft(n.shape));r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||n.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),a}function Th(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{begin:a,size:i}=s,[o,l]=hx(r,a,i);if(vN(r,o,l),ft(l)===0)return e.makeTensorInfo(l,r.dtype,[]);if(e.shouldExecuteOnCPU([r])||r.dtype==="string"){const f=e.texData.get(r.dataId),m=gft(f.values,o,l,r.shape,r.dtype);return e.makeTensorInfo(l,r.dtype,m)}const{isPacked:c}=e.texData.get(r.dataId),d=SN(r.shape,o,l);if(c||!d){const f=lt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Tmt(l):new wmt(l),m=[o];return e.runWebGLProgram(f,[r],r.dtype,m)}return e.uploadToGPU(r.dataId),Nmt(r,o,l,e)}const Cmt={kernelName:Rp,backendName:"webgl",kernelFunc:Th};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kmt=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockShape:a,crops:i}=s;F(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((T,C)=>T*C),l=im(r.shape,a,o),c=om(l.length,a.length),d=lm(r.shape,a,o),f=IN(i,a.length),m=AN(d,i,a.length),g=[],b=Nt({inputs:{x:r},backend:e,attrs:{shape:l}}),x=ls({inputs:{x:b},backend:e,attrs:{perm:c}}),v=Nt({inputs:{x},backend:e,attrs:{shape:d}}),w=Th({inputs:{x:v},backend:e,attrs:{begin:f,size:m}});return g.push(b),g.push(x),g.push(v),g.forEach(T=>e.disposeIntermediateTensorInfo(T)),w},$mt={kernelName:Gf,backendName:"webgl",kernelFunc:kmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Emt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,weights:a}=t,{size:i}=s,o=e.readSync(r.dataId),l=e.readSync(a.dataId),c=PP(o,l,a.dtype,a.shape,i);return e.makeTensorInfo([i],a.dtype,c)}const Imt={kernelName:N0,backendName:"webgl",kernelFunc:Emt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Amt=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Rmt=`
  return float(int(a.r) & int(b.r));
`;function Dmt(n){const{inputs:t,backend:e}=n,{a:s,b:r}=t,a=lt().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=lt().getNumber("WEBGL_VERSION");if(e.shouldExecuteOnCPU([s,r])||i===1){const l=e.texData.get(s.dataId).values,c=e.texData.get(r.dataId).values,[d,f]=Bdt(s.shape,r.shape,l,c,s.dtype),m=e.makeTensorInfo(f,s.dtype),g=e.texData.get(m.dataId);return g.values=d,m}let o;return a?o=new wh(Amt,s.shape,r.shape,!1):o=new Cl(Rmt,s.shape,r.shape),e.runWebGLProgram(o,[s,r],s.dtype)}const Omt={kernelName:jf,backendName:"webgl",kernelFunc:Dmt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _mt(n){const{inputs:t,backend:e}=n,{s0:s,s1:r}=t,a=e.readSync(s.dataId),i=e.readSync(r.dataId),o=jt(Array.from(a),Array.from(i));return e.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const Fmt={kernelName:C0,backendName:"webgl",kernelFunc:_mt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lmt="return float(a != b);",JP=Un({opSnippet:Lmt,cpuKernelImpl:oft,dtype:"bool"}),Mmt={kernelName:xp,backendName:"webgl",kernelFunc:JP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wm(n){const{inputs:t,backend:e}=n,{input:s}=t,r=e.texData.get(s.dataId);return zs({inputs:{x:r.complexTensorInfos.real},backend:e})}const zmt={kernelName:ab,backendName:"webgl",kernelFunc:wm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pmt="return float(int(x));";function Bmt(n,t){const e=new oa(n.shape,Pmt),s=t.runWebGLProgram(e,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KS(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return zs({inputs:{x:r},backend:e});const i=un(r.shape),o=KS({inputs:{x:r},backend:e,attrs:{dtype:"float32"}}),l=To({inputs:{real:o,imag:i},backend:e});return i.dispose(),e.disposeIntermediateTensorInfo(o),l}if(r.dtype==="complex64"){const i=wm({inputs:{input:r},backend:e}),o=KS({inputs:{x:i},backend:e,attrs:{dtype:a}});return e.disposeIntermediateTensorInfo(i),o}if(!H2(r.dtype,a)){const i=zs({inputs:{x:r},backend:e});return{dataId:i.dataId,shape:i.shape,dtype:a}}if(e.shouldExecuteOnCPU([r])){const i=e.texData.get(r.dataId).values,[o,l,c]=Vdt(i,r.shape,r.dtype,a);return e.makeTensorInfo(o,l,c)}if(a==="int32")return Bmt(r,e);if(a==="bool"){const i=e.makeTensorInfo([],"bool",kn("bool",1)),l=JP({inputs:{a:r,b:i},backend:e});return e.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${a}`)}const Vmt={kernelName:vc,backendName:"webgl",kernelFunc:KS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VD="return ceil(x);",Umt=le({opSnippet:VD,packedOpSnippet:VD,cpuKernelImpl:Udt}),Wmt={kernelName:wc,backendName:"webgl",kernelFunc:Umt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gmt{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jmt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hmt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{clipValueMin:a,clipValueMax:i}=s;let o;lt().getBool("WEBGL_PACK_CLIP")?o=new jmt(r.shape):o=new Gmt(r.shape);const l=[[a],[i]];return e.runWebGLProgram(o,[r],r.dtype,l)}const qmt={kernelName:Sc,backendName:"webgl",kernelFunc:Hmt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kmt{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UD(n,t){return{dataId:t.dataId,dtype:t.dtype,shape:n.shape}}function Xmt(n){const{inputs:t,backend:e}=n,{x:s}=t,r=e.texData.get(s.dataId),a=new Kmt(s.shape),i=[UD(s,r.complexTensorInfos.real),UD(s,r.complexTensorInfos.imag)];return e.runWebGLProgram(a,i,i[0].dtype)}const Ymt={kernelName:Hf,backendName:"webgl",kernelFunc:Xmt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zmt{constructor(t){this.outputShape=[],this.outputShape=fa(t,1),this.variableNames=t.map((i,o)=>`T${o}`);const e=new Array(t.length-1);e[0]=t[0][1];for(let i=1;i<e.length;i++)e[i]=e[i-1]+t[i][1];const s=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<e.length;i++){const o=e[i-1];s.push(`else if (yC < ${e[i]}) setOutput(getT${i}(yR, yC-${o}));`)}const r=e.length,a=e[e.length-1];s.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qmt{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=fa(t,e);const s=this.outputShape,r=s.length,a=Te(r),i=is("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((x,v)=>`T${v}`);const l=new Array(t.length-1);l[0]=t[0][e];for(let x=1;x<l.length;x++)l[x]=l[x-1]+t[x][e];const c=o[e],d=o.slice(-2),f=o.join();let m=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${d.join()}));
        }`;for(let x=1;x<l.length;x++){const v=l[x-1];m+=`
        if (${c} < ${l[x]}  && ${c} >= ${l[x-1]}) {
          return getChannel(
            getT${x}(${ny(o,c,v)}),
            vec2(${ny(d,c,v)}));
        }`}const g=l.length,b=l[l.length-1];m+=`
        return getChannel(
          getT${g}(${ny(o,c,b)}),
          vec2(${ny(d,c,b)}));`,this.userCode=`
      float getValue(${o.map(x=>"int "+x)}) {
        ${m}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function ny(n,t,e){const s=n.indexOf(t);return n.map((a,i)=>i===s?`${a} - ${e}`:a).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rx(n){const{inputs:t,backend:e}=n,{input:s}=t,r=e.texData.get(s.dataId);return zs({inputs:{x:r.complexTensorInfos.imag},backend:e})}const Jmt={kernelName:j0,backendName:"webgl",kernelFunc:Rx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zd(n,t,e){const s=n[0].dtype;if(s==="complex64"){const g=n.map(T=>wm({inputs:{input:T},backend:e})),b=n.map(T=>Rx({inputs:{input:T},backend:e})),x=zd(g,t,e),v=zd(b,t,e),w=To({inputs:{real:x,imag:v},backend:e});return g.forEach(T=>e.disposeIntermediateTensorInfo(T)),b.forEach(T=>e.disposeIntermediateTensorInfo(T)),e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v),w}let r=e.shouldExecuteOnCPU(n);if(s==="string"&&(r=!0),r){const g=n.map(k=>{const I=[-1,ft(k.shape.slice(t))];return Nt({inputs:{x:k},backend:e,attrs:{shape:I}})}),b=g.map(k=>({vals:e.readSync(k.dataId),shape:k.shape})),x=fa(g.map(k=>k.shape),1),v=g[0].shape[0]===1,w=Wdt(b,x,s,v),T=fa(n.map(k=>k.shape),t),C=e.makeTensorInfo(T,s,w);return g.forEach(k=>e.disposeIntermediateTensorInfo(k)),C}const a=n.filter(g=>ft(g.shape)>0),i=lt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){const g=i?new oa(n[0].shape,Wi):new Hi(n[0].shape,Wi);return e.runWebGLProgram(g,n,s)}const o=lt().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>o){const g=[];for(let x=0;x<a.length;x+=o){const v=a.slice(x,x+o);g.push(zd(v,t,e))}const b=zd(g,t,e);for(const x of g)e.disposeIntermediateTensorInfo(x);return b}if(i){const g=new Qmt(a.map(b=>b.shape),t);return e.runWebGLProgram(g,a,s)}const{tensors2D:l,outShape:c}=tgt(a,t,e),d=new Zmt(l.map(g=>g.shape)),f=e.runWebGLProgram(d,l,s);l.forEach(g=>e.disposeIntermediateTensorInfo(g));const m=Nt({inputs:{x:f},attrs:{shape:c},backend:e});return e.disposeIntermediateTensorInfo(f),m}function tgt(n,t,e){const s=fa(n.map(a=>a.shape),t);return{tensors2D:n.map(a=>Nt({inputs:{x:a},attrs:{shape:[-1,ft(a.shape.slice(t))]},backend:e})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tB(n){const{inputs:t,backend:e,attrs:s}=n,{axis:r}=s,a=Zt(r,t[0].shape)[0],i=t.map(c=>c.shape);kN(i,a);const o=fa(t.map(c=>c.shape),a);if(ft(o)===0)return e.makeTensorInfo(o,t[0].dtype,[]);const l=t.filter(c=>ft(c.shape)>0);return l.length===1?zs({inputs:{x:l[0]},backend:e}):zd(l,a,e)}const egt={kernelName:qf,backendName:"webgl",kernelFunc:tB};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eB{constructor(t,e=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const i=t.padInfo.top,o=t.padInfo.left,l=t.strideHeight,c=t.strideWidth,d=t.dilationHeight,f=t.dilationWidth,m=t.filterHeight,g=t.filterWidth,b=Math.floor(t.inChannels/4)*4,x=t.inChannels%4,v=t.dataFormat==="channelsLast",w=v?1:2,T=v?2:3,C=v?3:1;let k="",$="";s&&(r?k=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?k=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:k=`
          float activation(float x) {
            ${s}
          }
        `,$="result = activation(result);");const I=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${k}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${C}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${T}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${m}; wR++) {
          int xR = xRCorner + wR * ${d};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${g}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${b}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${x===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${b}) *
                    getW(wR, wC, ${b}, d2);
              } else {
                dotProd +=
                    getX(batch, ${b}, xR, xC) *
                    getW(wR, wC, ${b}, d2);
              }

            } else if (${x===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${b}, d2),
                getW(wR, wC, ${b} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${b}),
                  getX(batch, xR, xC, ${b} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${b}, xR, xC),
                  getX(batch, ${b} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${x===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${b}, d2),
                getW(wR, wC, ${b} + 1, d2),
                getW(wR, wC, ${b} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${b}),
                  getX(batch, xR, xC, ${b} + 1),
                  getX(batch, xR, xC, ${b} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${b}, xR, xC),
                  getX(batch, ${b} + 1, xR, xC),
                  getX(batch, ${b} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${I}
        ${$}
        setOutput(result);
      }
    `}}class ngt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,s=t.padInfo.top,r=t.padInfo.left,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,d=t.dilationWidth,f=t.filterDepth,m=t.filterHeight,g=t.filterWidth,b=Math.floor(t.inChannels/4)*4,x=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${i}, ${o});
      const ivec3 pads = ivec3(${e}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${g}; wC++) {
              int xC = xCCorner + wC * ${d};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${b}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${x===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${b}) *
                  getW(wF, wR, wC, ${b}, d2);
              } else if (${x===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${b}),
                  getX(batch, xF, xR, xC, ${b} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${b}, d2),
                  getW(wF, wR, wC, ${b} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${x===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${b}),
                  getX(batch, xF, xR, xC, ${b} + 1),
                  getX(batch, xF, xR, xC, ${b} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${b}, d2),
                  getW(wF, wR, wC, ${b} + 1, d2),
                  getW(wF, wR, wC, ${b} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nB{constructor(t,e=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Zn(this.outputShape.length);const i=t.padInfo.left,o=t.strideWidth,l=t.dilationWidth,c=t.filterHeight,d=t.filterWidth,f=d;let m=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<d;v++)m+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;m+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let v=0;v<d;v++)m+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;m+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(f+1)/2;v++){const w=v*2;if(m+=`
           xC = xCCorner + ${w*l};
           `,o===1){if(w<d&&(i%2===1?(m+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,l===1&&w>0?m+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:m+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):m+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<d)){const T=i%2===0?b0(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(m+=`
                   xCOffset = xC + imod(pads[1], 2) + ${T};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,l>1?m+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:m+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):T===1?m+=`
                     xC${w+1} = xTexelC${w};
                     `:m+=`
                     xCOffset = xC + ${T};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<d&&(i%2===1?(m+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<d&&(m+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(m+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<d&&(m+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<d&&(m+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<d&&(m+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}m+=`
     }
   `,m+=`
     }
   `,m+=`
     }
   `;let g="",b="";s&&(r?g=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:a?g=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:g=`vec4 activation(vec4 x) {
           ${s}
         }`,b="result = activation(result);");const x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${g}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${m}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${x}
         ${b}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sgt{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Zn(this.outputShape.length);const{dataFormat:s}=e,r=cs(),a=s==="channelsLast",i=a?1:2,o=a?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let c="";for(let d=0;d<=1;d++)for(let f=0;f<=1;f++)c+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${d};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${d*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${d*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r0(n,t){const e=n.length;return e>=3?t?[...n.slice(0,-3),n[e-3]*n[e-2],n[e-1]]:[...n.slice(0,-3),n[e-3],n[e-2]*n[e-1]]:!t&&e===1&&n[0]>1?[n[0],1]:null}function sB({x:n,filter:t,convInfo:e,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:o=null}){const l=n.shape,c=s.texData.get(n.dataId),d=e.inChannels,f=l[0]*l[1]*l[2],m=e.outChannels,g=e.dataFormat==="channelsLast",b=!1,x=!1;let v;const w=[];if(a!=null){const k=r0(a.shape,g);k!=null&&(a=Nt({inputs:{x:a},backend:s,attrs:{shape:k}}),w.push(a))}if(r!=null){const k=r0(r.shape,g);k!=null&&(r=Nt({inputs:{x:r},backend:s,attrs:{shape:k}}),w.push(r))}if(!((f===1||m===1)&&d>XP)&&c.isPacked&&g&&c.texture!=null&&l[2]%2!==0&&te(c.shape.slice(-3),l.slice(-3))){const k=l[0]*l[1]*(l[2]+1),$={dataId:n.dataId,shape:[1,k,e.inChannels],dtype:n.dtype},I=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,F(n0(c.shape,$.shape),()=>`packed reshape ${c.shape} to ${$.shape} isn't free`);const D=Nt({inputs:{x:t},backend:s,attrs:{shape:[1,e.inChannels,e.outChannels]}});w.push(D);const _=s0({a:$,b:D,backend:s,transposeA:b,transposeB:x,bias:r,activation:o,preluActivationWeights:a,leakyreluAlpha:i}),O=s.texData.get(_.dataId);F(O.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=I,O.shape=e.outShape,v=zs({inputs:{x:_},backend:s}),v.shape=e.outShape,w.push(_)}else{const k=e.outHeight*e.outWidth,$=Nt({inputs:{x:n},backend:s,attrs:{shape:g?[e.batchSize,k,e.inChannels]:[e.batchSize,e.inChannels,k]}}),I=Nt({inputs:{x:t},backend:s,attrs:{shape:[1,e.inChannels,e.outChannels]}}),D=s0({a:g?$:I,b:g?I:$,transposeA:!g,transposeB:x,backend:s,bias:r,activation:o,preluActivationWeights:a,leakyreluAlpha:i});v=Nt({inputs:{x:D},backend:s,attrs:{shape:e.outShape}}),w.push($),w.push(I),w.push(D)}for(const k of w)s.disposeIntermediateTensorInfo(k);return v}function rB({x:n,filter:t,convInfo:e,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:o=null}){const{filterWidth:l,filterHeight:c,inChannels:d,outWidth:f,outHeight:m,dataFormat:g}=e,b=g==="channelsLast",x=l*c*d,v=m*f,w=[e.batchSize,x,v],T=!0,C=!1,k=[];if(a!=null){const X=r0(a.shape,b);X!=null&&(a=Nt({inputs:{x:a},backend:s,attrs:{shape:X}}),k.push(a))}if(r!=null){const X=r0(r.shape,b);X!=null&&(r=Nt({inputs:{x:r},backend:s,attrs:{shape:X}}),k.push(r))}const $=Nt({inputs:{x:t},backend:s,attrs:{shape:[1,x,ft(t.shape)/x]}});k.push($);const I=new sgt(w,e),D=[n.shape,[e.padInfo.top,e.padInfo.left],[e.strideHeight,e.strideWidth],[e.dilationHeight,e.dilationWidth],[e.inChannels],[e.filterWidth*e.inChannels],[e.outWidth]],_=s.runWebGLProgram(I,[n],"float32",D),O=Nt({inputs:{x:_},backend:s,attrs:{shape:w}});k.push(_),k.push(O);const L=r!=null,R=a!=null,V=o==="leakyrelu",Y=o?kf(o,!0):null,Q=new KP(b?O.shape:$.shape,b?$.shape:O.shape,b?[e.batchSize,v,e.outChannels]:[e.batchSize,e.outChannels,v],T,C,L,Y,R,V),tt=b?[O,$]:[$,O];if(r&&tt.push(r),R&&tt.push(a),V){const X=s.makeTensorInfo([],"float32",ci(i,"float32"));tt.push(X),k.push(X)}const B=s.runWebGLProgram(Q,tt,"float32"),W=Nt({inputs:{x:B},backend:s,attrs:{shape:e.outShape}});k.push(B);for(const X of k)s.disposeIntermediateTensorInfo(X);return W}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rgt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:d}=s,f=di(l),m=En(r.shape,a.shape,i,c,o,d,!1,f);let g;if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))g=sB({x:r,filter:a,convInfo:m,backend:e});else if(m.strideWidth<=2&&f==="channelsLast"&&lt().getBool("WEBGL_EXP_CONV")){const x=new nB(m),v=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]];g=e.runWebGLProgram(x,[r,a],"float32",v)}else if(lt().getBool("WEBGL_CONV_IM2COL"))g=rB({x:r,filter:a,convInfo:m,backend:e});else{const x=new eB(m);g=e.runWebGLProgram(x,[r,a],"float32")}const b=Nt({inputs:{x:g},backend:e,attrs:{shape:m.outShape}});return e.disposeIntermediateTensorInfo(g),b}const agt={kernelName:Kf,backendName:"webgl",kernelFunc:rgt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class igt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,s=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ogt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,s=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=t.dataFormat==="channelsLast",o=e-1-t.padInfo.top,l=s-1-t.padInfo.left,c=i?1:2,d=i?2:3,f=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${d}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class lgt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,s=t.strideHeight,r=t.strideWidth,a=t.padInfo.front,i=t.padInfo.top,o=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${e} - ${a};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${o};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ugt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,s=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,l=e-1-t.padInfo.front,c=s-1-t.padInfo.top,d=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${e}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${e} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cgt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:d}=s,f=di(l),m=En(r.shape,d,i,1,o,c,!1,f),g=new igt(m);return e.runWebGLProgram(g,[r,a],"float32")}const hgt={kernelName:$0,backendName:"webgl",kernelFunc:cgt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dgt{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Zn(this.outputShape.length);const e=t.filterHeight,s=t.filterWidth,r=e-1-t.padInfo.top,a=s-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fgt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:d}=s,f=di(c),m=En(i,a.shape,o,1,l,d,!1,f);if(lt().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){const g=[[m.strideHeight,m.strideWidth]],b=new dgt(m);return e.runWebGLProgram(b,[r,a],"float32",g)}else{const g=new ogt(m);return e.runWebGLProgram(g,[r,a],"float32")}}const pgt={kernelName:Xf,backendName:"webgl",kernelFunc:fgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mgt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:o,dilations:l}=s,c=mo(r.shape,a.shape,i,l,o),d=new ngt(c);return e.runWebGLProgram(d,[r,a],"float32")}const ggt={kernelName:Yf,backendName:"webgl",kernelFunc:mgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ygt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,pad:o,filterShape:l}=s,c=mo(r.shape,l,i,1,o),d=new lgt(c);return e.runWebGLProgram(d,[r,a],"float32")}const bgt={kernelName:E0,backendName:"webgl",kernelFunc:ygt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xgt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{pad:i,strides:o,inputShape:l}=s,c=mo(l,a.shape,o,1,i),d=new ugt(c);return e.runWebGLProgram(d,[r,a],"float32")}const vgt={kernelName:I0,backendName:"webgl",kernelFunc:xgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wgt=Sh+`
  return cos(x);
`,Sgt=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Pl}
  return result;
`,Tgt=le({opSnippet:wgt,packedOpSnippet:Sgt}),Ngt={kernelName:Tc,backendName:"webgl",kernelFunc:Tgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cgt=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,kgt=le({opSnippet:Cgt}),$gt={kernelName:Nc,backendName:"webgl",kernelFunc:kgt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Egt{constructor(t,e,s,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,o,l,c]=t,[d]=e,[f,m]=s;this.outputShape=[d,f,m,c];const g=r==="bilinear"?1:0,[b,x]=[`${o-1}.0`,`${l-1}.0`],[v,w,T]=f>1?[`${(o-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${b} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${b}`],[C,k,$]=m>1?[`${(l-1)/(m-1)}`,"(x2-x1) * width_ratio",`x1*${x} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${x}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${C});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${k};

        float in_y = ${T};
        if( in_y < 0.0 || in_y > ${b} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${$};
        if( in_x < 0.0 || in_x > ${x} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${g} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Igt=n=>{const{inputs:t,backend:e,attrs:s}=n,{image:r,boxes:a,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:c}=s,d=new Egt(r.shape,a.shape,o,l,c);return e.runWebGLProgram(d,[r,a,i],"float32")},Agt={kernelName:R0,backendName:"webgl",kernelFunc:Igt};var Ef;(function(n){n.Prod="*",n.Sum="+"})(Ef||(Ef={}));class WD{constructor(t,e,s,r){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,i=this.op===Ef.Prod?"1.0":"0.0",o=s?i:`getX(${GD(a,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",d="";s?(c=r?`end != ${l-1}`:"end != 0",d=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",d=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Te(a)} coords = getOutputCoords();
        int end = ${jD(a,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${d};
          ${jD(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${GD(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function GD(n,t,e){if(n===1)return`${t}`;if(n===2)return`${t}.x, ${t}.y`;if(n===3)return`${t}.x, ${t}.y, ${t}.z`;if(n===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}function jD(n,t,e){if(n===1)return`${t}`;if(n===2)return`${t}.y`;if(n===3)return`${t}.z`;if(n===4)return`${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aB(n,t,e,s,r,a){const i=t.shape.length,o=We([s],i);let l=t;o!=null&&(l=ls({inputs:{x:t},backend:e,attrs:{perm:o}}));const c=tn(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${s}`);const d=l.shape[c];let f=zs({inputs:{x:l},backend:e});for(let m=0;m<=Math.ceil(Math.log2(d))-1;m++){const g=new WD(n,l.shape,!1,a),b=[[m]],x=f;f=e.runWebGLProgram(g,[f],f.dtype,b),e.disposeIntermediateTensorInfo(x)}if(r){const m=new WD(n,l.shape,r,a),g=f;f=e.runWebGLProgram(m,[f],f.dtype),e.disposeIntermediateTensorInfo(g)}if(o!=null){const m=go(o),g=ls({inputs:{x:f},backend:e,attrs:{perm:m}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(l),g}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rgt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,exclusive:i,reverse:o}=s;return aB(Ef.Prod,r,e,a,i,o)}const Dgt={kernelName:A0,backendName:"webgl",kernelFunc:Rgt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ogt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,exclusive:i,reverse:o}=s;return aB(Ef.Sum,r,e,a,i,o)}const _gt={kernelName:Zf,backendName:"webgl",kernelFunc:Ogt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fgt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,weights:a}=t,{size:i,binaryOutput:o}=s;if(r.shape.length===1){const l=e.readSync(r.dataId),c=e.readSync(a.dataId),d=PP(l,c,a.dtype,a.shape,i);return e.makeTensorInfo([i],a.dtype,d)}else if(r.shape.length===2){const l=e.bufferSync(r),c=e.bufferSync(a),d=Pdt(l,c,i,o);return e.makeTensorInfo(d.shape,a.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Lgt={kernelName:D0,backendName:"webgl",kernelFunc:Fgt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mgt{constructor(t,e,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${e};
      int offset_h = imod(h, ${e});
      int in_w = w / ${e};
      int offset_w = imod(w, ${e});
      int offset_d = (offset_h * ${e} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zgt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockSize:a,dataFormat:i}=s,o=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],c=i==="NHWC"?r.shape[2]:r.shape[3],d=i==="NHWC"?r.shape[3]:r.shape[1],f=l*a,m=c*a,g=d/(a*a),b=i==="NHWC"?[o,f,m,g]:[o,g,f,m],x=new Mgt(b,a,i);return e.runWebGLProgram(x,[r],r.dtype)}const Pgt={kernelName:O0,backendName:"webgl",kernelFunc:zgt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iB{constructor(t,e=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Zn(this.outputShape.length);const i=t.filterHeight,o=t.filterWidth,l=t.outChannels/t.inChannels;let c="",d="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,d="result = activation(result);");const f=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oB{constructor(t,e=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Zn(this.outputShape.length);const i=t.outChannels/t.inChannels,o=t.padInfo.left,l=t.strideWidth,c=t.dilationWidth,d=t.filterHeight,f=t.filterWidth,m=f;let g=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<f;w++)g+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;g+=`
    for (int r = 0; r < ${d}; r++) {
      `;for(let w=0;w<f;w++)g+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;g+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(m+1)/2;w++){const T=w*2;if(g+=`
          xC = xCCorner + ${T*c};
          `,l===1){if(T<f&&(o%2===1?(g+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }
              `,c===1&&T>0?g+=`
                xC${T} = vec4(xTexelC${T-2}.zw, xTexelC${T}.xy);
                `:g+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${T} = vec4(previous.zw, xTexelC${T}.xy);
                  } else {
                    xC${T} = vec4(0.0, 0.0, xTexelC${T}.xy);
                  }
                  `):g+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }

                xC${T} = xTexelC${T};
                `,T+1<f)){const C=o%2===0?b0(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(g+=`
                  xCOffset = xC + imod(pads[1], 2) + ${C};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                    xTexelC${T+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${T+1}.zw = vec2(0.0);
                    }
                    xTexelC${T+1}Ready = 1;
                  }
                  `,c>1?g+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${T+1} = vec4(previous.zw, xTexelC${T+1}.xy);
                    } else {
                     xC${T+1} = vec4(0.0, 0.0, xTexelC${T+1}.xy);
                    }
                    `:g+=`
                    xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.xy);
                    `):C===1?g+=`
                    xC${T+1} = xTexelC${T};
                    `:g+=`
                    xCOffset = xC + ${C};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                      xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${T+1}.zw = vec2(0.0);
                      }
                      xTexelC${T+1}Ready = 1;
                    }

                    xC${T+1} = xTexelC${T+1};
                    `}}else T<f&&(o%2===1?(g+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${T+1}Ready == 0) {
                  xTexelC${T+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${T+1}.zw = vec2(0.0);
                  }
                  xTexelC${T+1}Ready = 1;
                }

                xC${T} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
              `,T+1<f&&(g+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${T+1} = vec4(xTexelC${T+1}.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                  xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${T+1}.zw = vec2(0.);
                  }
                  xTexelC${T+1}Ready = 1;
                }

                xC${T} = vec4(
                  xTexelC${T}.xy, xTexelC${T+1}.xy);
              `,T+1<f&&(g+=`
                  xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
                `)));T<f&&(g+=`
            wTexel = getW(r, ${T}, d1, q);
            dotProd += xC${T} * vec4(wTexel.xz, wTexel.xz);
          `,T+1<f&&(g+=`
              wTexel = getW(r, ${T+1}, d1, q);
              dotProd += xC${T+1} * vec4(wTexel.xz, wTexel.xz);
            `))}g+=`
    }
  `,g+=`
      }
    `;let b="",x="";s&&(r?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:b=`vec4 activation(vec4 x) {
          ${s}
        }`,x="result = activation(result);");const v=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${g}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bgt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=s;let d=l;d==null&&(d=[1,1]),F(Pn(i,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);const f=En(r.shape,a.shape,i,d,o,c,!0);let m;lt().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?m=new oB(f):m=new iB(f);const g=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return e.runWebGLProgram(m,[r,a],"float32",g)}const Vgt={kernelName:Qf,backendName:"webgl",kernelFunc:Bgt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ugt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,s=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Wgt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,s=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=e-1-t.padInfo.top,o=s-1-t.padInfo.left,l=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ggt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:d}=s,f=En(r.shape,d,i,o,l,c,!0),m=new Ugt(f);return e.runWebGLProgram(m,[r,a],"float32")}const jgt={kernelName:_0,backendName:"webgl",kernelFunc:Ggt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hgt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:d}=s,f=En(d,a.shape,i,o,l,c,!0),m=new Wgt(f);return e.runWebGLProgram(m,[r,a],"float32")}const qgt={kernelName:F0,backendName:"webgl",kernelFunc:Hgt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kgt{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xgt(n){const{inputs:t,backend:e}=n,{x:s}=t,r=[...s.shape,...s.shape],a=ft(s.shape),i=Nt({inputs:{x:s},backend:e,attrs:{shape:[a]}}),o=new Kgt(a),l=e.runWebGLProgram(o,[i],i.dtype),c=Nt({inputs:{x:l},backend:e,attrs:{shape:r}});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(l),c}const Ygt={kernelName:L0,backendName:"webgl",kernelFunc:Xgt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zgt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:s,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:o,filterWidth:l,dilationHeight:c,dilationWidth:d}=t,{top:f,left:m}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${i});
      const ivec2 pads = ivec2(${f}, ${m});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${e}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${d};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qgt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:o,dilations:l}=s,c=Up(r.shape,a.shape,i,o,"NHWC",l);let d;const f=new Zgt(c);d=e.runWebGLProgram(f,[r,a],"float32");const m=Nt({inputs:{x:d},backend:e,attrs:{shape:c.outShape}});return e.disposeIntermediateTensorInfo(d),m}const Jgt={kernelName:Jf,backendName:"webgl",kernelFunc:Qgt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tyt(n){const{inputs:t,backend:e,attrs:s}=n,{equation:r}=s,a=t,{allDims:i,summedDims:o,idDims:l}=zN(r,a.length);BN(i.length,l,a);const{path:c,steps:d}=VN(o,l),f=d.length;let m=null,g=i.length;const b=[];for(let x=0;x<f;++x){for(const v of d[x]){const{permutationIndices:w,expandDims:T}=PN(g,l[v]);let C;UN(w)?C=a[v]:(C=ls({inputs:{x:a[v]},backend:e,attrs:{perm:w}}),b.push(C));const k=C.shape.slice();for(let $=0;$<T.length;++$)k.splice(T[$],0,1);te(C.shape,k)||(C=Nt({inputs:{x:C},backend:e,attrs:{shape:k}}),b.push(C)),m===null?m=C:(m=RC({inputs:{a:C,b:m},backend:e}),b.push(m))}x<f-1&&(c[x]>=0&&(m=Ax({inputs:{x:m},backend:e,attrs:{axis:c[x]-(i.length-g),keepDims:!1}}),b.push(m)),g--)}for(const x of b)x!==m&&e.disposeIntermediateTensorInfo(x);return m}const eyt={kernelName:z0,backendName:"webgl",kernelFunc:tyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nyt="return (x >= 0.0) ? x : (exp(x) - 1.0);",syt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ryt=le({opSnippet:nyt,packedOpSnippet:syt}),ayt={kernelName:kc,backendName:"webgl",kernelFunc:ryt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iyt="return (b >= 0.0) ? a : a * (b + 1.0);",oyt=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,lyt=n=>{const{inputs:t,backend:e}=n,{dy:s,y:r}=t,a=lt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wh(oyt,s.shape,r.shape):new Cl(iyt,s.shape,r.shape);return e.runWebGLProgram(a,[s,r],s.dtype)},uyt={kernelName:P0,backendName:"webgl",kernelFunc:lyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cyt=`
  return vec4(equal(a, b));
`,hyt="return float(a == b);",dyt=Un({opSnippet:hyt,packedOpSnippet:cyt,dtype:"bool",cpuKernelImpl:Gdt}),fyt={kernelName:tp,backendName:"webgl",kernelFunc:dyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pyt=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${RN};
  float a1 = ${DN};
  float a2 = ${ON};
  float a3 = ${_N};
  float a4 = ${FN};
  float a5 = ${LN};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,myt=le({opSnippet:pyt}),gyt={kernelName:$c,backendName:"webgl",kernelFunc:myt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yyt=Sh+`
  return exp(x);
`,byt=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,lB=le({opSnippet:yyt,packedOpSnippet:byt,cpuKernelImpl:jdt,dtype:"float32"}),xyt={kernelName:Ec,backendName:"webgl",kernelFunc:lB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XS(n){const{inputs:t,attrs:e,backend:s}=n,{dim:r}=e,{input:a}=t,i=a.shape.length,o=a.shape.slice();let l=r;return r<0&&(F(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),o.splice(l,0,1),Nt({inputs:{x:a},backend:s,attrs:{shape:o}})}const vyt={kernelName:ep,backendName:"webgl",kernelFunc:XS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HD="return exp(x) - 1.0;",wyt=le({opSnippet:HD,packedOpSnippet:HD,cpuKernelImpl:Hdt}),Syt={kernelName:Ic,backendName:"webgl",kernelFunc:wyt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qD{constructor(t,e,s){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const a=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let o;if(t==="real")o="return real * expR - imag * expI;";else if(t==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uB(n,t,e){const s=e.texData.get(n.dataId),r=ft(n.shape),a=n.shape[n.shape.length-1],i=r/a,o=Nt({inputs:{x:n},backend:e,attrs:{shape:[i,a]}}),l=o.shape,c=new qD("real",l,t),d=new qD("imag",l,t),f=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],m=e.runWebGLProgram(c,f,"float32"),g=e.runWebGLProgram(d,f,"float32"),b=To({inputs:{real:m,imag:g},backend:e});e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g);const x=Nt({inputs:{x:b},backend:e,attrs:{shape:n.shape}});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(b),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tyt(n){const{inputs:t,backend:e}=n,{input:s}=t;return uB(s,!1,e)}const Nyt={kernelName:B0,backendName:"webgl",kernelFunc:Tyt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cyt{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sm(n){const{backend:t,attrs:e}=n,{shape:s,value:r}=e;let{dtype:a}=e;if(a=a||El(r),a==="string"){const i=He(a,ft(s));return i.fill(r),t.makeTensorInfo(s,a,i)}else{const i=new Cyt(s,r),o=[[r]];return t.runWebGLProgram(i,[],a,o)}}const kyt={kernelName:V0,backendName:"webgl",kernelFunc:Sm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $yt{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${e} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${e}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eyt={kernelName:U0,backendName:"webgl",kernelFunc:({inputs:n,backend:t})=>{const{image:e}=n,s=t,r=new $yt(e.shape);return s.runWebGLProgram(r,[e],e.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KD="return floor(x);",Iyt=le({opSnippet:KD,packedOpSnippet:KD,cpuKernelImpl:qdt}),Ayt={kernelName:Ac,backendName:"webgl",kernelFunc:Iyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ryt=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Dyt=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Oyt=Un({opSnippet:Ryt,packedOpSnippet:Dyt,dtype:"int32"}),_yt={kernelName:Rc,backendName:"webgl",kernelFunc:Oyt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fyt{constructor(t){this.variableNames=["A"];const e=cs(),[s,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${e.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lyt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=cs(),[s,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${e.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${e.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Myt={kernelName:Fy,backendName:"webgl",kernelFunc:zyt};let Iu,Aw=lt().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function zyt(n){const{inputs:t,backend:e,attrs:s}=n;let{pixels:r}=t;const{numChannels:a}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],d=[c,l],f=[c,l,a];if(o||i){const x=lt().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Iu==null||x!==Aw)&&(Aw=x,Iu=document.createElement("canvas").getContext("2d",{willReadFrequently:Aw})),Iu.canvas.width=l,Iu.canvas.height=c,Iu.drawImage(r,0,0,l,c),r=Iu.canvas}const m=e.makeTensorInfo(d,"int32");e.texData.get(m.dataId).usage=Js.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(m.dataId),r);const g=lt().getBool("WEBGL_PACK")?new Lyt(f):new Fyt(f),b=e.runWebGLProgram(g,[m],"int32");return e.disposeData(m.dataId),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pyt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:d,dilations:f,dimRoundingMode:m,activation:g,leakyreluAlpha:b}=s,x=di(d),v=En(r.shape,a.shape,l,f,c,m,!1,x);let w;const T=[],C=i!=null,k=o!=null,$=g==="leakyrelu",I=()=>{const _=[r,a],O=(L,R)=>{if(R==="NCHW"&&L.shape.length===1&&L.shape[0]!==1){const V=Nt({inputs:{x:L},backend:e,attrs:{shape:[L.shape[0],1,1]}});return T.push(V),V}return L};if(C&&_.push(O(i,d)),k&&_.push(O(o,d)),$){const L=e.makeTensorInfo([],"float32",ci(b,"float32"));_.push(L),T.push(L)}return _};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))w=sB({x:r,filter:a,convInfo:v,backend:e,bias:i,activation:g,preluActivationWeights:o,leakyreluAlpha:b});else if(v.strideWidth<=2&&x==="channelsLast"&&lt().getBool("WEBGL_EXP_CONV")){const _=g?kf(g,!0):null,O=new nB(v,C,_,k,$),L=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],R=I();w=e.runWebGLProgram(O,R,"float32",L)}else if(lt().getBool("WEBGL_CONV_IM2COL"))w=rB({x:r,filter:a,convInfo:v,backend:e,bias:i,activation:g,preluActivationWeights:o,leakyreluAlpha:b});else{const _=g?kf(g,!1):null,O=new eB(v,C,_,k,$),L=I();w=e.runWebGLProgram(O,L,"float32")}const D=Nt({inputs:{x:w},backend:e,attrs:{shape:v.outShape}});return T.push(w),T.forEach(_=>e.disposeIntermediateTensorInfo(_)),D}const Byt={kernelName:hf,backendName:"webgl",kernelFunc:Pyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vyt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:d,dimRoundingMode:f,activation:m,leakyreluAlpha:g}=s,b=[];let x=d;x==null&&(x=[1,1]),F(Pn(l,x),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${x}'`);const v=En(r.shape,a.shape,l,x,c,f,!0),w=lt().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,T=m?kf(m,w):null,C=[r,a],k=i!=null,$=o!=null,I=m==="leakyrelu";if(k&&C.push(i),$&&C.push(o),I){const L=e.makeTensorInfo([],"float32",ci(g,"float32"));C.push(L),b.push(L)}let D;w?D=new oB(v,k,T,$,I):D=new iB(v,k,T,$,I);const _=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],O=e.runWebGLProgram(D,C,"float32",_);return b.forEach(L=>e.disposeIntermediateTensorInfo(L)),O}const Uyt={kernelName:df,backendName:"webgl",kernelFunc:Vyt};class Wyt{constructor(t,e,s,r){this.sliceDim=t,this.strides=e,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const a=Te(s.length);let i=`
    int index;`;for(let o=0;o<this.sliceDim;o++)i+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gyt(n){const{inputs:t,backend:e}=n,{params:s,indices:r}=t,a=r.shape,i=a[a.length-1],o=ft(s.shape),[l,c,d,f]=cx(s,r),m=Nt({inputs:{x:r},backend:e,attrs:{shape:[c,i]}}),g=Nt({inputs:{x:s},backend:e,attrs:{shape:[ft(s.shape)/d,d]}});if(e.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const w=e.readSync(r.dataId),T=e.bufferSync(s),C=Kdt(w,T,s.dtype,c,i,d,f,s.shape,o);return e.makeTensorInfo(l,s.dtype,C.values)}const b=new Wyt(i,f,[c,d],s.shape),x=e.runWebGLProgram(b,[g,m],g.dtype),v=Nt({inputs:{x},backend:e,attrs:{shape:l}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(x),v}const jyt={kernelName:W0,backendName:"webgl",kernelFunc:Gyt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hyt{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const s=Te(this.rank),r=qyt(t);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function qyt(n,t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<n.length;r++)r===2?s.push("index"):s.push(`${e[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cB(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,indices:a}=t,{axis:i,batchDims:o}=s,l=Zt(i,r.shape)[0];if(lt().get("DEBUG")){const T=e.readSync(a.dataId),C=r.shape[l];for(let k=0;k<T.length;++k){const $=T[k];F($<=C-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${C-1}]`)}}const c=GN(r,a,l,o),d=ft(a.shape),f=[],m=Nt({inputs:{x:r},backend:e,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),g=Nt({inputs:{x:a},backend:e,attrs:{shape:[c.batchSize,d/c.batchSize]}});f.push(m),f.push(g);const b=[c.batchSize,c.outerSize,d/c.batchSize,c.sliceSize];if(e.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const T=e.bufferSync(g),C=e.bufferSync(m),k=Xdt(C,T,b);return f.forEach($=>e.disposeIntermediateTensorInfo($)),e.makeTensorInfo(c.outputShape,k.dtype,k.values)}const x=new Hyt(m.shape,b),v=e.runWebGLProgram(x,[m,g],m.dtype);f.push(v);const w=Nt({inputs:{x:v},backend:e,attrs:{shape:c.outputShape}});return f.forEach(T=>e.disposeIntermediateTensorInfo(T)),w}const Kyt={kernelName:sp,backendName:"webgl",kernelFunc:cB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xyt="return float(a > b);",Yyt=`
  return vec4(greaterThan(a, b));
`,Zyt=Un({opSnippet:Xyt,packedOpSnippet:Yyt,cpuKernelImpl:Ydt,dtype:"bool"}),Qyt={kernelName:rp,backendName:"webgl",kernelFunc:Zyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jyt="return float(a >= b);",t0t=`
  return vec4(greaterThanEqual(a, b));
`,e0t=Un({opSnippet:Jyt,packedOpSnippet:t0t,dtype:"bool",cpuKernelImpl:Zdt}),n0t={kernelName:Dc,backendName:"webgl",kernelFunc:e0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0t(n){const{inputs:t,backend:e}=n,{input:s}=t;return uB(s,!0,e)}const r0t={kernelName:G0,backendName:"webgl",kernelFunc:s0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a0t="return float(!isnan(x) && !isinf(x));",i0t=le({opSnippet:a0t,dtype:"bool"}),o0t={kernelName:_c,backendName:"webgl",kernelFunc:i0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l0t="return float(isinf(x));",u0t=le({opSnippet:l0t,dtype:"bool"}),c0t={kernelName:Fc,backendName:"webgl",kernelFunc:u0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h0t="return float(isnan(x));",d0t=le({opSnippet:h0t,dtype:"bool"}),f0t={kernelName:Lc,backendName:"webgl",kernelFunc:d0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p0t="return float(a < b);",m0t=`
  return vec4(lessThan(a, b));
`,g0t=Un({opSnippet:p0t,packedOpSnippet:m0t,cpuKernelImpl:Qdt,dtype:"bool"}),y0t={kernelName:ip,backendName:"webgl",kernelFunc:g0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b0t="return float(a <= b);",x0t=`
  return vec4(lessThanEqual(a, b));
`,v0t=Un({opSnippet:b0t,packedOpSnippet:x0t,cpuKernelImpl:Jdt,dtype:"bool"}),w0t={kernelName:op,backendName:"webgl",kernelFunc:v0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0t(n){const{backend:t,attrs:e}=n,{start:s,stop:r,num:a}=e,i=tft(s,r,a);return t.makeTensorInfo([i.length],"float32",i)}const T0t={kernelName:H0,backendName:"webgl",kernelFunc:S0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N0t=Sh+`
  return x < 0.0 ? 0./0. : log(x);
`,C0t=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,k0t=le({opSnippet:N0t,packedOpSnippet:C0t,cpuKernelImpl:eft}),$0t={kernelName:Mc,backendName:"webgl",kernelFunc:k0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E0t=Sh+`
  return log(1.0 + x);
`,I0t=le({opSnippet:E0t}),A0t={kernelName:zc,backendName:"webgl",kernelFunc:I0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R0t="return float(a >= 1.0 && b >= 1.0);",D0t=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,O0t=Un({opSnippet:R0t,packedOpSnippet:D0t,dtype:"bool"}),_0t={kernelName:lp,backendName:"webgl",kernelFunc:O0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F0t="return float(!(x >= 1.0));",L0t=le({opSnippet:F0t}),M0t={kernelName:up,backendName:"webgl",kernelFunc:L0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z0t="return float(a >= 1.0 || b >= 1.0);",P0t=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,B0t=Un({opSnippet:z0t,packedOpSnippet:P0t,dtype:"bool"}),V0t={kernelName:cp,backendName:"webgl",kernelFunc:B0t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U0t{constructor(t,e,s,r,a){this.variableNames=["x"],this.outputShape=[];const i=e,o=t[3]-1;this.outputShape=t;let l;const c=`float(${s}) + float(${r}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W0t{constructor(t,e,s,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=e,o=t[3]-1;this.outputShape=t;let l;const c=`float(${s}) + float(${r}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G0t=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{depthRadius:a,bias:i,alpha:o,beta:l}=s,c=lt().getBool("WEBGL_PACK_NORMALIZATION")?new W0t(r.shape,a,i,o,l):new U0t(r.shape,a,i,o,l);return e.runWebGLProgram(c,[r],r.dtype)},j0t={kernelName:hp,backendName:"webgl",kernelFunc:G0t};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H0t{constructor(t,e,s,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=s,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${e})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${e} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q0t=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r,y:a,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:d}=s,f=new H0t(r.shape,o,l,c,d);return e.runWebGLProgram(f,[r,a,i],r.dtype)},K0t={kernelName:q0,backendName:"webgl",kernelFunc:q0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X0t(n,t,e,s){const r=ft(t),i=ft(n.shape)/r,o=Nt({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),l=Bl(o,n.dtype,"max",s),c=Nt({inputs:{x:l},attrs:{shape:e},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hB(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{reductionIndices:a,keepDims:i}=s,o=r.shape.length,l=Zt(a,r.shape);let c=l;const d=We(c,o),f=d!=null,m=e.shouldExecuteOnCPU([r]);let g=r;if(f){if(m){const C=e.texData.get(g.dataId).values,k=new Array(o);for(let D=0;D<k.length;D++)k[D]=r.shape[d[D]];const $=IC(C,r.shape,r.dtype,d,k);g=e.makeTensorInfo(k,r.dtype);const I=e.texData.get(g.dataId);I.values=$}else g=Ix(r,d,e);c=tn(c.length,o)}Bn("max",c,o);const[b,x]=In(g.shape,c);let v=b;i&&(v=Je(b,l));let w;if(m){const C=e.texData.get(g.dataId).values,k=nft(C,ft(x),v,r.dtype);w=e.makeTensorInfo(v,r.dtype);const $=e.texData.get(w.dataId);$.values=k}else w=X0t(g,x,v,e);return f&&e.disposeIntermediateTensorInfo(g),w}const Y0t={kernelName:dp,backendName:"webgl",kernelFunc:hB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z0t=AC+`
  return max(a, b);
`,Q0t=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Pl+`
  return result;
`,J0t=Un({opSnippet:Z0t,packedOpSnippet:Q0t,cpuKernelImpl:sft}),tbt={kernelName:Pc,backendName:"webgl",kernelFunc:J0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ebt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;xm(r,"maxPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;F(Pn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=kr(r.shape,a,i,c,o,l);if(d.filterWidth===1&&d.filterHeight===1&&te(d.inShape,d.outShape))return zs({inputs:{x:r},backend:e});const f=new $f(d,"max",!1);return e.runWebGLProgram(f,[r],r.dtype)}const nbt={kernelName:fp,backendName:"webgl",kernelFunc:ebt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sbt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{filterSize:a,strides:i,pad:o,dataFormat:l,dimRoundingMode:c}=s,d=[1,1,1],f=hi(r.shape,a,i,d,o,c,l),m=new DC(f,"max",!1);return e.runWebGLProgram(m,[r],r.dtype)}const rbt={kernelName:pp,backendName:"webgl",kernelFunc:sbt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class abt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,s=t.strideWidth,r=t.dilationHeight,a=t.effectiveFilterHeight,i=t.effectiveFilterWidth,o=a-1-t.padInfo.top,l=i-1-t.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${e}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class ibt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,s=t.strideHeight,r=t.strideWidth,a=t.dilationDepth,i=t.dilationHeight,o=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=l-1-t.padInfo.front,m=c-1-t.padInfo.top,g=d-1-t.padInfo.left,b=l*c*d-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${m}, ${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${e}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${b} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${d} +
                  wR * ${d} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function obt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,i=a,{filterSize:o,strides:l,pad:c,dimRoundingMode:d}=s,f=[1,1,1],m=hi(i.shape,o,l,f,c,d),g=new DC(m,"max",!0),b=e.runWebGLProgram(g,[i],i.dtype),x=new ibt(m),v=e.runWebGLProgram(x,[r,b],i.dtype);return e.disposeIntermediateTensorInfo(b),v}const lbt={kernelName:X0,backendName:"webgl",kernelFunc:obt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ubt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a,output:i}=t,o=a;xm([a,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:d,dimRoundingMode:f}=s,m=kr(o.shape,l,c,1,d,f),g=!0,b=new $f(m,"max",g),x=e.runWebGLProgram(b,[o],o.dtype),v=new abt(m),w=e.runWebGLProgram(v,[r,x],o.dtype);return e.disposeIntermediateTensorInfo(x),w}const cbt={kernelName:K0,backendName:"webgl",kernelFunc:ubt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hbt(n,t,e,s){let r=new $f(e,"max",!1);const a=s.runWebGLProgram(r,[n],"float32");r=new $f(e,"max",!0,!0,t);const i=s.runWebGLProgram(r,[n],"float32");return[a,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dbt={kernelName:Y0,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:s}=n,{filterSize:r,strides:a,pad:i,includeBatchInIndex:o}=t,l=e;F(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];F(Pn(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const d=kr(s.shape,r,a,c,i),[f,m]=hbt(s,o,d,l);return[f,m]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fbt(n,t,e,s){const r=ft(t),i=ft(n.shape)/r,o=Nt({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),l=Bl(o,"float32","mean",s),c=Nt({inputs:{x:l},attrs:{shape:e},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pbt={kernelName:mp,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:s}=n,{keepDims:r,axis:a}=t,i=e,o=s.shape.length,l=Zt(a,s.shape);let c=l;const d=We(c,o),f=d!=null,m=i.shouldExecuteOnCPU([s]),g=[];let b=s;if(f){if(m){const k=i.texData.get(b.dataId).values,$=new Array(o);for(let _=0;_<$.length;_++)$[_]=s.shape[d[_]];const I=IC(k,s.shape,s.dtype,d,$);b=i.makeTensorInfo($,s.dtype);const D=i.texData.get(b.dataId);D.values=I}else b=Ix(s,d,i);g.push(b),c=tn(c.length,o)}Bn("sum",c,o);const[x,v]=In(b.shape,c);let w=x;r&&(w=Je(x,l));const T=fbt(b,v,w,i);for(const C of g)i.disposeIntermediateTensorInfo(C);return T}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mbt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,o=r.shape.length,l=Zt(a,r.shape);let c=l;const d=We(c,o);let f=r;d!=null&&(f=ls({inputs:{x:r},backend:e,attrs:{perm:d}}),c=tn(c.length,r.shape.length)),Bn("min",c,o);const[m,g]=In(f.shape,c),b=ft(g),x=Nt({inputs:{x:f},backend:e,attrs:{shape:[-1,b]}}),v=Bl(x,x.dtype,"min",e);let w;if(i){const T=Je(m,l);w=Nt({inputs:{x:v},backend:e,attrs:{shape:T}})}else w=Nt({inputs:{x:v},backend:e,attrs:{shape:m}});return e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v),d!=null&&e.disposeIntermediateTensorInfo(f),w}const gbt={kernelName:gp,backendName:"webgl",kernelFunc:mbt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ybt=AC+`
  return min(a, b);
`,bbt=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Pl+`
  return result;
`,xbt=Un({opSnippet:ybt,packedOpSnippet:bbt,cpuKernelImpl:rft}),vbt={kernelName:Bc,backendName:"webgl",kernelFunc:xbt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wbt{constructor(t,e,s){this.variableNames=["x"],this.outputShape=e.map((d,f)=>d[0]+t[f]+d[1]);const r=t.length,a=Te(r),i=e.map(d=>d[0]).join(","),o=e.map((d,f)=>d[0]+t[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sbt{constructor(t,e,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((b,x)=>b[0]+t[x]+b[1]);const r=t.length,a=Te(r),i=e.map(b=>b[0]).join(","),o=e.map((b,x)=>b[0]+t[x]).join(","),l=is("rc",r),c=is("source",r),d=`${l[r-1]} < ${this.outputShape[r-1]}`,f=r===1?"source":`vec2(${c.slice(-2).join()})`,m=s==="reflect"?0:1;let g="";if(r===1){const b=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${m};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${m};
        }
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${b}
        result[0] = getChannel(getX(${c.join()}), ${f});
        ${l[r-1]} += 1;
        if(${d}) {
          ${b}
          result[1] = getChannel(getX(${c.join()}), ${f});
        }
      `}else{const b=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${m}) +
                gte * ((end - 1) * 2 - source + ${m});
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${b}
        result[0] = getChannel(getX(${c.join()}), ${f});
        ${l[r-1]} += 1;
        if(${d}) {
          ${b}
          result[1] = getChannel(getX(${c.join()}), ${f});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${b}
          result[2] = getChannel(getX(${c.join()}), ${f});
          ${l[r-1]} += 1;
          if(${d}) {
            ${b}
            result[3] = getChannel(getX(${c.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tbt=({inputs:n,backend:t,attrs:e})=>{const{x:s}=n,{paddings:r,mode:a}=e,i=lt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sbt(s.shape,r,a):new wbt(s.shape,r,a);return t.runWebGLProgram(i,[s],s.dtype)},Nbt={kernelName:yp,backendName:"webgl",kernelFunc:Tbt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cbt=`if (b == 0.0) return NAN;
  return mod(a, b);`,kbt=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Pl+`
  return result;
`,$bt=Un({opSnippet:Cbt,packedOpSnippet:kbt}),Ebt={kernelName:Vc,backendName:"webgl",kernelFunc:$bt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ibt{constructor(t,e,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${e-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${e-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Abt=`
if (a == b) {
  return 1.0;
};
return a / b;`,Rbt=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,dB=Un({opSnippet:Abt,packedOpSnippet:Rbt,checkOutOfBounds:!0}),Dbt={kernelName:Cc,backendName:"webgl",kernelFunc:dB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XD="return a - b;",fB=Un({opSnippet:XD,packedOpSnippet:XD,supportsComplex:!0,cpuKernelImpl:Cft}),Obt={kernelName:sh,backendName:"webgl",kernelFunc:fB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(n){const{inputs:t,backend:e,attrs:s}=n,{logits:r}=t,{dim:a}=s,i=Zt([a],r.shape),o=hB({inputs:{x:r},backend:e,attrs:{reductionIndices:i,keepDims:!1}}),l=Je(o.shape,i),c=Nt({inputs:{x:o},backend:e,attrs:{shape:l}}),d=fB({inputs:{a:r,b:c},backend:e}),f=lB({inputs:{x:d},backend:e}),m=Ax({inputs:{x:f},backend:e,attrs:{axis:i,keepDims:!1}}),g=Nt({inputs:{x:m},backend:e,attrs:{shape:l}}),b=dB({inputs:{a:f,b:g},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),b}const _bt={kernelName:Fp,backendName:"webgl",kernelFunc:pB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbt(n){const{inputs:t,backend:e,attrs:s}=n,{logits:r}=t,{numSamples:a,seed:i,normalized:o}=s,l=o?r:pB({inputs:{logits:r},backend:e,attrs:{dim:r.shape.length-1}}),c=l.shape[0],d=l.shape[1],f=new Ibt(c,d,a),m=[[i]],g=e.runWebGLProgram(f,[l],"int32",m);return o||e.disposeIntermediateTensorInfo(l),g}const Lbt={kernelName:Z0,backendName:"webgl",kernelFunc:Fbt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mbt=Er+`
  return -x;
`,zbt=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Pbt(n){const{inputs:t,backend:e}=n,{x:s}=t;if(e.shouldExecuteOnCPU([s])){const a=e.texData.get(s.dataId),[i,o]=ift(a.values,s.shape,s.dtype);return e.makeTensorInfo(o,s.dtype,i)}let r;return lt().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Hi(s.shape,zbt):r=new oa(s.shape,Mbt),e.runWebGLProgram(r,[s],s.dtype)}const Bbt={kernelName:bp,backendName:"webgl",kernelFunc:Pbt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vbt=ix;function Ubt(n){Ys("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s,c=e.readSync(r.dataId),d=e.readSync(a.dataId),{selectedIndices:f}=Vbt(c,d,i,o,l);return e.makeTensorInfo([f.length],"int32",new Int32Array(f))}const Wbt={kernelName:Q0,backendName:"webgl",kernelFunc:Ubt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gbt=ox;function jbt(n){Ys("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=s,d=e.readSync(r.dataId),f=e.readSync(a.dataId),{selectedIndices:m,validOutputs:g}=Gbt(d,f,i,o,l,c);return[e.makeTensorInfo([m.length],"int32",new Int32Array(m)),e.makeTensorInfo([],"int32",new Int32Array([g]))]}const Hbt={kernelName:J0,backendName:"webgl",kernelFunc:jbt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qbt=lx;function Kbt(n){Ys("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=s,d=e.readSync(r.dataId),f=e.readSync(a.dataId),m=i,g=o,b=l,x=c,{selectedIndices:v,selectedScores:w}=qbt(d,f,m,g,b,x);return[e.makeTensorInfo([v.length],"int32",new Int32Array(v)),e.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const Xbt={kernelName:tb,backendName:"webgl",kernelFunc:Kbt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ybt{constructor(t,e,s,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zbt=n=>{const{inputs:t,backend:e,attrs:s}=n,{indices:r}=t,{dtype:a,depth:i,onValue:o,offValue:l}=s,c=ft(r.shape),d=new Ybt(c,i,o,l),f=Nt({inputs:{x:r},backend:e,attrs:{shape:[c]}}),m=e.runWebGLProgram(d,[f],a);e.disposeIntermediateTensorInfo(f);const g=[...r.shape,i],b=Nt({inputs:{x:m},backend:e,attrs:{shape:g}});return e.disposeIntermediateTensorInfo(m),b},Qbt={kernelName:wp,backendName:"webgl",kernelFunc:Zbt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a0(n){const{inputs:t,backend:e}=n,{x:s}=t;if(s.dtype==="complex64"){const r=wm({inputs:{input:s},backend:e}),a=a0({inputs:{x:r},backend:e}),i=Rx({inputs:{input:s},backend:e}),o=a0({inputs:{x:i},backend:e}),l=To({inputs:{real:a,imag:o},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(o),l}else return Sm({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:e})}const Jbt={kernelName:Pp,backendName:"webgl",kernelFunc:a0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mB(n){const{inputs:t,backend:e}=n,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=wm({inputs:{input:s},backend:e}),a=mB({inputs:{x:r},backend:e}),i=Rx({inputs:{input:s},backend:e}),o=a0({inputs:{x:i},backend:e}),l=To({inputs:{real:a,imag:o},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(o),l}else return Sm({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:e})}const txt={kernelName:vp,backendName:"webgl",kernelFunc:mB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ext(n){const{inputs:t,backend:e,attrs:s}=n,{axis:r}=s;if(t.length===1)return XS({inputs:{input:t[0]},backend:e,attrs:{dim:r}});const a=t[0].shape,i=t[0].dtype;t.forEach(d=>{zn(a,d.shape,"All tensors passed to stack must have matching shapes"),F(i===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=t.map(d=>{const f=XS({inputs:{input:d},backend:e,attrs:{dim:r}});return o.push(f),f}),c=tB({inputs:l,backend:e,attrs:{axis:r}});return o.forEach(d=>e.disposeIntermediateTensorInfo(d)),c}const nxt={kernelName:Sp,backendName:"webgl",kernelFunc:ext};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sxt{constructor(t,e,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((c,d)=>c[0]+t[d]+c[1]);const r=t.length,a=Te(r),i=e.map(c=>c[0]).join(","),o=e.map((c,d)=>c[0]+t[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rxt{constructor(t,e,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((x,v)=>x[0]+t[v]+x[1]);const r=t.length,a=Te(r),i=e.map(x=>x[0]).join(","),o=e.map((x,v)=>x[0]+t[v]).join(","),l=is("rc",r),c=is("source",r),d=`${l[r-1]} < ${this.outputShape[r-1]}`,f=r===1?"source":`vec2(${c.slice(-2).join()})`,m=[`${a} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${d}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${d}) {`],g=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let b="";for(let x=0,v=r===1?2:4;x<v;x++)b+=`
        ${m[x]}
        if (${g}) {
          result[${x}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${x}] = getChannel(getX(${c.join()}), ${f});
        }
      `;b+=r===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${b}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gB=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{paddings:a,constantValue:i}=s;if(ft(r.shape)===0){const c=a.map((d,f)=>d[0]+r.shape[f]+d[1]);return Sm({backend:e,attrs:{shape:c,value:i,dtype:r.dtype}})}const o=lt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rxt(r.shape,a,i):new sxt(r.shape,a,i),l=[[i]];return e.runWebGLProgram(o,[r],r.dtype,l)},axt={kernelName:Tp,backendName:"webgl",kernelFunc:gB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ixt=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,oxt=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Pl+`
  return result;
`,lxt=Un({opSnippet:ixt,packedOpSnippet:oxt}),uxt={kernelName:Wc,backendName:"webgl",kernelFunc:lxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cxt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,o=r.shape.length,l=[],c=Zt(a,r.shape);let d=c;const f=We(d,o);let m=r;f!=null&&(m=ls({inputs:{x:r},backend:e,attrs:{perm:f}}),d=tn(d.length,o),l.push(m)),Bn("prod",d,o);let g;if(e.shouldExecuteOnCPU([m])){const b=e.texData.get(m.dataId).values,{outVals:x,outShape:v,outDtype:w}=lft(m.shape,m.dtype,b,d);g=e.makeTensorInfo(v,w,x)}else{const[b,x]=In(m.shape,d),v=ft(x),w=Nt({inputs:{x:m},backend:e,attrs:{shape:[-1,v]}}),T=kb(r.dtype),C=Bl(w,T,"prod",e);g=Nt({inputs:{x:C},backend:e,attrs:{shape:b}}),l.push(w),l.push(C)}if(i){l.push(g);const b=Je(g.shape,c);g=Nt({inputs:{x:g},backend:e,attrs:{shape:b}})}return l.forEach(b=>e.disposeIntermediateTensorInfo(b)),g}const hxt={kernelName:Cp,backendName:"webgl",kernelFunc:cxt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dxt(n){const{inputs:t,backend:e,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=t,{outputRaggedRank:o}=s,l=r.map(w=>e.readSync(w.dataId)),c=r.map(w=>w.shape),d=e.readSync(a.dataId),f=e.readSync(i.dataId),[m,g,b]=uft(l,c,d,a.shape,a.dtype,f,i.shape,o),x=m.map(w=>e.makeTensorInfo([w.length],"int32",w)),v=e.makeTensorInfo(b,a.dtype,g);return x.concat([v])}const fxt={kernelName:eb,backendName:"webgl",kernelFunc:dxt};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pxt(n){const{inputs:t,backend:e}=n,{starts:s,limits:r,deltas:a}=t,i=e.readSync(s.dataId),o=e.readSync(r.dataId),l=e.readSync(a.dataId),[c,d]=cft(i,s.shape,s.dtype,o,r.shape,l,a.shape),f=e.makeTensorInfo([c.length],"int32",c),m=e.makeTensorInfo([d.length],s.dtype,d);return[f,m]}const mxt={kernelName:nb,backendName:"webgl",kernelFunc:pxt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gxt(n){const{inputs:t,backend:e,attrs:s}=n,{shape:r,values:a,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=s,c=e.readSync(r.dataId),d=e.readSync(a.dataId),f=e.readSync(i.dataId),m=o.map(v=>e.readSync(v.dataId)),g=o.map(v=>v.shape),[b,x]=hft(c,r.shape,d,a.shape,a.dtype,f,i.shape,m,g,l);return e.makeTensorInfo(b,a.dtype,x)}const yxt={kernelName:sb,backendName:"webgl",kernelFunc:gxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yB=n=>{const{backend:t,attrs:e}=n,{start:s,stop:r,step:a,dtype:i}=e,o=dft(s,r,a,i);return t.makeTensorInfo([o.length],i,o)},bxt={kernelName:rb,backendName:"webgl",kernelFunc:yB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xxt="return 1.0 / x;",vxt=le({opSnippet:xxt}),wxt={kernelName:Gc,backendName:"webgl",kernelFunc:vxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sxt=Er+`
  return (x < 0.0) ? 0.0 : x;
`,Txt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Nxt=le({opSnippet:Sxt,packedOpSnippet:Txt}),Cxt={kernelName:jc,backendName:"webgl",kernelFunc:Nxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kxt=Er+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,$xt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ext=le({opSnippet:kxt,packedOpSnippet:$xt}),Ixt={kernelName:Hc,backendName:"webgl",kernelFunc:Ext};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Axt{constructor(t,e,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,l,c]=t;this.outputShape=[i,e,s,c];const d=[r&&e>1?o-1:o,r&&s>1?l-1:l],f=[r&&e>1?e-1:e,r&&s>1?s-1:s];let m;a?m="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":m="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/f[0]},
          ${d[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rxt{constructor(t,e,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,c]=t;this.outputShape=[i,e,s,c];const d=[r&&e>1?o-1:o,r&&s>1?l-1:l],f=[r&&e>1?e-1:e,r&&s>1?s-1:s];let m;a?m="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":m="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/f[0]},
          ${d[1]/f[1]},
          ${d[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dxt(n){const{inputs:t,backend:e,attrs:s}=n,{images:r}=t,{alignCorners:a,halfPixelCenters:i,size:o}=s,[l,c]=o,d=lt().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Rxt(r.shape,l,c,a,i):new Axt(r.shape,l,c,a,i);return e.runWebGLProgram(d,[r],"float32")}const Oxt={kernelName:Ep,backendName:"webgl",kernelFunc:Dxt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _xt{constructor(t,e,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,a]=e,[,i,o]=t,l=[s&&i>1?r-1:r,s&&o>1?a-1:a],c=[s&&i>1?i-1:i,s&&o>1?o-1:o],d=l[0]/c[0],f=l[1]/c[1],m=1/d,g=1/f,b=Math.ceil(m)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${f});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${g});

        const int winHeight = int(${b});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fxt(n){const{inputs:t,backend:e,attrs:s}=n,{images:r,dy:a}=t,{alignCorners:i}=s,o=new _xt(a.shape,r.shape,i);return e.runWebGLProgram(o,[a],a.dtype)}const Lxt={kernelName:ob,backendName:"webgl",kernelFunc:Fxt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mxt{constructor(t,e,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,l,c]=t;this.outputShape=[i,e,s,c];const d=[r&&e>1?o-1:o,r&&s>1?l-1:l],f=[r&&e>1?e-1:e,r&&s>1?s-1:s],m=r?"0.5":"0.0";let g;a?g="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/f[0]},
          ${d[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zxt{constructor(t,e,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,c]=t;this.outputShape=[i,e,s,c];const d=[r&&e>1?o-1:o,r&&s>1?l-1:l],f=[r&&e>1?e-1:e,r&&s>1?s-1:s],m=r?"0.5":"0.0";let g;a?g="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/f[0]},
          ${d[1]/f[1]},
          ${d[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxt(n){const{inputs:t,backend:e,attrs:s}=n,{images:r}=t,{alignCorners:a,halfPixelCenters:i,size:o}=s,[l,c]=o,d=lt().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new zxt(r.shape,l,c,a,i):new Mxt(r.shape,l,c,a,i);return e.runWebGLProgram(d,[r],r.dtype)}const Bxt={kernelName:$p,backendName:"webgl",kernelFunc:Pxt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vxt{constructor(t,e,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,a]=e,[,i,o]=t,l=[s&&i>1?r-1:r,s&&o>1?a-1:a],c=[s&&i>1?i-1:i,s&&o>1?o-1:o],d=l[0]/c[0],f=l[1]/c[1],m=1/d,g=1/f,b=Math.ceil(m)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${f});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${g});

        const int winHeight = int(${b});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uxt(n){const{inputs:t,backend:e,attrs:s}=n,{images:r,dy:a}=t,{alignCorners:i}=s,o=new Vxt(a.shape,r.shape,i);return e.runWebGLProgram(o,[a],a.dtype)}const Wxt={kernelName:ib,backendName:"webgl",kernelFunc:Uxt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gxt{constructor(t,e){this.variableNames=["x"];const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=t,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const r=o=>e.indexOf(o)!==-1&&t[o]!==1?`${t[o]} - coords[${o}] - 1`:`coords[${o}]`,a=t.map((o,l)=>r(l)).join(","),i=Te(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jxt{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=t;const r=is("rc",s),a=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,o=Te(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${a}){
            result.g = ${c(r.slice())};
          }
          if(${i}) {
            result.b = ${d(r.slice())};
            if(${a}) {
              result.a = ${f(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(b){return m(b)}function c(b){return b[s-1]="("+b[s-1]+" + 1)",m(b)}function d(b){return b[s-2]="("+b[s-2]+" + 1)",m(b)}function f(b){return b[s-1]="("+b[s-1]+" + 1)",b[s-2]="("+b[s-2]+" + 1)",m(b)}function m(b){const x=t.map((T,C)=>g(C,b)),v=x.join(","),w=x.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${w}))`}function g(b,x){return e.indexOf(b)!==-1&&t[b]!==1?`${t[b]} - ${x[b]} - 1`:`${x[b]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hxt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{dims:a}=s,i=r.shape.length,o=Zt(a,r.shape);if(i===0)return zs({inputs:{x:r},backend:e});const l=lt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jxt(r.shape,o):new Gxt(r.shape,o);return e.runWebGLProgram(l,[r],r.dtype)}const qxt={kernelName:Ip,backendName:"webgl",kernelFunc:Hxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kxt{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=t[1],r=t[2];this.outputShape=t;let a="";typeof e=="number"?a=`float outputValue = ${e.toFixed(2)};`:a=`
        vec3 fill = vec3(${e.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xxt={kernelName:Nb,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:s}=n,{radians:r,fillValue:a,center:i}=t,o=e,l=new Kxt(s.shape,a),[c,d]=EN(i,s.shape[1],s.shape[2]),f=[[c,d,Math.sin(r),Math.cos(r)]];return o.runWebGLProgram(l,[s],s.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yxt=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Zxt=le({opSnippet:Yxt}),Qxt={kernelName:qc,backendName:"webgl",kernelFunc:Zxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jxt="return inversesqrt(x);",t1t=le({opSnippet:Jxt,cpuKernelImpl:fft}),e1t={kernelName:Kc,backendName:"webgl",kernelFunc:t1t};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OC{constructor(t,e,s,r,a,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const c=Te(a.length),d=Te(i.length);let f="";s===1?f="i":s===2&&(f="i, j");const m=`getIndices(${f})`;let g="";r===1?g="i":r===2&&(g="i, coords[1]");const b=`getUpdates(${g})`;let x="";l&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,w=e>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${d} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${e}; j++) {
              int index = round(${m});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${b};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n1t{constructor(t,e,s,r,a,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const c=Te(a.length),d=Te(i.length);let f="";s===1?f="i":s===2&&(f="i, j");const m=`getIndices(${f})`;let g="";r===1?g="i":r===2&&(g="i, coords[1]");const b=`getUpdates(${g})`;let x="";l&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,w=e>1?"strides[j]":"strides",T=e>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${d} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${e}; j+=2) {
              ivec4 index = round(${m});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${e}) {
                flattenedIndex += index.yw * ${T};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${b};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s1t(n){const{inputs:t,backend:e,attrs:s}=n,{indices:r,updates:a}=t,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:c,strides:d,outputSize:f}=vo(a,r,i),m=[f/c,c];if(f===0)return e.makeTensorInfo(i,r.dtype);const g=Nt({inputs:{x:r},backend:e,attrs:{shape:[l,o]}}),b=Nt({inputs:{x:a},backend:e,attrs:{shape:[l,c]}}),x=e.makeTensorInfo([],"float32",new Float32Array([0]));let v;lt().getBool("WEBGL_PACK")?v=new n1t(l,o,g.shape.length,b.shape.length,d,m):v=new OC(l,o,g.shape.length,b.shape.length,d,m);const w=e.runWebGLProgram(v,[b,g,x],b.dtype),T=Nt({inputs:{x:w},backend:e,attrs:{shape:i}});return e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(x),T}const r1t={kernelName:lb,backendName:"webgl",kernelFunc:s1t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a1t{constructor(t,e,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,s];const a="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(e+1))}; ++i) { if (left >= right) break;`,o=lt().getNumber("WEBGL_VERSION")===2?a:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i1t(n){const{inputs:t,backend:e,attrs:s}=n,{sortedSequence:r,values:a}=t,{side:i}=s,o=new a1t(r.shape[0],r.shape[1],a.shape[1],i),l=[[r.shape[1]]];return e.runWebGLProgram(o,[r,a],"int32",l)}const o1t={kernelName:cb,backendName:"webgl",kernelFunc:i1t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l1t{constructor(t,e,s){this.variableNames=["c","a","b"],this.outputShape=e;let r,a;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)a="resRC",r="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let d=0;d<e.length;d++)c.push(`${o[d]}`),d<t&&l.push(`${o[d]}`);r=l.join(),a=c.join()}const i=Te(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1t(n){const{inputs:t,backend:e}=n,{condition:s,t:r,e:a}=t,i=new l1t(s.shape.length,r.shape,r.shape.length);return e.runWebGLProgram(i,[s,r,a],ys(r.dtype,a.dtype))}const c1t={kernelName:Ap,backendName:"webgl",kernelFunc:u1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h1t=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${fx};
  float scale = ${px};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,d1t=le({opSnippet:h1t}),f1t={kernelName:Xc,backendName:"webgl",kernelFunc:d1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p1t=Sh+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,m1t=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,g1t=le({opSnippet:p1t,packedOpSnippet:m1t,cpuKernelImpl:mft}),y1t={kernelName:Jc,backendName:"webgl",kernelFunc:g1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b1t=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,x1t=le({opSnippet:b1t}),v1t={kernelName:Qc,backendName:"webgl",kernelFunc:x1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1t=Sh+`
  return sin(x);
`,S1t=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Pl}
  return result;
`,T1t=le({opSnippet:w1t,packedOpSnippet:S1t}),N1t={kernelName:Yc,backendName:"webgl",kernelFunc:T1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C1t=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,k1t=le({opSnippet:C1t}),$1t={kernelName:Zc,backendName:"webgl",kernelFunc:k1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E1t=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,I1t=le({opSnippet:E1t}),A1t={kernelName:th,backendName:"webgl",kernelFunc:I1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R1t=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockShape:a,paddings:i}=s;F(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((w,T)=>w*T),l=[[0,0]];l.push(...i);for(let w=1+a.length;w<r.shape.length;++w)l.push([0,0]);const c=[],d=gB({inputs:{x:r},backend:e,attrs:{paddings:l,constantValue:0}}),f=im(d.shape,a,o,!1),m=om(f.length,a.length,!1),g=lm(d.shape,a,o,!1),b=Nt({inputs:{x:d},backend:e,attrs:{shape:f}}),x=ls({inputs:{x:b},backend:e,attrs:{perm:m}}),v=Nt({inputs:{x},backend:e,attrs:{shape:g}});return c.push(d),c.push(b),c.push(x),c.forEach(w=>e.disposeIntermediateTensorInfo(w)),v},D1t={kernelName:Op,backendName:"webgl",kernelFunc:R1t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1t(n){const{inputs:t,backend:e}=n,{indices:s,values:r,denseShape:a,defaultValue:i}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=e.readSync(s.dataId),l=e.readSync(r.dataId),c=e.readSync(a.dataId),d=e.readSync(i.dataId)[0],[f,m,g,b,x]=yft(o,s.shape,s.dtype,l,r.dtype,c,d);return[e.makeTensorInfo(m,s.dtype,f),e.makeTensorInfo([m[0]],r.dtype,g),e.makeTensorInfo([b.length],"bool",new Uint8Array(b.map(v=>Number(v)))),e.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const _1t={kernelName:hb,backendName:"webgl",kernelFunc:O1t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1t(n){const{inputs:t,backend:e}=n,{inputIndices:s,inputShape:r,newShape:a}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(e.readSync(r.dataId)),o=e.readSync(s.dataId),l=Array.from(e.readSync(a.dataId)),[c,d,f]=bft(o,s.shape,s.dtype,i,l);return[e.makeTensorInfo(d,s.dtype,c),e.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}const L1t={kernelName:db,backendName:"webgl",kernelFunc:F1t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1t(n){const{inputs:t,backend:e}=n,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const i=e.readSync(s.dataId),o=e.readSync(r.dataId),l=e.readSync(a.dataId),[c,d]=VP(i,s.shape,s.dtype,o,l,!0);return e.makeTensorInfo(d,s.dtype,c)}const z1t={kernelName:fb,backendName:"webgl",kernelFunc:M1t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1t(n){const{inputs:t,backend:e}=n,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const i=e.readSync(s.dataId),o=e.readSync(r.dataId),l=e.readSync(a.dataId),[c,d]=VP(i,s.shape,s.dtype,o,l);return e.makeTensorInfo(d,s.dtype,c)}const B1t={kernelName:pb,backendName:"webgl",kernelFunc:P1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1t(n){const{inputs:t,backend:e,attrs:s}=n,{sparseIndices:r,sparseValues:a,defaultValue:i}=t,{outputShape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:d,strides:f,outputSize:m}=vo(a,r,o),g=!1;if(a.dtype==="string"){const w=e.bufferSync(r),T=e.bufferSync(a),C=ni(e.readSync(i.dataId)[0]),k=pft(w,T,o,m,d,c,l,f,C,g);return e.makeTensorInfo(o,k.dtype,k.values)}const b=new OC(c,l,r.shape.length,a.shape.length,f,[m,1],g),x=e.runWebGLProgram(b,[a,r,i],a.dtype),v=Nt({inputs:{x},backend:e,attrs:{shape:o}});return e.disposeIntermediateTensorInfo(x),v}const U1t={kernelName:mb,backendName:"webgl",kernelFunc:V1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1t(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{numOrSizeSplits:a,axis:i}=s,o=Zt(i,r.shape)[0],l=WN(r,a,o),c=r.shape.length,d=new Array(c).fill(0),f=r.shape.slice();return l.map(m=>{const g=[...f];g[o]=m;const b=Th({inputs:{x:r},backend:e,attrs:{begin:d,size:g}});return d[o]+=m,b})}const G1t={kernelName:_p,backendName:"webgl",kernelFunc:W1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YD="return sqrt(x);",j1t=le({opSnippet:YD,packedOpSnippet:YD,cpuKernelImpl:xft}),H1t={kernelName:eh,backendName:"webgl",kernelFunc:j1t};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q1t="return x * x;",K1t=le({opSnippet:q1t}),X1t={kernelName:gb,backendName:"webgl",kernelFunc:K1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZD="return (a - b) * (a - b);",Y1t=Un({opSnippet:ZD,packedOpSnippet:ZD}),Z1t={kernelName:nh,backendName:"webgl",kernelFunc:Y1t};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q1t(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const a=e.readSync(r.dataId),i=ii(a),o=vft(i,"string",s);return e.makeTensorInfo(r.shape,"string",o)}const J1t={kernelName:Lp,backendName:"webgl",kernelFunc:Q1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tvt({inputs:n,attrs:t,backend:e}){const{x:s}=n,r=Er+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,a=new oa(s.shape,r);return e.runWebGLProgram(a,[s],s.dtype)}const evt={kernelName:oh,backendName:"webgl",kernelFunc:tvt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nvt{constructor(t,e,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,a=Te(s.length),i=Te(s.length);let o="";if(r===1)o="coords * strides + begin";else{let l=0;o=s.map((c,d)=>(l++,s.length===1?`coords * strides[${d}] + begin[${d}]`:`coords[${l-1}] * strides[${d}] + begin[${d}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${t});
      ${a} strides = ${a}(${e});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function svt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{begin:a,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:d,newAxisMask:f,shrinkAxisMask:m}=s,{finalShapeSparse:g,finalShape:b,isIdentity:x,sliceDim0:v,isSimpleSlice:w,begin:T,end:C,strides:k}=NN(r.shape,a,i,o,l,c,d,f,m);let $;if(x)$=Nt({inputs:{x:r},backend:e,attrs:{shape:b}});else if(v||w){F(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const D=wN(T,C,k),_=Th({inputs:{x:r},backend:e,attrs:{begin:T,size:D}});$=Nt({inputs:{x:_},backend:e,attrs:{shape:b}}),e.disposeIntermediateTensorInfo(_)}else if(e.shouldExecuteOnCPU([r])){const _=e.readSync(r.dataId),O=Ht(r.shape,r.dtype,_),L=wft(g,O,k,T);$=e.makeTensorInfo(b,r.dtype,L.values)}else{const _=new nvt(T,k,g);$=e.runWebGLProgram(_,[r],r.dtype)}const I=Nt({inputs:{x:$},backend:e,attrs:{shape:b}});return e.disposeIntermediateTensorInfo($),I}const rvt={kernelName:yb,backendName:"webgl",kernelFunc:svt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function avt(n){const{inputs:t,backend:e,attrs:s}=n,{separator:r,nGramWidths:a,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=s,{data:d,dataSplits:f}=t,m=e.readSync(d.dataId),g=e.readSync(f.dataId),[b,x]=Sft(m,g,r,a,i,o,l,c);return[e.makeTensorInfo([b.length],"string",b),e.makeTensorInfo(f.shape,"int32",x)]}const ivt={kernelName:bb,backendName:"webgl",kernelFunc:avt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ovt(n){const{inputs:t,backend:e,attrs:s}=n,{skipEmpty:r}=s,{input:a,delimiter:i}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=e.readSync(a.dataId),l=e.readSync(i.dataId)[0],[c,d,f]=Tft(o,l,r),m=d.length;return[e.makeTensorInfo([m,2],"int32",c),e.makeTensorInfo([m],"string",d),e.makeTensorInfo([2],"int32",new Int32Array(f))]}const lvt={kernelName:xb,backendName:"webgl",kernelFunc:ovt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uvt(n){const{inputs:t,backend:e,attrs:s}=n,{numBuckets:r}=s,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=e.readSync(a.dataId),o=Nft(i,r);return e.makeTensorInfo(a.shape,"int32",o)}const cvt={kernelName:vb,backendName:"webgl",kernelFunc:uvt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hvt="return tan(x);",dvt=le({opSnippet:hvt}),fvt={kernelName:rh,backendName:"webgl",kernelFunc:dvt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pvt=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,mvt=le({opSnippet:pvt}),gvt={kernelName:ah,backendName:"webgl",kernelFunc:mvt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yvt(n){const{inputs:t,backend:e,attrs:s}=n,{tensor:r,indices:a,updates:i}=t,{sliceRank:o,numUpdates:l,sliceSize:c,strides:d,outputSize:f}=vo(i,a,r.shape),m=[f/c,c];if(f===0)return e.makeTensorInfo(r.shape,a.dtype);const g=Nt({inputs:{x:a},backend:e,attrs:{shape:[l,o]}}),b=Nt({inputs:{x:i},backend:e,attrs:{shape:[l,c]}}),x=Nt({inputs:{x:r},backend:e,attrs:{shape:m}}),v=new OC(l,o,g.shape.length,b.shape.length,d,m,!1,!0),w=e.runWebGLProgram(v,[b,g,x],x.dtype),T=Nt({inputs:{x:w},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(w),T}const bvt={kernelName:ub,backendName:"webgl",kernelFunc:yvt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xvt{constructor(t,e){this.variableNames=["A"];const s=new Array(t.length);for(let i=0;i<s.length;i++)s[i]=t[i]*e[i];this.outputShape=s,this.rank=s.length;const r=Te(this.rank),a=vvt(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function vvt(n){const t=n.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${n[0]})`;const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<n.length;r++)s.push(`imod(${e[r]}, ${n[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bB(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{reps:a}=s;if(r.dtype==="string"||r.shape.length>5){const l=e.readSync(r.dataId),c=r.dtype==="string"?l.map(m=>ni(m)):l,d=Ht(r.shape,r.dtype,c),f=kft(d,a);return e.makeTensorInfo(f.shape,f.dtype,f.values)}const i=new xvt(r.shape,a);return e.runWebGLProgram(i,[r],r.dtype)}const wvt={kernelName:ih,backendName:"webgl",kernelFunc:bB};class Svt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Tvt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jo(n,t){t!==null&&n.disposeIntermediateTensorInfo(t)}function QD(n){let t=1;for(;t<n;)t*=2;return t}function Nvt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{k:a,sorted:i}=s,o=lt().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=lt().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,d=c[c.length-1];if(e.shouldExecuteOnCPU([r])||d<o||a>l){const L=e.readSync(r.dataId),[R,V]=$ft(L,c,r.dtype,a,i);return[e.makeTensorInfo(R.shape,R.dtype,R.values),e.makeTensorInfo(V.shape,V.dtype,V.values)]}if(a===0)return c[c.length-1]=0,[e.makeTensorInfo(c,r.dtype,[]),e.makeTensorInfo(c,"int32",[])];if(d===1)return[r,Sm({attrs:{shape:c,dtype:"int32",value:0},backend:e})];const f=e.texData.get(r.dataId),m=f!==null&&f.isPacked,g=m?e.unpackTensor(r):r,x=ft(c)/d,v=Nt({inputs:{x:g},attrs:{shape:[x,d]},backend:e});m&&jo(e,g);const w=QD(a),T=QD(d);let C=null;const k=()=>C===null?[v,v]:[v,C],$=(L,R,V)=>{const Y=k(),Q=new Svt(V),B=[[d],[C===null?1:0],[Number.NEGATIVE_INFINITY],[L],[R]],W=C;C=e.runWebGLProgram(Q,Y,"int32",B),jo(e,W)};for(let L=1;L<w;L*=2){const R=L*2;for(let V=L;V>=1;V/=2)$(R,V,[x,T])}for(let L=T;L>w;L/=2){const R=k(),V=new Tvt([x,L/2]),Q=[[d],[C===null?1:0],[w]],tt=C;C=e.runWebGLProgram(V,R,"int32",Q),jo(e,tt);const B=w/2,W=B*2;for(let X=B;X>=1;X/=2)$(W,X,C.shape)}let I=C;C=Th({inputs:{x:C},backend:e,attrs:{begin:0,size:[x,a]}}),jo(e,I);let D=cB({inputs:{x:v,indices:C},backend:e,attrs:{axis:1,batchDims:1}});jo(e,v);const _=c.slice(0,-1);_.push(a),I=C,C=Nt({inputs:{x:C},attrs:{shape:_},backend:e}),jo(e,I);const O=D;return D=Nt({inputs:{x:D},attrs:{shape:_},backend:e}),jo(e,O),[D,C]}const Cvt={kernelName:wb,backendName:"webgl",kernelFunc:Nvt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kvt{constructor(t,e,s,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const o=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${e}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${e}));
                float mapY = mapCoord(inY, float(${t}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $vt(n){const{inputs:t,backend:e,attrs:s}=n,{image:r,transforms:a}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=s,[d,f,m,g]=r.shape,[b,x]=c??[f,m],v=[d,b,x,g],w=new kvt(f,m,i,o,l,v);return e.runWebGLProgram(w,[r,a],"float32")}const Evt={kernelName:Sb,backendName:"webgl",kernelFunc:$vt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ivt(n){const{inputs:t,attrs:e,backend:s}=n,{axis:r}=e,{x:a}=t;xm(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(a.dataId),{outputValues:o,outputShape:l,indices:c}=Eft(i,r,a.shape,a.dtype);return[s.makeTensorInfo(l,a.dtype,o),s.makeTensorInfo([c.length],"int32",c)]}const Avt={kernelName:Tb,backendName:"webgl",kernelFunc:Ivt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rvt(n){const{inputs:t,backend:e,attrs:s}=n,{value:r}=t;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r,o=i.shape.length,l=r.shape[a],c=new Array(o-1);let d=0;for(let x=0;x<o;x++)x!==a&&(c[d++]=i.shape[x]);const f=[],m=new Array(o).fill(0),g=i.shape.slice();g[a]=1;const b=new Array(l);for(let x=0;x<b.length;x++){m[a]=x;const v=Th({inputs:{x:i},backend:e,attrs:{begin:m,size:g}}),w=Nt({inputs:{x:v},backend:e,attrs:{shape:c}});b[x]=w,f.push(v)}return f.forEach(x=>e.disposeIntermediateTensorInfo(x)),b}const Dvt={kernelName:Mp,backendName:"webgl",kernelFunc:Rvt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ovt{constructor(t,e){this.variableNames=["x","segmentIds"];const s=t.windowSize,r=t.batchSize,a=t.inSize,i=t.numSegments,o=i*Math.ceil(a/s);this.outputShape=[r,o];const l="0.0",c="sumValue",d=Math.floor(s/4)*4,f=s%4,m=`
        sumValue += dot(values, segFilter);
    `;let g="";a%s>0&&(g=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let b="";a%s>0&&(b=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${b}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${m}
        }

        int inIdx = inOffset + ${d};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${m}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${m}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${m}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _vt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,segmentIds:a}=t,{numSegments:i}=s,o=r.shape.length,l=[];let c=0;const d=We([c],o);let f=r;d!=null&&(f=ls({inputs:{x:r},backend:e,attrs:{perm:d}}),l.push(f),c=tn(1,o)[0]);const m=XL(f.shape,c,i),g=ft([f.shape[c]]),b=Nt({inputs:{x:f},backend:e,attrs:{shape:[-1,g]}});l.push(b);const x=kb(r.dtype),v=(k,$,I,D,_)=>{const O=k.shape[0],L=k.shape[1],R=KL(L,_),V={windowSize:R,inSize:L,batchSize:O,numSegments:_},Y=new Ovt(V,$),Q=e.compileAndRun(Y,[k,I],D);if(l.push(Q),Q.shape[1]===_)return Q;const tt=yB({backend:e,attrs:{start:0,stop:_,step:1,dtype:"float32"}}),B=bB({inputs:{x:tt},backend:e,attrs:{reps:[L/R]}});return l.push(tt),l.push(B),v(Q,$,B,D,_)},w=v(b,"unsortedSegmentSum",a,x,i),T=Nt({inputs:{x:w},backend:e,attrs:{shape:m}});let C=T;if(d!=null){l.push(T);const k=go(d);C=ls({inputs:{x:C},backend:e,attrs:{perm:k}})}return l.forEach(k=>e.disposeIntermediateTensorInfo(k)),C}const Fvt={kernelName:zp,backendName:"webgl",kernelFunc:_vt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lvt=[xpt,wpt,Npt,$pt,Ipt,Dpt,_pt,Lpt,Bpt,Upt,jpt,Kpt,Zpt,emt,rmt,imt,lmt,dmt,pmt,gmt,vmt,$mt,Imt,Omt,Fmt,Vmt,Wmt,qmt,npt,Ymt,egt,agt,hgt,pgt,ggt,bgt,vgt,Ngt,$gt,Agt,Dgt,_gt,Lgt,Pgt,Vgt,jgt,qgt,Ygt,Jgt,eyt,ayt,uyt,fyt,gyt,xyt,vyt,Syt,Nyt,kyt,Eyt,Ayt,_yt,Myt,Byt,Uyt,jyt,Kyt,Qyt,n0t,ept,r0t,Jmt,o0t,c0t,f0t,rpt,y0t,w0t,T0t,$0t,A0t,_0t,M0t,V0t,j0t,K0t,Y0t,tbt,nbt,rbt,lbt,cbt,dbt,pbt,gbt,vbt,Nbt,Ebt,Lbt,opt,Bbt,Wbt,Hbt,Xbt,Mmt,Qbt,txt,nxt,axt,uxt,ipt,hxt,fxt,mxt,yxt,bxt,zmt,Dbt,wxt,Cxt,Ixt,upt,Oxt,Lxt,Bxt,Wxt,qxt,Xxt,Qxt,e1t,r1t,o1t,c1t,f1t,y1t,v1t,N1t,$1t,Cmt,_bt,A1t,D1t,_1t,L1t,z1t,B1t,U1t,G1t,H1t,X1t,Z1t,J1t,evt,rvt,ivt,lvt,cvt,Obt,gpt,fvt,gvt,bvt,wvt,Cvt,Evt,ypt,Avt,Dvt,Fvt,Jbt];for(const n of Lvt)Cb(n);var Pd={exports:{}};const Mvt=ZS(brt),zvt=ZS(BQ);/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Pvt=Pd.exports,JD;function Bvt(){return JD||(JD=1,function(n,t){(function(e,s){s(t,Mvt,zvt)})(Pvt,function(e,s,r){const a={1:{name:"/m/01g317",id:1,displayName:"person"},2:{name:"/m/0199g",id:2,displayName:"bicycle"},3:{name:"/m/0k4j",id:3,displayName:"car"},4:{name:"/m/04_sv",id:4,displayName:"motorcycle"},5:{name:"/m/05czz6l",id:5,displayName:"airplane"},6:{name:"/m/01bjv",id:6,displayName:"bus"},7:{name:"/m/07jdr",id:7,displayName:"train"},8:{name:"/m/07r04",id:8,displayName:"truck"},9:{name:"/m/019jd",id:9,displayName:"boat"},10:{name:"/m/015qff",id:10,displayName:"traffic light"},11:{name:"/m/01pns0",id:11,displayName:"fire hydrant"},13:{name:"/m/02pv19",id:13,displayName:"stop sign"},14:{name:"/m/015qbp",id:14,displayName:"parking meter"},15:{name:"/m/0cvnqh",id:15,displayName:"bench"},16:{name:"/m/015p6",id:16,displayName:"bird"},17:{name:"/m/01yrx",id:17,displayName:"cat"},18:{name:"/m/0bt9lr",id:18,displayName:"dog"},19:{name:"/m/03k3r",id:19,displayName:"horse"},20:{name:"/m/07bgp",id:20,displayName:"sheep"},21:{name:"/m/01xq0k1",id:21,displayName:"cow"},22:{name:"/m/0bwd_0j",id:22,displayName:"elephant"},23:{name:"/m/01dws",id:23,displayName:"bear"},24:{name:"/m/0898b",id:24,displayName:"zebra"},25:{name:"/m/03bk1",id:25,displayName:"giraffe"},27:{name:"/m/01940j",id:27,displayName:"backpack"},28:{name:"/m/0hnnb",id:28,displayName:"umbrella"},31:{name:"/m/080hkjn",id:31,displayName:"handbag"},32:{name:"/m/01rkbr",id:32,displayName:"tie"},33:{name:"/m/01s55n",id:33,displayName:"suitcase"},34:{name:"/m/02wmf",id:34,displayName:"frisbee"},35:{name:"/m/071p9",id:35,displayName:"skis"},36:{name:"/m/06__v",id:36,displayName:"snowboard"},37:{name:"/m/018xm",id:37,displayName:"sports ball"},38:{name:"/m/02zt3",id:38,displayName:"kite"},39:{name:"/m/03g8mr",id:39,displayName:"baseball bat"},40:{name:"/m/03grzl",id:40,displayName:"baseball glove"},41:{name:"/m/06_fw",id:41,displayName:"skateboard"},42:{name:"/m/019w40",id:42,displayName:"surfboard"},43:{name:"/m/0dv9c",id:43,displayName:"tennis racket"},44:{name:"/m/04dr76w",id:44,displayName:"bottle"},46:{name:"/m/09tvcd",id:46,displayName:"wine glass"},47:{name:"/m/08gqpm",id:47,displayName:"cup"},48:{name:"/m/0dt3t",id:48,displayName:"fork"},49:{name:"/m/04ctx",id:49,displayName:"knife"},50:{name:"/m/0cmx8",id:50,displayName:"spoon"},51:{name:"/m/04kkgm",id:51,displayName:"bowl"},52:{name:"/m/09qck",id:52,displayName:"banana"},53:{name:"/m/014j1m",id:53,displayName:"apple"},54:{name:"/m/0l515",id:54,displayName:"sandwich"},55:{name:"/m/0cyhj_",id:55,displayName:"orange"},56:{name:"/m/0hkxq",id:56,displayName:"broccoli"},57:{name:"/m/0fj52s",id:57,displayName:"carrot"},58:{name:"/m/01b9xk",id:58,displayName:"hot dog"},59:{name:"/m/0663v",id:59,displayName:"pizza"},60:{name:"/m/0jy4k",id:60,displayName:"donut"},61:{name:"/m/0fszt",id:61,displayName:"cake"},62:{name:"/m/01mzpv",id:62,displayName:"chair"},63:{name:"/m/02crq1",id:63,displayName:"couch"},64:{name:"/m/03fp41",id:64,displayName:"potted plant"},65:{name:"/m/03ssj5",id:65,displayName:"bed"},67:{name:"/m/04bcr3",id:67,displayName:"dining table"},70:{name:"/m/09g1w",id:70,displayName:"toilet"},72:{name:"/m/07c52",id:72,displayName:"tv"},73:{name:"/m/01c648",id:73,displayName:"laptop"},74:{name:"/m/020lf",id:74,displayName:"mouse"},75:{name:"/m/0qjjc",id:75,displayName:"remote"},76:{name:"/m/01m2v",id:76,displayName:"keyboard"},77:{name:"/m/050k8",id:77,displayName:"cell phone"},78:{name:"/m/0fx9l",id:78,displayName:"microwave"},79:{name:"/m/029bxz",id:79,displayName:"oven"},80:{name:"/m/01k6s3",id:80,displayName:"toaster"},81:{name:"/m/0130jx",id:81,displayName:"sink"},82:{name:"/m/040b_t",id:82,displayName:"refrigerator"},84:{name:"/m/0bt_c3",id:84,displayName:"book"},85:{name:"/m/01x3z",id:85,displayName:"clock"},86:{name:"/m/02s195",id:86,displayName:"vase"},87:{name:"/m/01lsmm",id:87,displayName:"scissors"},88:{name:"/m/0kmg4",id:88,displayName:"teddy bear"},89:{name:"/m/03wvsk",id:89,displayName:"hair drier"},90:{name:"/m/012xff",id:90,displayName:"toothbrush"}};class i{constructor(l,c){this.modelPath=c||`https://storage.googleapis.com/tfjs-models/savedmodel/${this.getPrefix(l)}/model.json`}getPrefix(l){return l==="lite_mobilenet_v2"?`ssd${l}`:`ssd_${l}`}async load(){this.model=await s.loadGraphModel(this.modelPath);const l=r.zeros([1,300,300,3],"int32"),c=await this.model.executeAsync(l);await Promise.all(c.map(d=>d.data())),c.map(d=>d.dispose()),l.dispose()}async infer(l,c,d){const f=r.tidy(()=>(l instanceof r.Tensor||(l=r.browser.fromPixels(l)),r.expandDims(l))),m=f.shape[1],g=f.shape[2],b=await this.model.executeAsync(f),x=b[0].dataSync(),v=b[1].dataSync();f.dispose(),r.dispose(b);const[w,T]=this.calculateMaxScores(x,b[0].shape[1],b[0].shape[2]),C=r.getBackend();r.getBackend()==="webgl"&&r.setBackend("cpu");const k=r.tidy(()=>{const I=r.tensor2d(v,[b[1].shape[1],b[1].shape[3]]);return r.image.nonMaxSuppression(I,w,c,d,d)}),$=k.dataSync();return k.dispose(),C!==r.getBackend()&&r.setBackend(C),this.buildDetectedObjects(g,m,v,w,$,T)}buildDetectedObjects(l,c,d,f,m,g){const b=m.length,x=[];for(let v=0;v<b;v++){const w=[];for(let I=0;I<4;I++)w[I]=d[4*m[v]+I];const T=w[0]*c,C=w[1]*l,k=w[2]*c,$=w[3]*l;w[0]=C,w[1]=T,w[2]=$-C,w[3]=k-T,x.push({bbox:w,class:a[g[m[v]]+1].displayName,score:f[m[v]]})}return x}calculateMaxScores(l,c,d){const f=[],m=[];for(let g=0;g<c;g++){let b=Number.MIN_VALUE,x=-1;for(let v=0;v<d;v++)l[g*d+v]>b&&(b=l[g*d+v],x=v);f[g]=b,m[g]=x}return[f,m]}async detect(l,c=20,d=.5){return this.infer(l,c,d)}dispose(){this.model!=null&&this.model.dispose()}}e.ObjectDetection=i,e.load=async function(o={}){if(r==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");const l=o.base||"lite_mobilenet_v2",c=o.modelUrl;if(["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(l)===-1)throw new Error(`ObjectDetection constructed with invalid base model ${l}. Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.`);const d=new i(l,c);return await d.load(),d},e.version="2.2.3",Object.defineProperty(e,"__esModule",{value:!0})})}(Pd,Pd.exports)),Pd.exports}var Vvt=Bvt();function YS(){const n=nt.useRef(null),t=nt.useRef(null),e=nt.useRef(null),s=nt.useRef(null),r=nt.useRef(null);return nt.useEffect(()=>((async()=>{try{const i=await navigator.mediaDevices.getUserMedia({video:!0});e.current=i,n.current&&(n.current.srcObject=i,n.current.onloadedmetadata=async()=>{await n.current.play(),r.current=await Vvt.load();const o=async()=>{if(n.current&&n.current.readyState===4&&t.current&&r.current){const l=n.current,c=t.current,d=c.getContext("2d");c.width=l.videoWidth,c.height=l.videoHeight,d.clearRect(0,0,c.width,c.height),d.drawImage(l,0,0,c.width,c.height);const f=await r.current.detect(l);console.log("Predictions:",f),f.forEach(m=>{const[g,b,x,v]=m.bbox;d.strokeStyle="lime",d.lineWidth=2,d.strokeRect(g,b,x,v),d.font="16px Arial",d.fillStyle="lime",d.fillText(m.class,g,b>10?b-5:10)})}s.current=requestAnimationFrame(o)};o()})}catch(i){console.error("Error accessing webcam:",i)}})(),()=>{s.current&&cancelAnimationFrame(s.current),e.current&&e.current.getTracks().forEach(i=>i.stop())}),[]),q.jsx("div",{className:"camera-wrapper",children:q.jsxs("div",{className:"webcam",children:[q.jsx("video",{ref:n,autoPlay:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"inherit"}}),q.jsx("canvas",{ref:t,className:"overlay"})]})})}const Uvt="/zen-app/assets/zen_music-CS5ZWNfA.mp3",Rw=[{content:q.jsx("div",{className:"lets-begin-container",children:q.jsx("div",{className:"lets-begin-wrapper",children:q.jsx("h1",{className:"lb-message",children:"Let's Begin"})})}),duration:1500,transition:.3,delay:.6},{content:q.jsx("div",{className:"camera-component",children:q.jsx(YS,{})}),duration:1e4,transition:.3,delay:.8},{content:q.jsxs("div",{className:"text-container",children:[q.jsx("h1",{className:"text-title",children:"Breathe in..."}),q.jsx("p",{className:"text-subtitle",children:"and hold"})]}),duration:7e3,transition:.3,delay:.8},{content:q.jsx("div",{className:"text-container",children:q.jsx("h1",{className:"text-title",children:"Breathe out..."})}),duration:7e3,transition:.3,delay:.8},{content:q.jsx("div",{className:"camera-component",children:q.jsx(YS,{})}),duration:4e3,transition:.3,delay:.8},{content:q.jsxs("div",{className:"text-container",children:[q.jsx("h1",{className:"text-title",children:"Great work today!"}),q.jsx("p",{className:"text-subtitle",children:"Let's record your meditation session."})]}),duration:4e3,transition:.3,delay:.8}];function Wvt(){const[n,t]=nt.useState(0),e=Rw[n],s=uc(),r=nt.useRef(null);return nt.useEffect(()=>(r.current&&r.current.play().catch(a=>{console.log("Audio playback failed:",a)}),()=>{r.current&&(r.current.pause(),r.current.currentTime=0)}),[]),nt.useEffect(()=>{const a=Rw[n];if(n<Rw.length-1){const i=setTimeout(()=>{t(o=>o+1)},a.duration);return()=>clearTimeout(i)}else setTimeout(()=>{s("/trigger_selection")},a.duration)},[n,s]),q.jsxs(q.Fragment,{children:[q.jsx("audio",{ref:r,src:Uvt,loop:!0}),q.jsx(qI,{children:q.jsx(cR.div,{className:"background",initial:{opacity:0,scale:1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1},transition:{duration:1}},5)}),q.jsx(qI,{children:q.jsx(cR.div,{initial:{opacity:0,y:0},animate:{opacity:1,y:0},exit:{opacity:0,y:0},transition:{delay:e.delay||0,duration:e.transition},className:"meditation-step",children:e.content},n)})]})}function Gvt(){const[n,t]=nt.useState(!1),e=()=>{t(s=>!s)};return q.jsx(q.Fragment,{children:q.jsx("div",{className:"menu-component",children:q.jsx("div",{className:`menu-background ${n?"visible":""}`,children:q.jsxs("div",{className:"menu-wrapper",children:[q.jsx("div",{className:"menu-button",onClick:e,children:q.jsx(OO,{width:100,height:100,cx:50,cy:50,rx:33.3,ry:33.3,startOffset:0,reversed:!0,text:"MENU MENU MENU MENU MENU MENU MENU ",textProps:{style:{fontSize:7},textLength:360,lengthAdjust:"spacing"},textPathProps:null,tspanProps:null,ellipseProps:null,svgProps:{className:"rotating-curved-text"}})}),q.jsxs("div",{className:`menu-dropdown ${n?"visible":"hidden"}`,children:[q.jsx(Zd,{className:"link",to:"/",onClick:()=>t(!1),children:"MEDITATION"}),q.jsx(Zd,{className:"link",to:"/emotion",onClick:()=>t(!1),children:"EMOTION"})]})]})})})})}const jvt=[{title:"Family",svg:q.jsx(_O,{size:100})},{title:"News",svg:q.jsx(FO,{size:100})},{title:"Health",svg:q.jsx(LO,{size:100})},{title:"Work",svg:q.jsx(MO,{size:100})},{title:"Friends",svg:q.jsx(zO,{size:100})},{title:"Participation",svg:q.jsx(PO,{size:100})},{title:"Self",svg:q.jsx(BO,{size:100})},{title:"Relationships",svg:q.jsx(VO,{size:100})},{title:"Activities",svg:q.jsx(UO,{size:100})},{title:"Independence",svg:q.jsx(WO,{size:100})}];function Hvt(){const[n,t]=nt.useState([]),[e,s]=nt.useState(""),r=uc(),a=o=>{s(""),t(l=>l.includes(o)?l.filter(c=>c!==o):[...l,o])},i=()=>{if(n.length===0){s("Please select at least one trigger before continuing.");return}r("/emotion_selection",{state:{selectedTriggers:n}})};return q.jsxs("div",{className:"trigger-selection-page",children:[q.jsx("h1",{className:"title",children:"Choose Trigger(s) for today"}),q.jsx("div",{className:"trigger-options",children:jvt.map(({title:o,svg:l})=>{const c=n.includes(o);return q.jsxs("div",{className:"trigger-option",children:[q.jsx("p",{className:"trigger-name",children:o}),q.jsx("div",{className:`trigger-icon-wrapper ${c?"selected":""}`,onClick:()=>a(o),children:q.jsx("div",{className:"trigger-icon",children:l})})]},o)})}),q.jsx("div",{className:"done-button",onClick:i,children:q.jsx("p",{children:"Done"})}),e&&q.jsx("p",{className:"error-message",children:e})]})}const qvt=[{title:"Acceptance",color:"#ED6841"},{title:"Calm",color:"#9ED6F4"},{title:"Excited",color:"#ED5073"},{title:"Grateful",color:"#F37EC6"},{title:"Happy",color:"#FADD4E"},{title:"Hopeful",color:"#6466D4"},{title:"Loved",color:"#F2C0DE"},{title:"Relaxed",color:"#9FEAD6"},{title:"Relieved",color:"#2F78F6"},{title:"Satisfied",color:"#FFB800"},{title:"Angry",color:"#B24C47"},{title:"Anxious",color:"#7E9AA9"},{title:"Bored",color:"#2A5A8D"},{title:"Detached",color:"#CCC3FA"},{title:"Helpless",color:"#48A8F8"},{title:"Restless",color:"#6ED89C"},{title:"Sad",color:"#113576"},{title:"Stressed",color:"#95387C"},{title:"Tired",color:"#71CAC3"},{title:"Worried",color:"#F19795"}];function Kvt(){const[n,t]=nt.useState([]),[e,s]=nt.useState(""),r=uc(),a=li(),{selectedTriggers:i}=a.state||{},o=c=>{s(""),t(d=>d.includes(c)?d.filter(f=>f!==c):[...d,c])};console.log("Selected Triggers:",i);const l=()=>{if(n.length===0){s("Please select at least one emotion before continuing.");return}r("/meditation_result",{state:{selectedTriggers:i,selectedEmotions:n}})};return q.jsxs("div",{className:"emotion-selection-page",children:[q.jsx("h1",{className:"title",children:"Choose emotion(s) for today"}),q.jsx("div",{className:"emotion-options",children:qvt.map(({title:c,color:d})=>{const f=n.includes(d);return q.jsxs("div",{className:"emotion-option",children:[q.jsx("p",{className:"emotion-name",children:c}),q.jsx("div",{className:`emotion-color-wrapper ${f?"selected":""}`,onClick:()=>o(d),children:q.jsx("div",{className:"emotion-color",style:{backgroundColor:d}})})]})})}),q.jsx("div",{className:"done-button",onClick:l,children:q.jsx("p",{children:"Done"})}),e&&q.jsx("p",{className:"error-message",children:e})]})}function Xvt(){const n=li(),{selectedTriggers:t=[],selectedEmotions:e=[]}=n.state||{},[s,r]=nt.useState(""),a=uc(),i=()=>{if(s){const o={name:s,emotions:e,triggers:t},l=localStorage.getItem("bubbles"),c=l?JSON.parse(l):[],d=[o,...c];localStorage.setItem("bubbles",JSON.stringify(d)),a("/emotion")}};return console.log(s),console.log("Selected Triggers:",t),console.log("Selected Emotions:",e),q.jsxs("div",{className:"session-result-page",children:[q.jsxs("div",{className:"result-container",children:[q.jsx("div",{className:"result-svg-container",children:q.jsx("div",{className:"result-svg",children:q.jsx(GO,{size:410,emotions:e,triggers:t})})}),q.jsxs("div",{className:"name-input",children:[q.jsx("input",{type:"text",id:"name",placeholder:"Enter your name",onChange:o=>r(o.target.value),className:"minimal-input",autoComplete:"off"}),q.jsx("label",{htmlFor:"name",className:"input-label",children:"Enter your name"})]})]}),q.jsx("div",{className:"radial-gradient-bg"}),q.jsx("div",{className:"glass-blur-overlay"}),q.jsx("div",{className:"result-submit-button",children:q.jsx("div",{className:"wrapper",children:q.jsxs("button",{className:"submit-btn",onClick:i,children:[q.jsx("span",{children:"Submit"}),q.jsx("path",{d:"M29.049,5.009L28.19,4.151c-0.943-0.945-2.488-0.945-3.434,0L10.172,18.737l-5.175-5.173c-0.943-0.944-2.489-0.944-3.432,0.001l-0.858,0.857c-0.943,0.944-0.943,2.489,0,3.433l7.744,7.752c0.944,0.943,2.489,0.943,3.433,0L29.049,8.442C29.991,7.498,29.991,5.953,29.049,5.009z"})]})})})]})}function Yvt(){return q.jsx(q.Fragment,{children:q.jsxs(eG,{children:[q.jsx(Gvt,{}),q.jsxs(DW,{children:[q.jsx(Vi,{path:"/",element:q.jsx(kG,{})}),q.jsx(Vi,{path:"/emotion",element:q.jsx($G,{})}),q.jsx(Vi,{path:"/meditation_session",element:q.jsx(Wvt,{})}),q.jsx(Vi,{path:"/trigger_selection",element:q.jsx(Hvt,{})}),q.jsx(Vi,{path:"/emotion_selection",element:q.jsx(Kvt,{})}),q.jsx(Vi,{path:"/meditation_result",element:q.jsx(Xvt,{})}),q.jsx(Vi,{path:"/camera",element:q.jsx(YS,{})})]})]})})}UU.createRoot(document.getElementById("root")).render(q.jsx(nt.StrictMode,{children:q.jsx(Yvt,{})}));
